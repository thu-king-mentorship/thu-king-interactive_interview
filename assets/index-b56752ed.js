(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const o of document.querySelectorAll('link[rel="modulepreload"]'))r(o);new MutationObserver(o=>{for(const i of o)if(i.type==="childList")for(const s of i.addedNodes)s.tagName==="LINK"&&s.rel==="modulepreload"&&r(s)}).observe(document,{childList:!0,subtree:!0});function n(o){const i={};return o.integrity&&(i.integrity=o.integrity),o.referrerPolicy&&(i.referrerPolicy=o.referrerPolicy),o.crossOrigin==="use-credentials"?i.credentials="include":o.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function r(o){if(o.ep)return;o.ep=!0;const i=n(o);fetch(o.href,i)}})();const Av="modulepreload",Iv=function(e,t){return new URL(e,t).href},cd={},Pv=function(t,n,r){if(!n||n.length===0)return t();const o=document.getElementsByTagName("link");return Promise.all(n.map(i=>{if(i=Iv(i,r),i in cd)return;cd[i]=!0;const s=i.endsWith(".css"),l=s?'[rel="stylesheet"]':"";if(!!r)for(let p=o.length-1;p>=0;p--){const a=o[p];if(a.href===i&&(!s||a.rel==="stylesheet"))return}else if(document.querySelector(`link[href="${i}"]${l}`))return;const c=document.createElement("link");if(c.rel=s?"stylesheet":Av,s||(c.as="script",c.crossOrigin=""),c.href=i,document.head.appendChild(c),s)return new Promise((p,a)=>{c.addEventListener("load",p),c.addEventListener("error",()=>a(new Error(`Unable to preload CSS for ${i}`)))})})).then(()=>t()).catch(i=>{const s=new Event("vite:preloadError",{cancelable:!0});if(s.payload=i,window.dispatchEvent(s),!s.defaultPrevented)throw i})};/**
* @vue/shared v3.5.13
* (c) 2018-present Yuxi (Evan) You and Vue contributors
* @license MIT
**//*! #__NO_SIDE_EFFECTS__ */function gc(e){const t=Object.create(null);for(const n of e.split(","))t[n]=1;return n=>n in t}const yt={},Wo=[],Dn=()=>{},jv=()=>!1,wa=e=>e.charCodeAt(0)===111&&e.charCodeAt(1)===110&&(e.charCodeAt(2)>122||e.charCodeAt(2)<97),vc=e=>e.startsWith("onUpdate:"),Mt=Object.assign,bc=(e,t)=>{const n=e.indexOf(t);n>-1&&e.splice(n,1)},Ev=Object.prototype.hasOwnProperty,dt=(e,t)=>Ev.call(e,t),De=Array.isArray,zo=e=>ui(e)==="[object Map]",ka=e=>ui(e)==="[object Set]",ud=e=>ui(e)==="[object Date]",We=e=>typeof e=="function",kt=e=>typeof e=="string",Bn=e=>typeof e=="symbol",gt=e=>e!==null&&typeof e=="object",ef=e=>(gt(e)||We(e))&&We(e.then)&&We(e.catch),tf=Object.prototype.toString,ui=e=>tf.call(e),Nv=e=>ui(e).slice(8,-1),nf=e=>ui(e)==="[object Object]",_c=e=>kt(e)&&e!=="NaN"&&e[0]!=="-"&&""+parseInt(e,10)===e,Ps=gc(",key,ref,ref_for,ref_key,onVnodeBeforeMount,onVnodeMounted,onVnodeBeforeUpdate,onVnodeUpdated,onVnodeBeforeUnmount,onVnodeUnmounted"),Sa=e=>{const t=Object.create(null);return n=>t[n]||(t[n]=e(n))},Mv=/-(\w)/g,$n=Sa(e=>e.replace(Mv,(t,n)=>n?n.toUpperCase():"")),Lv=/\B([A-Z])/g,jo=Sa(e=>e.replace(Lv,"-$1").toLowerCase()),Ca=Sa(e=>e.charAt(0).toUpperCase()+e.slice(1)),tl=Sa(e=>e?`on${Ca(e)}`:""),Vr=(e,t)=>!Object.is(e,t),Ri=(e,...t)=>{for(let n=0;n<e.length;n++)e[n](...t)},rf=(e,t,n,r=!1)=>{Object.defineProperty(e,t,{configurable:!0,enumerable:!1,writable:r,value:n})},Il=e=>{const t=parseFloat(e);return isNaN(t)?e:t},Dv=e=>{const t=kt(e)?Number(e):NaN;return isNaN(t)?e:t};let dd;const xa=()=>dd||(dd=typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:typeof global<"u"?global:{});function Ye(e){if(De(e)){const t={};for(let n=0;n<e.length;n++){const r=e[n],o=kt(r)?Uv(r):Ye(r);if(o)for(const i in o)t[i]=o[i]}return t}else if(kt(e)||gt(e))return e}const Rv=/;(?![^(]*\))/g,Fv=/:([^]+)/,Bv=/\/\*[^]*?\*\//g;function Uv(e){const t={};return e.replace(Bv,"").split(Rv).forEach(n=>{if(n){const r=n.split(Fv);r.length>1&&(t[r[0].trim()]=r[1].trim())}}),t}function Xe(e){let t="";if(kt(e))t=e;else if(De(e))for(let n=0;n<e.length;n++){const r=Xe(e[n]);r&&(t+=r+" ")}else if(gt(e))for(const n in e)e[n]&&(t+=n+" ");return t.trim()}function qv(e){if(!e)return null;let{class:t,style:n}=e;return t&&!kt(t)&&(e.class=Xe(t)),n&&(e.style=Ye(n)),e}const Vv="itemscope,allowfullscreen,formnovalidate,ismap,nomodule,novalidate,readonly",Hv=gc(Vv);function of(e){return!!e||e===""}function Kv(e,t){if(e.length!==t.length)return!1;let n=!0;for(let r=0;n&&r<e.length;r++)n=$a(e[r],t[r]);return n}function $a(e,t){if(e===t)return!0;let n=ud(e),r=ud(t);if(n||r)return n&&r?e.getTime()===t.getTime():!1;if(n=Bn(e),r=Bn(t),n||r)return e===t;if(n=De(e),r=De(t),n||r)return n&&r?Kv(e,t):!1;if(n=gt(e),r=gt(t),n||r){if(!n||!r)return!1;const o=Object.keys(e).length,i=Object.keys(t).length;if(o!==i)return!1;for(const s in e){const l=e.hasOwnProperty(s),u=t.hasOwnProperty(s);if(l&&!u||!l&&u||!$a(e[s],t[s]))return!1}}return String(e)===String(t)}function sf(e,t){return e.findIndex(n=>$a(n,t))}const af=e=>!!(e&&e.__v_isRef===!0),Se=e=>kt(e)?e:e==null?"":De(e)||gt(e)&&(e.toString===tf||!We(e.toString))?af(e)?Se(e.value):JSON.stringify(e,lf,2):String(e),lf=(e,t)=>af(t)?lf(e,t.value):zo(t)?{[`Map(${t.size})`]:[...t.entries()].reduce((n,[r,o],i)=>(n[nl(r,i)+" =>"]=o,n),{})}:ka(t)?{[`Set(${t.size})`]:[...t.values()].map(n=>nl(n))}:Bn(t)?nl(t):gt(t)&&!De(t)&&!nf(t)?String(t):t,nl=(e,t="")=>{var n;return Bn(e)?`Symbol(${(n=e.description)!=null?n:t})`:e};/**
* @vue/reactivity v3.5.13
* (c) 2018-present Yuxi (Evan) You and Vue contributors
* @license MIT
**/let rn;class cf{constructor(t=!1){this.detached=t,this._active=!0,this.effects=[],this.cleanups=[],this._isPaused=!1,this.parent=rn,!t&&rn&&(this.index=(rn.scopes||(rn.scopes=[])).push(this)-1)}get active(){return this._active}pause(){if(this._active){this._isPaused=!0;let t,n;if(this.scopes)for(t=0,n=this.scopes.length;t<n;t++)this.scopes[t].pause();for(t=0,n=this.effects.length;t<n;t++)this.effects[t].pause()}}resume(){if(this._active&&this._isPaused){this._isPaused=!1;let t,n;if(this.scopes)for(t=0,n=this.scopes.length;t<n;t++)this.scopes[t].resume();for(t=0,n=this.effects.length;t<n;t++)this.effects[t].resume()}}run(t){if(this._active){const n=rn;try{return rn=this,t()}finally{rn=n}}}on(){rn=this}off(){rn=this.parent}stop(t){if(this._active){this._active=!1;let n,r;for(n=0,r=this.effects.length;n<r;n++)this.effects[n].stop();for(this.effects.length=0,n=0,r=this.cleanups.length;n<r;n++)this.cleanups[n]();if(this.cleanups.length=0,this.scopes){for(n=0,r=this.scopes.length;n<r;n++)this.scopes[n].stop(!0);this.scopes.length=0}if(!this.detached&&this.parent&&!t){const o=this.parent.scopes.pop();o&&o!==this&&(this.parent.scopes[this.index]=o,o.index=this.index)}this.parent=void 0}}}function uf(e){return new cf(e)}function df(){return rn}function Gv(e,t=!1){rn&&rn.cleanups.push(e)}let bt;const rl=new WeakSet;class pf{constructor(t){this.fn=t,this.deps=void 0,this.depsTail=void 0,this.flags=5,this.next=void 0,this.cleanup=void 0,this.scheduler=void 0,rn&&rn.active&&rn.effects.push(this)}pause(){this.flags|=64}resume(){this.flags&64&&(this.flags&=-65,rl.has(this)&&(rl.delete(this),this.trigger()))}notify(){this.flags&2&&!(this.flags&32)||this.flags&8||hf(this)}run(){if(!(this.flags&1))return this.fn();this.flags|=2,pd(this),mf(this);const t=bt,n=Rn;bt=this,Rn=!0;try{return this.fn()}finally{yf(this),bt=t,Rn=n,this.flags&=-3}}stop(){if(this.flags&1){for(let t=this.deps;t;t=t.nextDep)kc(t);this.deps=this.depsTail=void 0,pd(this),this.onStop&&this.onStop(),this.flags&=-2}}trigger(){this.flags&64?rl.add(this):this.scheduler?this.scheduler():this.runIfDirty()}runIfDirty(){Pl(this)&&this.run()}get dirty(){return Pl(this)}}let ff=0,js,Es;function hf(e,t=!1){if(e.flags|=8,t){e.next=Es,Es=e;return}e.next=js,js=e}function Tc(){ff++}function wc(){if(--ff>0)return;if(Es){let t=Es;for(Es=void 0;t;){const n=t.next;t.next=void 0,t.flags&=-9,t=n}}let e;for(;js;){let t=js;for(js=void 0;t;){const n=t.next;if(t.next=void 0,t.flags&=-9,t.flags&1)try{t.trigger()}catch(r){e||(e=r)}t=n}}if(e)throw e}function mf(e){for(let t=e.deps;t;t=t.nextDep)t.version=-1,t.prevActiveLink=t.dep.activeLink,t.dep.activeLink=t}function yf(e){let t,n=e.depsTail,r=n;for(;r;){const o=r.prevDep;r.version===-1?(r===n&&(n=o),kc(r),Wv(r)):t=r,r.dep.activeLink=r.prevActiveLink,r.prevActiveLink=void 0,r=o}e.deps=t,e.depsTail=n}function Pl(e){for(let t=e.deps;t;t=t.nextDep)if(t.dep.version!==t.version||t.dep.computed&&(gf(t.dep.computed)||t.dep.version!==t.version))return!0;return!!e._dirty}function gf(e){if(e.flags&4&&!(e.flags&16)||(e.flags&=-17,e.globalVersion===Ws))return;e.globalVersion=Ws;const t=e.dep;if(e.flags|=2,t.version>0&&!e.isSSR&&e.deps&&!Pl(e)){e.flags&=-3;return}const n=bt,r=Rn;bt=e,Rn=!0;try{mf(e);const o=e.fn(e._value);(t.version===0||Vr(o,e._value))&&(e._value=o,t.version++)}catch(o){throw t.version++,o}finally{bt=n,Rn=r,yf(e),e.flags&=-3}}function kc(e,t=!1){const{dep:n,prevSub:r,nextSub:o}=e;if(r&&(r.nextSub=o,e.prevSub=void 0),o&&(o.prevSub=r,e.nextSub=void 0),n.subs===e&&(n.subs=r,!r&&n.computed)){n.computed.flags&=-5;for(let i=n.computed.deps;i;i=i.nextDep)kc(i,!0)}!t&&!--n.sc&&n.map&&n.map.delete(n.key)}function Wv(e){const{prevDep:t,nextDep:n}=e;t&&(t.nextDep=n,e.prevDep=void 0),n&&(n.prevDep=t,e.nextDep=void 0)}let Rn=!0;const vf=[];function Xr(){vf.push(Rn),Rn=!1}function Zr(){const e=vf.pop();Rn=e===void 0?!0:e}function pd(e){const{cleanup:t}=e;if(e.cleanup=void 0,t){const n=bt;bt=void 0;try{t()}finally{bt=n}}}let Ws=0;class zv{constructor(t,n){this.sub=t,this.dep=n,this.version=n.version,this.nextDep=this.prevDep=this.nextSub=this.prevSub=this.prevActiveLink=void 0}}class Sc{constructor(t){this.computed=t,this.version=0,this.activeLink=void 0,this.subs=void 0,this.map=void 0,this.key=void 0,this.sc=0}track(t){if(!bt||!Rn||bt===this.computed)return;let n=this.activeLink;if(n===void 0||n.sub!==bt)n=this.activeLink=new zv(bt,this),bt.deps?(n.prevDep=bt.depsTail,bt.depsTail.nextDep=n,bt.depsTail=n):bt.deps=bt.depsTail=n,bf(n);else if(n.version===-1&&(n.version=this.version,n.nextDep)){const r=n.nextDep;r.prevDep=n.prevDep,n.prevDep&&(n.prevDep.nextDep=r),n.prevDep=bt.depsTail,n.nextDep=void 0,bt.depsTail.nextDep=n,bt.depsTail=n,bt.deps===n&&(bt.deps=r)}return n}trigger(t){this.version++,Ws++,this.notify(t)}notify(t){Tc();try{for(let n=this.subs;n;n=n.prevSub)n.sub.notify()&&n.sub.dep.notify()}finally{wc()}}}function bf(e){if(e.dep.sc++,e.sub.flags&4){const t=e.dep.computed;if(t&&!e.dep.subs){t.flags|=20;for(let r=t.deps;r;r=r.nextDep)bf(r)}const n=e.dep.subs;n!==e&&(e.prevSub=n,n&&(n.nextSub=e)),e.dep.subs=e}}const zi=new WeakMap,To=Symbol(""),jl=Symbol(""),zs=Symbol("");function zt(e,t,n){if(Rn&&bt){let r=zi.get(e);r||zi.set(e,r=new Map);let o=r.get(n);o||(r.set(n,o=new Sc),o.map=r,o.key=n),o.track()}}function yr(e,t,n,r,o,i){const s=zi.get(e);if(!s){Ws++;return}const l=u=>{u&&u.trigger()};if(Tc(),t==="clear")s.forEach(l);else{const u=De(e),c=u&&_c(n);if(u&&n==="length"){const p=Number(r);s.forEach((a,d)=>{(d==="length"||d===zs||!Bn(d)&&d>=p)&&l(a)})}else switch((n!==void 0||s.has(void 0))&&l(s.get(n)),c&&l(s.get(zs)),t){case"add":u?c&&l(s.get("length")):(l(s.get(To)),zo(e)&&l(s.get(jl)));break;case"delete":u||(l(s.get(To)),zo(e)&&l(s.get(jl)));break;case"set":zo(e)&&l(s.get(To));break}}wc()}function Qv(e,t){const n=zi.get(e);return n&&n.get(t)}function Do(e){const t=nt(e);return t===e?t:(zt(t,"iterate",zs),Sn(e)?t:t.map(Qt))}function Oa(e){return zt(e=nt(e),"iterate",zs),e}const Jv={__proto__:null,[Symbol.iterator](){return ol(this,Symbol.iterator,Qt)},concat(...e){return Do(this).concat(...e.map(t=>De(t)?Do(t):t))},entries(){return ol(this,"entries",e=>(e[1]=Qt(e[1]),e))},every(e,t){return hr(this,"every",e,t,void 0,arguments)},filter(e,t){return hr(this,"filter",e,t,n=>n.map(Qt),arguments)},find(e,t){return hr(this,"find",e,t,Qt,arguments)},findIndex(e,t){return hr(this,"findIndex",e,t,void 0,arguments)},findLast(e,t){return hr(this,"findLast",e,t,Qt,arguments)},findLastIndex(e,t){return hr(this,"findLastIndex",e,t,void 0,arguments)},forEach(e,t){return hr(this,"forEach",e,t,void 0,arguments)},includes(...e){return sl(this,"includes",e)},indexOf(...e){return sl(this,"indexOf",e)},join(e){return Do(this).join(e)},lastIndexOf(...e){return sl(this,"lastIndexOf",e)},map(e,t){return hr(this,"map",e,t,void 0,arguments)},pop(){return ks(this,"pop")},push(...e){return ks(this,"push",e)},reduce(e,...t){return fd(this,"reduce",e,t)},reduceRight(e,...t){return fd(this,"reduceRight",e,t)},shift(){return ks(this,"shift")},some(e,t){return hr(this,"some",e,t,void 0,arguments)},splice(...e){return ks(this,"splice",e)},toReversed(){return Do(this).toReversed()},toSorted(e){return Do(this).toSorted(e)},toSpliced(...e){return Do(this).toSpliced(...e)},unshift(...e){return ks(this,"unshift",e)},values(){return ol(this,"values",Qt)}};function ol(e,t,n){const r=Oa(e),o=r[t]();return r!==e&&!Sn(e)&&(o._next=o.next,o.next=()=>{const i=o._next();return i.value&&(i.value=n(i.value)),i}),o}const Yv=Array.prototype;function hr(e,t,n,r,o,i){const s=Oa(e),l=s!==e&&!Sn(e),u=s[t];if(u!==Yv[t]){const a=u.apply(e,i);return l?Qt(a):a}let c=n;s!==e&&(l?c=function(a,d){return n.call(this,Qt(a),d,e)}:n.length>2&&(c=function(a,d){return n.call(this,a,d,e)}));const p=u.call(s,c,r);return l&&o?o(p):p}function fd(e,t,n,r){const o=Oa(e);let i=n;return o!==e&&(Sn(e)?n.length>3&&(i=function(s,l,u){return n.call(this,s,l,u,e)}):i=function(s,l,u){return n.call(this,s,Qt(l),u,e)}),o[t](i,...r)}function sl(e,t,n){const r=nt(e);zt(r,"iterate",zs);const o=r[t](...n);return(o===-1||o===!1)&&$c(n[0])?(n[0]=nt(n[0]),r[t](...n)):o}function ks(e,t,n=[]){Xr(),Tc();const r=nt(e)[t].apply(e,n);return wc(),Zr(),r}const Xv=gc("__proto__,__v_isRef,__isVue"),_f=new Set(Object.getOwnPropertyNames(Symbol).filter(e=>e!=="arguments"&&e!=="caller").map(e=>Symbol[e]).filter(Bn));function Zv(e){Bn(e)||(e=String(e));const t=nt(this);return zt(t,"has",e),t.hasOwnProperty(e)}class Tf{constructor(t=!1,n=!1){this._isReadonly=t,this._isShallow=n}get(t,n,r){if(n==="__v_skip")return t.__v_skip;const o=this._isReadonly,i=this._isShallow;if(n==="__v_isReactive")return!o;if(n==="__v_isReadonly")return o;if(n==="__v_isShallow")return i;if(n==="__v_raw")return r===(o?i?c0:Cf:i?Sf:kf).get(t)||Object.getPrototypeOf(t)===Object.getPrototypeOf(r)?t:void 0;const s=De(t);if(!o){let u;if(s&&(u=Jv[n]))return u;if(n==="hasOwnProperty")return Zv}const l=Reflect.get(t,n,Nt(t)?t:r);return(Bn(n)?_f.has(n):Xv(n))||(o||zt(t,"get",n),i)?l:Nt(l)?s&&_c(n)?l:l.value:gt(l)?o?xf(l):br(l):l}}class wf extends Tf{constructor(t=!1){super(!1,t)}set(t,n,r,o){let i=t[n];if(!this._isShallow){const u=$o(i);if(!Sn(r)&&!$o(r)&&(i=nt(i),r=nt(r)),!De(t)&&Nt(i)&&!Nt(r))return u?!1:(i.value=r,!0)}const s=De(t)&&_c(n)?Number(n)<t.length:dt(t,n),l=Reflect.set(t,n,r,Nt(t)?t:o);return t===nt(o)&&(s?Vr(r,i)&&yr(t,"set",n,r):yr(t,"add",n,r)),l}deleteProperty(t,n){const r=dt(t,n);t[n];const o=Reflect.deleteProperty(t,n);return o&&r&&yr(t,"delete",n,void 0),o}has(t,n){const r=Reflect.has(t,n);return(!Bn(n)||!_f.has(n))&&zt(t,"has",n),r}ownKeys(t){return zt(t,"iterate",De(t)?"length":To),Reflect.ownKeys(t)}}class e0 extends Tf{constructor(t=!1){super(!0,t)}set(t,n){return!0}deleteProperty(t,n){return!0}}const t0=new wf,n0=new e0,r0=new wf(!0);const El=e=>e,xi=e=>Reflect.getPrototypeOf(e);function o0(e,t,n){return function(...r){const o=this.__v_raw,i=nt(o),s=zo(i),l=e==="entries"||e===Symbol.iterator&&s,u=e==="keys"&&s,c=o[e](...r),p=n?El:t?Nl:Qt;return!t&&zt(i,"iterate",u?jl:To),{next(){const{value:a,done:d}=c.next();return d?{value:a,done:d}:{value:l?[p(a[0]),p(a[1])]:p(a),done:d}},[Symbol.iterator](){return this}}}}function $i(e){return function(...t){return e==="delete"?!1:e==="clear"?void 0:this}}function s0(e,t){const n={get(o){const i=this.__v_raw,s=nt(i),l=nt(o);e||(Vr(o,l)&&zt(s,"get",o),zt(s,"get",l));const{has:u}=xi(s),c=t?El:e?Nl:Qt;if(u.call(s,o))return c(i.get(o));if(u.call(s,l))return c(i.get(l));i!==s&&i.get(o)},get size(){const o=this.__v_raw;return!e&&zt(nt(o),"iterate",To),Reflect.get(o,"size",o)},has(o){const i=this.__v_raw,s=nt(i),l=nt(o);return e||(Vr(o,l)&&zt(s,"has",o),zt(s,"has",l)),o===l?i.has(o):i.has(o)||i.has(l)},forEach(o,i){const s=this,l=s.__v_raw,u=nt(l),c=t?El:e?Nl:Qt;return!e&&zt(u,"iterate",To),l.forEach((p,a)=>o.call(i,c(p),c(a),s))}};return Mt(n,e?{add:$i("add"),set:$i("set"),delete:$i("delete"),clear:$i("clear")}:{add(o){!t&&!Sn(o)&&!$o(o)&&(o=nt(o));const i=nt(this);return xi(i).has.call(i,o)||(i.add(o),yr(i,"add",o,o)),this},set(o,i){!t&&!Sn(i)&&!$o(i)&&(i=nt(i));const s=nt(this),{has:l,get:u}=xi(s);let c=l.call(s,o);c||(o=nt(o),c=l.call(s,o));const p=u.call(s,o);return s.set(o,i),c?Vr(i,p)&&yr(s,"set",o,i):yr(s,"add",o,i),this},delete(o){const i=nt(this),{has:s,get:l}=xi(i);let u=s.call(i,o);u||(o=nt(o),u=s.call(i,o)),l&&l.call(i,o);const c=i.delete(o);return u&&yr(i,"delete",o,void 0),c},clear(){const o=nt(this),i=o.size!==0,s=o.clear();return i&&yr(o,"clear",void 0,void 0),s}}),["keys","values","entries",Symbol.iterator].forEach(o=>{n[o]=o0(o,e,t)}),n}function Cc(e,t){const n=s0(e,t);return(r,o,i)=>o==="__v_isReactive"?!e:o==="__v_isReadonly"?e:o==="__v_raw"?r:Reflect.get(dt(n,o)&&o in r?n:r,o,i)}const i0={get:Cc(!1,!1)},a0={get:Cc(!1,!0)},l0={get:Cc(!0,!1)};const kf=new WeakMap,Sf=new WeakMap,Cf=new WeakMap,c0=new WeakMap;function u0(e){switch(e){case"Object":case"Array":return 1;case"Map":case"Set":case"WeakMap":case"WeakSet":return 2;default:return 0}}function d0(e){return e.__v_skip||!Object.isExtensible(e)?0:u0(Nv(e))}function br(e){return $o(e)?e:xc(e,!1,t0,i0,kf)}function p0(e){return xc(e,!1,r0,a0,Sf)}function xf(e){return xc(e,!0,n0,l0,Cf)}function xc(e,t,n,r,o){if(!gt(e)||e.__v_raw&&!(t&&e.__v_isReactive))return e;const i=o.get(e);if(i)return i;const s=d0(e);if(s===0)return e;const l=new Proxy(e,s===2?r:n);return o.set(e,l),l}function Hr(e){return $o(e)?Hr(e.__v_raw):!!(e&&e.__v_isReactive)}function $o(e){return!!(e&&e.__v_isReadonly)}function Sn(e){return!!(e&&e.__v_isShallow)}function $c(e){return e?!!e.__v_raw:!1}function nt(e){const t=e&&e.__v_raw;return t?nt(t):e}function Oc(e){return!dt(e,"__v_skip")&&Object.isExtensible(e)&&rf(e,"__v_skip",!0),e}const Qt=e=>gt(e)?br(e):e,Nl=e=>gt(e)?xf(e):e;function Nt(e){return e?e.__v_isRef===!0:!1}function be(e){return $f(e,!1)}function Ss(e){return $f(e,!0)}function $f(e,t){return Nt(e)?e:new f0(e,t)}class f0{constructor(t,n){this.dep=new Sc,this.__v_isRef=!0,this.__v_isShallow=!1,this._rawValue=n?t:nt(t),this._value=n?t:Qt(t),this.__v_isShallow=n}get value(){return this.dep.track(),this._value}set value(t){const n=this._rawValue,r=this.__v_isShallow||Sn(t)||$o(t);t=r?t:nt(t),Vr(t,n)&&(this._rawValue=t,this._value=r?t:Qt(t),this.dep.trigger())}}function st(e){return Nt(e)?e.value:e}const h0={get:(e,t,n)=>t==="__v_raw"?e:st(Reflect.get(e,t,n)),set:(e,t,n,r)=>{const o=e[t];return Nt(o)&&!Nt(n)?(o.value=n,!0):Reflect.set(e,t,n,r)}};function Of(e){return Hr(e)?e:new Proxy(e,h0)}function m0(e){const t=De(e)?new Array(e.length):{};for(const n in e)t[n]=g0(e,n);return t}class y0{constructor(t,n,r){this._object=t,this._key=n,this._defaultValue=r,this.__v_isRef=!0,this._value=void 0}get value(){const t=this._object[this._key];return this._value=t===void 0?this._defaultValue:t}set value(t){this._object[this._key]=t}get dep(){return Qv(nt(this._object),this._key)}}function g0(e,t,n){const r=e[t];return Nt(r)?r:new y0(e,t,n)}class v0{constructor(t,n,r){this.fn=t,this.setter=n,this._value=void 0,this.dep=new Sc(this),this.__v_isRef=!0,this.deps=void 0,this.depsTail=void 0,this.flags=16,this.globalVersion=Ws-1,this.next=void 0,this.effect=this,this.__v_isReadonly=!n,this.isSSR=r}notify(){if(this.flags|=16,!(this.flags&8)&&bt!==this)return hf(this,!0),!0}get value(){const t=this.dep.track();return gf(this),t&&(t.version=this.dep.version),this._value}set value(t){this.setter&&this.setter(t)}}function b0(e,t,n=!1){let r,o;return We(e)?r=e:(r=e.get,o=e.set),new v0(r,o,n)}const Oi={},Qi=new WeakMap;let po;function _0(e,t=!1,n=po){if(n){let r=Qi.get(n);r||Qi.set(n,r=[]),r.push(e)}}function T0(e,t,n=yt){const{immediate:r,deep:o,once:i,scheduler:s,augmentJob:l,call:u}=n,c=L=>o?L:Sn(L)||o===!1||o===0?gr(L,1):gr(L);let p,a,d,h,m=!1,y=!1;if(Nt(e)?(a=()=>e.value,m=Sn(e)):Hr(e)?(a=()=>c(e),m=!0):De(e)?(y=!0,m=e.some(L=>Hr(L)||Sn(L)),a=()=>e.map(L=>{if(Nt(L))return L.value;if(Hr(L))return c(L);if(We(L))return u?u(L,2):L()})):We(e)?t?a=u?()=>u(e,2):e:a=()=>{if(d){Xr();try{d()}finally{Zr()}}const L=po;po=p;try{return u?u(e,3,[h]):e(h)}finally{po=L}}:a=Dn,t&&o){const L=a,B=o===!0?1/0:o;a=()=>gr(L(),B)}const T=df(),g=()=>{p.stop(),T&&T.active&&bc(T.effects,p)};if(i&&t){const L=t;t=(...B)=>{L(...B),g()}}let C=y?new Array(e.length).fill(Oi):Oi;const N=L=>{if(!(!(p.flags&1)||!p.dirty&&!L))if(t){const B=p.run();if(o||m||(y?B.some((M,E)=>Vr(M,C[E])):Vr(B,C))){d&&d();const M=po;po=p;try{const E=[B,C===Oi?void 0:y&&C[0]===Oi?[]:C,h];u?u(t,3,E):t(...E),C=B}finally{po=M}}}else p.run()};return l&&l(N),p=new pf(a),p.scheduler=s?()=>s(N,!1):N,h=L=>_0(L,!1,p),d=p.onStop=()=>{const L=Qi.get(p);if(L){if(u)u(L,4);else for(const B of L)B();Qi.delete(p)}},t?r?N(!0):C=p.run():s?s(N.bind(null,!0),!0):p.run(),g.pause=p.pause.bind(p),g.resume=p.resume.bind(p),g.stop=g,g}function gr(e,t=1/0,n){if(t<=0||!gt(e)||e.__v_skip||(n=n||new Set,n.has(e)))return e;if(n.add(e),t--,Nt(e))gr(e.value,t,n);else if(De(e))for(let r=0;r<e.length;r++)gr(e[r],t,n);else if(ka(e)||zo(e))e.forEach(r=>{gr(r,t,n)});else if(nf(e)){for(const r in e)gr(e[r],t,n);for(const r of Object.getOwnPropertySymbols(e))Object.prototype.propertyIsEnumerable.call(e,r)&&gr(e[r],t,n)}return e}/**
* @vue/runtime-core v3.5.13
* (c) 2018-present Yuxi (Evan) You and Vue contributors
* @license MIT
**/function di(e,t,n,r){try{return r?e(...r):e()}catch(o){Aa(o,t,n)}}function Un(e,t,n,r){if(We(e)){const o=di(e,t,n,r);return o&&ef(o)&&o.catch(i=>{Aa(i,t,n)}),o}if(De(e)){const o=[];for(let i=0;i<e.length;i++)o.push(Un(e[i],t,n,r));return o}}function Aa(e,t,n,r=!0){const o=t?t.vnode:null,{errorHandler:i,throwUnhandledErrorInProduction:s}=t&&t.appContext.config||yt;if(t){let l=t.parent;const u=t.proxy,c=`https://vuejs.org/error-reference/#runtime-${n}`;for(;l;){const p=l.ec;if(p){for(let a=0;a<p.length;a++)if(p[a](e,u,c)===!1)return}l=l.parent}if(i){Xr(),di(i,null,10,[e,u,c]),Zr();return}}w0(e,n,o,r,s)}function w0(e,t,n,r=!0,o=!1){if(o)throw e;console.error(e)}const sn=[];let Qn=-1;const Qo=[];let Rr=null,qo=0;const Af=Promise.resolve();let Ji=null;function pi(e){const t=Ji||Af;return e?t.then(this?e.bind(this):e):t}function k0(e){let t=Qn+1,n=sn.length;for(;t<n;){const r=t+n>>>1,o=sn[r],i=Qs(o);i<e||i===e&&o.flags&2?t=r+1:n=r}return t}function Ac(e){if(!(e.flags&1)){const t=Qs(e),n=sn[sn.length-1];!n||!(e.flags&2)&&t>=Qs(n)?sn.push(e):sn.splice(k0(t),0,e),e.flags|=1,If()}}function If(){Ji||(Ji=Af.then(jf))}function S0(e){De(e)?Qo.push(...e):Rr&&e.id===-1?Rr.splice(qo+1,0,e):e.flags&1||(Qo.push(e),e.flags|=1),If()}function hd(e,t,n=Qn+1){for(;n<sn.length;n++){const r=sn[n];if(r&&r.flags&2){if(e&&r.id!==e.uid)continue;sn.splice(n,1),n--,r.flags&4&&(r.flags&=-2),r(),r.flags&4||(r.flags&=-2)}}}function Pf(e){if(Qo.length){const t=[...new Set(Qo)].sort((n,r)=>Qs(n)-Qs(r));if(Qo.length=0,Rr){Rr.push(...t);return}for(Rr=t,qo=0;qo<Rr.length;qo++){const n=Rr[qo];n.flags&4&&(n.flags&=-2),n.flags&8||n(),n.flags&=-2}Rr=null,qo=0}}const Qs=e=>e.id==null?e.flags&2?-1:1/0:e.id;function jf(e){const t=Dn;try{for(Qn=0;Qn<sn.length;Qn++){const n=sn[Qn];n&&!(n.flags&8)&&(n.flags&4&&(n.flags&=-2),di(n,n.i,n.i?15:14),n.flags&4||(n.flags&=-2))}}finally{for(;Qn<sn.length;Qn++){const n=sn[Qn];n&&(n.flags&=-2)}Qn=-1,sn.length=0,Pf(),Ji=null,(sn.length||Qo.length)&&jf()}}let Ft=null,Ia=null;function Yi(e){const t=Ft;return Ft=e,Ia=e&&e.type.__scopeId||null,t}function Ef(e){Ia=e}function Nf(){Ia=null}function et(e,t=Ft,n){if(!t||e._n)return e;const r=(...o)=>{r._d&&$d(-1);const i=Yi(t);let s;try{s=e(...o)}finally{Yi(i),r._d&&$d(1)}return s};return r._n=!0,r._c=!0,r._d=!0,r}function Kr(e,t){if(Ft===null)return e;const n=La(Ft),r=e.dirs||(e.dirs=[]);for(let o=0;o<t.length;o++){let[i,s,l,u=yt]=t[o];i&&(We(i)&&(i={mounted:i,updated:i}),i.deep&&gr(s),r.push({dir:i,instance:n,value:s,oldValue:void 0,arg:l,modifiers:u}))}return e}function io(e,t,n,r){const o=e.dirs,i=t&&t.dirs;for(let s=0;s<o.length;s++){const l=o[s];i&&(l.oldValue=i[s].value);let u=l.dir[r];u&&(Xr(),Un(u,n,8,[e.el,l,e,t]),Zr())}}const Mf=Symbol("_vte"),Lf=e=>e.__isTeleport,Ns=e=>e&&(e.disabled||e.disabled===""),md=e=>e&&(e.defer||e.defer===""),yd=e=>typeof SVGElement<"u"&&e instanceof SVGElement,gd=e=>typeof MathMLElement=="function"&&e instanceof MathMLElement,Ml=(e,t)=>{const n=e&&e.to;return kt(n)?t?t(n):null:n},Df={name:"Teleport",__isTeleport:!0,process(e,t,n,r,o,i,s,l,u,c){const{mc:p,pc:a,pbc:d,o:{insert:h,querySelector:m,createText:y,createComment:T}}=c,g=Ns(t.props);let{shapeFlag:C,children:N,dynamicChildren:L}=t;if(e==null){const B=t.el=y(""),M=t.anchor=y("");h(B,n,r),h(M,n,r);const E=(q,ue)=>{C&16&&(o&&o.isCE&&(o.ce._teleportTarget=q),p(N,q,ue,o,i,s,l,u))},W=()=>{const q=t.target=Ml(t.props,m),ue=Rf(q,t,y,h);q&&(s!=="svg"&&yd(q)?s="svg":s!=="mathml"&&gd(q)&&(s="mathml"),g||(E(q,ue),Fi(t,!1)))};g&&(E(n,M),Fi(t,!0)),md(t.props)?nn(()=>{W(),t.el.__isMounted=!0},i):W()}else{if(md(t.props)&&!e.el.__isMounted){nn(()=>{Df.process(e,t,n,r,o,i,s,l,u,c),delete e.el.__isMounted},i);return}t.el=e.el,t.targetStart=e.targetStart;const B=t.anchor=e.anchor,M=t.target=e.target,E=t.targetAnchor=e.targetAnchor,W=Ns(e.props),q=W?n:M,ue=W?B:E;if(s==="svg"||yd(M)?s="svg":(s==="mathml"||gd(M))&&(s="mathml"),L?(d(e.dynamicChildren,L,q,o,i,s,l),Lc(e,t,!0)):u||a(e,t,q,ue,o,i,s,l,!1),g)W?t.props&&e.props&&t.props.to!==e.props.to&&(t.props.to=e.props.to):Ai(t,n,B,c,1);else if((t.props&&t.props.to)!==(e.props&&e.props.to)){const ce=t.target=Ml(t.props,m);ce&&Ai(t,ce,null,c,0)}else W&&Ai(t,M,E,c,1);Fi(t,g)}},remove(e,t,n,{um:r,o:{remove:o}},i){const{shapeFlag:s,children:l,anchor:u,targetStart:c,targetAnchor:p,target:a,props:d}=e;if(a&&(o(c),o(p)),i&&o(u),s&16){const h=i||!Ns(d);for(let m=0;m<l.length;m++){const y=l[m];r(y,t,n,h,!!y.dynamicChildren)}}},move:Ai,hydrate:C0};function Ai(e,t,n,{o:{insert:r},m:o},i=2){i===0&&r(e.targetAnchor,t,n);const{el:s,anchor:l,shapeFlag:u,children:c,props:p}=e,a=i===2;if(a&&r(s,t,n),(!a||Ns(p))&&u&16)for(let d=0;d<c.length;d++)o(c[d],t,n,2);a&&r(l,t,n)}function C0(e,t,n,r,o,i,{o:{nextSibling:s,parentNode:l,querySelector:u,insert:c,createText:p}},a){const d=t.target=Ml(t.props,u);if(d){const h=Ns(t.props),m=d._lpa||d.firstChild;if(t.shapeFlag&16)if(h)t.anchor=a(s(e),t,l(e),n,r,o,i),t.targetStart=m,t.targetAnchor=m&&s(m);else{t.anchor=s(e);let y=m;for(;y;){if(y&&y.nodeType===8){if(y.data==="teleport start anchor")t.targetStart=y;else if(y.data==="teleport anchor"){t.targetAnchor=y,d._lpa=t.targetAnchor&&s(t.targetAnchor);break}}y=s(y)}t.targetAnchor||Rf(d,t,p,c),a(m&&s(m),t,d,n,r,o,i)}Fi(t,h)}return t.anchor&&s(t.anchor)}const Js=Df;function Fi(e,t){const n=e.ctx;if(n&&n.ut){let r,o;for(t?(r=e.el,o=e.anchor):(r=e.targetStart,o=e.targetAnchor);r&&r!==o;)r.nodeType===1&&r.setAttribute("data-v-owner",n.uid),r=r.nextSibling;n.ut()}}function Rf(e,t,n,r){const o=t.targetStart=n(""),i=t.targetAnchor=n("");return o[Mf]=i,e&&(r(o,e),r(i,e)),i}const Fr=Symbol("_leaveCb"),Ii=Symbol("_enterCb");function Ff(){const e={isMounted:!1,isLeaving:!1,isUnmounting:!1,leavingVNodes:new Map};return St(()=>{e.isMounted=!0}),Wf(()=>{e.isUnmounting=!0}),e}const Tn=[Function,Array],Bf={mode:String,appear:Boolean,persisted:Boolean,onBeforeEnter:Tn,onEnter:Tn,onAfterEnter:Tn,onEnterCancelled:Tn,onBeforeLeave:Tn,onLeave:Tn,onAfterLeave:Tn,onLeaveCancelled:Tn,onBeforeAppear:Tn,onAppear:Tn,onAfterAppear:Tn,onAppearCancelled:Tn},Uf=e=>{const t=e.subTree;return t.component?Uf(t.component):t},x0={name:"BaseTransition",props:Bf,setup(e,{slots:t}){const n=Fc(),r=Ff();return()=>{const o=t.default&&Ic(t.default(),!0);if(!o||!o.length)return;const i=qf(o),s=nt(e),{mode:l}=s;if(r.isLeaving)return il(i);const u=vd(i);if(!u)return il(i);let c=Ys(u,s,r,n,a=>c=a);u.type!==an&&Oo(u,c);let p=n.subTree&&vd(n.subTree);if(p&&p.type!==an&&!fo(u,p)&&Uf(n).type!==an){let a=Ys(p,s,r,n);if(Oo(p,a),l==="out-in"&&u.type!==an)return r.isLeaving=!0,a.afterLeave=()=>{r.isLeaving=!1,n.job.flags&8||n.update(),delete a.afterLeave,p=void 0},il(i);l==="in-out"&&u.type!==an?a.delayLeave=(d,h,m)=>{const y=Vf(r,p);y[String(p.key)]=p,d[Fr]=()=>{h(),d[Fr]=void 0,delete c.delayedLeave,p=void 0},c.delayedLeave=()=>{m(),delete c.delayedLeave,p=void 0}}:p=void 0}else p&&(p=void 0);return i}}};function qf(e){let t=e[0];if(e.length>1){for(const n of e)if(n.type!==an){t=n;break}}return t}const $0=x0;function Vf(e,t){const{leavingVNodes:n}=e;let r=n.get(t.type);return r||(r=Object.create(null),n.set(t.type,r)),r}function Ys(e,t,n,r,o){const{appear:i,mode:s,persisted:l=!1,onBeforeEnter:u,onEnter:c,onAfterEnter:p,onEnterCancelled:a,onBeforeLeave:d,onLeave:h,onAfterLeave:m,onLeaveCancelled:y,onBeforeAppear:T,onAppear:g,onAfterAppear:C,onAppearCancelled:N}=t,L=String(e.key),B=Vf(n,e),M=(q,ue)=>{q&&Un(q,r,9,ue)},E=(q,ue)=>{const ce=ue[1];M(q,ue),De(q)?q.every(te=>te.length<=1)&&ce():q.length<=1&&ce()},W={mode:s,persisted:l,beforeEnter(q){let ue=u;if(!n.isMounted)if(i)ue=T||u;else return;q[Fr]&&q[Fr](!0);const ce=B[L];ce&&fo(e,ce)&&ce.el[Fr]&&ce.el[Fr](),M(ue,[q])},enter(q){let ue=c,ce=p,te=a;if(!n.isMounted)if(i)ue=g||c,ce=C||p,te=N||a;else return;let Q=!1;const ae=q[Ii]=ke=>{Q||(Q=!0,ke?M(te,[q]):M(ce,[q]),W.delayedLeave&&W.delayedLeave(),q[Ii]=void 0)};ue?E(ue,[q,ae]):ae()},leave(q,ue){const ce=String(e.key);if(q[Ii]&&q[Ii](!0),n.isUnmounting)return ue();M(d,[q]);let te=!1;const Q=q[Fr]=ae=>{te||(te=!0,ue(),ae?M(y,[q]):M(m,[q]),q[Fr]=void 0,B[ce]===e&&delete B[ce])};B[ce]=e,h?E(h,[q,Q]):Q()},clone(q){const ue=Ys(q,t,n,r,o);return o&&o(ue),ue}};return W}function il(e){if(Pa(e))return e=zr(e),e.children=null,e}function vd(e){if(!Pa(e))return Lf(e.type)&&e.children?qf(e.children):e;const{shapeFlag:t,children:n}=e;if(n){if(t&16)return n[0];if(t&32&&We(n.default))return n.default()}}function Oo(e,t){e.shapeFlag&6&&e.component?(e.transition=t,Oo(e.component.subTree,t)):e.shapeFlag&128?(e.ssContent.transition=t.clone(e.ssContent),e.ssFallback.transition=t.clone(e.ssFallback)):e.transition=t}function Ic(e,t=!1,n){let r=[],o=0;for(let i=0;i<e.length;i++){let s=e[i];const l=n==null?s.key:String(n)+String(s.key!=null?s.key:i);s.type===Be?(s.patchFlag&128&&o++,r=r.concat(Ic(s.children,t,l))):(t||s.type!==an)&&r.push(l!=null?zr(s,{key:l}):s)}if(o>1)for(let i=0;i<r.length;i++)r[i].patchFlag=-2;return r}/*! #__NO_SIDE_EFFECTS__ */function je(e,t){return We(e)?(()=>Mt({name:e.name},t,{setup:e}))():e}function Hf(e){e.ids=[e.ids[0]+e.ids[2]+++"-",0,0]}function Xi(e,t,n,r,o=!1){if(De(e)){e.forEach((m,y)=>Xi(m,t&&(De(t)?t[y]:t),n,r,o));return}if(Jo(r)&&!o){r.shapeFlag&512&&r.type.__asyncResolved&&r.component.subTree.component&&Xi(e,t,n,r.component.subTree);return}const i=r.shapeFlag&4?La(r.component):r.el,s=o?null:i,{i:l,r:u}=e,c=t&&t.r,p=l.refs===yt?l.refs={}:l.refs,a=l.setupState,d=nt(a),h=a===yt?()=>!1:m=>dt(d,m);if(c!=null&&c!==u&&(kt(c)?(p[c]=null,h(c)&&(a[c]=null)):Nt(c)&&(c.value=null)),We(u))di(u,l,12,[s,p]);else{const m=kt(u),y=Nt(u);if(m||y){const T=()=>{if(e.f){const g=m?h(u)?a[u]:p[u]:u.value;o?De(g)&&bc(g,i):De(g)?g.includes(i)||g.push(i):m?(p[u]=[i],h(u)&&(a[u]=p[u])):(u.value=[i],e.k&&(p[e.k]=u.value))}else m?(p[u]=s,h(u)&&(a[u]=s)):y&&(u.value=s,e.k&&(p[e.k]=s))};s?(T.id=-1,nn(T,n)):T()}}}xa().requestIdleCallback;xa().cancelIdleCallback;const Jo=e=>!!e.type.__asyncLoader,Pa=e=>e.type.__isKeepAlive;function O0(e,t){Kf(e,"a",t)}function A0(e,t){Kf(e,"da",t)}function Kf(e,t,n=Ut){const r=e.__wdc||(e.__wdc=()=>{let o=n;for(;o;){if(o.isDeactivated)return;o=o.parent}return e()});if(ja(t,r,n),n){let o=n.parent;for(;o&&o.parent;)Pa(o.parent.vnode)&&I0(r,t,n,o),o=o.parent}}function I0(e,t,n,r){const o=ja(t,e,r,!0);Ct(()=>{bc(r[t],o)},n)}function ja(e,t,n=Ut,r=!1){if(n){const o=n[e]||(n[e]=[]),i=t.__weh||(t.__weh=(...s)=>{Xr();const l=fi(n),u=Un(t,n,e,s);return l(),Zr(),u});return r?o.unshift(i):o.push(i),i}}const Or=e=>(t,n=Ut)=>{(!ei||e==="sp")&&ja(e,(...r)=>t(...r),n)},Pc=Or("bm"),St=Or("m"),P0=Or("bu"),Gf=Or("u"),Wf=Or("bum"),Ct=Or("um"),j0=Or("sp"),E0=Or("rtg"),N0=Or("rtc");function M0(e,t=Ut){ja("ec",e,t)}const jc="components",L0="directives";function wo(e,t){return Ec(jc,e,!0,t)||e}const zf=Symbol.for("v-ndc");function Ea(e){return kt(e)?Ec(jc,e,!1)||e:e||zf}function D0(e){return Ec(L0,e)}function Ec(e,t,n=!0,r=!1){const o=Ft||Ut;if(o){const i=o.type;if(e===jc){const l=xb(i,!1);if(l&&(l===t||l===$n(t)||l===Ca($n(t))))return i}const s=bd(o[e]||i[e],t)||bd(o.appContext[e],t);return!s&&r?i:s}}function bd(e,t){return e&&(e[t]||e[$n(t)]||e[Ca($n(t))])}function lt(e,t,n,r){let o;const i=n&&n[r],s=De(e);if(s||kt(e)){const l=s&&Hr(e);let u=!1;l&&(u=!Sn(e),e=Oa(e)),o=new Array(e.length);for(let c=0,p=e.length;c<p;c++)o[c]=t(u?Qt(e[c]):e[c],c,void 0,i&&i[c])}else if(typeof e=="number"){o=new Array(e);for(let l=0;l<e;l++)o[l]=t(l+1,l,void 0,i&&i[l])}else if(gt(e))if(e[Symbol.iterator])o=Array.from(e,(l,u)=>t(l,u,void 0,i&&i[u]));else{const l=Object.keys(e);o=new Array(l.length);for(let u=0,c=l.length;u<c;u++){const p=l[u];o[u]=t(e[p],p,u,i&&i[u])}}else o=[];return n&&(n[r]=o),o}function Yo(e,t,n={},r,o){if(Ft.ce||Ft.parent&&Jo(Ft.parent)&&Ft.parent.ce)return t!=="default"&&(n.name=t),R(),Oe(Be,null,[Re("slot",n,r&&r())],64);let i=e[t];i&&i._c&&(i._d=!1),R();const s=i&&Qf(i(n)),l=n.key||s&&s.key,u=Oe(Be,{key:(l&&!Bn(l)?l:`_${t}`)+(!s&&r?"_fb":"")},s||(r?r():[]),s&&e._===1?64:-2);return!o&&u.scopeId&&(u.slotScopeIds=[u.scopeId+"-s"]),i&&i._c&&(i._d=!0),u}function Qf(e){return e.some(t=>Zs(t)?!(t.type===an||t.type===Be&&!Qf(t.children)):!0)?e:null}const Ll=e=>e?hh(e)?La(e):Ll(e.parent):null,Ms=Mt(Object.create(null),{$:e=>e,$el:e=>e.vnode.el,$data:e=>e.data,$props:e=>e.props,$attrs:e=>e.attrs,$slots:e=>e.slots,$refs:e=>e.refs,$parent:e=>Ll(e.parent),$root:e=>Ll(e.root),$host:e=>e.ce,$emit:e=>e.emit,$options:e=>Nc(e),$forceUpdate:e=>e.f||(e.f=()=>{Ac(e.update)}),$nextTick:e=>e.n||(e.n=pi.bind(e.proxy)),$watch:e=>lb.bind(e)}),al=(e,t)=>e!==yt&&!e.__isScriptSetup&&dt(e,t),R0={get({_:e},t){if(t==="__v_skip")return!0;const{ctx:n,setupState:r,data:o,props:i,accessCache:s,type:l,appContext:u}=e;let c;if(t[0]!=="$"){const h=s[t];if(h!==void 0)switch(h){case 1:return r[t];case 2:return o[t];case 4:return n[t];case 3:return i[t]}else{if(al(r,t))return s[t]=1,r[t];if(o!==yt&&dt(o,t))return s[t]=2,o[t];if((c=e.propsOptions[0])&&dt(c,t))return s[t]=3,i[t];if(n!==yt&&dt(n,t))return s[t]=4,n[t];Dl&&(s[t]=0)}}const p=Ms[t];let a,d;if(p)return t==="$attrs"&&zt(e.attrs,"get",""),p(e);if((a=l.__cssModules)&&(a=a[t]))return a;if(n!==yt&&dt(n,t))return s[t]=4,n[t];if(d=u.config.globalProperties,dt(d,t))return d[t]},set({_:e},t,n){const{data:r,setupState:o,ctx:i}=e;return al(o,t)?(o[t]=n,!0):r!==yt&&dt(r,t)?(r[t]=n,!0):dt(e.props,t)||t[0]==="$"&&t.slice(1)in e?!1:(i[t]=n,!0)},has({_:{data:e,setupState:t,accessCache:n,ctx:r,appContext:o,propsOptions:i}},s){let l;return!!n[s]||e!==yt&&dt(e,s)||al(t,s)||(l=i[0])&&dt(l,s)||dt(r,s)||dt(Ms,s)||dt(o.config.globalProperties,s)},defineProperty(e,t,n){return n.get!=null?e._.accessCache[t]=0:dt(n,"value")&&this.set(e,t,n.value,null),Reflect.defineProperty(e,t,n)}};function F0(){return B0().slots}function B0(){const e=Fc();return e.setupContext||(e.setupContext=yh(e))}function _d(e){return De(e)?e.reduce((t,n)=>(t[n]=null,t),{}):e}let Dl=!0;function U0(e){const t=Nc(e),n=e.proxy,r=e.ctx;Dl=!1,t.beforeCreate&&Td(t.beforeCreate,e,"bc");const{data:o,computed:i,methods:s,watch:l,provide:u,inject:c,created:p,beforeMount:a,mounted:d,beforeUpdate:h,updated:m,activated:y,deactivated:T,beforeDestroy:g,beforeUnmount:C,destroyed:N,unmounted:L,render:B,renderTracked:M,renderTriggered:E,errorCaptured:W,serverPrefetch:q,expose:ue,inheritAttrs:ce,components:te,directives:Q,filters:ae}=t;if(c&&q0(c,r,null),s)for(const qe in s){const He=s[qe];We(He)&&(r[qe]=He.bind(n))}if(o){const qe=o.call(n,n);gt(qe)&&(e.data=br(qe))}if(Dl=!0,i)for(const qe in i){const He=i[qe],pt=We(He)?He.bind(n,n):We(He.get)?He.get.bind(n,n):Dn,D=!We(He)&&We(He.set)?He.set.bind(n):Dn,v=z({get:pt,set:D});Object.defineProperty(r,qe,{enumerable:!0,configurable:!0,get:()=>v.value,set:A=>v.value=A})}if(l)for(const qe in l)Jf(l[qe],r,n,qe);if(u){const qe=We(u)?u.call(n):u;Reflect.ownKeys(qe).forEach(He=>{z0(He,qe[He])})}p&&Td(p,e,"c");function Ee(qe,He){De(He)?He.forEach(pt=>qe(pt.bind(n))):He&&qe(He.bind(n))}if(Ee(Pc,a),Ee(St,d),Ee(P0,h),Ee(Gf,m),Ee(O0,y),Ee(A0,T),Ee(M0,W),Ee(N0,M),Ee(E0,E),Ee(Wf,C),Ee(Ct,L),Ee(j0,q),De(ue))if(ue.length){const qe=e.exposed||(e.exposed={});ue.forEach(He=>{Object.defineProperty(qe,He,{get:()=>n[He],set:pt=>n[He]=pt})})}else e.exposed||(e.exposed={});B&&e.render===Dn&&(e.render=B),ce!=null&&(e.inheritAttrs=ce),te&&(e.components=te),Q&&(e.directives=Q),q&&Hf(e)}function q0(e,t,n=Dn){De(e)&&(e=Rl(e));for(const r in e){const o=e[r];let i;gt(o)?"default"in o?i=Ls(o.from||r,o.default,!0):i=Ls(o.from||r):i=Ls(o),Nt(i)?Object.defineProperty(t,r,{enumerable:!0,configurable:!0,get:()=>i.value,set:s=>i.value=s}):t[r]=i}}function Td(e,t,n){Un(De(e)?e.map(r=>r.bind(t.proxy)):e.bind(t.proxy),t,n)}function Jf(e,t,n,r){let o=r.includes(".")?ch(n,r):()=>n[r];if(kt(e)){const i=t[e];We(i)&&Cn(o,i)}else if(We(e))Cn(o,e.bind(n));else if(gt(e))if(De(e))e.forEach(i=>Jf(i,t,n,r));else{const i=We(e.handler)?e.handler.bind(n):t[e.handler];We(i)&&Cn(o,i,e)}}function Nc(e){const t=e.type,{mixins:n,extends:r}=t,{mixins:o,optionsCache:i,config:{optionMergeStrategies:s}}=e.appContext,l=i.get(t);let u;return l?u=l:!o.length&&!n&&!r?u=t:(u={},o.length&&o.forEach(c=>Zi(u,c,s,!0)),Zi(u,t,s)),gt(t)&&i.set(t,u),u}function Zi(e,t,n,r=!1){const{mixins:o,extends:i}=t;i&&Zi(e,i,n,!0),o&&o.forEach(s=>Zi(e,s,n,!0));for(const s in t)if(!(r&&s==="expose")){const l=V0[s]||n&&n[s];e[s]=l?l(e[s],t[s]):t[s]}return e}const V0={data:wd,props:kd,emits:kd,methods:Os,computed:Os,beforeCreate:tn,created:tn,beforeMount:tn,mounted:tn,beforeUpdate:tn,updated:tn,beforeDestroy:tn,beforeUnmount:tn,destroyed:tn,unmounted:tn,activated:tn,deactivated:tn,errorCaptured:tn,serverPrefetch:tn,components:Os,directives:Os,watch:K0,provide:wd,inject:H0};function wd(e,t){return t?e?function(){return Mt(We(e)?e.call(this,this):e,We(t)?t.call(this,this):t)}:t:e}function H0(e,t){return Os(Rl(e),Rl(t))}function Rl(e){if(De(e)){const t={};for(let n=0;n<e.length;n++)t[e[n]]=e[n];return t}return e}function tn(e,t){return e?[...new Set([].concat(e,t))]:t}function Os(e,t){return e?Mt(Object.create(null),e,t):t}function kd(e,t){return e?De(e)&&De(t)?[...new Set([...e,...t])]:Mt(Object.create(null),_d(e),_d(t??{})):t}function K0(e,t){if(!e)return t;if(!t)return e;const n=Mt(Object.create(null),e);for(const r in t)n[r]=tn(e[r],t[r]);return n}function Yf(){return{app:null,config:{isNativeTag:jv,performance:!1,globalProperties:{},optionMergeStrategies:{},errorHandler:void 0,warnHandler:void 0,compilerOptions:{}},mixins:[],components:{},directives:{},provides:Object.create(null),optionsCache:new WeakMap,propsCache:new WeakMap,emitsCache:new WeakMap}}let G0=0;function W0(e,t){return function(r,o=null){We(r)||(r=Mt({},r)),o!=null&&!gt(o)&&(o=null);const i=Yf(),s=new WeakSet,l=[];let u=!1;const c=i.app={_uid:G0++,_component:r,_props:o,_container:null,_context:i,_instance:null,version:Ab,get config(){return i.config},set config(p){},use(p,...a){return s.has(p)||(p&&We(p.install)?(s.add(p),p.install(c,...a)):We(p)&&(s.add(p),p(c,...a))),c},mixin(p){return i.mixins.includes(p)||i.mixins.push(p),c},component(p,a){return a?(i.components[p]=a,c):i.components[p]},directive(p,a){return a?(i.directives[p]=a,c):i.directives[p]},mount(p,a,d){if(!u){const h=c._ceVNode||Re(r,o);return h.appContext=i,d===!0?d="svg":d===!1&&(d=void 0),a&&t?t(h,p):e(h,p,d),u=!0,c._container=p,p.__vue_app__=c,La(h.component)}},onUnmount(p){l.push(p)},unmount(){u&&(Un(l,c._instance,16),e(null,c._container),delete c._container.__vue_app__)},provide(p,a){return i.provides[p]=a,c},runWithContext(p){const a=ko;ko=c;try{return p()}finally{ko=a}}};return c}}let ko=null;function z0(e,t){if(Ut){let n=Ut.provides;const r=Ut.parent&&Ut.parent.provides;r===n&&(n=Ut.provides=Object.create(r)),n[e]=t}}function Ls(e,t,n=!1){const r=Ut||Ft;if(r||ko){const o=ko?ko._context.provides:r?r.parent==null?r.vnode.appContext&&r.vnode.appContext.provides:r.parent.provides:void 0;if(o&&e in o)return o[e];if(arguments.length>1)return n&&We(t)?t.call(r&&r.proxy):t}}function Q0(){return!!(Ut||Ft||ko)}const Xf={},Zf=()=>Object.create(Xf),eh=e=>Object.getPrototypeOf(e)===Xf;function J0(e,t,n,r=!1){const o={},i=Zf();e.propsDefaults=Object.create(null),th(e,t,o,i);for(const s in e.propsOptions[0])s in o||(o[s]=void 0);n?e.props=r?o:p0(o):e.type.props?e.props=o:e.props=i,e.attrs=i}function Y0(e,t,n,r){const{props:o,attrs:i,vnode:{patchFlag:s}}=e,l=nt(o),[u]=e.propsOptions;let c=!1;if((r||s>0)&&!(s&16)){if(s&8){const p=e.vnode.dynamicProps;for(let a=0;a<p.length;a++){let d=p[a];if(Na(e.emitsOptions,d))continue;const h=t[d];if(u)if(dt(i,d))h!==i[d]&&(i[d]=h,c=!0);else{const m=$n(d);o[m]=Fl(u,l,m,h,e,!1)}else h!==i[d]&&(i[d]=h,c=!0)}}}else{th(e,t,o,i)&&(c=!0);let p;for(const a in l)(!t||!dt(t,a)&&((p=jo(a))===a||!dt(t,p)))&&(u?n&&(n[a]!==void 0||n[p]!==void 0)&&(o[a]=Fl(u,l,a,void 0,e,!0)):delete o[a]);if(i!==l)for(const a in i)(!t||!dt(t,a))&&(delete i[a],c=!0)}c&&yr(e.attrs,"set","")}function th(e,t,n,r){const[o,i]=e.propsOptions;let s=!1,l;if(t)for(let u in t){if(Ps(u))continue;const c=t[u];let p;o&&dt(o,p=$n(u))?!i||!i.includes(p)?n[p]=c:(l||(l={}))[p]=c:Na(e.emitsOptions,u)||(!(u in r)||c!==r[u])&&(r[u]=c,s=!0)}if(i){const u=nt(n),c=l||yt;for(let p=0;p<i.length;p++){const a=i[p];n[a]=Fl(o,u,a,c[a],e,!dt(c,a))}}return s}function Fl(e,t,n,r,o,i){const s=e[n];if(s!=null){const l=dt(s,"default");if(l&&r===void 0){const u=s.default;if(s.type!==Function&&!s.skipFactory&&We(u)){const{propsDefaults:c}=o;if(n in c)r=c[n];else{const p=fi(o);r=c[n]=u.call(null,t),p()}}else r=u;o.ce&&o.ce._setProp(n,r)}s[0]&&(i&&!l?r=!1:s[1]&&(r===""||r===jo(n))&&(r=!0))}return r}const X0=new WeakMap;function nh(e,t,n=!1){const r=n?X0:t.propsCache,o=r.get(e);if(o)return o;const i=e.props,s={},l=[];let u=!1;if(!We(e)){const p=a=>{u=!0;const[d,h]=nh(a,t,!0);Mt(s,d),h&&l.push(...h)};!n&&t.mixins.length&&t.mixins.forEach(p),e.extends&&p(e.extends),e.mixins&&e.mixins.forEach(p)}if(!i&&!u)return gt(e)&&r.set(e,Wo),Wo;if(De(i))for(let p=0;p<i.length;p++){const a=$n(i[p]);Sd(a)&&(s[a]=yt)}else if(i)for(const p in i){const a=$n(p);if(Sd(a)){const d=i[p],h=s[a]=De(d)||We(d)?{type:d}:Mt({},d),m=h.type;let y=!1,T=!0;if(De(m))for(let g=0;g<m.length;++g){const C=m[g],N=We(C)&&C.name;if(N==="Boolean"){y=!0;break}else N==="String"&&(T=!1)}else y=We(m)&&m.name==="Boolean";h[0]=y,h[1]=T,(y||dt(h,"default"))&&l.push(a)}}const c=[s,l];return gt(e)&&r.set(e,c),c}function Sd(e){return e[0]!=="$"&&!Ps(e)}const rh=e=>e[0]==="_"||e==="$stable",Mc=e=>De(e)?e.map(Xn):[Xn(e)],Z0=(e,t,n)=>{if(t._n)return t;const r=et((...o)=>Mc(t(...o)),n);return r._c=!1,r},oh=(e,t,n)=>{const r=e._ctx;for(const o in e){if(rh(o))continue;const i=e[o];if(We(i))t[o]=Z0(o,i,r);else if(i!=null){const s=Mc(i);t[o]=()=>s}}},sh=(e,t)=>{const n=Mc(t);e.slots.default=()=>n},ih=(e,t,n)=>{for(const r in t)(n||r!=="_")&&(e[r]=t[r])},eb=(e,t,n)=>{const r=e.slots=Zf();if(e.vnode.shapeFlag&32){const o=t._;o?(ih(r,t,n),n&&rf(r,"_",o,!0)):oh(t,r)}else t&&sh(e,t)},tb=(e,t,n)=>{const{vnode:r,slots:o}=e;let i=!0,s=yt;if(r.shapeFlag&32){const l=t._;l?n&&l===1?i=!1:ih(o,t,n):(i=!t.$stable,oh(t,o)),s=t}else t&&(sh(e,t),s={default:1});if(i)for(const l in o)!rh(l)&&s[l]==null&&delete o[l]},nn=mb;function nb(e){return rb(e)}function rb(e,t){const n=xa();n.__VUE__=!0;const{insert:r,remove:o,patchProp:i,createElement:s,createText:l,createComment:u,setText:c,setElementText:p,parentNode:a,nextSibling:d,setScopeId:h=Dn,insertStaticContent:m}=e,y=(_,O,V,J=null,X=null,ne=null,de=void 0,fe=null,pe=!!O.dynamicChildren)=>{if(_===O)return;_&&!fo(_,O)&&(J=G(_),A(_,X,ne,!0),_=null),O.patchFlag===-2&&(pe=!1,O.dynamicChildren=null);const{type:oe,ref:U,shapeFlag:K}=O;switch(oe){case Ma:T(_,O,V,J);break;case an:g(_,O,V,J);break;case Bi:_==null&&C(O,V,J,de);break;case Be:te(_,O,V,J,X,ne,de,fe,pe);break;default:K&1?B(_,O,V,J,X,ne,de,fe,pe):K&6?Q(_,O,V,J,X,ne,de,fe,pe):(K&64||K&128)&&oe.process(_,O,V,J,X,ne,de,fe,pe,le)}U!=null&&X&&Xi(U,_&&_.ref,ne,O||_,!O)},T=(_,O,V,J)=>{if(_==null)r(O.el=l(O.children),V,J);else{const X=O.el=_.el;O.children!==_.children&&c(X,O.children)}},g=(_,O,V,J)=>{_==null?r(O.el=u(O.children||""),V,J):O.el=_.el},C=(_,O,V,J)=>{[_.el,_.anchor]=m(_.children,O,V,J,_.el,_.anchor)},N=({el:_,anchor:O},V,J)=>{let X;for(;_&&_!==O;)X=d(_),r(_,V,J),_=X;r(O,V,J)},L=({el:_,anchor:O})=>{let V;for(;_&&_!==O;)V=d(_),o(_),_=V;o(O)},B=(_,O,V,J,X,ne,de,fe,pe)=>{O.type==="svg"?de="svg":O.type==="math"&&(de="mathml"),_==null?M(O,V,J,X,ne,de,fe,pe):q(_,O,X,ne,de,fe,pe)},M=(_,O,V,J,X,ne,de,fe)=>{let pe,oe;const{props:U,shapeFlag:K,transition:re,dirs:ye}=_;if(pe=_.el=s(_.type,ne,U&&U.is,U),K&8?p(pe,_.children):K&16&&W(_.children,pe,null,J,X,ll(_,ne),de,fe),ye&&io(_,null,J,"created"),E(pe,_,_.scopeId,de,J),U){for(const Ce in U)Ce!=="value"&&!Ps(Ce)&&i(pe,Ce,null,U[Ce],ne,J);"value"in U&&i(pe,"value",null,U.value,ne),(oe=U.onVnodeBeforeMount)&&Wn(oe,J,_)}ye&&io(_,null,J,"beforeMount");const ge=ob(X,re);ge&&re.beforeEnter(pe),r(pe,O,V),((oe=U&&U.onVnodeMounted)||ge||ye)&&nn(()=>{oe&&Wn(oe,J,_),ge&&re.enter(pe),ye&&io(_,null,J,"mounted")},X)},E=(_,O,V,J,X)=>{if(V&&h(_,V),J)for(let ne=0;ne<J.length;ne++)h(_,J[ne]);if(X){let ne=X.subTree;if(O===ne||dh(ne.type)&&(ne.ssContent===O||ne.ssFallback===O)){const de=X.vnode;E(_,de,de.scopeId,de.slotScopeIds,X.parent)}}},W=(_,O,V,J,X,ne,de,fe,pe=0)=>{for(let oe=pe;oe<_.length;oe++){const U=_[oe]=fe?Br(_[oe]):Xn(_[oe]);y(null,U,O,V,J,X,ne,de,fe)}},q=(_,O,V,J,X,ne,de)=>{const fe=O.el=_.el;let{patchFlag:pe,dynamicChildren:oe,dirs:U}=O;pe|=_.patchFlag&16;const K=_.props||yt,re=O.props||yt;let ye;if(V&&ao(V,!1),(ye=re.onVnodeBeforeUpdate)&&Wn(ye,V,O,_),U&&io(O,_,V,"beforeUpdate"),V&&ao(V,!0),(K.innerHTML&&re.innerHTML==null||K.textContent&&re.textContent==null)&&p(fe,""),oe?ue(_.dynamicChildren,oe,fe,V,J,ll(O,X),ne):de||He(_,O,fe,null,V,J,ll(O,X),ne,!1),pe>0){if(pe&16)ce(fe,K,re,V,X);else if(pe&2&&K.class!==re.class&&i(fe,"class",null,re.class,X),pe&4&&i(fe,"style",K.style,re.style,X),pe&8){const ge=O.dynamicProps;for(let Ce=0;Ce<ge.length;Ce++){const we=ge[Ce],tt=K[we],ct=re[we];(ct!==tt||we==="value")&&i(fe,we,tt,ct,X,V)}}pe&1&&_.children!==O.children&&p(fe,O.children)}else!de&&oe==null&&ce(fe,K,re,V,X);((ye=re.onVnodeUpdated)||U)&&nn(()=>{ye&&Wn(ye,V,O,_),U&&io(O,_,V,"updated")},J)},ue=(_,O,V,J,X,ne,de)=>{for(let fe=0;fe<O.length;fe++){const pe=_[fe],oe=O[fe],U=pe.el&&(pe.type===Be||!fo(pe,oe)||pe.shapeFlag&70)?a(pe.el):V;y(pe,oe,U,null,J,X,ne,de,!0)}},ce=(_,O,V,J,X)=>{if(O!==V){if(O!==yt)for(const ne in O)!Ps(ne)&&!(ne in V)&&i(_,ne,O[ne],null,X,J);for(const ne in V){if(Ps(ne))continue;const de=V[ne],fe=O[ne];de!==fe&&ne!=="value"&&i(_,ne,fe,de,X,J)}"value"in V&&i(_,"value",O.value,V.value,X)}},te=(_,O,V,J,X,ne,de,fe,pe)=>{const oe=O.el=_?_.el:l(""),U=O.anchor=_?_.anchor:l("");let{patchFlag:K,dynamicChildren:re,slotScopeIds:ye}=O;ye&&(fe=fe?fe.concat(ye):ye),_==null?(r(oe,V,J),r(U,V,J),W(O.children||[],V,U,X,ne,de,fe,pe)):K>0&&K&64&&re&&_.dynamicChildren?(ue(_.dynamicChildren,re,V,X,ne,de,fe),(O.key!=null||X&&O===X.subTree)&&Lc(_,O,!0)):He(_,O,V,U,X,ne,de,fe,pe)},Q=(_,O,V,J,X,ne,de,fe,pe)=>{O.slotScopeIds=fe,_==null?O.shapeFlag&512?X.ctx.activate(O,V,J,de,pe):ae(O,V,J,X,ne,de,pe):ke(_,O,pe)},ae=(_,O,V,J,X,ne,de)=>{const fe=_.component=wb(_,J,X);if(Pa(_)&&(fe.ctx.renderer=le),kb(fe,!1,de),fe.asyncDep){if(X&&X.registerDep(fe,Ee,de),!_.el){const pe=fe.subTree=Re(an);g(null,pe,O,V)}}else Ee(fe,_,O,V,X,ne,de)},ke=(_,O,V)=>{const J=O.component=_.component;if(fb(_,O,V))if(J.asyncDep&&!J.asyncResolved){qe(J,O,V);return}else J.next=O,J.update();else O.el=_.el,J.vnode=O},Ee=(_,O,V,J,X,ne,de)=>{const fe=()=>{if(_.isMounted){let{next:K,bu:re,u:ye,parent:ge,vnode:Ce}=_;{const Tt=ah(_);if(Tt){K&&(K.el=Ce.el,qe(_,K,de)),Tt.asyncDep.then(()=>{_.isUnmounted||fe()});return}}let we=K,tt;ao(_,!1),K?(K.el=Ce.el,qe(_,K,de)):K=Ce,re&&Ri(re),(tt=K.props&&K.props.onVnodeBeforeUpdate)&&Wn(tt,ge,K,Ce),ao(_,!0);const ct=cl(_),_t=_.subTree;_.subTree=ct,y(_t,ct,a(_t.el),G(_t),_,X,ne),K.el=ct.el,we===null&&hb(_,ct.el),ye&&nn(ye,X),(tt=K.props&&K.props.onVnodeUpdated)&&nn(()=>Wn(tt,ge,K,Ce),X)}else{let K;const{el:re,props:ye}=O,{bm:ge,m:Ce,parent:we,root:tt,type:ct}=_,_t=Jo(O);if(ao(_,!1),ge&&Ri(ge),!_t&&(K=ye&&ye.onVnodeBeforeMount)&&Wn(K,we,O),ao(_,!0),re&&Fe){const Tt=()=>{_.subTree=cl(_),Fe(re,_.subTree,_,X,null)};_t&&ct.__asyncHydrate?ct.__asyncHydrate(re,_,Tt):Tt()}else{tt.ce&&tt.ce._injectChildStyle(ct);const Tt=_.subTree=cl(_);y(null,Tt,V,J,_,X,ne),O.el=Tt.el}if(Ce&&nn(Ce,X),!_t&&(K=ye&&ye.onVnodeMounted)){const Tt=O;nn(()=>Wn(K,we,Tt),X)}(O.shapeFlag&256||we&&Jo(we.vnode)&&we.vnode.shapeFlag&256)&&_.a&&nn(_.a,X),_.isMounted=!0,O=V=J=null}};_.scope.on();const pe=_.effect=new pf(fe);_.scope.off();const oe=_.update=pe.run.bind(pe),U=_.job=pe.runIfDirty.bind(pe);U.i=_,U.id=_.uid,pe.scheduler=()=>Ac(U),ao(_,!0),oe()},qe=(_,O,V)=>{O.component=_;const J=_.vnode.props;_.vnode=O,_.next=null,Y0(_,O.props,J,V),tb(_,O.children,V),Xr(),hd(_),Zr()},He=(_,O,V,J,X,ne,de,fe,pe=!1)=>{const oe=_&&_.children,U=_?_.shapeFlag:0,K=O.children,{patchFlag:re,shapeFlag:ye}=O;if(re>0){if(re&128){D(oe,K,V,J,X,ne,de,fe,pe);return}else if(re&256){pt(oe,K,V,J,X,ne,de,fe,pe);return}}ye&8?(U&16&&I(oe,X,ne),K!==oe&&p(V,K)):U&16?ye&16?D(oe,K,V,J,X,ne,de,fe,pe):I(oe,X,ne,!0):(U&8&&p(V,""),ye&16&&W(K,V,J,X,ne,de,fe,pe))},pt=(_,O,V,J,X,ne,de,fe,pe)=>{_=_||Wo,O=O||Wo;const oe=_.length,U=O.length,K=Math.min(oe,U);let re;for(re=0;re<K;re++){const ye=O[re]=pe?Br(O[re]):Xn(O[re]);y(_[re],ye,V,null,X,ne,de,fe,pe)}oe>U?I(_,X,ne,!0,!1,K):W(O,V,J,X,ne,de,fe,pe,K)},D=(_,O,V,J,X,ne,de,fe,pe)=>{let oe=0;const U=O.length;let K=_.length-1,re=U-1;for(;oe<=K&&oe<=re;){const ye=_[oe],ge=O[oe]=pe?Br(O[oe]):Xn(O[oe]);if(fo(ye,ge))y(ye,ge,V,null,X,ne,de,fe,pe);else break;oe++}for(;oe<=K&&oe<=re;){const ye=_[K],ge=O[re]=pe?Br(O[re]):Xn(O[re]);if(fo(ye,ge))y(ye,ge,V,null,X,ne,de,fe,pe);else break;K--,re--}if(oe>K){if(oe<=re){const ye=re+1,ge=ye<U?O[ye].el:J;for(;oe<=re;)y(null,O[oe]=pe?Br(O[oe]):Xn(O[oe]),V,ge,X,ne,de,fe,pe),oe++}}else if(oe>re)for(;oe<=K;)A(_[oe],X,ne,!0),oe++;else{const ye=oe,ge=oe,Ce=new Map;for(oe=ge;oe<=re;oe++){const At=O[oe]=pe?Br(O[oe]):Xn(O[oe]);At.key!=null&&Ce.set(At.key,oe)}let we,tt=0;const ct=re-ge+1;let _t=!1,Tt=0;const mn=new Array(ct);for(oe=0;oe<ct;oe++)mn[oe]=0;for(oe=ye;oe<=K;oe++){const At=_[oe];if(tt>=ct){A(At,X,ne,!0);continue}let vt;if(At.key!=null)vt=Ce.get(At.key);else for(we=ge;we<=re;we++)if(mn[we-ge]===0&&fo(At,O[we])){vt=we;break}vt===void 0?A(At,X,ne,!0):(mn[vt-ge]=oe+1,vt>=Tt?Tt=vt:_t=!0,y(At,O[vt],V,null,X,ne,de,fe,pe),tt++)}const Ir=_t?sb(mn):Wo;for(we=Ir.length-1,oe=ct-1;oe>=0;oe--){const At=ge+oe,vt=O[At],lr=At+1<U?O[At+1].el:J;mn[oe]===0?y(null,vt,V,lr,X,ne,de,fe,pe):_t&&(we<0||oe!==Ir[we]?v(vt,V,lr,2):we--)}}},v=(_,O,V,J,X=null)=>{const{el:ne,type:de,transition:fe,children:pe,shapeFlag:oe}=_;if(oe&6){v(_.component.subTree,O,V,J);return}if(oe&128){_.suspense.move(O,V,J);return}if(oe&64){de.move(_,O,V,le);return}if(de===Be){r(ne,O,V);for(let K=0;K<pe.length;K++)v(pe[K],O,V,J);r(_.anchor,O,V);return}if(de===Bi){N(_,O,V);return}if(J!==2&&oe&1&&fe)if(J===0)fe.beforeEnter(ne),r(ne,O,V),nn(()=>fe.enter(ne),X);else{const{leave:K,delayLeave:re,afterLeave:ye}=fe,ge=()=>r(ne,O,V),Ce=()=>{K(ne,()=>{ge(),ye&&ye()})};re?re(ne,ge,Ce):Ce()}else r(ne,O,V)},A=(_,O,V,J=!1,X=!1)=>{const{type:ne,props:de,ref:fe,children:pe,dynamicChildren:oe,shapeFlag:U,patchFlag:K,dirs:re,cacheIndex:ye}=_;if(K===-2&&(X=!1),fe!=null&&Xi(fe,null,V,_,!0),ye!=null&&(O.renderCache[ye]=void 0),U&256){O.ctx.deactivate(_);return}const ge=U&1&&re,Ce=!Jo(_);let we;if(Ce&&(we=de&&de.onVnodeBeforeUnmount)&&Wn(we,O,_),U&6)w(_.component,V,J);else{if(U&128){_.suspense.unmount(V,J);return}ge&&io(_,null,O,"beforeUnmount"),U&64?_.type.remove(_,O,V,le,J):oe&&!oe.hasOnce&&(ne!==Be||K>0&&K&64)?I(oe,O,V,!1,!0):(ne===Be&&K&384||!X&&U&16)&&I(pe,O,V),J&&$(_)}(Ce&&(we=de&&de.onVnodeUnmounted)||ge)&&nn(()=>{we&&Wn(we,O,_),ge&&io(_,null,O,"unmounted")},V)},$=_=>{const{type:O,el:V,anchor:J,transition:X}=_;if(O===Be){b(V,J);return}if(O===Bi){L(_);return}const ne=()=>{o(V),X&&!X.persisted&&X.afterLeave&&X.afterLeave()};if(_.shapeFlag&1&&X&&!X.persisted){const{leave:de,delayLeave:fe}=X,pe=()=>de(V,ne);fe?fe(_.el,ne,pe):pe()}else ne()},b=(_,O)=>{let V;for(;_!==O;)V=d(_),o(_),_=V;o(O)},w=(_,O,V)=>{const{bum:J,scope:X,job:ne,subTree:de,um:fe,m:pe,a:oe}=_;Cd(pe),Cd(oe),J&&Ri(J),X.stop(),ne&&(ne.flags|=8,A(de,_,O,V)),fe&&nn(fe,O),nn(()=>{_.isUnmounted=!0},O),O&&O.pendingBranch&&!O.isUnmounted&&_.asyncDep&&!_.asyncResolved&&_.suspenseId===O.pendingId&&(O.deps--,O.deps===0&&O.resolve())},I=(_,O,V,J=!1,X=!1,ne=0)=>{for(let de=ne;de<_.length;de++)A(_[de],O,V,J,X)},G=_=>{if(_.shapeFlag&6)return G(_.component.subTree);if(_.shapeFlag&128)return _.suspense.next();const O=d(_.anchor||_.el),V=O&&O[Mf];return V?d(V):O};let Z=!1;const he=(_,O,V)=>{_==null?O._vnode&&A(O._vnode,null,null,!0):y(O._vnode||null,_,O,null,null,null,V),O._vnode=_,Z||(Z=!0,hd(),Pf(),Z=!1)},le={p:y,um:A,m:v,r:$,mt:ae,mc:W,pc:He,pbc:ue,n:G,o:e};let me,Fe;return t&&([me,Fe]=t(le)),{render:he,hydrate:me,createApp:W0(he,me)}}function ll({type:e,props:t},n){return n==="svg"&&e==="foreignObject"||n==="mathml"&&e==="annotation-xml"&&t&&t.encoding&&t.encoding.includes("html")?void 0:n}function ao({effect:e,job:t},n){n?(e.flags|=32,t.flags|=4):(e.flags&=-33,t.flags&=-5)}function ob(e,t){return(!e||e&&!e.pendingBranch)&&t&&!t.persisted}function Lc(e,t,n=!1){const r=e.children,o=t.children;if(De(r)&&De(o))for(let i=0;i<r.length;i++){const s=r[i];let l=o[i];l.shapeFlag&1&&!l.dynamicChildren&&((l.patchFlag<=0||l.patchFlag===32)&&(l=o[i]=Br(o[i]),l.el=s.el),!n&&l.patchFlag!==-2&&Lc(s,l)),l.type===Ma&&(l.el=s.el)}}function sb(e){const t=e.slice(),n=[0];let r,o,i,s,l;const u=e.length;for(r=0;r<u;r++){const c=e[r];if(c!==0){if(o=n[n.length-1],e[o]<c){t[r]=o,n.push(r);continue}for(i=0,s=n.length-1;i<s;)l=i+s>>1,e[n[l]]<c?i=l+1:s=l;c<e[n[i]]&&(i>0&&(t[r]=n[i-1]),n[i]=r)}}for(i=n.length,s=n[i-1];i-- >0;)n[i]=s,s=t[s];return n}function ah(e){const t=e.subTree.component;if(t)return t.asyncDep&&!t.asyncResolved?t:ah(t)}function Cd(e){if(e)for(let t=0;t<e.length;t++)e[t].flags|=8}const ib=Symbol.for("v-scx"),ab=()=>Ls(ib);function Cn(e,t,n){return lh(e,t,n)}function lh(e,t,n=yt){const{immediate:r,deep:o,flush:i,once:s}=n,l=Mt({},n),u=t&&r||!t&&i!=="post";let c;if(ei){if(i==="sync"){const h=ab();c=h.__watcherHandles||(h.__watcherHandles=[])}else if(!u){const h=()=>{};return h.stop=Dn,h.resume=Dn,h.pause=Dn,h}}const p=Ut;l.call=(h,m,y)=>Un(h,p,m,y);let a=!1;i==="post"?l.scheduler=h=>{nn(h,p&&p.suspense)}:i!=="sync"&&(a=!0,l.scheduler=(h,m)=>{m?h():Ac(h)}),l.augmentJob=h=>{t&&(h.flags|=4),a&&(h.flags|=2,p&&(h.id=p.uid,h.i=p))};const d=T0(e,t,l);return ei&&(c?c.push(d):u&&d()),d}function lb(e,t,n){const r=this.proxy,o=kt(e)?e.includes(".")?ch(r,e):()=>r[e]:e.bind(r,r);let i;We(t)?i=t:(i=t.handler,n=t);const s=fi(this),l=lh(o,i.bind(r),n);return s(),l}function ch(e,t){const n=t.split(".");return()=>{let r=e;for(let o=0;o<n.length&&r;o++)r=r[n[o]];return r}}const cb=(e,t)=>t==="modelValue"||t==="model-value"?e.modelModifiers:e[`${t}Modifiers`]||e[`${$n(t)}Modifiers`]||e[`${jo(t)}Modifiers`];function ub(e,t,...n){if(e.isUnmounted)return;const r=e.vnode.props||yt;let o=n;const i=t.startsWith("update:"),s=i&&cb(r,t.slice(7));s&&(s.trim&&(o=n.map(p=>kt(p)?p.trim():p)),s.number&&(o=n.map(Il)));let l,u=r[l=tl(t)]||r[l=tl($n(t))];!u&&i&&(u=r[l=tl(jo(t))]),u&&Un(u,e,6,o);const c=r[l+"Once"];if(c){if(!e.emitted)e.emitted={};else if(e.emitted[l])return;e.emitted[l]=!0,Un(c,e,6,o)}}function uh(e,t,n=!1){const r=t.emitsCache,o=r.get(e);if(o!==void 0)return o;const i=e.emits;let s={},l=!1;if(!We(e)){const u=c=>{const p=uh(c,t,!0);p&&(l=!0,Mt(s,p))};!n&&t.mixins.length&&t.mixins.forEach(u),e.extends&&u(e.extends),e.mixins&&e.mixins.forEach(u)}return!i&&!l?(gt(e)&&r.set(e,null),null):(De(i)?i.forEach(u=>s[u]=null):Mt(s,i),gt(e)&&r.set(e,s),s)}function Na(e,t){return!e||!wa(t)?!1:(t=t.slice(2).replace(/Once$/,""),dt(e,t[0].toLowerCase()+t.slice(1))||dt(e,jo(t))||dt(e,t))}function cl(e){const{type:t,vnode:n,proxy:r,withProxy:o,propsOptions:[i],slots:s,attrs:l,emit:u,render:c,renderCache:p,props:a,data:d,setupState:h,ctx:m,inheritAttrs:y}=e,T=Yi(e);let g,C;try{if(n.shapeFlag&4){const L=o||r,B=L;g=Xn(c.call(B,L,p,a,h,d,m)),C=l}else{const L=t;g=Xn(L.length>1?L(a,{attrs:l,slots:s,emit:u}):L(a,null)),C=t.props?l:db(l)}}catch(L){Ds.length=0,Aa(L,e,1),g=Re(an)}let N=g;if(C&&y!==!1){const L=Object.keys(C),{shapeFlag:B}=N;L.length&&B&7&&(i&&L.some(vc)&&(C=pb(C,i)),N=zr(N,C,!1,!0))}return n.dirs&&(N=zr(N,null,!1,!0),N.dirs=N.dirs?N.dirs.concat(n.dirs):n.dirs),n.transition&&Oo(N,n.transition),g=N,Yi(T),g}const db=e=>{let t;for(const n in e)(n==="class"||n==="style"||wa(n))&&((t||(t={}))[n]=e[n]);return t},pb=(e,t)=>{const n={};for(const r in e)(!vc(r)||!(r.slice(9)in t))&&(n[r]=e[r]);return n};function fb(e,t,n){const{props:r,children:o,component:i}=e,{props:s,children:l,patchFlag:u}=t,c=i.emitsOptions;if(t.dirs||t.transition)return!0;if(n&&u>=0){if(u&1024)return!0;if(u&16)return r?xd(r,s,c):!!s;if(u&8){const p=t.dynamicProps;for(let a=0;a<p.length;a++){const d=p[a];if(s[d]!==r[d]&&!Na(c,d))return!0}}}else return(o||l)&&(!l||!l.$stable)?!0:r===s?!1:r?s?xd(r,s,c):!0:!!s;return!1}function xd(e,t,n){const r=Object.keys(t);if(r.length!==Object.keys(e).length)return!0;for(let o=0;o<r.length;o++){const i=r[o];if(t[i]!==e[i]&&!Na(n,i))return!0}return!1}function hb({vnode:e,parent:t},n){for(;t;){const r=t.subTree;if(r.suspense&&r.suspense.activeBranch===e&&(r.el=e.el),r===e)(e=t.vnode).el=n,t=t.parent;else break}}const dh=e=>e.__isSuspense;function mb(e,t){t&&t.pendingBranch?De(e)?t.effects.push(...e):t.effects.push(e):S0(e)}const Be=Symbol.for("v-fgt"),Ma=Symbol.for("v-txt"),an=Symbol.for("v-cmt"),Bi=Symbol.for("v-stc"),Ds=[];let gn=null;function R(e=!1){Ds.push(gn=e?null:[])}function yb(){Ds.pop(),gn=Ds[Ds.length-1]||null}let Xs=1;function $d(e,t=!1){Xs+=e,e<0&&gn&&t&&(gn.hasOnce=!0)}function ph(e){return e.dynamicChildren=Xs>0?gn||Wo:null,yb(),Xs>0&&gn&&gn.push(e),e}function ee(e,t,n,r,o,i){return ph(H(e,t,n,r,o,i,!0))}function Oe(e,t,n,r,o){return ph(Re(e,t,n,r,o,!0))}function Zs(e){return e?e.__v_isVNode===!0:!1}function fo(e,t){return e.type===t.type&&e.key===t.key}const fh=({key:e})=>e??null,Ui=({ref:e,ref_key:t,ref_for:n})=>(typeof e=="number"&&(e=""+e),e!=null?kt(e)||Nt(e)||We(e)?{i:Ft,r:e,k:t,f:!!n}:e:null);function H(e,t=null,n=null,r=0,o=null,i=e===Be?0:1,s=!1,l=!1){const u={__v_isVNode:!0,__v_skip:!0,type:e,props:t,key:t&&fh(t),ref:t&&Ui(t),scopeId:Ia,slotScopeIds:null,children:n,component:null,suspense:null,ssContent:null,ssFallback:null,dirs:null,transition:null,el:null,anchor:null,target:null,targetStart:null,targetAnchor:null,staticCount:0,shapeFlag:i,patchFlag:r,dynamicProps:o,dynamicChildren:null,appContext:null,ctx:Ft};return l?(Dc(u,n),i&128&&e.normalize(u)):n&&(u.shapeFlag|=kt(n)?8:16),Xs>0&&!s&&gn&&(u.patchFlag>0||i&6)&&u.patchFlag!==32&&gn.push(u),u}const Re=gb;function gb(e,t=null,n=null,r=0,o=null,i=!1){if((!e||e===zf)&&(e=an),Zs(e)){const l=zr(e,t,!0);return n&&Dc(l,n),Xs>0&&!i&&gn&&(l.shapeFlag&6?gn[gn.indexOf(e)]=l:gn.push(l)),l.patchFlag=-2,l}if($b(e)&&(e=e.__vccOpts),t){t=vb(t);let{class:l,style:u}=t;l&&!kt(l)&&(t.class=Xe(l)),gt(u)&&($c(u)&&!De(u)&&(u=Mt({},u)),t.style=Ye(u))}const s=kt(e)?1:dh(e)?128:Lf(e)?64:gt(e)?4:We(e)?2:0;return H(e,t,n,r,o,s,i,!0)}function vb(e){return e?$c(e)||eh(e)?Mt({},e):e:null}function zr(e,t,n=!1,r=!1){const{props:o,ref:i,patchFlag:s,children:l,transition:u}=e,c=t?Rc(o||{},t):o,p={__v_isVNode:!0,__v_skip:!0,type:e.type,props:c,key:c&&fh(c),ref:t&&t.ref?n&&i?De(i)?i.concat(Ui(t)):[i,Ui(t)]:Ui(t):i,scopeId:e.scopeId,slotScopeIds:e.slotScopeIds,children:l,target:e.target,targetStart:e.targetStart,targetAnchor:e.targetAnchor,staticCount:e.staticCount,shapeFlag:e.shapeFlag,patchFlag:t&&e.type!==Be?s===-1?16:s|16:s,dynamicProps:e.dynamicProps,dynamicChildren:e.dynamicChildren,appContext:e.appContext,dirs:e.dirs,transition:u,component:e.component,suspense:e.suspense,ssContent:e.ssContent&&zr(e.ssContent),ssFallback:e.ssFallback&&zr(e.ssFallback),el:e.el,anchor:e.anchor,ctx:e.ctx,ce:e.ce};return u&&r&&Oo(p,u.clone(p)),p}function On(e=" ",t=0){return Re(Ma,null,e,t)}function bb(e,t){const n=Re(Bi,null,e);return n.staticCount=t,n}function xe(e="",t=!1){return t?(R(),Oe(an,null,e)):Re(an,null,e)}function Xn(e){return e==null||typeof e=="boolean"?Re(an):De(e)?Re(Be,null,e.slice()):Zs(e)?Br(e):Re(Ma,null,String(e))}function Br(e){return e.el===null&&e.patchFlag!==-1||e.memo?e:zr(e)}function Dc(e,t){let n=0;const{shapeFlag:r}=e;if(t==null)t=null;else if(De(t))n=16;else if(typeof t=="object")if(r&65){const o=t.default;o&&(o._c&&(o._d=!1),Dc(e,o()),o._c&&(o._d=!0));return}else{n=32;const o=t._;!o&&!eh(t)?t._ctx=Ft:o===3&&Ft&&(Ft.slots._===1?t._=1:(t._=2,e.patchFlag|=1024))}else We(t)?(t={default:t,_ctx:Ft},n=32):(t=String(t),r&64?(n=16,t=[On(t)]):n=8);e.children=t,e.shapeFlag|=n}function Rc(...e){const t={};for(let n=0;n<e.length;n++){const r=e[n];for(const o in r)if(o==="class")t.class!==r.class&&(t.class=Xe([t.class,r.class]));else if(o==="style")t.style=Ye([t.style,r.style]);else if(wa(o)){const i=t[o],s=r[o];s&&i!==s&&!(De(i)&&i.includes(s))&&(t[o]=i?[].concat(i,s):s)}else o!==""&&(t[o]=r[o])}return t}function Wn(e,t,n,r=null){Un(e,t,7,[n,r])}const _b=Yf();let Tb=0;function wb(e,t,n){const r=e.type,o=(t?t.appContext:e.appContext)||_b,i={uid:Tb++,vnode:e,type:r,parent:t,appContext:o,root:null,next:null,subTree:null,effect:null,update:null,job:null,scope:new cf(!0),render:null,proxy:null,exposed:null,exposeProxy:null,withProxy:null,provides:t?t.provides:Object.create(o.provides),ids:t?t.ids:["",0,0],accessCache:null,renderCache:[],components:null,directives:null,propsOptions:nh(r,o),emitsOptions:uh(r,o),emit:null,emitted:null,propsDefaults:yt,inheritAttrs:r.inheritAttrs,ctx:yt,data:yt,props:yt,attrs:yt,slots:yt,refs:yt,setupState:yt,setupContext:null,suspense:n,suspenseId:n?n.pendingId:0,asyncDep:null,asyncResolved:!1,isMounted:!1,isUnmounted:!1,isDeactivated:!1,bc:null,c:null,bm:null,m:null,bu:null,u:null,um:null,bum:null,da:null,a:null,rtg:null,rtc:null,ec:null,sp:null};return i.ctx={_:i},i.root=t?t.root:i,i.emit=ub.bind(null,i),e.ce&&e.ce(i),i}let Ut=null;const Fc=()=>Ut||Ft;let ea,Bl;{const e=xa(),t=(n,r)=>{let o;return(o=e[n])||(o=e[n]=[]),o.push(r),i=>{o.length>1?o.forEach(s=>s(i)):o[0](i)}};ea=t("__VUE_INSTANCE_SETTERS__",n=>Ut=n),Bl=t("__VUE_SSR_SETTERS__",n=>ei=n)}const fi=e=>{const t=Ut;return ea(e),e.scope.on(),()=>{e.scope.off(),ea(t)}},Od=()=>{Ut&&Ut.scope.off(),ea(null)};function hh(e){return e.vnode.shapeFlag&4}let ei=!1;function kb(e,t=!1,n=!1){t&&Bl(t);const{props:r,children:o}=e.vnode,i=hh(e);J0(e,r,i,t),eb(e,o,n);const s=i?Sb(e,t):void 0;return t&&Bl(!1),s}function Sb(e,t){const n=e.type;e.accessCache=Object.create(null),e.proxy=new Proxy(e.ctx,R0);const{setup:r}=n;if(r){Xr();const o=e.setupContext=r.length>1?yh(e):null,i=fi(e),s=di(r,e,0,[e.props,o]),l=ef(s);if(Zr(),i(),(l||e.sp)&&!Jo(e)&&Hf(e),l){if(s.then(Od,Od),t)return s.then(u=>{Ad(e,u,t)}).catch(u=>{Aa(u,e,0)});e.asyncDep=s}else Ad(e,s,t)}else mh(e,t)}function Ad(e,t,n){We(t)?e.type.__ssrInlineRender?e.ssrRender=t:e.render=t:gt(t)&&(e.setupState=Of(t)),mh(e,n)}let Id;function mh(e,t,n){const r=e.type;if(!e.render){if(!t&&Id&&!r.render){const o=r.template||Nc(e).template;if(o){const{isCustomElement:i,compilerOptions:s}=e.appContext.config,{delimiters:l,compilerOptions:u}=r,c=Mt(Mt({isCustomElement:i,delimiters:l},s),u);r.render=Id(o,c)}}e.render=r.render||Dn}{const o=fi(e);Xr();try{U0(e)}finally{Zr(),o()}}}const Cb={get(e,t){return zt(e,"get",""),e[t]}};function yh(e){const t=n=>{e.exposed=n||{}};return{attrs:new Proxy(e.attrs,Cb),slots:e.slots,emit:e.emit,expose:t}}function La(e){return e.exposed?e.exposeProxy||(e.exposeProxy=new Proxy(Of(Oc(e.exposed)),{get(t,n){if(n in t)return t[n];if(n in Ms)return Ms[n](e)},has(t,n){return n in t||n in Ms}})):e.proxy}function xb(e,t=!0){return We(e)?e.displayName||e.name:e.name||t&&e.__name}function $b(e){return We(e)&&"__vccOpts"in e}const z=(e,t)=>b0(e,t,ei);function Ob(e,t,n){const r=arguments.length;return r===2?gt(t)&&!De(t)?Zs(t)?Re(e,null,[t]):Re(e,t):Re(e,null,t):(r>3?n=Array.prototype.slice.call(arguments,2):r===3&&Zs(n)&&(n=[n]),Re(e,t,n))}const Ab="3.5.13";/**
* @vue/runtime-dom v3.5.13
* (c) 2018-present Yuxi (Evan) You and Vue contributors
* @license MIT
**/let Ul;const Pd=typeof window<"u"&&window.trustedTypes;if(Pd)try{Ul=Pd.createPolicy("vue",{createHTML:e=>e})}catch{}const gh=Ul?e=>Ul.createHTML(e):e=>e,Ib="http://www.w3.org/2000/svg",Pb="http://www.w3.org/1998/Math/MathML",mr=typeof document<"u"?document:null,jd=mr&&mr.createElement("template"),jb={insert:(e,t,n)=>{t.insertBefore(e,n||null)},remove:e=>{const t=e.parentNode;t&&t.removeChild(e)},createElement:(e,t,n,r)=>{const o=t==="svg"?mr.createElementNS(Ib,e):t==="mathml"?mr.createElementNS(Pb,e):n?mr.createElement(e,{is:n}):mr.createElement(e);return e==="select"&&r&&r.multiple!=null&&o.setAttribute("multiple",r.multiple),o},createText:e=>mr.createTextNode(e),createComment:e=>mr.createComment(e),setText:(e,t)=>{e.nodeValue=t},setElementText:(e,t)=>{e.textContent=t},parentNode:e=>e.parentNode,nextSibling:e=>e.nextSibling,querySelector:e=>mr.querySelector(e),setScopeId(e,t){e.setAttribute(t,"")},insertStaticContent(e,t,n,r,o,i){const s=n?n.previousSibling:t.lastChild;if(o&&(o===i||o.nextSibling))for(;t.insertBefore(o.cloneNode(!0),n),!(o===i||!(o=o.nextSibling)););else{jd.innerHTML=gh(r==="svg"?`<svg>${e}</svg>`:r==="mathml"?`<math>${e}</math>`:e);const l=jd.content;if(r==="svg"||r==="mathml"){const u=l.firstChild;for(;u.firstChild;)l.appendChild(u.firstChild);l.removeChild(u)}t.insertBefore(l,n)}return[s?s.nextSibling:t.firstChild,n?n.previousSibling:t.lastChild]}},Er="transition",Cs="animation",os=Symbol("_vtc"),vh={name:String,type:String,css:{type:Boolean,default:!0},duration:[String,Number,Object],enterFromClass:String,enterActiveClass:String,enterToClass:String,appearFromClass:String,appearActiveClass:String,appearToClass:String,leaveFromClass:String,leaveActiveClass:String,leaveToClass:String},bh=Mt({},Bf,vh),Eb=e=>(e.displayName="Transition",e.props=bh,e),ss=Eb((e,{slots:t})=>Ob($0,_h(e),t)),lo=(e,t=[])=>{De(e)?e.forEach(n=>n(...t)):e&&e(...t)},Ed=e=>e?De(e)?e.some(t=>t.length>1):e.length>1:!1;function _h(e){const t={};for(const te in e)te in vh||(t[te]=e[te]);if(e.css===!1)return t;const{name:n="v",type:r,duration:o,enterFromClass:i=`${n}-enter-from`,enterActiveClass:s=`${n}-enter-active`,enterToClass:l=`${n}-enter-to`,appearFromClass:u=i,appearActiveClass:c=s,appearToClass:p=l,leaveFromClass:a=`${n}-leave-from`,leaveActiveClass:d=`${n}-leave-active`,leaveToClass:h=`${n}-leave-to`}=e,m=Nb(o),y=m&&m[0],T=m&&m[1],{onBeforeEnter:g,onEnter:C,onEnterCancelled:N,onLeave:L,onLeaveCancelled:B,onBeforeAppear:M=g,onAppear:E=C,onAppearCancelled:W=N}=t,q=(te,Q,ae,ke)=>{te._enterCancelled=ke,Lr(te,Q?p:l),Lr(te,Q?c:s),ae&&ae()},ue=(te,Q)=>{te._isLeaving=!1,Lr(te,a),Lr(te,h),Lr(te,d),Q&&Q()},ce=te=>(Q,ae)=>{const ke=te?E:C,Ee=()=>q(Q,te,ae);lo(ke,[Q,Ee]),Nd(()=>{Lr(Q,te?u:i),zn(Q,te?p:l),Ed(ke)||Md(Q,r,y,Ee)})};return Mt(t,{onBeforeEnter(te){lo(g,[te]),zn(te,i),zn(te,s)},onBeforeAppear(te){lo(M,[te]),zn(te,u),zn(te,c)},onEnter:ce(!1),onAppear:ce(!0),onLeave(te,Q){te._isLeaving=!0;const ae=()=>ue(te,Q);zn(te,a),te._enterCancelled?(zn(te,d),ql()):(ql(),zn(te,d)),Nd(()=>{te._isLeaving&&(Lr(te,a),zn(te,h),Ed(L)||Md(te,r,T,ae))}),lo(L,[te,ae])},onEnterCancelled(te){q(te,!1,void 0,!0),lo(N,[te])},onAppearCancelled(te){q(te,!0,void 0,!0),lo(W,[te])},onLeaveCancelled(te){ue(te),lo(B,[te])}})}function Nb(e){if(e==null)return null;if(gt(e))return[ul(e.enter),ul(e.leave)];{const t=ul(e);return[t,t]}}function ul(e){return Dv(e)}function zn(e,t){t.split(/\s+/).forEach(n=>n&&e.classList.add(n)),(e[os]||(e[os]=new Set)).add(t)}function Lr(e,t){t.split(/\s+/).forEach(r=>r&&e.classList.remove(r));const n=e[os];n&&(n.delete(t),n.size||(e[os]=void 0))}function Nd(e){requestAnimationFrame(()=>{requestAnimationFrame(e)})}let Mb=0;function Md(e,t,n,r){const o=e._endId=++Mb,i=()=>{o===e._endId&&r()};if(n!=null)return setTimeout(i,n);const{type:s,timeout:l,propCount:u}=Th(e,t);if(!s)return r();const c=s+"end";let p=0;const a=()=>{e.removeEventListener(c,d),i()},d=h=>{h.target===e&&++p>=u&&a()};setTimeout(()=>{p<u&&a()},l+1),e.addEventListener(c,d)}function Th(e,t){const n=window.getComputedStyle(e),r=m=>(n[m]||"").split(", "),o=r(`${Er}Delay`),i=r(`${Er}Duration`),s=Ld(o,i),l=r(`${Cs}Delay`),u=r(`${Cs}Duration`),c=Ld(l,u);let p=null,a=0,d=0;t===Er?s>0&&(p=Er,a=s,d=i.length):t===Cs?c>0&&(p=Cs,a=c,d=u.length):(a=Math.max(s,c),p=a>0?s>c?Er:Cs:null,d=p?p===Er?i.length:u.length:0);const h=p===Er&&/\b(transform|all)(,|$)/.test(r(`${Er}Property`).toString());return{type:p,timeout:a,propCount:d,hasTransform:h}}function Ld(e,t){for(;e.length<t.length;)e=e.concat(e);return Math.max(...t.map((n,r)=>Dd(n)+Dd(e[r])))}function Dd(e){return e==="auto"?0:Number(e.slice(0,-1).replace(",","."))*1e3}function ql(){return document.body.offsetHeight}function Lb(e,t,n){const r=e[os];r&&(t=(t?[t,...r]:[...r]).join(" ")),t==null?e.removeAttribute("class"):n?e.setAttribute("class",t):e.className=t}const Rd=Symbol("_vod"),Db=Symbol("_vsh"),Rb=Symbol(""),Fb=/(^|;)\s*display\s*:/;function Bb(e,t,n){const r=e.style,o=kt(n);let i=!1;if(n&&!o){if(t)if(kt(t))for(const s of t.split(";")){const l=s.slice(0,s.indexOf(":")).trim();n[l]==null&&qi(r,l,"")}else for(const s in t)n[s]==null&&qi(r,s,"");for(const s in n)s==="display"&&(i=!0),qi(r,s,n[s])}else if(o){if(t!==n){const s=r[Rb];s&&(n+=";"+s),r.cssText=n,i=Fb.test(n)}}else t&&e.removeAttribute("style");Rd in e&&(e[Rd]=i?r.display:"",e[Db]&&(r.display="none"))}const Fd=/\s*!important$/;function qi(e,t,n){if(De(n))n.forEach(r=>qi(e,t,r));else if(n==null&&(n=""),t.startsWith("--"))e.setProperty(t,n);else{const r=Ub(e,t);Fd.test(n)?e.setProperty(jo(r),n.replace(Fd,""),"important"):e[r]=n}}const Bd=["Webkit","Moz","ms"],dl={};function Ub(e,t){const n=dl[t];if(n)return n;let r=$n(t);if(r!=="filter"&&r in e)return dl[t]=r;r=Ca(r);for(let o=0;o<Bd.length;o++){const i=Bd[o]+r;if(i in e)return dl[t]=i}return t}const Ud="http://www.w3.org/1999/xlink";function qd(e,t,n,r,o,i=Hv(t)){r&&t.startsWith("xlink:")?n==null?e.removeAttributeNS(Ud,t.slice(6,t.length)):e.setAttributeNS(Ud,t,n):n==null||i&&!of(n)?e.removeAttribute(t):e.setAttribute(t,i?"":Bn(n)?String(n):n)}function Vd(e,t,n,r,o){if(t==="innerHTML"||t==="textContent"){n!=null&&(e[t]=t==="innerHTML"?gh(n):n);return}const i=e.tagName;if(t==="value"&&i!=="PROGRESS"&&!i.includes("-")){const l=i==="OPTION"?e.getAttribute("value")||"":e.value,u=n==null?e.type==="checkbox"?"on":"":String(n);(l!==u||!("_value"in e))&&(e.value=u),n==null&&e.removeAttribute(t),e._value=n;return}let s=!1;if(n===""||n==null){const l=typeof e[t];l==="boolean"?n=of(n):n==null&&l==="string"?(n="",s=!0):l==="number"&&(n=0,s=!0)}try{e[t]=n}catch{}s&&e.removeAttribute(o||t)}function ho(e,t,n,r){e.addEventListener(t,n,r)}function qb(e,t,n,r){e.removeEventListener(t,n,r)}const Hd=Symbol("_vei");function Vb(e,t,n,r,o=null){const i=e[Hd]||(e[Hd]={}),s=i[t];if(r&&s)s.value=r;else{const[l,u]=Hb(t);if(r){const c=i[t]=Wb(r,o);ho(e,l,c,u)}else s&&(qb(e,l,s,u),i[t]=void 0)}}const Kd=/(?:Once|Passive|Capture)$/;function Hb(e){let t;if(Kd.test(e)){t={};let r;for(;r=e.match(Kd);)e=e.slice(0,e.length-r[0].length),t[r[0].toLowerCase()]=!0}return[e[2]===":"?e.slice(3):jo(e.slice(2)),t]}let pl=0;const Kb=Promise.resolve(),Gb=()=>pl||(Kb.then(()=>pl=0),pl=Date.now());function Wb(e,t){const n=r=>{if(!r._vts)r._vts=Date.now();else if(r._vts<=n.attached)return;Un(zb(r,n.value),t,5,[r])};return n.value=e,n.attached=Gb(),n}function zb(e,t){if(De(t)){const n=e.stopImmediatePropagation;return e.stopImmediatePropagation=()=>{n.call(e),e._stopped=!0},t.map(r=>o=>!o._stopped&&r&&r(o))}else return t}const Gd=e=>e.charCodeAt(0)===111&&e.charCodeAt(1)===110&&e.charCodeAt(2)>96&&e.charCodeAt(2)<123,Qb=(e,t,n,r,o,i)=>{const s=o==="svg";t==="class"?Lb(e,r,s):t==="style"?Bb(e,n,r):wa(t)?vc(t)||Vb(e,t,n,r,i):(t[0]==="."?(t=t.slice(1),!0):t[0]==="^"?(t=t.slice(1),!1):Jb(e,t,r,s))?(Vd(e,t,r),!e.tagName.includes("-")&&(t==="value"||t==="checked"||t==="selected")&&qd(e,t,r,s,i,t!=="value")):e._isVueCE&&(/[A-Z]/.test(t)||!kt(r))?Vd(e,$n(t),r,i,t):(t==="true-value"?e._trueValue=r:t==="false-value"&&(e._falseValue=r),qd(e,t,r,s))};function Jb(e,t,n,r){if(r)return!!(t==="innerHTML"||t==="textContent"||t in e&&Gd(t)&&We(n));if(t==="spellcheck"||t==="draggable"||t==="translate"||t==="form"||t==="list"&&e.tagName==="INPUT"||t==="type"&&e.tagName==="TEXTAREA")return!1;if(t==="width"||t==="height"){const o=e.tagName;if(o==="IMG"||o==="VIDEO"||o==="CANVAS"||o==="SOURCE")return!1}return Gd(t)&&kt(n)?!1:t in e}const wh=new WeakMap,kh=new WeakMap,ta=Symbol("_moveCb"),Wd=Symbol("_enterCb"),Yb=e=>(delete e.props.mode,e),Xb=Yb({name:"TransitionGroup",props:Mt({},bh,{tag:String,moveClass:String}),setup(e,{slots:t}){const n=Fc(),r=Ff();let o,i;return Gf(()=>{if(!o.length)return;const s=e.moveClass||`${e.name||"v"}-move`;if(!n_(o[0].el,n.vnode.el,s))return;o.forEach(Zb),o.forEach(e_);const l=o.filter(t_);ql(),l.forEach(u=>{const c=u.el,p=c.style;zn(c,s),p.transform=p.webkitTransform=p.transitionDuration="";const a=c[ta]=d=>{d&&d.target!==c||(!d||/transform$/.test(d.propertyName))&&(c.removeEventListener("transitionend",a),c[ta]=null,Lr(c,s))};c.addEventListener("transitionend",a)})}),()=>{const s=nt(e),l=_h(s);let u=s.tag||Be;if(o=[],i)for(let c=0;c<i.length;c++){const p=i[c];p.el&&p.el instanceof Element&&(o.push(p),Oo(p,Ys(p,l,r,n)),wh.set(p,p.el.getBoundingClientRect()))}i=t.default?Ic(t.default()):[];for(let c=0;c<i.length;c++){const p=i[c];p.key!=null&&Oo(p,Ys(p,l,r,n))}return Re(u,null,i)}}}),Rs=Xb;function Zb(e){const t=e.el;t[ta]&&t[ta](),t[Wd]&&t[Wd]()}function e_(e){kh.set(e,e.el.getBoundingClientRect())}function t_(e){const t=wh.get(e),n=kh.get(e),r=t.left-n.left,o=t.top-n.top;if(r||o){const i=e.el.style;return i.transform=i.webkitTransform=`translate(${r}px,${o}px)`,i.transitionDuration="0s",e}}function n_(e,t,n){const r=e.cloneNode(),o=e[os];o&&o.forEach(l=>{l.split(/\s+/).forEach(u=>u&&r.classList.remove(u))}),n.split(/\s+/).forEach(l=>l&&r.classList.add(l)),r.style.display="none";const i=t.nodeType===1?t:t.parentNode;i.appendChild(r);const{hasTransform:s}=Th(r);return i.removeChild(r),s}const na=e=>{const t=e.props["onUpdate:modelValue"]||!1;return De(t)?n=>Ri(t,n):t};function r_(e){e.target.composing=!0}function zd(e){const t=e.target;t.composing&&(t.composing=!1,t.dispatchEvent(new Event("input")))}const Xo=Symbol("_assign"),is={created(e,{modifiers:{lazy:t,trim:n,number:r}},o){e[Xo]=na(o);const i=r||o.props&&o.props.type==="number";ho(e,t?"change":"input",s=>{if(s.target.composing)return;let l=e.value;n&&(l=l.trim()),i&&(l=Il(l)),e[Xo](l)}),n&&ho(e,"change",()=>{e.value=e.value.trim()}),t||(ho(e,"compositionstart",r_),ho(e,"compositionend",zd),ho(e,"change",zd))},mounted(e,{value:t}){e.value=t??""},beforeUpdate(e,{value:t,oldValue:n,modifiers:{lazy:r,trim:o,number:i}},s){if(e[Xo]=na(s),e.composing)return;const l=(i||e.type==="number")&&!/^0\d/.test(e.value)?Il(e.value):e.value,u=t??"";l!==u&&(document.activeElement===e&&e.type!=="range"&&(r&&t===n||o&&e.value.trim()===u)||(e.value=u))}},o_={deep:!0,created(e,t,n){e[Xo]=na(n),ho(e,"change",()=>{const r=e._modelValue,o=s_(e),i=e.checked,s=e[Xo];if(De(r)){const l=sf(r,o),u=l!==-1;if(i&&!u)s(r.concat(o));else if(!i&&u){const c=[...r];c.splice(l,1),s(c)}}else if(ka(r)){const l=new Set(r);i?l.add(o):l.delete(o),s(l)}else s(Sh(e,i))})},mounted:Qd,beforeUpdate(e,t,n){e[Xo]=na(n),Qd(e,t,n)}};function Qd(e,{value:t,oldValue:n},r){e._modelValue=t;let o;if(De(t))o=sf(t,r.props.value)>-1;else if(ka(t))o=t.has(r.props.value);else{if(t===n)return;o=$a(t,Sh(e,!0))}e.checked!==o&&(e.checked=o)}function s_(e){return"_value"in e?e._value:e.value}function Sh(e,t){const n=t?"_trueValue":"_falseValue";return n in e?e[n]:t}const i_=Mt({patchProp:Qb},jb);let Jd;function a_(){return Jd||(Jd=nb(i_))}const l_=(...e)=>{const t=a_().createApp(...e),{mount:n}=t;return t.mount=r=>{const o=u_(r);if(!o)return;const i=t._component;!We(i)&&!i.render&&!i.template&&(i.template=o.innerHTML),o.nodeType===1&&(o.textContent="");const s=n(o,!1,c_(o));return o instanceof Element&&(o.removeAttribute("v-cloak"),o.setAttribute("data-v-app","")),s},t};function c_(e){if(e instanceof SVGElement)return"svg";if(typeof MathMLElement=="function"&&e instanceof MathMLElement)return"mathml"}function u_(e){return kt(e)?document.querySelector(e):e}var d_=Object.defineProperty,p_=(e,t,n)=>t in e?d_(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,ot=(e,t,n)=>(p_(e,typeof t!="symbol"?t+"":t,n),n),vr=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function Ch(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}function f_(e){throw new Error('Could not dynamically require "'+e+'". Please configure the dynamicRequireTargets or/and ignoreDynamicRequires option of @rollup/plugin-commonjs appropriately for this require call to work.')}var xh={exports:{}};/*!
 * @overview es6-promise - a tiny implementation of Promises/A+.
 * @copyright Copyright (c) 2014 Yehuda Katz, Tom Dale, Stefan Penner and contributors (Conversion to ES6 API by Jake Archibald)
 * @license   Licensed under MIT license
 *            See https://raw.githubusercontent.com/stefanpenner/es6-promise/master/LICENSE
 * @version   v4.2.8+1e68dce6
 */(function(e,t){(function(n,r){e.exports=r()})(vr,function(){function n(U){var K=typeof U;return U!==null&&(K==="object"||K==="function")}function r(U){return typeof U=="function"}var o=void 0;Array.isArray?o=Array.isArray:o=function(U){return Object.prototype.toString.call(U)==="[object Array]"};var i=o,s=0,l=void 0,u=void 0,c=function(U,K){M[s]=U,M[s+1]=K,s+=2,s===2&&(u?u(E):q())};function p(U){u=U}function a(U){c=U}var d=typeof window<"u"?window:void 0,h=d||{},m=h.MutationObserver||h.WebKitMutationObserver,y=typeof self>"u"&&typeof process<"u"&&{}.toString.call(process)==="[object process]",T=typeof Uint8ClampedArray<"u"&&typeof importScripts<"u"&&typeof MessageChannel<"u";function g(){return function(){return process.nextTick(E)}}function C(){return typeof l<"u"?function(){l(E)}:B()}function N(){var U=0,K=new m(E),re=document.createTextNode("");return K.observe(re,{characterData:!0}),function(){re.data=U=++U%2}}function L(){var U=new MessageChannel;return U.port1.onmessage=E,function(){return U.port2.postMessage(0)}}function B(){var U=setTimeout;return function(){return U(E,1)}}var M=new Array(1e3);function E(){for(var U=0;U<s;U+=2){var K=M[U],re=M[U+1];K(re),M[U]=void 0,M[U+1]=void 0}s=0}function W(){try{var U=Function("return this")().require("vertx");return l=U.runOnLoop||U.runOnContext,C()}catch{return B()}}var q=void 0;y?q=g():m?q=N():T?q=L():d===void 0&&typeof f_=="function"?q=W():q=B();function ue(U,K){var re=this,ye=new this.constructor(Q);ye[te]===void 0&&_(ye);var ge=re._state;if(ge){var Ce=arguments[ge-1];c(function(){return he(ge,ye,Ce,re._result)})}else G(re,ye,U,K);return ye}function ce(U){var K=this;if(U&&typeof U=="object"&&U.constructor===K)return U;var re=new K(Q);return $(re,U),re}var te=Math.random().toString(36).substring(2);function Q(){}var ae=void 0,ke=1,Ee=2;function qe(){return new TypeError("You cannot resolve a promise with itself")}function He(){return new TypeError("A promises callback cannot return that same promise.")}function pt(U,K,re,ye){try{U.call(K,re,ye)}catch(ge){return ge}}function D(U,K,re){c(function(ye){var ge=!1,Ce=pt(re,K,function(we){ge||(ge=!0,K!==we?$(ye,we):w(ye,we))},function(we){ge||(ge=!0,I(ye,we))},"Settle: "+(ye._label||" unknown promise"));!ge&&Ce&&(ge=!0,I(ye,Ce))},U)}function v(U,K){K._state===ke?w(U,K._result):K._state===Ee?I(U,K._result):G(K,void 0,function(re){return $(U,re)},function(re){return I(U,re)})}function A(U,K,re){K.constructor===U.constructor&&re===ue&&K.constructor.resolve===ce?v(U,K):re===void 0?w(U,K):r(re)?D(U,K,re):w(U,K)}function $(U,K){if(U===K)I(U,qe());else if(n(K)){var re=void 0;try{re=K.then}catch(ye){I(U,ye);return}A(U,K,re)}else w(U,K)}function b(U){U._onerror&&U._onerror(U._result),Z(U)}function w(U,K){U._state===ae&&(U._result=K,U._state=ke,U._subscribers.length!==0&&c(Z,U))}function I(U,K){U._state===ae&&(U._state=Ee,U._result=K,c(b,U))}function G(U,K,re,ye){var ge=U._subscribers,Ce=ge.length;U._onerror=null,ge[Ce]=K,ge[Ce+ke]=re,ge[Ce+Ee]=ye,Ce===0&&U._state&&c(Z,U)}function Z(U){var K=U._subscribers,re=U._state;if(K.length!==0){for(var ye=void 0,ge=void 0,Ce=U._result,we=0;we<K.length;we+=3)ye=K[we],ge=K[we+re],ye?he(re,ye,ge,Ce):ge(Ce);U._subscribers.length=0}}function he(U,K,re,ye){var ge=r(re),Ce=void 0,we=void 0,tt=!0;if(ge){try{Ce=re(ye)}catch(ct){tt=!1,we=ct}if(K===Ce){I(K,He());return}}else Ce=ye;K._state!==ae||(ge&&tt?$(K,Ce):tt===!1?I(K,we):U===ke?w(K,Ce):U===Ee&&I(K,Ce))}function le(U,K){try{K(function(re){$(U,re)},function(re){I(U,re)})}catch(re){I(U,re)}}var me=0;function Fe(){return me++}function _(U){U[te]=me++,U._state=void 0,U._result=void 0,U._subscribers=[]}function O(){return new Error("Array Methods must be provided an Array")}var V=function(){function U(K,re){this._instanceConstructor=K,this.promise=new K(Q),this.promise[te]||_(this.promise),i(re)?(this.length=re.length,this._remaining=re.length,this._result=new Array(this.length),this.length===0?w(this.promise,this._result):(this.length=this.length||0,this._enumerate(re),this._remaining===0&&w(this.promise,this._result))):I(this.promise,O())}return U.prototype._enumerate=function(K){for(var re=0;this._state===ae&&re<K.length;re++)this._eachEntry(K[re],re)},U.prototype._eachEntry=function(K,re){var ye=this._instanceConstructor,ge=ye.resolve;if(ge===ce){var Ce=void 0,we=void 0,tt=!1;try{Ce=K.then}catch(_t){tt=!0,we=_t}if(Ce===ue&&K._state!==ae)this._settledAt(K._state,re,K._result);else if(typeof Ce!="function")this._remaining--,this._result[re]=K;else if(ye===pe){var ct=new ye(Q);tt?I(ct,we):A(ct,K,Ce),this._willSettleAt(ct,re)}else this._willSettleAt(new ye(function(_t){return _t(K)}),re)}else this._willSettleAt(ge(K),re)},U.prototype._settledAt=function(K,re,ye){var ge=this.promise;ge._state===ae&&(this._remaining--,K===Ee?I(ge,ye):this._result[re]=ye),this._remaining===0&&w(ge,this._result)},U.prototype._willSettleAt=function(K,re){var ye=this;G(K,void 0,function(ge){return ye._settledAt(ke,re,ge)},function(ge){return ye._settledAt(Ee,re,ge)})},U}();function J(U){return new V(this,U).promise}function X(U){var K=this;return i(U)?new K(function(re,ye){for(var ge=U.length,Ce=0;Ce<ge;Ce++)K.resolve(U[Ce]).then(re,ye)}):new K(function(re,ye){return ye(new TypeError("You must pass an array to race."))})}function ne(U){var K=this,re=new K(Q);return I(re,U),re}function de(){throw new TypeError("You must pass a resolver function as the first argument to the promise constructor")}function fe(){throw new TypeError("Failed to construct 'Promise': Please use the 'new' operator, this object constructor cannot be called as a function.")}var pe=function(){function U(K){this[te]=Fe(),this._result=this._state=void 0,this._subscribers=[],Q!==K&&(typeof K!="function"&&de(),this instanceof U?le(this,K):fe())}return U.prototype.catch=function(K){return this.then(null,K)},U.prototype.finally=function(K){var re=this,ye=re.constructor;return r(K)?re.then(function(ge){return ye.resolve(K()).then(function(){return ge})},function(ge){return ye.resolve(K()).then(function(){throw ge})}):re.then(K,K)},U}();pe.prototype.then=ue,pe.all=J,pe.race=X,pe.resolve=ce,pe.reject=ne,pe._setScheduler=p,pe._setAsap=a,pe._asap=c;function oe(){var U=void 0;if(typeof vr<"u")U=vr;else if(typeof self<"u")U=self;else try{U=Function("return this")()}catch{throw new Error("polyfill failed because global object is unavailable in this environment")}var K=U.Promise;if(K){var re=null;try{re=Object.prototype.toString.call(K.resolve())}catch{}if(re==="[object Promise]"&&!K.cast)return}U.Promise=pe}return pe.polyfill=oe,pe.Promise=pe,pe})})(xh);var h_=xh.exports;h_.polyfill();class Bc{constructor(){ot(this,"debug"),ot(this,"logger",{log:()=>{}})}setupDebugger(t){this.debug=t,t&&(this.logger.log=console.log.bind(window.console))}}const Uc=new Bc,qn=Uc.logger;function Zo(e,t){return Date.now()-e+t}function qc(e){const t=parseInt(e,10);let n=Math.floor(t/3600),r=Math.floor((t-n*3600)/60),o=t-n*3600-r*60;return n<10&&(n="0"+n),r<10&&(r="0"+r),o<10&&(o="0"+o),n+":"+r+":"+o}const m_=je({props:{containerCssClass:[String,Object],cantClose:{type:Boolean,default:!1}},methods:{close(){this.cantClose||this.$emit("close")}}}),Pn=(e,t)=>{const n=e.__vccOpts||e;for(const[r,o]of t)n[r]=o;return n},y_={class:"modal-header"},g_={class:"modal-body"},v_={class:"modal-footer"};function b_(e,t,n,r,o,i){return R(),Oe(ss,{name:"fade"},{default:et(()=>[H("div",{class:"modal-mask",onClick:t[2]||(t[2]=(...s)=>e.close&&e.close(...s))},[H("div",{class:Xe(["modal-container bg-gray-800 nrt-card-4",e.containerCssClass]),onClick:t[1]||(t[1]=s=>s.stopPropagation())},[H("div",y_,[e.cantClose?xe("",!0):(R(),ee("button",{key:0,class:"close-button",onClick:t[0]||(t[0]=(...s)=>e.close&&e.close(...s))}," X ")),Yo(e.$slots,"header",{},()=>[On(" default header ")])]),H("div",g_,[Yo(e.$slots,"body",{},()=>[On(" default body ")])]),H("div",v_,[Yo(e.$slots,"footer")])],2)])]),_:3})}const eo=Pn(m_,[["render",b_]]);function as(){return`${Date.now()}-${Math.floor(Math.random()*1e11)}-${Math.floor(Math.random()*1e11)}`}const $h="3.4.0";function Vl(){return`NARRAT_SAVE_${ve().saveFileName}`}const __="gameSave";let $t;function ir(){if($t)return $t;if(!$t){let e=null;try{let t=localStorage.getItem(Vl());t||(t=localStorage.getItem(__)),t&&(localStorage.setItem(`${Vl()}_BACKUP`,t),e=JSON.parse(t)),e&&typeof e=="object"&&e.slots&&e.slots[0]&&e.slots[0].id||(e=null,localStorage.clear())}catch(t){ys(`Save file deleted because it was either broken or an outdated format: ${t}`)}e?$t=e:$t=Ah()}return w_($t),Ih($t),hs(),$t}function T_(){$t=Ah(),hs()}function Oh(){return{achievements:{achievements:{}},data:{}}}function w_(e){e.version==="1.4.0"&&(e.globalSave=Oh(),e.version="1.5.0"),e.version==="1.5.0"&&(e.version="2.16.0"),e.version==="2.16.0"&&(e.slots.forEach(t=>{t&&t.saveData&&(t.saveData.settings={baseSettings:{textSpeed:30,animateText:!0,fontSize:16},customSettings:{}})}),e.version="2.17.0"),e.version==="2.17.0"&&(e.slots.forEach(t=>{t&&t.saveData&&(t.saveData.config={gameCharacter:"game",playerCharacter:"player"})}),e.version="3.2.3"),e.version==="3.2.3"&&(e.slots.forEach(t=>{t&&t.saveData&&(t.saveData.choices={choices:{}})}),e.version="3.3.8"),e.version==="3.3.8"&&(e.slots.forEach(t=>{t&&t.saveData&&(t.saveData.rendering={dialogPanelMode:"auto"})}),e.version="3.3.9"),e.version==="3.3.9"&&(e.slots.forEach(t=>{t&&t.saveData&&(t.saveData.plugins={},t.saveData.customStores={})}),e.version="3.4.0")}function Ah(){const e={version:$h,slots:[],globalSave:Oh()};return Ih(e),e}function Ih(e){const t=ve().saves.slots??10;e.slots.length<1&&(e.slots[0]={slotType:"auto",id:as(),saveData:null,slotNumber:0}),e.slots[0].slotType="auto";for(let n=1;n<t+1;n++)e.slots.length<=n&&(e.slots[n]={slotNumber:n,slotType:ve().saves.mode==="manual"?"manual":"auto",id:as(),saveData:null})}function Ph(e,t,n){const r=C_(n);if($t.slots[r])$t.slots[r].saveData=e;else{Te(`Tried to save to slot ${n} but it doesn't exist`);return}$t.globalSave=t,hs()}function k_(e){$t.lastSaveSlot=e}function hs(){localStorage.setItem(Vl(),JSON.stringify($t))}function S_(){const e=$t.slots.find(t=>!t.saveData);return e?e.id:!1}function C_(e){return $t.slots.findIndex(t=>t.id===e)}function Fs(e){return $t.slots.find(t=>t.id===e)}function Vc(){return $t.slots.find(e=>e.slotType==="auto")}function x_(e){const t=$t.slots.findIndex(n=>n.id===e);$t.slots[t].saveData=null,hs()}function $_(e,t){const n=Fs(e);n&&n.saveData&&(n.saveData.metadata.name=t),hs()}function O_(){return{saveDate:new Date().toISOString(),name:"New Save"}}function A_({slot:e,name:t,extractedSave:n}){const r=Fs(e),o=O_();r&&r.saveData?o.name=r.saveData.metadata.name:o.name=t??"Auto Save",ve().saves.mode==="manual"&&(o.name="Auto Save");const i={...n.gameSave,version:$h,metadata:o},s=ir().globalSave;Object.assign(s,n.globalSave);const l={saveSlot:i,global:s};return Ph(i,s,e),l}function I_(e){$t&&($t.globalSave=e,hs())}function P_(e,t,n,r){const o=e.saveSlot,i=e.global;Ph({...o,main:{...o.main,playTime:t},metadata:{...o.metadata,name:r??"Manual Save",saveDate:new Date().toISOString()}},i,n)}var j_=!1;/*!
 * pinia v2.1.7
 * (c) 2023 Eduardo San Martin Morote
 * @license MIT
 */let jh;const Da=e=>jh=e,Eh=Symbol();function Hl(e){return e&&typeof e=="object"&&Object.prototype.toString.call(e)==="[object Object]"&&typeof e.toJSON!="function"}var Bs;(function(e){e.direct="direct",e.patchObject="patch object",e.patchFunction="patch function"})(Bs||(Bs={}));const E_=!1,fl=typeof navigator=="object"?navigator:{userAgent:""};/Macintosh/.test(fl.userAgent)&&/AppleWebKit/.test(fl.userAgent)&&/Safari/.test(fl.userAgent);function N_(){const e=uf(!0),t=e.run(()=>be({}));let n=[],r=[];const o=Oc({install(i){Da(o),o._a=i,i.provide(Eh,o),i.config.globalProperties.$pinia=o,r.forEach(s=>n.push(s)),r=[]},use(i){return!this._a&&!j_?r.push(i):n.push(i),this},_p:n,_a:null,_e:e,_s:new Map,state:t});return o}const Nh=()=>{};function Yd(e,t,n,r=Nh){e.push(t);const o=()=>{const i=e.indexOf(t);i>-1&&(e.splice(i,1),r())};return!n&&df()&&Gv(o),o}function Ro(e,...t){e.slice().forEach(n=>{n(...t)})}const M_=e=>e();function Kl(e,t){e instanceof Map&&t instanceof Map&&t.forEach((n,r)=>e.set(r,n)),e instanceof Set&&t instanceof Set&&t.forEach(e.add,e);for(const n in t){if(!t.hasOwnProperty(n))continue;const r=t[n],o=e[n];Hl(o)&&Hl(r)&&e.hasOwnProperty(n)&&!Nt(r)&&!Hr(r)?e[n]=Kl(o,r):e[n]=r}return e}const L_=Symbol();function D_(e){return!Hl(e)||!e.hasOwnProperty(L_)}const{assign:Dr}=Object;function R_(e){return!!(Nt(e)&&e.effect)}function F_(e,t,n,r){const{state:o,actions:i,getters:s}=t,l=n.state.value[e];let u;function c(){!l&&(n.state.value[e]=o?o():{});const p=m0(n.state.value[e]);return Dr(p,i,Object.keys(s||{}).reduce((a,d)=>(a[d]=Oc(z(()=>{Da(n);const h=n._s.get(e);return s[d].call(h,h)})),a),{}))}return u=Mh(e,c,t,n,r,!0),u}function Mh(e,t,n={},r,o,i){let s;const l=Dr({actions:{}},n),u={deep:!0};let c,p,a=[],d=[],h;const m=r.state.value[e];!i&&!m&&(r.state.value[e]={}),be({});let y;function T(E){let W;c=p=!1,typeof E=="function"?(E(r.state.value[e]),W={type:Bs.patchFunction,storeId:e,events:h}):(Kl(r.state.value[e],E),W={type:Bs.patchObject,payload:E,storeId:e,events:h});const q=y=Symbol();pi().then(()=>{y===q&&(c=!0)}),p=!0,Ro(a,W,r.state.value[e])}const g=i?function(){const{state:E}=n,W=E?E():{};this.$patch(q=>{Dr(q,W)})}:Nh;function C(){s.stop(),a=[],d=[],r._s.delete(e)}function N(E,W){return function(){Da(r);const q=Array.from(arguments),ue=[],ce=[];function te(ke){ue.push(ke)}function Q(ke){ce.push(ke)}Ro(d,{args:q,name:E,store:B,after:te,onError:Q});let ae;try{ae=W.apply(this&&this.$id===e?this:B,q)}catch(ke){throw Ro(ce,ke),ke}return ae instanceof Promise?ae.then(ke=>(Ro(ue,ke),ke)).catch(ke=>(Ro(ce,ke),Promise.reject(ke))):(Ro(ue,ae),ae)}}const L={_p:r,$id:e,$onAction:Yd.bind(null,d),$patch:T,$reset:g,$subscribe(E,W={}){const q=Yd(a,E,W.detached,()=>ue()),ue=s.run(()=>Cn(()=>r.state.value[e],ce=>{(W.flush==="sync"?p:c)&&E({storeId:e,type:Bs.direct,events:h},ce)},Dr({},u,W)));return q},$dispose:C},B=br(L);r._s.set(e,B);const M=(r._a&&r._a.runWithContext||M_)(()=>r._e.run(()=>(s=uf()).run(t)));for(const E in M){const W=M[E];if(Nt(W)&&!R_(W)||Hr(W))i||(m&&D_(W)&&(Nt(W)?W.value=m[E]:Kl(W,m[E])),r.state.value[e][E]=W);else if(typeof W=="function"){const q=N(E,W);M[E]=q,l.actions[E]=W}}return Dr(B,M),Dr(nt(B),M),Object.defineProperty(B,"$state",{get:()=>r.state.value[e],set:E=>{T(W=>{Dr(W,E)})}}),r._p.forEach(E=>{Dr(B,s.run(()=>E({store:B,app:r._a,pinia:r,options:l})))}),m&&i&&n.hydrate&&n.hydrate(B.$state,m),c=!0,p=!0,B}function Ot(e,t,n){let r,o;const i=typeof t=="function";typeof e=="string"?(r=e,o=i?n:t):(o=e,r=e.id);function s(l,u){const c=Q0();return l=l||(c?Ls(Eh,null):null),l&&Da(l),l=jh,l._s.has(r)||(i?Mh(r,t,o,l):F_(r,o,l)),l._s.get(r)}return s.$id=r,s}function Us(e,t){return Array.isArray(t)?t.reduce((n,r)=>(n[r]=function(){return e(this.$pinia)[r]},n),{}):Object.keys(t).reduce((n,r)=>(n[r]=function(){const o=e(this.$pinia),i=t[r];return typeof i=="function"?i.call(this,o):o[i]},n),{})}const hi=Ot("tooltips",{state:()=>({tooltip:null}),actions:{addCustomTooltip(e){e.title&&(e.title=Cr(e.title)),e.text=Cr(e.text),this.tooltip=e},addTooltip(e,t){const n=va(e);n&&this.addCustomTooltip({keyword:e,title:n.title,text:n.description,x:(t==null?void 0:t.x)??window.screenX,y:(t==null?void 0:t.y)??window.screenY,width:Co().options.width})},deleteTooltip(){this.tooltip=null}}});function Hc(){return window}function B_(e){const t=Co().options.keywordsPrefix,n=new RegExp(`${t}(\\w*)`,"gi");return e=e.replace(n,U_),e}Hc().onTooltipEnter=(e,t)=>{const n={x:e.clientX,y:e.clientY-20};hi().addTooltip(t,n)};Hc().onTooltipLeave=()=>{hi().deleteTooltip()};function U_(e,t){const n=t.toLowerCase();return va(n)?`<span class='highlighted-tooltip-keyword'
      onmouseenter="onTooltipEnter(event, '${n}')"
      onmouseleave="onTooltipLeave()">${t}</span>`:n}function Lh(e,t,n="$"){return t.replace(/%{[^}]*}/g,r=>{const o=r.substr(2,r.length-3);return Dh(e,o,n)})}function Cr(e){const t=fs(),n=Lh(t,e,"$");return B_(n)}function Dh(e,t,n){const[r,o]=Za(e,t,n);return r[o]}const Rh=/\$\$"/,q_=e=>typeof e=="string"&&e.search(Rh)===0;function V_(e){let t=null;const n=[],r=/<[^>]*>/g;do t=r.exec(e),t&&n.push(t);while(t);return n}const rt=Ot("dialog",{state:()=>({dialog:[],playMode:"normal",clearedAt:0,clearedDialogVisible:!1}),actions:{generateSaveData(){return{dialog:ze(this.dialog),clearedAt:this.clearedAt}},loadSaveData(e){this.dialog=ze(e.dialog),this.clearedAt=e.clearedAt},addDialog(e){this.dialog.push({...e,interactive:e.interactive??!1,id:as(),text:Cr(e.text)});const t=ve().dialogPanel.historyLength??200;this.dialog.length>t&&(this.dialog.shift(),this.clearedAt--)},toggleAutoPlay(){this.playMode=this.playMode==="auto"?"normal":"auto"},toggleSkip(){this.playMode=this.playMode==="skip"?"normal":"skip"},toggleHistory(){this.clearedDialogVisible=!this.clearedDialogVisible},clearDialog(){this.clearedAt=this.dialog.length},makeLastDialogInteractive(){this.dialog[this.dialog.length-1].interactive=!0},isDialogCleared(e){return e<this.clearedAt},reset(){this.dialog=[],this.playMode="normal",this.clearedAt=0,this.clearedDialogVisible=!1}},getters:{currentDialog(){return this.dialog[this.dialog.length-1]}}});var rr={};/*!
 *  howler.js v2.2.4
 *  howlerjs.com
 *
 *  (c) 2013-2020, James Simpson of GoldFire Studios
 *  goldfirestudios.com
 *
 *  MIT License
 */(function(e){(function(){var t=function(){this.init()};t.prototype={init:function(){var a=this||n;return a._counter=1e3,a._html5AudioPool=[],a.html5PoolSize=10,a._codecs={},a._howls=[],a._muted=!1,a._volume=1,a._canPlayEvent="canplaythrough",a._navigator=typeof window<"u"&&window.navigator?window.navigator:null,a.masterGain=null,a.noAudio=!1,a.usingWebAudio=!0,a.autoSuspend=!0,a.ctx=null,a.autoUnlock=!0,a._setup(),a},volume:function(a){var d=this||n;if(a=parseFloat(a),d.ctx||p(),typeof a<"u"&&a>=0&&a<=1){if(d._volume=a,d._muted)return d;d.usingWebAudio&&d.masterGain.gain.setValueAtTime(a,n.ctx.currentTime);for(var h=0;h<d._howls.length;h++)if(!d._howls[h]._webAudio)for(var m=d._howls[h]._getSoundIds(),y=0;y<m.length;y++){var T=d._howls[h]._soundById(m[y]);T&&T._node&&(T._node.volume=T._volume*a)}return d}return d._volume},mute:function(a){var d=this||n;d.ctx||p(),d._muted=a,d.usingWebAudio&&d.masterGain.gain.setValueAtTime(a?0:d._volume,n.ctx.currentTime);for(var h=0;h<d._howls.length;h++)if(!d._howls[h]._webAudio)for(var m=d._howls[h]._getSoundIds(),y=0;y<m.length;y++){var T=d._howls[h]._soundById(m[y]);T&&T._node&&(T._node.muted=a?!0:T._muted)}return d},stop:function(){for(var a=this||n,d=0;d<a._howls.length;d++)a._howls[d].stop();return a},unload:function(){for(var a=this||n,d=a._howls.length-1;d>=0;d--)a._howls[d].unload();return a.usingWebAudio&&a.ctx&&typeof a.ctx.close<"u"&&(a.ctx.close(),a.ctx=null,p()),a},codecs:function(a){return(this||n)._codecs[a.replace(/^x-/,"")]},_setup:function(){var a=this||n;if(a.state=a.ctx&&a.ctx.state||"suspended",a._autoSuspend(),!a.usingWebAudio)if(typeof Audio<"u")try{var d=new Audio;typeof d.oncanplaythrough>"u"&&(a._canPlayEvent="canplay")}catch{a.noAudio=!0}else a.noAudio=!0;try{var d=new Audio;d.muted&&(a.noAudio=!0)}catch{}return a.noAudio||a._setupCodecs(),a},_setupCodecs:function(){var a=this||n,d=null;try{d=typeof Audio<"u"?new Audio:null}catch{return a}if(!d||typeof d.canPlayType!="function")return a;var h=d.canPlayType("audio/mpeg;").replace(/^no$/,""),m=a._navigator?a._navigator.userAgent:"",y=m.match(/OPR\/(\d+)/g),T=y&&parseInt(y[0].split("/")[1],10)<33,g=m.indexOf("Safari")!==-1&&m.indexOf("Chrome")===-1,C=m.match(/Version\/(.*?) /),N=g&&C&&parseInt(C[1],10)<15;return a._codecs={mp3:!!(!T&&(h||d.canPlayType("audio/mp3;").replace(/^no$/,""))),mpeg:!!h,opus:!!d.canPlayType('audio/ogg; codecs="opus"').replace(/^no$/,""),ogg:!!d.canPlayType('audio/ogg; codecs="vorbis"').replace(/^no$/,""),oga:!!d.canPlayType('audio/ogg; codecs="vorbis"').replace(/^no$/,""),wav:!!(d.canPlayType('audio/wav; codecs="1"')||d.canPlayType("audio/wav")).replace(/^no$/,""),aac:!!d.canPlayType("audio/aac;").replace(/^no$/,""),caf:!!d.canPlayType("audio/x-caf;").replace(/^no$/,""),m4a:!!(d.canPlayType("audio/x-m4a;")||d.canPlayType("audio/m4a;")||d.canPlayType("audio/aac;")).replace(/^no$/,""),m4b:!!(d.canPlayType("audio/x-m4b;")||d.canPlayType("audio/m4b;")||d.canPlayType("audio/aac;")).replace(/^no$/,""),mp4:!!(d.canPlayType("audio/x-mp4;")||d.canPlayType("audio/mp4;")||d.canPlayType("audio/aac;")).replace(/^no$/,""),weba:!!(!N&&d.canPlayType('audio/webm; codecs="vorbis"').replace(/^no$/,"")),webm:!!(!N&&d.canPlayType('audio/webm; codecs="vorbis"').replace(/^no$/,"")),dolby:!!d.canPlayType('audio/mp4; codecs="ec-3"').replace(/^no$/,""),flac:!!(d.canPlayType("audio/x-flac;")||d.canPlayType("audio/flac;")).replace(/^no$/,"")},a},_unlockAudio:function(){var a=this||n;if(!(a._audioUnlocked||!a.ctx)){a._audioUnlocked=!1,a.autoUnlock=!1,!a._mobileUnloaded&&a.ctx.sampleRate!==44100&&(a._mobileUnloaded=!0,a.unload()),a._scratchBuffer=a.ctx.createBuffer(1,1,22050);var d=function(h){for(;a._html5AudioPool.length<a.html5PoolSize;)try{var m=new Audio;m._unlocked=!0,a._releaseHtml5Audio(m)}catch{a.noAudio=!0;break}for(var y=0;y<a._howls.length;y++)if(!a._howls[y]._webAudio)for(var T=a._howls[y]._getSoundIds(),g=0;g<T.length;g++){var C=a._howls[y]._soundById(T[g]);C&&C._node&&!C._node._unlocked&&(C._node._unlocked=!0,C._node.load())}a._autoResume();var N=a.ctx.createBufferSource();N.buffer=a._scratchBuffer,N.connect(a.ctx.destination),typeof N.start>"u"?N.noteOn(0):N.start(0),typeof a.ctx.resume=="function"&&a.ctx.resume(),N.onended=function(){N.disconnect(0),a._audioUnlocked=!0,document.removeEventListener("touchstart",d,!0),document.removeEventListener("touchend",d,!0),document.removeEventListener("click",d,!0),document.removeEventListener("keydown",d,!0);for(var L=0;L<a._howls.length;L++)a._howls[L]._emit("unlock")}};return document.addEventListener("touchstart",d,!0),document.addEventListener("touchend",d,!0),document.addEventListener("click",d,!0),document.addEventListener("keydown",d,!0),a}},_obtainHtml5Audio:function(){var a=this||n;if(a._html5AudioPool.length)return a._html5AudioPool.pop();var d=new Audio().play();return d&&typeof Promise<"u"&&(d instanceof Promise||typeof d.then=="function")&&d.catch(function(){console.warn("HTML5 Audio pool exhausted, returning potentially locked audio object.")}),new Audio},_releaseHtml5Audio:function(a){var d=this||n;return a._unlocked&&d._html5AudioPool.push(a),d},_autoSuspend:function(){var a=this;if(!(!a.autoSuspend||!a.ctx||typeof a.ctx.suspend>"u"||!n.usingWebAudio)){for(var d=0;d<a._howls.length;d++)if(a._howls[d]._webAudio){for(var h=0;h<a._howls[d]._sounds.length;h++)if(!a._howls[d]._sounds[h]._paused)return a}return a._suspendTimer&&clearTimeout(a._suspendTimer),a._suspendTimer=setTimeout(function(){if(a.autoSuspend){a._suspendTimer=null,a.state="suspending";var m=function(){a.state="suspended",a._resumeAfterSuspend&&(delete a._resumeAfterSuspend,a._autoResume())};a.ctx.suspend().then(m,m)}},3e4),a}},_autoResume:function(){var a=this;if(!(!a.ctx||typeof a.ctx.resume>"u"||!n.usingWebAudio))return a.state==="running"&&a.ctx.state!=="interrupted"&&a._suspendTimer?(clearTimeout(a._suspendTimer),a._suspendTimer=null):a.state==="suspended"||a.state==="running"&&a.ctx.state==="interrupted"?(a.ctx.resume().then(function(){a.state="running";for(var d=0;d<a._howls.length;d++)a._howls[d]._emit("resume")}),a._suspendTimer&&(clearTimeout(a._suspendTimer),a._suspendTimer=null)):a.state==="suspending"&&(a._resumeAfterSuspend=!0),a}};var n=new t,r=function(a){var d=this;if(!a.src||a.src.length===0){console.error("An array of source files must be passed with any new Howl.");return}d.init(a)};r.prototype={init:function(a){var d=this;return n.ctx||p(),d._autoplay=a.autoplay||!1,d._format=typeof a.format!="string"?a.format:[a.format],d._html5=a.html5||!1,d._muted=a.mute||!1,d._loop=a.loop||!1,d._pool=a.pool||5,d._preload=typeof a.preload=="boolean"||a.preload==="metadata"?a.preload:!0,d._rate=a.rate||1,d._sprite=a.sprite||{},d._src=typeof a.src!="string"?a.src:[a.src],d._volume=a.volume!==void 0?a.volume:1,d._xhr={method:a.xhr&&a.xhr.method?a.xhr.method:"GET",headers:a.xhr&&a.xhr.headers?a.xhr.headers:null,withCredentials:a.xhr&&a.xhr.withCredentials?a.xhr.withCredentials:!1},d._duration=0,d._state="unloaded",d._sounds=[],d._endTimers={},d._queue=[],d._playLock=!1,d._onend=a.onend?[{fn:a.onend}]:[],d._onfade=a.onfade?[{fn:a.onfade}]:[],d._onload=a.onload?[{fn:a.onload}]:[],d._onloaderror=a.onloaderror?[{fn:a.onloaderror}]:[],d._onplayerror=a.onplayerror?[{fn:a.onplayerror}]:[],d._onpause=a.onpause?[{fn:a.onpause}]:[],d._onplay=a.onplay?[{fn:a.onplay}]:[],d._onstop=a.onstop?[{fn:a.onstop}]:[],d._onmute=a.onmute?[{fn:a.onmute}]:[],d._onvolume=a.onvolume?[{fn:a.onvolume}]:[],d._onrate=a.onrate?[{fn:a.onrate}]:[],d._onseek=a.onseek?[{fn:a.onseek}]:[],d._onunlock=a.onunlock?[{fn:a.onunlock}]:[],d._onresume=[],d._webAudio=n.usingWebAudio&&!d._html5,typeof n.ctx<"u"&&n.ctx&&n.autoUnlock&&n._unlockAudio(),n._howls.push(d),d._autoplay&&d._queue.push({event:"play",action:function(){d.play()}}),d._preload&&d._preload!=="none"&&d.load(),d},load:function(){var a=this,d=null;if(n.noAudio){a._emit("loaderror",null,"No audio support.");return}typeof a._src=="string"&&(a._src=[a._src]);for(var h=0;h<a._src.length;h++){var m,y;if(a._format&&a._format[h])m=a._format[h];else{if(y=a._src[h],typeof y!="string"){a._emit("loaderror",null,"Non-string found in selected audio sources - ignoring.");continue}m=/^data:audio\/([^;,]+);/i.exec(y),m||(m=/\.([^.]+)$/.exec(y.split("?",1)[0])),m&&(m=m[1].toLowerCase())}if(m||console.warn('No file extension was found. Consider using the "format" property or specify an extension.'),m&&n.codecs(m)){d=a._src[h];break}}if(!d){a._emit("loaderror",null,"No codec support for selected audio sources.");return}return a._src=d,a._state="loading",window.location.protocol==="https:"&&d.slice(0,5)==="http:"&&(a._html5=!0,a._webAudio=!1),new o(a),a._webAudio&&s(a),a},play:function(a,d){var h=this,m=null;if(typeof a=="number")m=a,a=null;else{if(typeof a=="string"&&h._state==="loaded"&&!h._sprite[a])return null;if(typeof a>"u"&&(a="__default",!h._playLock)){for(var y=0,T=0;T<h._sounds.length;T++)h._sounds[T]._paused&&!h._sounds[T]._ended&&(y++,m=h._sounds[T]._id);y===1?a=null:m=null}}var g=m?h._soundById(m):h._inactiveSound();if(!g)return null;if(m&&!a&&(a=g._sprite||"__default"),h._state!=="loaded"){g._sprite=a,g._ended=!1;var C=g._id;return h._queue.push({event:"play",action:function(){h.play(C)}}),C}if(m&&!g._paused)return d||h._loadQueue("play"),g._id;h._webAudio&&n._autoResume();var N=Math.max(0,g._seek>0?g._seek:h._sprite[a][0]/1e3),L=Math.max(0,(h._sprite[a][0]+h._sprite[a][1])/1e3-N),B=L*1e3/Math.abs(g._rate),M=h._sprite[a][0]/1e3,E=(h._sprite[a][0]+h._sprite[a][1])/1e3;g._sprite=a,g._ended=!1;var W=function(){g._paused=!1,g._seek=N,g._start=M,g._stop=E,g._loop=!!(g._loop||h._sprite[a][2])};if(N>=E){h._ended(g);return}var q=g._node;if(h._webAudio){var ue=function(){h._playLock=!1,W(),h._refreshBuffer(g);var ae=g._muted||h._muted?0:g._volume;q.gain.setValueAtTime(ae,n.ctx.currentTime),g._playStart=n.ctx.currentTime,typeof q.bufferSource.start>"u"?g._loop?q.bufferSource.noteGrainOn(0,N,86400):q.bufferSource.noteGrainOn(0,N,L):g._loop?q.bufferSource.start(0,N,86400):q.bufferSource.start(0,N,L),B!==1/0&&(h._endTimers[g._id]=setTimeout(h._ended.bind(h,g),B)),d||setTimeout(function(){h._emit("play",g._id),h._loadQueue()},0)};n.state==="running"&&n.ctx.state!=="interrupted"?ue():(h._playLock=!0,h.once("resume",ue),h._clearTimer(g._id))}else{var ce=function(){q.currentTime=N,q.muted=g._muted||h._muted||n._muted||q.muted,q.volume=g._volume*n.volume(),q.playbackRate=g._rate;try{var ae=q.play();if(ae&&typeof Promise<"u"&&(ae instanceof Promise||typeof ae.then=="function")?(h._playLock=!0,W(),ae.then(function(){h._playLock=!1,q._unlocked=!0,d?h._loadQueue():h._emit("play",g._id)}).catch(function(){h._playLock=!1,h._emit("playerror",g._id,"Playback was unable to start. This is most commonly an issue on mobile devices and Chrome where playback was not within a user interaction."),g._ended=!0,g._paused=!0})):d||(h._playLock=!1,W(),h._emit("play",g._id)),q.playbackRate=g._rate,q.paused){h._emit("playerror",g._id,"Playback was unable to start. This is most commonly an issue on mobile devices and Chrome where playback was not within a user interaction.");return}a!=="__default"||g._loop?h._endTimers[g._id]=setTimeout(h._ended.bind(h,g),B):(h._endTimers[g._id]=function(){h._ended(g),q.removeEventListener("ended",h._endTimers[g._id],!1)},q.addEventListener("ended",h._endTimers[g._id],!1))}catch(ke){h._emit("playerror",g._id,ke)}};q.src==="data:audio/wav;base64,UklGRigAAABXQVZFZm10IBIAAAABAAEARKwAAIhYAQACABAAAABkYXRhAgAAAAEA"&&(q.src=h._src,q.load());var te=window&&window.ejecta||!q.readyState&&n._navigator.isCocoonJS;if(q.readyState>=3||te)ce();else{h._playLock=!0,h._state="loading";var Q=function(){h._state="loaded",ce(),q.removeEventListener(n._canPlayEvent,Q,!1)};q.addEventListener(n._canPlayEvent,Q,!1),h._clearTimer(g._id)}}return g._id},pause:function(a){var d=this;if(d._state!=="loaded"||d._playLock)return d._queue.push({event:"pause",action:function(){d.pause(a)}}),d;for(var h=d._getSoundIds(a),m=0;m<h.length;m++){d._clearTimer(h[m]);var y=d._soundById(h[m]);if(y&&!y._paused&&(y._seek=d.seek(h[m]),y._rateSeek=0,y._paused=!0,d._stopFade(h[m]),y._node))if(d._webAudio){if(!y._node.bufferSource)continue;typeof y._node.bufferSource.stop>"u"?y._node.bufferSource.noteOff(0):y._node.bufferSource.stop(0),d._cleanBuffer(y._node)}else(!isNaN(y._node.duration)||y._node.duration===1/0)&&y._node.pause();arguments[1]||d._emit("pause",y?y._id:null)}return d},stop:function(a,d){var h=this;if(h._state!=="loaded"||h._playLock)return h._queue.push({event:"stop",action:function(){h.stop(a)}}),h;for(var m=h._getSoundIds(a),y=0;y<m.length;y++){h._clearTimer(m[y]);var T=h._soundById(m[y]);T&&(T._seek=T._start||0,T._rateSeek=0,T._paused=!0,T._ended=!0,h._stopFade(m[y]),T._node&&(h._webAudio?T._node.bufferSource&&(typeof T._node.bufferSource.stop>"u"?T._node.bufferSource.noteOff(0):T._node.bufferSource.stop(0),h._cleanBuffer(T._node)):(!isNaN(T._node.duration)||T._node.duration===1/0)&&(T._node.currentTime=T._start||0,T._node.pause(),T._node.duration===1/0&&h._clearSound(T._node))),d||h._emit("stop",T._id))}return h},mute:function(a,d){var h=this;if(h._state!=="loaded"||h._playLock)return h._queue.push({event:"mute",action:function(){h.mute(a,d)}}),h;if(typeof d>"u")if(typeof a=="boolean")h._muted=a;else return h._muted;for(var m=h._getSoundIds(d),y=0;y<m.length;y++){var T=h._soundById(m[y]);T&&(T._muted=a,T._interval&&h._stopFade(T._id),h._webAudio&&T._node?T._node.gain.setValueAtTime(a?0:T._volume,n.ctx.currentTime):T._node&&(T._node.muted=n._muted?!0:a),h._emit("mute",T._id))}return h},volume:function(){var a=this,d=arguments,h,m;if(d.length===0)return a._volume;if(d.length===1||d.length===2&&typeof d[1]>"u"){var y=a._getSoundIds(),T=y.indexOf(d[0]);T>=0?m=parseInt(d[0],10):h=parseFloat(d[0])}else d.length>=2&&(h=parseFloat(d[0]),m=parseInt(d[1],10));var g;if(typeof h<"u"&&h>=0&&h<=1){if(a._state!=="loaded"||a._playLock)return a._queue.push({event:"volume",action:function(){a.volume.apply(a,d)}}),a;typeof m>"u"&&(a._volume=h),m=a._getSoundIds(m);for(var C=0;C<m.length;C++)g=a._soundById(m[C]),g&&(g._volume=h,d[2]||a._stopFade(m[C]),a._webAudio&&g._node&&!g._muted?g._node.gain.setValueAtTime(h,n.ctx.currentTime):g._node&&!g._muted&&(g._node.volume=h*n.volume()),a._emit("volume",g._id))}else return g=m?a._soundById(m):a._sounds[0],g?g._volume:0;return a},fade:function(a,d,h,m){var y=this;if(y._state!=="loaded"||y._playLock)return y._queue.push({event:"fade",action:function(){y.fade(a,d,h,m)}}),y;a=Math.min(Math.max(0,parseFloat(a)),1),d=Math.min(Math.max(0,parseFloat(d)),1),h=parseFloat(h),y.volume(a,m);for(var T=y._getSoundIds(m),g=0;g<T.length;g++){var C=y._soundById(T[g]);if(C){if(m||y._stopFade(T[g]),y._webAudio&&!C._muted){var N=n.ctx.currentTime,L=N+h/1e3;C._volume=a,C._node.gain.setValueAtTime(a,N),C._node.gain.linearRampToValueAtTime(d,L)}y._startFadeInterval(C,a,d,h,T[g],typeof m>"u")}}return y},_startFadeInterval:function(a,d,h,m,y,T){var g=this,C=d,N=h-d,L=Math.abs(N/.01),B=Math.max(4,L>0?m/L:m),M=Date.now();a._fadeTo=h,a._interval=setInterval(function(){var E=(Date.now()-M)/m;M=Date.now(),C+=N*E,C=Math.round(C*100)/100,N<0?C=Math.max(h,C):C=Math.min(h,C),g._webAudio?a._volume=C:g.volume(C,a._id,!0),T&&(g._volume=C),(h<d&&C<=h||h>d&&C>=h)&&(clearInterval(a._interval),a._interval=null,a._fadeTo=null,g.volume(h,a._id),g._emit("fade",a._id))},B)},_stopFade:function(a){var d=this,h=d._soundById(a);return h&&h._interval&&(d._webAudio&&h._node.gain.cancelScheduledValues(n.ctx.currentTime),clearInterval(h._interval),h._interval=null,d.volume(h._fadeTo,a),h._fadeTo=null,d._emit("fade",a)),d},loop:function(){var a=this,d=arguments,h,m,y;if(d.length===0)return a._loop;if(d.length===1)if(typeof d[0]=="boolean")h=d[0],a._loop=h;else return y=a._soundById(parseInt(d[0],10)),y?y._loop:!1;else d.length===2&&(h=d[0],m=parseInt(d[1],10));for(var T=a._getSoundIds(m),g=0;g<T.length;g++)y=a._soundById(T[g]),y&&(y._loop=h,a._webAudio&&y._node&&y._node.bufferSource&&(y._node.bufferSource.loop=h,h&&(y._node.bufferSource.loopStart=y._start||0,y._node.bufferSource.loopEnd=y._stop,a.playing(T[g])&&(a.pause(T[g],!0),a.play(T[g],!0)))));return a},rate:function(){var a=this,d=arguments,h,m;if(d.length===0)m=a._sounds[0]._id;else if(d.length===1){var y=a._getSoundIds(),T=y.indexOf(d[0]);T>=0?m=parseInt(d[0],10):h=parseFloat(d[0])}else d.length===2&&(h=parseFloat(d[0]),m=parseInt(d[1],10));var g;if(typeof h=="number"){if(a._state!=="loaded"||a._playLock)return a._queue.push({event:"rate",action:function(){a.rate.apply(a,d)}}),a;typeof m>"u"&&(a._rate=h),m=a._getSoundIds(m);for(var C=0;C<m.length;C++)if(g=a._soundById(m[C]),g){a.playing(m[C])&&(g._rateSeek=a.seek(m[C]),g._playStart=a._webAudio?n.ctx.currentTime:g._playStart),g._rate=h,a._webAudio&&g._node&&g._node.bufferSource?g._node.bufferSource.playbackRate.setValueAtTime(h,n.ctx.currentTime):g._node&&(g._node.playbackRate=h);var N=a.seek(m[C]),L=(a._sprite[g._sprite][0]+a._sprite[g._sprite][1])/1e3-N,B=L*1e3/Math.abs(g._rate);(a._endTimers[m[C]]||!g._paused)&&(a._clearTimer(m[C]),a._endTimers[m[C]]=setTimeout(a._ended.bind(a,g),B)),a._emit("rate",g._id)}}else return g=a._soundById(m),g?g._rate:a._rate;return a},seek:function(){var a=this,d=arguments,h,m;if(d.length===0)a._sounds.length&&(m=a._sounds[0]._id);else if(d.length===1){var y=a._getSoundIds(),T=y.indexOf(d[0]);T>=0?m=parseInt(d[0],10):a._sounds.length&&(m=a._sounds[0]._id,h=parseFloat(d[0]))}else d.length===2&&(h=parseFloat(d[0]),m=parseInt(d[1],10));if(typeof m>"u")return 0;if(typeof h=="number"&&(a._state!=="loaded"||a._playLock))return a._queue.push({event:"seek",action:function(){a.seek.apply(a,d)}}),a;var g=a._soundById(m);if(g)if(typeof h=="number"&&h>=0){var C=a.playing(m);C&&a.pause(m,!0),g._seek=h,g._ended=!1,a._clearTimer(m),!a._webAudio&&g._node&&!isNaN(g._node.duration)&&(g._node.currentTime=h);var N=function(){C&&a.play(m,!0),a._emit("seek",m)};if(C&&!a._webAudio){var L=function(){a._playLock?setTimeout(L,0):N()};setTimeout(L,0)}else N()}else if(a._webAudio){var B=a.playing(m)?n.ctx.currentTime-g._playStart:0,M=g._rateSeek?g._rateSeek-g._seek:0;return g._seek+(M+B*Math.abs(g._rate))}else return g._node.currentTime;return a},playing:function(a){var d=this;if(typeof a=="number"){var h=d._soundById(a);return h?!h._paused:!1}for(var m=0;m<d._sounds.length;m++)if(!d._sounds[m]._paused)return!0;return!1},duration:function(a){var d=this,h=d._duration,m=d._soundById(a);return m&&(h=d._sprite[m._sprite][1]/1e3),h},state:function(){return this._state},unload:function(){for(var a=this,d=a._sounds,h=0;h<d.length;h++)d[h]._paused||a.stop(d[h]._id),a._webAudio||(a._clearSound(d[h]._node),d[h]._node.removeEventListener("error",d[h]._errorFn,!1),d[h]._node.removeEventListener(n._canPlayEvent,d[h]._loadFn,!1),d[h]._node.removeEventListener("ended",d[h]._endFn,!1),n._releaseHtml5Audio(d[h]._node)),delete d[h]._node,a._clearTimer(d[h]._id);var m=n._howls.indexOf(a);m>=0&&n._howls.splice(m,1);var y=!0;for(h=0;h<n._howls.length;h++)if(n._howls[h]._src===a._src||a._src.indexOf(n._howls[h]._src)>=0){y=!1;break}return i&&y&&delete i[a._src],n.noAudio=!1,a._state="unloaded",a._sounds=[],a=null,null},on:function(a,d,h,m){var y=this,T=y["_on"+a];return typeof d=="function"&&T.push(m?{id:h,fn:d,once:m}:{id:h,fn:d}),y},off:function(a,d,h){var m=this,y=m["_on"+a],T=0;if(typeof d=="number"&&(h=d,d=null),d||h)for(T=0;T<y.length;T++){var g=h===y[T].id;if(d===y[T].fn&&g||!d&&g){y.splice(T,1);break}}else if(a)m["_on"+a]=[];else{var C=Object.keys(m);for(T=0;T<C.length;T++)C[T].indexOf("_on")===0&&Array.isArray(m[C[T]])&&(m[C[T]]=[])}return m},once:function(a,d,h){var m=this;return m.on(a,d,h,1),m},_emit:function(a,d,h){for(var m=this,y=m["_on"+a],T=y.length-1;T>=0;T--)(!y[T].id||y[T].id===d||a==="load")&&(setTimeout((function(g){g.call(this,d,h)}).bind(m,y[T].fn),0),y[T].once&&m.off(a,y[T].fn,y[T].id));return m._loadQueue(a),m},_loadQueue:function(a){var d=this;if(d._queue.length>0){var h=d._queue[0];h.event===a&&(d._queue.shift(),d._loadQueue()),a||h.action()}return d},_ended:function(a){var d=this,h=a._sprite;if(!d._webAudio&&a._node&&!a._node.paused&&!a._node.ended&&a._node.currentTime<a._stop)return setTimeout(d._ended.bind(d,a),100),d;var m=!!(a._loop||d._sprite[h][2]);if(d._emit("end",a._id),!d._webAudio&&m&&d.stop(a._id,!0).play(a._id),d._webAudio&&m){d._emit("play",a._id),a._seek=a._start||0,a._rateSeek=0,a._playStart=n.ctx.currentTime;var y=(a._stop-a._start)*1e3/Math.abs(a._rate);d._endTimers[a._id]=setTimeout(d._ended.bind(d,a),y)}return d._webAudio&&!m&&(a._paused=!0,a._ended=!0,a._seek=a._start||0,a._rateSeek=0,d._clearTimer(a._id),d._cleanBuffer(a._node),n._autoSuspend()),!d._webAudio&&!m&&d.stop(a._id,!0),d},_clearTimer:function(a){var d=this;if(d._endTimers[a]){if(typeof d._endTimers[a]!="function")clearTimeout(d._endTimers[a]);else{var h=d._soundById(a);h&&h._node&&h._node.removeEventListener("ended",d._endTimers[a],!1)}delete d._endTimers[a]}return d},_soundById:function(a){for(var d=this,h=0;h<d._sounds.length;h++)if(a===d._sounds[h]._id)return d._sounds[h];return null},_inactiveSound:function(){var a=this;a._drain();for(var d=0;d<a._sounds.length;d++)if(a._sounds[d]._ended)return a._sounds[d].reset();return new o(a)},_drain:function(){var a=this,d=a._pool,h=0,m=0;if(!(a._sounds.length<d)){for(m=0;m<a._sounds.length;m++)a._sounds[m]._ended&&h++;for(m=a._sounds.length-1;m>=0;m--){if(h<=d)return;a._sounds[m]._ended&&(a._webAudio&&a._sounds[m]._node&&a._sounds[m]._node.disconnect(0),a._sounds.splice(m,1),h--)}}},_getSoundIds:function(a){var d=this;if(typeof a>"u"){for(var h=[],m=0;m<d._sounds.length;m++)h.push(d._sounds[m]._id);return h}else return[a]},_refreshBuffer:function(a){var d=this;return a._node.bufferSource=n.ctx.createBufferSource(),a._node.bufferSource.buffer=i[d._src],a._panner?a._node.bufferSource.connect(a._panner):a._node.bufferSource.connect(a._node),a._node.bufferSource.loop=a._loop,a._loop&&(a._node.bufferSource.loopStart=a._start||0,a._node.bufferSource.loopEnd=a._stop||0),a._node.bufferSource.playbackRate.setValueAtTime(a._rate,n.ctx.currentTime),d},_cleanBuffer:function(a){var d=this,h=n._navigator&&n._navigator.vendor.indexOf("Apple")>=0;if(!a.bufferSource)return d;if(n._scratchBuffer&&a.bufferSource&&(a.bufferSource.onended=null,a.bufferSource.disconnect(0),h))try{a.bufferSource.buffer=n._scratchBuffer}catch{}return a.bufferSource=null,d},_clearSound:function(a){var d=/MSIE |Trident\//.test(n._navigator&&n._navigator.userAgent);d||(a.src="data:audio/wav;base64,UklGRigAAABXQVZFZm10IBIAAAABAAEARKwAAIhYAQACABAAAABkYXRhAgAAAAEA")}};var o=function(a){this._parent=a,this.init()};o.prototype={init:function(){var a=this,d=a._parent;return a._muted=d._muted,a._loop=d._loop,a._volume=d._volume,a._rate=d._rate,a._seek=0,a._paused=!0,a._ended=!0,a._sprite="__default",a._id=++n._counter,d._sounds.push(a),a.create(),a},create:function(){var a=this,d=a._parent,h=n._muted||a._muted||a._parent._muted?0:a._volume;return d._webAudio?(a._node=typeof n.ctx.createGain>"u"?n.ctx.createGainNode():n.ctx.createGain(),a._node.gain.setValueAtTime(h,n.ctx.currentTime),a._node.paused=!0,a._node.connect(n.masterGain)):n.noAudio||(a._node=n._obtainHtml5Audio(),a._errorFn=a._errorListener.bind(a),a._node.addEventListener("error",a._errorFn,!1),a._loadFn=a._loadListener.bind(a),a._node.addEventListener(n._canPlayEvent,a._loadFn,!1),a._endFn=a._endListener.bind(a),a._node.addEventListener("ended",a._endFn,!1),a._node.src=d._src,a._node.preload=d._preload===!0?"auto":d._preload,a._node.volume=h*n.volume(),a._node.load()),a},reset:function(){var a=this,d=a._parent;return a._muted=d._muted,a._loop=d._loop,a._volume=d._volume,a._rate=d._rate,a._seek=0,a._rateSeek=0,a._paused=!0,a._ended=!0,a._sprite="__default",a._id=++n._counter,a},_errorListener:function(){var a=this;a._parent._emit("loaderror",a._id,a._node.error?a._node.error.code:0),a._node.removeEventListener("error",a._errorFn,!1)},_loadListener:function(){var a=this,d=a._parent;d._duration=Math.ceil(a._node.duration*10)/10,Object.keys(d._sprite).length===0&&(d._sprite={__default:[0,d._duration*1e3]}),d._state!=="loaded"&&(d._state="loaded",d._emit("load"),d._loadQueue()),a._node.removeEventListener(n._canPlayEvent,a._loadFn,!1)},_endListener:function(){var a=this,d=a._parent;d._duration===1/0&&(d._duration=Math.ceil(a._node.duration*10)/10,d._sprite.__default[1]===1/0&&(d._sprite.__default[1]=d._duration*1e3),d._ended(a)),a._node.removeEventListener("ended",a._endFn,!1)}};var i={},s=function(a){var d=a._src;if(i[d]){a._duration=i[d].duration,c(a);return}if(/^data:[^;]+;base64,/.test(d)){for(var h=atob(d.split(",")[1]),m=new Uint8Array(h.length),y=0;y<h.length;++y)m[y]=h.charCodeAt(y);u(m.buffer,a)}else{var T=new XMLHttpRequest;T.open(a._xhr.method,d,!0),T.withCredentials=a._xhr.withCredentials,T.responseType="arraybuffer",a._xhr.headers&&Object.keys(a._xhr.headers).forEach(function(g){T.setRequestHeader(g,a._xhr.headers[g])}),T.onload=function(){var g=(T.status+"")[0];if(g!=="0"&&g!=="2"&&g!=="3"){a._emit("loaderror",null,"Failed loading audio file with status: "+T.status+".");return}u(T.response,a)},T.onerror=function(){a._webAudio&&(a._html5=!0,a._webAudio=!1,a._sounds=[],delete i[d],a.load())},l(T)}},l=function(a){try{a.send()}catch{a.onerror()}},u=function(a,d){var h=function(){d._emit("loaderror",null,"Decoding audio data failed.")},m=function(y){y&&d._sounds.length>0?(i[d._src]=y,c(d,y)):h()};typeof Promise<"u"&&n.ctx.decodeAudioData.length===1?n.ctx.decodeAudioData(a).then(m).catch(h):n.ctx.decodeAudioData(a,m,h)},c=function(a,d){d&&!a._duration&&(a._duration=d.duration),Object.keys(a._sprite).length===0&&(a._sprite={__default:[0,a._duration*1e3]}),a._state!=="loaded"&&(a._state="loaded",a._emit("load"),a._loadQueue())},p=function(){if(n.usingWebAudio){try{typeof AudioContext<"u"?n.ctx=new AudioContext:typeof webkitAudioContext<"u"?n.ctx=new webkitAudioContext:n.usingWebAudio=!1}catch{n.usingWebAudio=!1}n.ctx||(n.usingWebAudio=!1);var a=/iP(hone|od|ad)/.test(n._navigator&&n._navigator.platform),d=n._navigator&&n._navigator.appVersion.match(/OS (\d+)_(\d+)_?(\d+)?/),h=d?parseInt(d[1],10):null;if(a&&h&&h<9){var m=/safari/.test(n._navigator&&n._navigator.userAgent.toLowerCase());n._navigator&&!m&&(n.usingWebAudio=!1)}n.usingWebAudio&&(n.masterGain=typeof n.ctx.createGain>"u"?n.ctx.createGainNode():n.ctx.createGain(),n.masterGain.gain.setValueAtTime(n._muted?0:n._volume,n.ctx.currentTime),n.masterGain.connect(n.ctx.destination)),n._setup()}};e.Howler=n,e.Howl=r,typeof vr<"u"?(vr.HowlerGlobal=t,vr.Howler=n,vr.Howl=r,vr.Sound=o):typeof window<"u"&&(window.HowlerGlobal=t,window.Howler=n,window.Howl=r,window.Sound=o)})();/*!
 *  Spatial Plugin - Adds support for stereo and 3D audio where Web Audio is supported.
 *  
 *  howler.js v2.2.4
 *  howlerjs.com
 *
 *  (c) 2013-2020, James Simpson of GoldFire Studios
 *  goldfirestudios.com
 *
 *  MIT License
 */(function(){HowlerGlobal.prototype._pos=[0,0,0],HowlerGlobal.prototype._orientation=[0,0,-1,0,1,0],HowlerGlobal.prototype.stereo=function(n){var r=this;if(!r.ctx||!r.ctx.listener)return r;for(var o=r._howls.length-1;o>=0;o--)r._howls[o].stereo(n);return r},HowlerGlobal.prototype.pos=function(n,r,o){var i=this;if(!i.ctx||!i.ctx.listener)return i;if(r=typeof r!="number"?i._pos[1]:r,o=typeof o!="number"?i._pos[2]:o,typeof n=="number")i._pos=[n,r,o],typeof i.ctx.listener.positionX<"u"?(i.ctx.listener.positionX.setTargetAtTime(i._pos[0],Howler.ctx.currentTime,.1),i.ctx.listener.positionY.setTargetAtTime(i._pos[1],Howler.ctx.currentTime,.1),i.ctx.listener.positionZ.setTargetAtTime(i._pos[2],Howler.ctx.currentTime,.1)):i.ctx.listener.setPosition(i._pos[0],i._pos[1],i._pos[2]);else return i._pos;return i},HowlerGlobal.prototype.orientation=function(n,r,o,i,s,l){var u=this;if(!u.ctx||!u.ctx.listener)return u;var c=u._orientation;if(r=typeof r!="number"?c[1]:r,o=typeof o!="number"?c[2]:o,i=typeof i!="number"?c[3]:i,s=typeof s!="number"?c[4]:s,l=typeof l!="number"?c[5]:l,typeof n=="number")u._orientation=[n,r,o,i,s,l],typeof u.ctx.listener.forwardX<"u"?(u.ctx.listener.forwardX.setTargetAtTime(n,Howler.ctx.currentTime,.1),u.ctx.listener.forwardY.setTargetAtTime(r,Howler.ctx.currentTime,.1),u.ctx.listener.forwardZ.setTargetAtTime(o,Howler.ctx.currentTime,.1),u.ctx.listener.upX.setTargetAtTime(i,Howler.ctx.currentTime,.1),u.ctx.listener.upY.setTargetAtTime(s,Howler.ctx.currentTime,.1),u.ctx.listener.upZ.setTargetAtTime(l,Howler.ctx.currentTime,.1)):u.ctx.listener.setOrientation(n,r,o,i,s,l);else return c;return u},Howl.prototype.init=function(n){return function(r){var o=this;return o._orientation=r.orientation||[1,0,0],o._stereo=r.stereo||null,o._pos=r.pos||null,o._pannerAttr={coneInnerAngle:typeof r.coneInnerAngle<"u"?r.coneInnerAngle:360,coneOuterAngle:typeof r.coneOuterAngle<"u"?r.coneOuterAngle:360,coneOuterGain:typeof r.coneOuterGain<"u"?r.coneOuterGain:0,distanceModel:typeof r.distanceModel<"u"?r.distanceModel:"inverse",maxDistance:typeof r.maxDistance<"u"?r.maxDistance:1e4,panningModel:typeof r.panningModel<"u"?r.panningModel:"HRTF",refDistance:typeof r.refDistance<"u"?r.refDistance:1,rolloffFactor:typeof r.rolloffFactor<"u"?r.rolloffFactor:1},o._onstereo=r.onstereo?[{fn:r.onstereo}]:[],o._onpos=r.onpos?[{fn:r.onpos}]:[],o._onorientation=r.onorientation?[{fn:r.onorientation}]:[],n.call(this,r)}}(Howl.prototype.init),Howl.prototype.stereo=function(n,r){var o=this;if(!o._webAudio)return o;if(o._state!=="loaded")return o._queue.push({event:"stereo",action:function(){o.stereo(n,r)}}),o;var i=typeof Howler.ctx.createStereoPanner>"u"?"spatial":"stereo";if(typeof r>"u")if(typeof n=="number")o._stereo=n,o._pos=[n,0,0];else return o._stereo;for(var s=o._getSoundIds(r),l=0;l<s.length;l++){var u=o._soundById(s[l]);if(u)if(typeof n=="number")u._stereo=n,u._pos=[n,0,0],u._node&&(u._pannerAttr.panningModel="equalpower",(!u._panner||!u._panner.pan)&&t(u,i),i==="spatial"?typeof u._panner.positionX<"u"?(u._panner.positionX.setValueAtTime(n,Howler.ctx.currentTime),u._panner.positionY.setValueAtTime(0,Howler.ctx.currentTime),u._panner.positionZ.setValueAtTime(0,Howler.ctx.currentTime)):u._panner.setPosition(n,0,0):u._panner.pan.setValueAtTime(n,Howler.ctx.currentTime)),o._emit("stereo",u._id);else return u._stereo}return o},Howl.prototype.pos=function(n,r,o,i){var s=this;if(!s._webAudio)return s;if(s._state!=="loaded")return s._queue.push({event:"pos",action:function(){s.pos(n,r,o,i)}}),s;if(r=typeof r!="number"?0:r,o=typeof o!="number"?-.5:o,typeof i>"u")if(typeof n=="number")s._pos=[n,r,o];else return s._pos;for(var l=s._getSoundIds(i),u=0;u<l.length;u++){var c=s._soundById(l[u]);if(c)if(typeof n=="number")c._pos=[n,r,o],c._node&&((!c._panner||c._panner.pan)&&t(c,"spatial"),typeof c._panner.positionX<"u"?(c._panner.positionX.setValueAtTime(n,Howler.ctx.currentTime),c._panner.positionY.setValueAtTime(r,Howler.ctx.currentTime),c._panner.positionZ.setValueAtTime(o,Howler.ctx.currentTime)):c._panner.setPosition(n,r,o)),s._emit("pos",c._id);else return c._pos}return s},Howl.prototype.orientation=function(n,r,o,i){var s=this;if(!s._webAudio)return s;if(s._state!=="loaded")return s._queue.push({event:"orientation",action:function(){s.orientation(n,r,o,i)}}),s;if(r=typeof r!="number"?s._orientation[1]:r,o=typeof o!="number"?s._orientation[2]:o,typeof i>"u")if(typeof n=="number")s._orientation=[n,r,o];else return s._orientation;for(var l=s._getSoundIds(i),u=0;u<l.length;u++){var c=s._soundById(l[u]);if(c)if(typeof n=="number")c._orientation=[n,r,o],c._node&&(c._panner||(c._pos||(c._pos=s._pos||[0,0,-.5]),t(c,"spatial")),typeof c._panner.orientationX<"u"?(c._panner.orientationX.setValueAtTime(n,Howler.ctx.currentTime),c._panner.orientationY.setValueAtTime(r,Howler.ctx.currentTime),c._panner.orientationZ.setValueAtTime(o,Howler.ctx.currentTime)):c._panner.setOrientation(n,r,o)),s._emit("orientation",c._id);else return c._orientation}return s},Howl.prototype.pannerAttr=function(){var n=this,r=arguments,o,i,s;if(!n._webAudio)return n;if(r.length===0)return n._pannerAttr;if(r.length===1)if(typeof r[0]=="object")o=r[0],typeof i>"u"&&(o.pannerAttr||(o.pannerAttr={coneInnerAngle:o.coneInnerAngle,coneOuterAngle:o.coneOuterAngle,coneOuterGain:o.coneOuterGain,distanceModel:o.distanceModel,maxDistance:o.maxDistance,refDistance:o.refDistance,rolloffFactor:o.rolloffFactor,panningModel:o.panningModel}),n._pannerAttr={coneInnerAngle:typeof o.pannerAttr.coneInnerAngle<"u"?o.pannerAttr.coneInnerAngle:n._coneInnerAngle,coneOuterAngle:typeof o.pannerAttr.coneOuterAngle<"u"?o.pannerAttr.coneOuterAngle:n._coneOuterAngle,coneOuterGain:typeof o.pannerAttr.coneOuterGain<"u"?o.pannerAttr.coneOuterGain:n._coneOuterGain,distanceModel:typeof o.pannerAttr.distanceModel<"u"?o.pannerAttr.distanceModel:n._distanceModel,maxDistance:typeof o.pannerAttr.maxDistance<"u"?o.pannerAttr.maxDistance:n._maxDistance,refDistance:typeof o.pannerAttr.refDistance<"u"?o.pannerAttr.refDistance:n._refDistance,rolloffFactor:typeof o.pannerAttr.rolloffFactor<"u"?o.pannerAttr.rolloffFactor:n._rolloffFactor,panningModel:typeof o.pannerAttr.panningModel<"u"?o.pannerAttr.panningModel:n._panningModel});else return s=n._soundById(parseInt(r[0],10)),s?s._pannerAttr:n._pannerAttr;else r.length===2&&(o=r[0],i=parseInt(r[1],10));for(var l=n._getSoundIds(i),u=0;u<l.length;u++)if(s=n._soundById(l[u]),s){var c=s._pannerAttr;c={coneInnerAngle:typeof o.coneInnerAngle<"u"?o.coneInnerAngle:c.coneInnerAngle,coneOuterAngle:typeof o.coneOuterAngle<"u"?o.coneOuterAngle:c.coneOuterAngle,coneOuterGain:typeof o.coneOuterGain<"u"?o.coneOuterGain:c.coneOuterGain,distanceModel:typeof o.distanceModel<"u"?o.distanceModel:c.distanceModel,maxDistance:typeof o.maxDistance<"u"?o.maxDistance:c.maxDistance,refDistance:typeof o.refDistance<"u"?o.refDistance:c.refDistance,rolloffFactor:typeof o.rolloffFactor<"u"?o.rolloffFactor:c.rolloffFactor,panningModel:typeof o.panningModel<"u"?o.panningModel:c.panningModel};var p=s._panner;p||(s._pos||(s._pos=n._pos||[0,0,-.5]),t(s,"spatial"),p=s._panner),p.coneInnerAngle=c.coneInnerAngle,p.coneOuterAngle=c.coneOuterAngle,p.coneOuterGain=c.coneOuterGain,p.distanceModel=c.distanceModel,p.maxDistance=c.maxDistance,p.refDistance=c.refDistance,p.rolloffFactor=c.rolloffFactor,p.panningModel=c.panningModel}return n},Sound.prototype.init=function(n){return function(){var r=this,o=r._parent;r._orientation=o._orientation,r._stereo=o._stereo,r._pos=o._pos,r._pannerAttr=o._pannerAttr,n.call(this),r._stereo?o.stereo(r._stereo):r._pos&&o.pos(r._pos[0],r._pos[1],r._pos[2],r._id)}}(Sound.prototype.init),Sound.prototype.reset=function(n){return function(){var r=this,o=r._parent;return r._orientation=o._orientation,r._stereo=o._stereo,r._pos=o._pos,r._pannerAttr=o._pannerAttr,r._stereo?o.stereo(r._stereo):r._pos?o.pos(r._pos[0],r._pos[1],r._pos[2],r._id):r._panner&&(r._panner.disconnect(0),r._panner=void 0,o._refreshBuffer(r)),n.call(this)}}(Sound.prototype.reset);var t=function(n,r){r=r||"spatial",r==="spatial"?(n._panner=Howler.ctx.createPanner(),n._panner.coneInnerAngle=n._pannerAttr.coneInnerAngle,n._panner.coneOuterAngle=n._pannerAttr.coneOuterAngle,n._panner.coneOuterGain=n._pannerAttr.coneOuterGain,n._panner.distanceModel=n._pannerAttr.distanceModel,n._panner.maxDistance=n._pannerAttr.maxDistance,n._panner.refDistance=n._pannerAttr.refDistance,n._panner.rolloffFactor=n._pannerAttr.rolloffFactor,n._panner.panningModel=n._pannerAttr.panningModel,typeof n._panner.positionX<"u"?(n._panner.positionX.setValueAtTime(n._pos[0],Howler.ctx.currentTime),n._panner.positionY.setValueAtTime(n._pos[1],Howler.ctx.currentTime),n._panner.positionZ.setValueAtTime(n._pos[2],Howler.ctx.currentTime)):n._panner.setPosition(n._pos[0],n._pos[1],n._pos[2]),typeof n._panner.orientationX<"u"?(n._panner.orientationX.setValueAtTime(n._orientation[0],Howler.ctx.currentTime),n._panner.orientationY.setValueAtTime(n._orientation[1],Howler.ctx.currentTime),n._panner.orientationZ.setValueAtTime(n._orientation[2],Howler.ctx.currentTime)):n._panner.setOrientation(n._orientation[0],n._orientation[1],n._orientation[2])):(n._panner=Howler.ctx.createStereoPanner(),n._panner.pan.setValueAtTime(n._stereo,Howler.ctx.currentTime)),n._panner.connect(n._node),n._paused||n._parent.pause(n._id,!0).play(n._id,!0)}})()})(rr);function cn(e){return new Promise((t,n)=>{setTimeout(t,e)})}const Fh=e=>e.reduce((t,n)=>({...t,[n]:n}),{}),Bh=e=>e!==null&&typeof e=="object"&&typeof e.then=="function"&&typeof e.catch=="function",Uh=["music","ambiant","sound"],Xd=Fh(Uh),Yt=Ot("audio",{state:()=>{const e=new Map;for(const t in Xd)e.set(t,{channels:[],options:{volume:1}});return{modes:e,masterVolume:1}},actions:{stopAll(){this.modes.forEach(e=>{e.channels.forEach((t,n)=>{t&&(this.actuallyStopChannel(t),e.channels[n]=null)})})},async stopChannel(e,t){const n=this.getAudioChannel(e,t);if(!n)return;const{fadeOutTime:r}=ga(n.audio);if(this.setAudioChannel(e,t,null),xn().options.musicFadeOutTime){const o=Mn(n.audio);o&&o.fade(o.volume(n.howlerId),0,r,n.howlerId),await cn(r)}this.actuallyStopChannel(n)},async pauseChannel(e,t){const n=this.getAudioChannel(e,t);if(!n)return;const r=Mn(n.audio);if(!r){Te(`Could not find audio ${n.audio}`);return}r.pause(n.howlerId)},async playChannel(e,t,n){rr.Howler.ctx.state==="suspended"&&(console.warn("Audio context is suspended :o"),rr.Howler.ctx.resume());const r=this.getAudioChannel(e,n);if(e==="sound")return this.actuallyPlayChannel(e,n,t);r&&r.audio!==t?await this.changeChannel(e,t,n):r&&r.audio===t?await this.resumeChannel(e,n):await this.actuallyPlayChannel(e,n,t)},async resumeChannel(e,t){const n=this.getAudioChannel(e,t);if(!n)return;const r=Mn(n.audio);if(!r){Te(`Could not find audio ${n.audio}`);return}r.play(n.howlerId)},async changeChannel(e,t,n){this.getAudioChannel(e,n)&&e!=="sound"&&await this.stopChannel(e,n),await this.actuallyPlayChannel(e,n,t)},actuallyStopChannel(e){G_(e.audio,e.howlerId)},getAudioChannel(e,t){return this.modes.get(e).channels[t]||null},setAudioChannel(e,t,n){this.modes.get(e).channels[t]=n},async actuallyPlayChannel(e,t,n){const r=Mn(n);if(!r){Te(`Could not find audio ${n}`);return}const{fadeInTime:o,fadeInDelay:i}=ga(n),s=this.audioVolume(e,n);if(e!=="sound"){const l=r.play();r.volume(0,l),r.pause(l),this.setAudioChannel(e,t,{audio:n,howlerId:l}),await cn(i);const u=this.getAudioChannel(e,t);u!==null&&u.audio===n&&(r.play(l),r.fade(0,s,o,l))}else if(e==="sound"){const l=r.play();r.volume(s,l),this.setAudioChannel(e,t,{audio:n,howlerId:l})}},reloadAudio(e){for(const t in e.modes){if(t==="sound")continue;const n=t;this.modes.get(n).options=ze(e.modes[n].options);for(const r in e.modes[n].channels){const o=e.modes[n].channels[r];o&&o.audio&&this.actuallyPlayChannel(n,Number(r),o.audio)}}},stopSound(e){const t=Mn(e);t&&t.stop()},generateSaveData(){const e={};for(const t in Xd){const n=this.modes.get(t);e[t]={options:ze(n.options),channels:ze(n.channels).map(r=>r?{audio:r.audio}:{audio:null})}}return{modes:e,masterVolume:this.masterVolume}},loadSaveData(e){this.masterVolume=e.masterVolume},reset(){this.stopAll()},setModeVolume(e,t){const n=this.modes.get(e);n.options.volume=t;for(const r in n.channels){const o=n.channels[r];if(o){const i=Mn(o.audio);i&&i.volume(this.modeVolume(e),o.howlerId)}}},setMasterVolume(e){this.masterVolume=e,rr.Howler.volume(e)},modeVolume(e){return this.masterVolume*this.modes.get(e).options.volume},audioVolume(e,t){var n;return this.modeVolume(e)*(((n=rv(t))==null?void 0:n.volume)??1)}}}),qh={};rr.Howler.volume(.5);let Gl={};async function H_(e){qn.log("Loading audio");const t=[];rr.Howler.volume(e.options.volume);for(const n in e.files){const r=e.files[n];r.src||(r.src=r.path,r.path||console.error(`Audio config for ${n} doesn't have any \`src\` value to find the file`),console.warn("Using `path` for audio and musics is deprecated. Please replace `path` with `src` in your config file!")),t.push(K_(n,e.files[n]))}return e.audioTriggers&&(Gl=e.audioTriggers),Promise.all(t)}function ms(e){Gl[e]&&Yt().playChannel("sound",Gl[e],0)}async function K_(e,t){return new Promise((n,r)=>{const o=new rr.Howl({...t,src:Zt(t.src)});o.load(),qh[e]=o,n()})}function G_(e,t){const n=Mn(e);if(!n){ys(`Could not find music ${e}`);return}n.stop(t)}function Mn(e){return qh[e]}function W_(e){const t=Mn(e),{fadeInTime:n}=ga(e),r=t.play(),o=Yt().audioVolume("music",e);return t.fade(0,o,n,r),r}async function z_(e,t){const n=Mn(e),{fadeOutTime:r}=ga(e);n.fade(n.volume(t),0,r,t),await cn(r),n.stop(t)}function Q_(e,t){return e-t*li().options.extraPointsPerLevel}function Vh(e,t){const{options:n}=li();let r=e;n.showDifficultyWithoutModifiers||(r=Q_(e,t));const o=li().options;let i=!1,s=0,l=o.difficultyText[0][1];for(;!i;)o.difficultyText.length>s&&r>=o.difficultyText[s][0]?l=o.difficultyText[s][1]:i=!0,s++;let u="";return n.showDifficultyText&&n.showDifficultyNumber?u=`${l} (${r})`:n.showDifficultyText?u=l:n.showDifficultyNumber&&(u=r.toString()),u}function J_({skill:e,skillCheckId:t,value:n}){const r=Lt(),o=r.getSkillCheck(t),i=Yu(e),s=r.skills[e].level,l=Vh(n,s);let u=!0,c=`<span class='skill-check'>[<span class='skill-check-name'>${i.name}</span> - `;return o.happened?o.succeeded?c="":(u=!1,c+=` <span class='skill-check-difficulty'>${l}</span> - <span class='skill-check-failed'>FAILED</span>]</span>`):c+=` <span class='skill-check-difficulty'>${l}</span>]</span>`,{difficultyText:c,allowed:u}}function Y_(e,t){const n=Lt(),r=Yu(t.skill),o=Vh(t.difficulty,n.skills[t.skill].level);return`<span class='passive-skill-check skill-check'>[<span class='skill-check-name'>${r.name}</span> - <span class='skill-check-difficulty'>${o}</span> - ${e?'<span class="skill-check-success">Success</span>':'<span class="skill-check-failed">Failure</span>'}]</span>`}function X_(e){const{options:t}=li(),n=Z_(t,e),r=Lt().skills[e].level*t.extraPointsPerLevel;let o=n.reduce((i,s)=>i+s.unmodified,r);return t.finalRollIsHighest?(o=n.reduce((i,s)=>s.modified>i?s.modified:i,0),qn.log(`[SKILL CHECK] Keeping only highest roll: ${o}`)):t.finalRollIsLowest&&(o=n.reduce((i,s)=>s.modified<i?s.modified:i,n[0].modified),qn.log(`[SKILL CHECK] Keeping only lowest roll: ${o}`)),{roll:o,rolls:n}}function Z_(e,t){const n=Lt().skills[t],r=n.level*e.extraPointsPerLevel;let{diceRange:o,diceCount:i}=e;e.extraDicePerLevel&&(i+=e.extraDicePerLevel*n.level);const s=[];for(let l=0;l<i;l++){const u=eT(o),c=u+r;qn.log(`[SKILL CHECK] Roll ${l+1}/${i}: ${c}. (Base roll: ${u}, modifier: ${r} - Skill level: ${n.level})`),s.push({unmodified:u,modified:c})}return s}function eT(e){return Math.floor(Math.random()*e[1])+e[0]}function tT(e){const{skills:t}=kr(),{roll:n,rolls:r}=X_(e.skill),o=t[e.skill];let i=!1;if(typeof e.winsNeeded=="number"){const s=r.reduce((l,u)=>(Zd(u.modified,e.difficulty)&&l++,l),0);s>=e.winsNeeded&&(i=!0),qn.log(`[SKILL CHECK ${o.name}] - Dice pool mode. ${e.winsNeeded} wins needed. Got ${s} successes.
      (${e.id} - ${s}/${e.winsNeeded} - rolls: ${JSON.stringify(r.map(l=>l.modified))})`)}else i=Zd(n,e.difficulty),qn.log(`[SKILL CHECK ${o.name}]: ${i?"✅":"❌"}`,`(${e.id}) - ${n}/${e.difficulty}`);return ms(i?"onSkillCheckSuccess":"onSkillCheckFailure"),i}function Zd(e,t){const{options:n}=li();let r=e>=t;return n.successOnRollsBelowThreshold&&(r=e<=t),n.failOnRollsEqualToThreshold&&e===t&&(r=!1),r}var f={};(function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.Type=e.JsonType=e.JavaScriptTypeBuilder=e.JsonTypeBuilder=e.TypeBuilder=e.TypeBuilderError=e.TransformEncodeBuilder=e.TransformDecodeBuilder=e.TemplateLiteralDslParser=e.TemplateLiteralGenerator=e.TemplateLiteralGeneratorError=e.TemplateLiteralFinite=e.TemplateLiteralFiniteError=e.TemplateLiteralParser=e.TemplateLiteralParserError=e.TemplateLiteralResolver=e.TemplateLiteralPattern=e.TemplateLiteralPatternError=e.UnionResolver=e.KeyArrayResolver=e.KeyArrayResolverError=e.KeyResolver=e.ObjectMap=e.Intrinsic=e.IndexedAccessor=e.TypeClone=e.TypeExtends=e.TypeExtendsResult=e.TypeExtendsError=e.ExtendsUndefined=e.TypeGuard=e.TypeGuardUnknownTypeError=e.ValueGuard=e.FormatRegistry=e.TypeBoxError=e.TypeRegistry=e.PatternStringExact=e.PatternNumberExact=e.PatternBooleanExact=e.PatternString=e.PatternNumber=e.PatternBoolean=e.Kind=e.Hint=e.Optional=e.Readonly=e.Transform=void 0,e.Transform=Symbol.for("TypeBox.Transform"),e.Readonly=Symbol.for("TypeBox.Readonly"),e.Optional=Symbol.for("TypeBox.Optional"),e.Hint=Symbol.for("TypeBox.Hint"),e.Kind=Symbol.for("TypeBox.Kind"),e.PatternBoolean="(true|false)",e.PatternNumber="(0|[1-9][0-9]*)",e.PatternString="(.*)",e.PatternBooleanExact=`^${e.PatternBoolean}$`,e.PatternNumberExact=`^${e.PatternNumber}$`,e.PatternStringExact=`^${e.PatternString}$`;var t;(function(D){const v=new Map;function A(){return new Map(v)}D.Entries=A;function $(){return v.clear()}D.Clear=$;function b(Z){return v.delete(Z)}D.Delete=b;function w(Z){return v.has(Z)}D.Has=w;function I(Z,he){v.set(Z,he)}D.Set=I;function G(Z){return v.get(Z)}D.Get=G})(t||(e.TypeRegistry=t={}));class n extends Error{constructor(v){super(v)}}e.TypeBoxError=n;var r;(function(D){const v=new Map;function A(){return new Map(v)}D.Entries=A;function $(){return v.clear()}D.Clear=$;function b(Z){return v.delete(Z)}D.Delete=b;function w(Z){return v.has(Z)}D.Has=w;function I(Z,he){v.set(Z,he)}D.Set=I;function G(Z){return v.get(Z)}D.Get=G})(r||(e.FormatRegistry=r={}));var o;(function(D){function v(me){return Array.isArray(me)}D.IsArray=v;function A(me){return typeof me=="bigint"}D.IsBigInt=A;function $(me){return typeof me=="boolean"}D.IsBoolean=$;function b(me){return me instanceof globalThis.Date}D.IsDate=b;function w(me){return me===null}D.IsNull=w;function I(me){return typeof me=="number"}D.IsNumber=I;function G(me){return typeof me=="object"&&me!==null}D.IsObject=G;function Z(me){return typeof me=="string"}D.IsString=Z;function he(me){return me instanceof globalThis.Uint8Array}D.IsUint8Array=he;function le(me){return me===void 0}D.IsUndefined=le})(o||(e.ValueGuard=o={}));class i extends n{}e.TypeGuardUnknownTypeError=i;var s;(function(D){function v(P){try{return new RegExp(P),!0}catch{return!1}}function A(P){if(!o.IsString(P))return!1;for(let x=0;x<P.length;x++){const j=P.charCodeAt(x);if(j>=7&&j<=13||j===27||j===127)return!1}return!0}function $(P){return I(P)||Pt(P)}function b(P){return o.IsUndefined(P)||o.IsBigInt(P)}function w(P){return o.IsUndefined(P)||o.IsNumber(P)}function I(P){return o.IsUndefined(P)||o.IsBoolean(P)}function G(P){return o.IsUndefined(P)||o.IsString(P)}function Z(P){return o.IsUndefined(P)||o.IsString(P)&&A(P)&&v(P)}function he(P){return o.IsUndefined(P)||o.IsString(P)&&A(P)}function le(P){return o.IsUndefined(P)||Pt(P)}function me(P){return oe(P,"Any")&&G(P.$id)}D.TAny=me;function Fe(P){return oe(P,"Array")&&P.type==="array"&&G(P.$id)&&Pt(P.items)&&w(P.minItems)&&w(P.maxItems)&&I(P.uniqueItems)&&le(P.contains)&&w(P.minContains)&&w(P.maxContains)}D.TArray=Fe;function _(P){return oe(P,"AsyncIterator")&&P.type==="AsyncIterator"&&G(P.$id)&&Pt(P.items)}D.TAsyncIterator=_;function O(P){return oe(P,"BigInt")&&P.type==="bigint"&&G(P.$id)&&b(P.exclusiveMaximum)&&b(P.exclusiveMinimum)&&b(P.maximum)&&b(P.minimum)&&b(P.multipleOf)}D.TBigInt=O;function V(P){return oe(P,"Boolean")&&P.type==="boolean"&&G(P.$id)}D.TBoolean=V;function J(P){return oe(P,"Constructor")&&P.type==="Constructor"&&G(P.$id)&&o.IsArray(P.parameters)&&P.parameters.every(x=>Pt(x))&&Pt(P.returns)}D.TConstructor=J;function X(P){return oe(P,"Date")&&P.type==="Date"&&G(P.$id)&&w(P.exclusiveMaximumTimestamp)&&w(P.exclusiveMinimumTimestamp)&&w(P.maximumTimestamp)&&w(P.minimumTimestamp)&&w(P.multipleOfTimestamp)}D.TDate=X;function ne(P){return oe(P,"Function")&&P.type==="Function"&&G(P.$id)&&o.IsArray(P.parameters)&&P.parameters.every(x=>Pt(x))&&Pt(P.returns)}D.TFunction=ne;function de(P){return oe(P,"Integer")&&P.type==="integer"&&G(P.$id)&&w(P.exclusiveMaximum)&&w(P.exclusiveMinimum)&&w(P.maximum)&&w(P.minimum)&&w(P.multipleOf)}D.TInteger=de;function fe(P){return oe(P,"Intersect")&&!(o.IsString(P.type)&&P.type!=="object")&&o.IsArray(P.allOf)&&P.allOf.every(x=>Pt(x)&&!no(x))&&G(P.type)&&(I(P.unevaluatedProperties)||le(P.unevaluatedProperties))&&G(P.$id)}D.TIntersect=fe;function pe(P){return oe(P,"Iterator")&&P.type==="Iterator"&&G(P.$id)&&Pt(P.items)}D.TIterator=pe;function oe(P,x){return U(P)&&P[e.Kind]===x}D.TKindOf=oe;function U(P){return o.IsObject(P)&&e.Kind in P&&o.IsString(P[e.Kind])}D.TKind=U;function K(P){return ge(P)&&o.IsString(P.const)}D.TLiteralString=K;function re(P){return ge(P)&&o.IsNumber(P.const)}D.TLiteralNumber=re;function ye(P){return ge(P)&&o.IsBoolean(P.const)}D.TLiteralBoolean=ye;function ge(P){return oe(P,"Literal")&&G(P.$id)&&(o.IsBoolean(P.const)||o.IsNumber(P.const)||o.IsString(P.const))}D.TLiteral=ge;function Ce(P){return oe(P,"Never")&&o.IsObject(P.not)&&Object.getOwnPropertyNames(P.not).length===0}D.TNever=Ce;function we(P){return oe(P,"Not")&&Pt(P.not)}D.TNot=we;function tt(P){return oe(P,"Null")&&P.type==="null"&&G(P.$id)}D.TNull=tt;function ct(P){return oe(P,"Number")&&P.type==="number"&&G(P.$id)&&w(P.exclusiveMaximum)&&w(P.exclusiveMinimum)&&w(P.maximum)&&w(P.minimum)&&w(P.multipleOf)}D.TNumber=ct;function _t(P){return oe(P,"Object")&&P.type==="object"&&G(P.$id)&&o.IsObject(P.properties)&&$(P.additionalProperties)&&w(P.minProperties)&&w(P.maxProperties)&&Object.entries(P.properties).every(([x,j])=>A(x)&&Pt(j))}D.TObject=_t;function Tt(P){return oe(P,"Promise")&&P.type==="Promise"&&G(P.$id)&&Pt(P.item)}D.TPromise=Tt;function mn(P){return oe(P,"Record")&&P.type==="object"&&G(P.$id)&&$(P.additionalProperties)&&o.IsObject(P.patternProperties)&&(x=>{const j=Object.getOwnPropertyNames(x.patternProperties);return j.length===1&&v(j[0])&&o.IsObject(x.patternProperties)&&Pt(x.patternProperties[j[0]])})(P)}D.TRecord=mn;function Ir(P){return o.IsObject(P)&&e.Hint in P&&P[e.Hint]==="Recursive"}D.TRecursive=Ir;function At(P){return oe(P,"Ref")&&G(P.$id)&&o.IsString(P.$ref)}D.TRef=At;function vt(P){return oe(P,"String")&&P.type==="string"&&G(P.$id)&&w(P.minLength)&&w(P.maxLength)&&Z(P.pattern)&&he(P.format)}D.TString=vt;function lr(P){return oe(P,"Symbol")&&P.type==="symbol"&&G(P.$id)}D.TSymbol=lr;function cr(P){return oe(P,"TemplateLiteral")&&P.type==="string"&&o.IsString(P.pattern)&&P.pattern[0]==="^"&&P.pattern[P.pattern.length-1]==="$"}D.TTemplateLiteral=cr;function Eo(P){return oe(P,"This")&&G(P.$id)&&o.IsString(P.$ref)}D.TThis=Eo;function no(P){return o.IsObject(P)&&e.Transform in P}D.TTransform=no;function It(P){return oe(P,"Tuple")&&P.type==="array"&&G(P.$id)&&o.IsNumber(P.minItems)&&o.IsNumber(P.maxItems)&&P.minItems===P.maxItems&&(o.IsUndefined(P.items)&&o.IsUndefined(P.additionalItems)&&P.minItems===0||o.IsArray(P.items)&&P.items.every(x=>Pt(x)))}D.TTuple=It;function No(P){return oe(P,"Undefined")&&P.type==="undefined"&&G(P.$id)}D.TUndefined=No;function Kn(P){return ur(P)&&P.anyOf.every(x=>K(x)||re(x))}D.TUnionLiteral=Kn;function ur(P){return oe(P,"Union")&&G(P.$id)&&o.IsObject(P)&&o.IsArray(P.anyOf)&&P.anyOf.every(x=>Pt(x))}D.TUnion=ur;function dr(P){return oe(P,"Uint8Array")&&P.type==="Uint8Array"&&G(P.$id)&&w(P.minByteLength)&&w(P.maxByteLength)}D.TUint8Array=dr;function qt(P){return oe(P,"Unknown")&&G(P.$id)}D.TUnknown=qt;function Pr(P){return oe(P,"Unsafe")}D.TUnsafe=Pr;function jr(P){return oe(P,"Void")&&P.type==="void"&&G(P.$id)}D.TVoid=jr;function Ts(P){return o.IsObject(P)&&P[e.Readonly]==="Readonly"}D.TReadonly=Ts;function Mo(P){return o.IsObject(P)&&P[e.Optional]==="Optional"}D.TOptional=Mo;function Pt(P){return o.IsObject(P)&&(me(P)||Fe(P)||V(P)||O(P)||_(P)||J(P)||X(P)||ne(P)||de(P)||fe(P)||pe(P)||ge(P)||Ce(P)||we(P)||tt(P)||ct(P)||_t(P)||Tt(P)||mn(P)||At(P)||vt(P)||lr(P)||cr(P)||Eo(P)||It(P)||No(P)||ur(P)||dr(P)||qt(P)||Pr(P)||jr(P)||U(P)&&t.Has(P[e.Kind]))}D.TSchema=Pt})(s||(e.TypeGuard=s={}));var l;(function(D){function v(A){return A[e.Kind]==="Intersect"?A.allOf.every($=>v($)):A[e.Kind]==="Union"?A.anyOf.some($=>v($)):A[e.Kind]==="Undefined"?!0:A[e.Kind]==="Not"?!v(A.not):!1}D.Check=v})(l||(e.ExtendsUndefined=l={}));class u extends n{}e.TypeExtendsError=u;var c;(function(D){D[D.Union=0]="Union",D[D.True=1]="True",D[D.False=2]="False"})(c||(e.TypeExtendsResult=c={}));var p;(function(D){function v(S){return S===c.False?S:c.True}function A(S){throw new u(S)}function $(S){return s.TNever(S)||s.TIntersect(S)||s.TUnion(S)||s.TUnknown(S)||s.TAny(S)}function b(S,k){return s.TNever(k)?oe():s.TIntersect(k)?ne(S,k):s.TUnion(k)?ie(S,k):s.TUnknown(k)?Ie():s.TAny(k)?w():A("StructuralRight")}function w(S,k){return c.True}function I(S,k){return s.TIntersect(k)?ne(S,k):s.TUnion(k)&&k.anyOf.some(Me=>s.TAny(Me)||s.TUnknown(Me))?c.True:s.TUnion(k)?c.Union:s.TUnknown(k)||s.TAny(k)?c.True:c.Union}function G(S,k){return s.TUnknown(S)?c.False:s.TAny(S)?c.Union:s.TNever(S)?c.True:c.False}function Z(S,k){return s.TObject(k)&&cr(k)?c.True:$(k)?b(S,k):s.TArray(k)?v($e(S.items,k.items)):c.False}function he(S,k){return $(k)?b(S,k):s.TAsyncIterator(k)?v($e(S.items,k.items)):c.False}function le(S,k){return $(k)?b(S,k):s.TObject(k)?It(S,k):s.TRecord(k)?qt(S,k):s.TBigInt(k)?c.True:c.False}function me(S,k){return s.TLiteral(S)&&o.IsBoolean(S.const)||s.TBoolean(S)?c.True:c.False}function Fe(S,k){return $(k)?b(S,k):s.TObject(k)?It(S,k):s.TRecord(k)?qt(S,k):s.TBoolean(k)?c.True:c.False}function _(S,k){return $(k)?b(S,k):s.TObject(k)?It(S,k):s.TConstructor(k)?S.parameters.length>k.parameters.length?c.False:S.parameters.every((Me,Ze)=>v($e(k.parameters[Ze],Me))===c.True)?v($e(S.returns,k.returns)):c.False:c.False}function O(S,k){return $(k)?b(S,k):s.TObject(k)?It(S,k):s.TRecord(k)?qt(S,k):s.TDate(k)?c.True:c.False}function V(S,k){return $(k)?b(S,k):s.TObject(k)?It(S,k):s.TFunction(k)?S.parameters.length>k.parameters.length?c.False:S.parameters.every((Me,Ze)=>v($e(k.parameters[Ze],Me))===c.True)?v($e(S.returns,k.returns)):c.False:c.False}function J(S,k){return s.TLiteral(S)&&o.IsNumber(S.const)||s.TNumber(S)||s.TInteger(S)?c.True:c.False}function X(S,k){return s.TInteger(k)||s.TNumber(k)?c.True:$(k)?b(S,k):s.TObject(k)?It(S,k):s.TRecord(k)?qt(S,k):c.False}function ne(S,k){return k.allOf.every(Me=>$e(S,Me)===c.True)?c.True:c.False}function de(S,k){return S.allOf.some(Me=>$e(Me,k)===c.True)?c.True:c.False}function fe(S,k){return $(k)?b(S,k):s.TIterator(k)?v($e(S.items,k.items)):c.False}function pe(S,k){return s.TLiteral(k)&&k.const===S.const?c.True:$(k)?b(S,k):s.TObject(k)?It(S,k):s.TRecord(k)?qt(S,k):s.TString(k)?jr(S):s.TNumber(k)?ge(S):s.TInteger(k)?J(S):s.TBoolean(k)?me(S):c.False}function oe(S,k){return c.False}function U(S,k){return c.True}function K(S){let[k,Me]=[S,0];for(;s.TNot(k);)k=k.not,Me+=1;return Me%2===0?k:e.Type.Unknown()}function re(S,k){return s.TNot(S)?$e(K(S),k):s.TNot(k)?$e(S,K(k)):A("Invalid fallthrough for Not")}function ye(S,k){return $(k)?b(S,k):s.TObject(k)?It(S,k):s.TRecord(k)?qt(S,k):s.TNull(k)?c.True:c.False}function ge(S,k){return s.TLiteralNumber(S)||s.TNumber(S)||s.TInteger(S)?c.True:c.False}function Ce(S,k){return $(k)?b(S,k):s.TObject(k)?It(S,k):s.TRecord(k)?qt(S,k):s.TInteger(k)||s.TNumber(k)?c.True:c.False}function we(S,k){return Object.getOwnPropertyNames(S.properties).length===k}function tt(S){return cr(S)}function ct(S){return we(S,0)||we(S,1)&&"description"in S.properties&&s.TUnion(S.properties.description)&&S.properties.description.anyOf.length===2&&(s.TString(S.properties.description.anyOf[0])&&s.TUndefined(S.properties.description.anyOf[1])||s.TString(S.properties.description.anyOf[1])&&s.TUndefined(S.properties.description.anyOf[0]))}function _t(S){return we(S,0)}function Tt(S){return we(S,0)}function mn(S){return we(S,0)}function Ir(S){return we(S,0)}function At(S){return cr(S)}function vt(S){const k=e.Type.Number();return we(S,0)||we(S,1)&&"length"in S.properties&&v($e(S.properties.length,k))===c.True}function lr(S){return we(S,0)}function cr(S){const k=e.Type.Number();return we(S,0)||we(S,1)&&"length"in S.properties&&v($e(S.properties.length,k))===c.True}function Eo(S){const k=e.Type.Function([e.Type.Any()],e.Type.Any());return we(S,0)||we(S,1)&&"then"in S.properties&&v($e(S.properties.then,k))===c.True}function no(S,k){return $e(S,k)===c.False||s.TOptional(S)&&!s.TOptional(k)?c.False:c.True}function It(S,k){return s.TUnknown(S)?c.False:s.TAny(S)?c.Union:s.TNever(S)||s.TLiteralString(S)&&tt(k)||s.TLiteralNumber(S)&&_t(k)||s.TLiteralBoolean(S)&&Tt(k)||s.TSymbol(S)&&ct(k)||s.TBigInt(S)&&mn(k)||s.TString(S)&&tt(k)||s.TSymbol(S)&&ct(k)||s.TNumber(S)&&_t(k)||s.TInteger(S)&&_t(k)||s.TBoolean(S)&&Tt(k)||s.TUint8Array(S)&&At(k)||s.TDate(S)&&Ir(k)||s.TConstructor(S)&&lr(k)||s.TFunction(S)&&vt(k)?c.True:s.TRecord(S)&&s.TString(ur(S))?k[e.Hint]==="Record"?c.True:c.False:s.TRecord(S)&&s.TNumber(ur(S))&&we(k,0)?c.True:c.False}function No(S,k){return $(k)?b(S,k):s.TRecord(k)?qt(S,k):s.TObject(k)?(()=>{for(const Me of Object.getOwnPropertyNames(k.properties)){if(!(Me in S.properties)&&!s.TOptional(k.properties[Me]))return c.False;if(s.TOptional(k.properties[Me]))return c.True;if(no(S.properties[Me],k.properties[Me])===c.False)return c.False}return c.True})():c.False}function Kn(S,k){return $(k)?b(S,k):s.TObject(k)&&Eo(k)?c.True:s.TPromise(k)?v($e(S.item,k.item)):c.False}function ur(S){return e.PatternNumberExact in S.patternProperties?e.Type.Number():e.PatternStringExact in S.patternProperties?e.Type.String():A("Unknown record key pattern")}function dr(S){return e.PatternNumberExact in S.patternProperties?S.patternProperties[e.PatternNumberExact]:e.PatternStringExact in S.patternProperties?S.patternProperties[e.PatternStringExact]:A("Unable to get record value schema")}function qt(S,k){const[Me,Ze]=[ur(k),dr(k)];return s.TLiteralString(S)&&s.TNumber(Me)&&v($e(S,Ze))===c.True?c.True:s.TUint8Array(S)&&s.TNumber(Me)||s.TString(S)&&s.TNumber(Me)||s.TArray(S)&&s.TNumber(Me)?$e(S,Ze):s.TObject(S)?(()=>{for(const dn of Object.getOwnPropertyNames(S.properties))if(no(Ze,S.properties[dn])===c.False)return c.False;return c.True})():c.False}function Pr(S,k){return $(k)?b(S,k):s.TObject(k)?It(S,k):s.TRecord(k)?$e(dr(S),dr(k)):c.False}function jr(S,k){return s.TLiteral(S)&&o.IsString(S.const)||s.TString(S)?c.True:c.False}function Ts(S,k){return $(k)?b(S,k):s.TObject(k)?It(S,k):s.TRecord(k)?qt(S,k):s.TString(k)?c.True:c.False}function Mo(S,k){return $(k)?b(S,k):s.TObject(k)?It(S,k):s.TRecord(k)?qt(S,k):s.TSymbol(k)?c.True:c.False}function Pt(S,k){return s.TTemplateLiteral(S)?$e(B.Resolve(S),k):s.TTemplateLiteral(k)?$e(S,B.Resolve(k)):A("Invalid fallthrough for TemplateLiteral")}function P(S,k){return s.TArray(k)&&S.items!==void 0&&S.items.every(Me=>$e(Me,k.items)===c.True)}function x(S,k){return s.TNever(S)?c.True:s.TUnknown(S)?c.False:s.TAny(S)?c.Union:c.False}function j(S,k){return $(k)?b(S,k):s.TObject(k)&&cr(k)||s.TArray(k)&&P(S,k)?c.True:s.TTuple(k)?o.IsUndefined(S.items)&&!o.IsUndefined(k.items)||!o.IsUndefined(S.items)&&o.IsUndefined(k.items)?c.False:o.IsUndefined(S.items)&&!o.IsUndefined(k.items)||S.items.every((Me,Ze)=>$e(Me,k.items[Ze])===c.True)?c.True:c.False:c.False}function F(S,k){return $(k)?b(S,k):s.TObject(k)?It(S,k):s.TRecord(k)?qt(S,k):s.TUint8Array(k)?c.True:c.False}function se(S,k){return $(k)?b(S,k):s.TObject(k)?It(S,k):s.TRecord(k)?qt(S,k):s.TVoid(k)?xt(S):s.TUndefined(k)?c.True:c.False}function ie(S,k){return k.anyOf.some(Me=>$e(S,Me)===c.True)?c.True:c.False}function Ne(S,k){return S.anyOf.every(Me=>$e(Me,k)===c.True)?c.True:c.False}function Ie(S,k){return c.True}function it(S,k){return s.TNever(k)?oe():s.TIntersect(k)?ne(S,k):s.TUnion(k)?ie(S,k):s.TAny(k)?w():s.TString(k)?jr(S):s.TNumber(k)?ge(S):s.TInteger(k)?J(S):s.TBoolean(k)?me(S):s.TArray(k)?G(S):s.TTuple(k)?x(S):s.TObject(k)?It(S,k):s.TUnknown(k)?c.True:c.False}function xt(S,k){return s.TUndefined(S)||s.TUndefined(S)?c.True:c.False}function ht(S,k){return s.TIntersect(k)?ne(S,k):s.TUnion(k)?ie(S,k):s.TUnknown(k)?Ie():s.TAny(k)?w():s.TObject(k)?It(S,k):s.TVoid(k)?c.True:c.False}function $e(S,k){return s.TTemplateLiteral(S)||s.TTemplateLiteral(k)?Pt(S,k):s.TNot(S)||s.TNot(k)?re(S,k):s.TAny(S)?I(S,k):s.TArray(S)?Z(S,k):s.TBigInt(S)?le(S,k):s.TBoolean(S)?Fe(S,k):s.TAsyncIterator(S)?he(S,k):s.TConstructor(S)?_(S,k):s.TDate(S)?O(S,k):s.TFunction(S)?V(S,k):s.TInteger(S)?X(S,k):s.TIntersect(S)?de(S,k):s.TIterator(S)?fe(S,k):s.TLiteral(S)?pe(S,k):s.TNever(S)?U():s.TNull(S)?ye(S,k):s.TNumber(S)?Ce(S,k):s.TObject(S)?No(S,k):s.TRecord(S)?Pr(S,k):s.TString(S)?Ts(S,k):s.TSymbol(S)?Mo(S,k):s.TTuple(S)?j(S,k):s.TPromise(S)?Kn(S,k):s.TUint8Array(S)?F(S,k):s.TUndefined(S)?se(S,k):s.TUnion(S)?Ne(S,k):s.TUnknown(S)?it(S,k):s.TVoid(S)?ht(S,k):A(`Unknown left type operand '${S[e.Kind]}'`)}function mt(S,k){return $e(S,k)}D.Extends=mt})(p||(e.TypeExtends=p={}));var a;(function(D){function v(Z){return Z.map(he=>w(he))}function A(Z){return new Date(Z.getTime())}function $(Z){return new Uint8Array(Z)}function b(Z){const he=Object.getOwnPropertyNames(Z).reduce((me,Fe)=>({...me,[Fe]:w(Z[Fe])}),{}),le=Object.getOwnPropertySymbols(Z).reduce((me,Fe)=>({...me,[Fe]:w(Z[Fe])}),{});return{...he,...le}}function w(Z){return o.IsArray(Z)?v(Z):o.IsDate(Z)?A(Z):o.IsUint8Array(Z)?$(Z):o.IsObject(Z)?b(Z):Z}function I(Z){return Z.map(he=>G(he))}D.Rest=I;function G(Z,he={}){return{...w(Z),...he}}D.Type=G})(a||(e.TypeClone=a={}));var d;(function(D){function v(_){return _.map(O=>{const{[e.Optional]:V,...J}=a.Type(O);return J})}function A(_){return _.every(O=>s.TOptional(O))}function $(_){return _.some(O=>s.TOptional(O))}function b(_){return A(_.allOf)?e.Type.Optional(e.Type.Intersect(v(_.allOf))):_}function w(_){return $(_.anyOf)?e.Type.Optional(e.Type.Union(v(_.anyOf))):_}function I(_){return _[e.Kind]==="Intersect"?b(_):_[e.Kind]==="Union"?w(_):_}function G(_,O){const V=_.allOf.reduce((J,X)=>{const ne=me(X,O);return ne[e.Kind]==="Never"?J:[...J,ne]},[]);return I(e.Type.Intersect(V))}function Z(_,O){const V=_.anyOf.map(J=>me(J,O));return I(e.Type.Union(V))}function he(_,O){const V=_.properties[O];return o.IsUndefined(V)?e.Type.Never():e.Type.Union([V])}function le(_,O){const V=_.items;if(o.IsUndefined(V))return e.Type.Never();const J=V[O];return o.IsUndefined(J)?e.Type.Never():J}function me(_,O){return _[e.Kind]==="Intersect"?G(_,O):_[e.Kind]==="Union"?Z(_,O):_[e.Kind]==="Object"?he(_,O):_[e.Kind]==="Tuple"?le(_,O):e.Type.Never()}function Fe(_,O,V={}){const J=O.map(X=>me(_,X.toString()));return I(e.Type.Union(J,V))}D.Resolve=Fe})(d||(e.IndexedAccessor=d={}));var h;(function(D){function v(le){const[me,Fe]=[le.slice(0,1),le.slice(1)];return`${me.toLowerCase()}${Fe}`}function A(le){const[me,Fe]=[le.slice(0,1),le.slice(1)];return`${me.toUpperCase()}${Fe}`}function $(le){return le.toUpperCase()}function b(le){return le.toLowerCase()}function w(le,me){const Fe=E.ParseExact(le.pattern);if(!q.Check(Fe))return{...le,pattern:I(le.pattern,me)};const _=[...ce.Generate(Fe)].map(J=>e.Type.Literal(J)),O=G(_,me),V=e.Type.Union(O);return e.Type.TemplateLiteral([V])}function I(le,me){return typeof le=="string"?me==="Uncapitalize"?v(le):me==="Capitalize"?A(le):me==="Uppercase"?$(le):me==="Lowercase"?b(le):le:le.toString()}function G(le,me){if(le.length===0)return[];const[Fe,..._]=le;return[he(Fe,me),...G(_,me)]}function Z(le,me){return s.TTemplateLiteral(le)?w(le,me):s.TUnion(le)?e.Type.Union(G(le.anyOf,me)):s.TLiteral(le)?e.Type.Literal(I(le.const,me)):le}function he(le,me){return Z(le,me)}D.Map=he})(h||(e.Intrinsic=h={}));var m;(function(D){function v(I,G){return e.Type.Intersect(I.allOf.map(Z=>b(Z,G)),{...I})}function A(I,G){return e.Type.Union(I.anyOf.map(Z=>b(Z,G)),{...I})}function $(I,G){return G(I)}function b(I,G){return I[e.Kind]==="Intersect"?v(I,G):I[e.Kind]==="Union"?A(I,G):I[e.Kind]==="Object"?$(I,G):I}function w(I,G,Z){return{...b(a.Type(I),G),...Z}}D.Map=w})(m||(e.ObjectMap=m={}));var y;(function(D){function v(he){return he[0]==="^"&&he[he.length-1]==="$"?he.slice(1,he.length-1):he}function A(he,le){return he.allOf.reduce((me,Fe)=>[...me,...I(Fe,le)],[])}function $(he,le){const me=he.anyOf.map(Fe=>I(Fe,le));return[...me.reduce((Fe,_)=>_.map(O=>me.every(V=>V.includes(O))?Fe.add(O):Fe)[0],new Set)]}function b(he,le){return Object.getOwnPropertyNames(he.properties)}function w(he,le){return le.includePatterns?Object.getOwnPropertyNames(he.patternProperties):[]}function I(he,le){return s.TIntersect(he)?A(he,le):s.TUnion(he)?$(he,le):s.TObject(he)?b(he):s.TRecord(he)?w(he,le):[]}function G(he,le){return[...new Set(I(he,le))]}D.ResolveKeys=G;function Z(he){return`^(${G(he,{includePatterns:!0}).map(le=>`(${v(le)})`).join("|")})$`}D.ResolvePattern=Z})(y||(e.KeyResolver=y={}));class T extends n{}e.KeyArrayResolverError=T;var g;(function(D){function v(A){return Array.isArray(A)?A:s.TUnionLiteral(A)?A.anyOf.map($=>$.const.toString()):s.TLiteral(A)?[A.const]:s.TTemplateLiteral(A)?(()=>{const $=E.ParseExact(A.pattern);if(!q.Check($))throw new T("Cannot resolve keys from infinite template expression");return[...ce.Generate($)]})():[]}D.Resolve=v})(g||(e.KeyArrayResolver=g={}));var C;(function(D){function*v($){for(const b of $.anyOf)b[e.Kind]==="Union"?yield*v(b):yield b}function A($){return e.Type.Union([...v($)],{...$})}D.Resolve=A})(C||(e.UnionResolver=C={}));class N extends n{}e.TemplateLiteralPatternError=N;var L;(function(D){function v(w){throw new N(w)}function A(w){return w.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")}function $(w,I){return s.TTemplateLiteral(w)?w.pattern.slice(1,w.pattern.length-1):s.TUnion(w)?`(${w.anyOf.map(G=>$(G,I)).join("|")})`:s.TNumber(w)?`${I}${e.PatternNumber}`:s.TInteger(w)?`${I}${e.PatternNumber}`:s.TBigInt(w)?`${I}${e.PatternNumber}`:s.TString(w)?`${I}${e.PatternString}`:s.TLiteral(w)?`${I}${A(w.const.toString())}`:s.TBoolean(w)?`${I}${e.PatternBoolean}`:v(`Unexpected Kind '${w[e.Kind]}'`)}function b(w){return`^${w.map(I=>$(I,"")).join("")}$`}D.Create=b})(L||(e.TemplateLiteralPattern=L={}));var B;(function(D){function v(A){const $=E.ParseExact(A.pattern);if(!q.Check($))return e.Type.String();const b=[...ce.Generate($)].map(w=>e.Type.Literal(w));return e.Type.Union(b)}D.Resolve=v})(B||(e.TemplateLiteralResolver=B={}));class M extends n{}e.TemplateLiteralParserError=M;var E;(function(D){function v(_,O,V){return _[O]===V&&_.charCodeAt(O-1)!==92}function A(_,O){return v(_,O,"(")}function $(_,O){return v(_,O,")")}function b(_,O){return v(_,O,"|")}function w(_){if(!(A(_,0)&&$(_,_.length-1)))return!1;let O=0;for(let V=0;V<_.length;V++)if(A(_,V)&&(O+=1),$(_,V)&&(O-=1),O===0&&V!==_.length-1)return!1;return!0}function I(_){return _.slice(1,_.length-1)}function G(_){let O=0;for(let V=0;V<_.length;V++)if(A(_,V)&&(O+=1),$(_,V)&&(O-=1),b(_,V)&&O===0)return!0;return!1}function Z(_){for(let O=0;O<_.length;O++)if(A(_,O))return!0;return!1}function he(_){let[O,V]=[0,0];const J=[];for(let ne=0;ne<_.length;ne++)if(A(_,ne)&&(O+=1),$(_,ne)&&(O-=1),b(_,ne)&&O===0){const de=_.slice(V,ne);de.length>0&&J.push(me(de)),V=ne+1}const X=_.slice(V);return X.length>0&&J.push(me(X)),J.length===0?{type:"const",const:""}:J.length===1?J[0]:{type:"or",expr:J}}function le(_){function O(X,ne){if(!A(X,ne))throw new M("TemplateLiteralParser: Index must point to open parens");let de=0;for(let fe=ne;fe<X.length;fe++)if(A(X,fe)&&(de+=1),$(X,fe)&&(de-=1),de===0)return[ne,fe];throw new M("TemplateLiteralParser: Unclosed group parens in expression")}function V(X,ne){for(let de=ne;de<X.length;de++)if(A(X,de))return[ne,de];return[ne,X.length]}const J=[];for(let X=0;X<_.length;X++)if(A(_,X)){const[ne,de]=O(_,X),fe=_.slice(ne,de+1);J.push(me(fe)),X=de}else{const[ne,de]=V(_,X),fe=_.slice(ne,de);fe.length>0&&J.push(me(fe)),X=de-1}return J.length===0?{type:"const",const:""}:J.length===1?J[0]:{type:"and",expr:J}}function me(_){return w(_)?me(I(_)):G(_)?he(_):Z(_)?le(_):{type:"const",const:_}}D.Parse=me;function Fe(_){return me(_.slice(1,_.length-1))}D.ParseExact=Fe})(E||(e.TemplateLiteralParser=E={}));class W extends n{}e.TemplateLiteralFiniteError=W;var q;(function(D){function v(I){throw new W(I)}function A(I){return I.type==="or"&&I.expr.length===2&&I.expr[0].type==="const"&&I.expr[0].const==="0"&&I.expr[1].type==="const"&&I.expr[1].const==="[1-9][0-9]*"}function $(I){return I.type==="or"&&I.expr.length===2&&I.expr[0].type==="const"&&I.expr[0].const==="true"&&I.expr[1].type==="const"&&I.expr[1].const==="false"}function b(I){return I.type==="const"&&I.const===".*"}function w(I){return $(I)?!0:A(I)||b(I)?!1:I.type==="and"?I.expr.every(G=>w(G)):I.type==="or"?I.expr.every(G=>w(G)):I.type==="const"?!0:v("Unknown expression type")}D.Check=w})(q||(e.TemplateLiteralFinite=q={}));class ue extends n{}e.TemplateLiteralGeneratorError=ue;var ce;(function(D){function*v(I){if(I.length===1)return yield*I[0];for(const G of I[0])for(const Z of v(I.slice(1)))yield`${G}${Z}`}function*A(I){return yield*v(I.expr.map(G=>[...w(G)]))}function*$(I){for(const G of I.expr)yield*w(G)}function*b(I){return yield I.const}function*w(I){return I.type==="and"?yield*A(I):I.type==="or"?yield*$(I):I.type==="const"?yield*b(I):(()=>{throw new ue("Unknown expression")})()}D.Generate=w})(ce||(e.TemplateLiteralGenerator=ce={}));var te;(function(D){function*v(w){const I=w.trim().replace(/"|'/g,"");return I==="boolean"?yield e.Type.Boolean():I==="number"?yield e.Type.Number():I==="bigint"?yield e.Type.BigInt():I==="string"?yield e.Type.String():yield(()=>{const G=I.split("|").map(Z=>e.Type.Literal(Z.trim()));return G.length===0?e.Type.Never():G.length===1?G[0]:e.Type.Union(G)})()}function*A(w){if(w[1]!=="{"){const I=e.Type.Literal("$"),G=$(w.slice(1));return yield*[I,...G]}for(let I=2;I<w.length;I++)if(w[I]==="}"){const G=v(w.slice(2,I)),Z=$(w.slice(I+1));return yield*[...G,...Z]}yield e.Type.Literal(w)}function*$(w){for(let I=0;I<w.length;I++)if(w[I]==="$"){const G=e.Type.Literal(w.slice(0,I)),Z=A(w.slice(I));return yield*[G,...Z]}yield e.Type.Literal(w)}function b(w){return[...$(w)]}D.Parse=b})(te||(e.TemplateLiteralDslParser=te={}));class Q{constructor(v){this.schema=v}Decode(v){return new ae(this.schema,v)}}e.TransformDecodeBuilder=Q;class ae{constructor(v,A){this.schema=v,this.decode=A}Encode(v){const A=a.Type(this.schema);return s.TTransform(A)?(()=>{const $={Encode:b=>A[e.Transform].Encode(v(b)),Decode:b=>this.decode(A[e.Transform].Decode(b))};return{...A,[e.Transform]:$}})():(()=>{const $={Decode:this.decode,Encode:v};return{...A,[e.Transform]:$}})()}}e.TransformEncodeBuilder=ae;let ke=0;class Ee extends n{}e.TypeBuilderError=Ee;class qe{Create(v){return v}Throw(v){throw new Ee(v)}Discard(v,A){return A.reduce(($,b)=>{const{[b]:w,...I}=$;return I},v)}Strict(v){return JSON.parse(JSON.stringify(v))}}e.TypeBuilder=qe;class He extends qe{ReadonlyOptional(v){return this.Readonly(this.Optional(v))}Readonly(v){return{...a.Type(v),[e.Readonly]:"Readonly"}}Optional(v){return{...a.Type(v),[e.Optional]:"Optional"}}Any(v={}){return this.Create({...v,[e.Kind]:"Any"})}Array(v,A={}){return this.Create({...A,[e.Kind]:"Array",type:"array",items:a.Type(v)})}Boolean(v={}){return this.Create({...v,[e.Kind]:"Boolean",type:"boolean"})}Capitalize(v,A={}){return{...h.Map(a.Type(v),"Capitalize"),...A}}Composite(v,A){const $=e.Type.Intersect(v,{}),b=y.ResolveKeys($,{includePatterns:!1}).reduce((w,I)=>({...w,[I]:e.Type.Index($,[I])}),{});return e.Type.Object(b,A)}Enum(v,A={}){if(o.IsUndefined(v))return this.Throw("Enum undefined or empty");const $=Object.getOwnPropertyNames(v).filter(w=>isNaN(w)).map(w=>v[w]),b=[...new Set($)].map(w=>e.Type.Literal(w));return this.Union(b,{...A,[e.Hint]:"Enum"})}Extends(v,A,$,b,w={}){switch(p.Extends(v,A)){case c.Union:return this.Union([a.Type($,w),a.Type(b,w)]);case c.True:return a.Type($,w);case c.False:return a.Type(b,w)}}Exclude(v,A,$={}){return s.TTemplateLiteral(v)?this.Exclude(B.Resolve(v),A,$):s.TTemplateLiteral(A)?this.Exclude(v,B.Resolve(A),$):s.TUnion(v)?(()=>{const b=v.anyOf.filter(w=>p.Extends(w,A)===c.False);return b.length===1?a.Type(b[0],$):this.Union(b,$)})():p.Extends(v,A)!==c.False?this.Never($):a.Type(v,$)}Extract(v,A,$={}){return s.TTemplateLiteral(v)?this.Extract(B.Resolve(v),A,$):s.TTemplateLiteral(A)?this.Extract(v,B.Resolve(A),$):s.TUnion(v)?(()=>{const b=v.anyOf.filter(w=>p.Extends(w,A)!==c.False);return b.length===1?a.Type(b[0],$):this.Union(b,$)})():p.Extends(v,A)!==c.False?a.Type(v,$):this.Never($)}Index(v,A,$={}){return s.TArray(v)&&s.TNumber(A)?a.Type(v.items,$):s.TTuple(v)&&s.TNumber(A)?(()=>{const b=(o.IsUndefined(v.items)?[]:v.items).map(w=>a.Type(w));return this.Union(b,$)})():(()=>{const b=g.Resolve(A),w=a.Type(v);return d.Resolve(w,b,$)})()}Integer(v={}){return this.Create({...v,[e.Kind]:"Integer",type:"integer"})}Intersect(v,A={}){if(v.length===0)return e.Type.Never();if(v.length===1)return a.Type(v[0],A);v.some(I=>s.TTransform(I))&&this.Throw("Cannot intersect transform types");const $=v.every(I=>s.TObject(I)),b=a.Rest(v),w=s.TSchema(A.unevaluatedProperties)?{unevaluatedProperties:a.Type(A.unevaluatedProperties)}:{};return A.unevaluatedProperties===!1||s.TSchema(A.unevaluatedProperties)||$?this.Create({...A,...w,[e.Kind]:"Intersect",type:"object",allOf:b}):this.Create({...A,...w,[e.Kind]:"Intersect",allOf:b})}KeyOf(v,A={}){return s.TRecord(v)?(()=>{const $=Object.getOwnPropertyNames(v.patternProperties)[0];return $===e.PatternNumberExact?this.Number(A):$===e.PatternStringExact?this.String(A):this.Throw("Unable to resolve key type from Record key pattern")})():s.TTuple(v)?(()=>{const $=(o.IsUndefined(v.items)?[]:v.items).map((b,w)=>e.Type.Literal(w.toString()));return this.Union($,A)})():s.TArray(v)?this.Number(A):(()=>{const $=y.ResolveKeys(v,{includePatterns:!1});if($.length===0)return this.Never(A);const b=$.map(w=>this.Literal(w));return this.Union(b,A)})()}Literal(v,A={}){return this.Create({...A,[e.Kind]:"Literal",const:v,type:typeof v})}Lowercase(v,A={}){return{...h.Map(a.Type(v),"Lowercase"),...A}}Never(v={}){return this.Create({...v,[e.Kind]:"Never",not:{}})}Not(v,A){return this.Create({...A,[e.Kind]:"Not",not:a.Type(v)})}Null(v={}){return this.Create({...v,[e.Kind]:"Null",type:"null"})}Number(v={}){return this.Create({...v,[e.Kind]:"Number",type:"number"})}Object(v,A={}){const $=Object.getOwnPropertyNames(v),b=$.filter(Z=>s.TOptional(v[Z])),w=$.filter(Z=>!b.includes(Z)),I=s.TSchema(A.additionalProperties)?{additionalProperties:a.Type(A.additionalProperties)}:{},G=$.reduce((Z,he)=>({...Z,[he]:a.Type(v[he])}),{});return w.length>0?this.Create({...A,...I,[e.Kind]:"Object",type:"object",properties:G,required:w}):this.Create({...A,...I,[e.Kind]:"Object",type:"object",properties:G})}Omit(v,A,$={}){const b=g.Resolve(A);return m.Map(this.Discard(a.Type(v),["$id",e.Transform]),w=>{o.IsArray(w.required)&&(w.required=w.required.filter(I=>!b.includes(I)),w.required.length===0&&delete w.required);for(const I of Object.getOwnPropertyNames(w.properties))b.includes(I)&&delete w.properties[I];return this.Create(w)},$)}Partial(v,A={}){return m.Map(this.Discard(a.Type(v),["$id",e.Transform]),$=>{const b=Object.getOwnPropertyNames($.properties).reduce((w,I)=>({...w,[I]:this.Optional($.properties[I])}),{});return this.Object(b,this.Discard($,["required"]))},A)}Pick(v,A,$={}){const b=g.Resolve(A);return m.Map(this.Discard(a.Type(v),["$id",e.Transform]),w=>{o.IsArray(w.required)&&(w.required=w.required.filter(I=>b.includes(I)),w.required.length===0&&delete w.required);for(const I of Object.getOwnPropertyNames(w.properties))b.includes(I)||delete w.properties[I];return this.Create(w)},$)}Record(v,A,$={}){return s.TTemplateLiteral(v)?(()=>{const b=E.ParseExact(v.pattern);return q.Check(b)?this.Object([...ce.Generate(b)].reduce((w,I)=>({...w,[I]:a.Type(A)}),{}),$):this.Create({...$,[e.Kind]:"Record",type:"object",patternProperties:{[v.pattern]:a.Type(A)}})})():s.TUnion(v)?(()=>{const b=C.Resolve(v);if(s.TUnionLiteral(b)){const w=b.anyOf.reduce((I,G)=>({...I,[G.const]:a.Type(A)}),{});return this.Object(w,{...$,[e.Hint]:"Record"})}else this.Throw("Record key of type union contains non-literal types")})():s.TLiteral(v)?o.IsString(v.const)||o.IsNumber(v.const)?this.Object({[v.const]:a.Type(A)},$):this.Throw("Record key of type literal is not of type string or number"):s.TInteger(v)||s.TNumber(v)?this.Create({...$,[e.Kind]:"Record",type:"object",patternProperties:{[e.PatternNumberExact]:a.Type(A)}}):s.TString(v)?(()=>{const b=o.IsUndefined(v.pattern)?e.PatternStringExact:v.pattern;return this.Create({...$,[e.Kind]:"Record",type:"object",patternProperties:{[b]:a.Type(A)}})})():this.Never()}Recursive(v,A={}){o.IsUndefined(A.$id)&&(A.$id=`T${ke++}`);const $=v({[e.Kind]:"This",$ref:`${A.$id}`});return $.$id=A.$id,this.Create({...A,[e.Hint]:"Recursive",...$})}Ref(v,A={}){return o.IsString(v)?this.Create({...A,[e.Kind]:"Ref",$ref:v}):(o.IsUndefined(v.$id)&&this.Throw("Reference target type must specify an $id"),this.Create({...A,[e.Kind]:"Ref",$ref:v.$id}))}Required(v,A={}){return m.Map(this.Discard(a.Type(v),["$id",e.Transform]),$=>{const b=Object.getOwnPropertyNames($.properties).reduce((w,I)=>({...w,[I]:this.Discard($.properties[I],[e.Optional])}),{});return this.Object(b,$)},A)}Rest(v){return s.TTuple(v)&&!o.IsUndefined(v.items)?a.Rest(v.items):s.TIntersect(v)?a.Rest(v.allOf):s.TUnion(v)?a.Rest(v.anyOf):[]}String(v={}){return this.Create({...v,[e.Kind]:"String",type:"string"})}TemplateLiteral(v,A={}){const $=o.IsString(v)?L.Create(te.Parse(v)):L.Create(v);return this.Create({...A,[e.Kind]:"TemplateLiteral",type:"string",pattern:$})}Transform(v){return new Q(v)}Tuple(v,A={}){const[$,b,w]=[!1,v.length,v.length],I=a.Rest(v),G=v.length>0?{...A,[e.Kind]:"Tuple",type:"array",items:I,additionalItems:$,minItems:b,maxItems:w}:{...A,[e.Kind]:"Tuple",type:"array",minItems:b,maxItems:w};return this.Create(G)}Uncapitalize(v,A={}){return{...h.Map(a.Type(v),"Uncapitalize"),...A}}Union(v,A={}){return s.TTemplateLiteral(v)?B.Resolve(v):(()=>{const $=v;if($.length===0)return this.Never(A);if($.length===1)return this.Create(a.Type($[0],A));const b=a.Rest($);return this.Create({...A,[e.Kind]:"Union",anyOf:b})})()}Unknown(v={}){return this.Create({...v,[e.Kind]:"Unknown"})}Unsafe(v={}){return this.Create({...v,[e.Kind]:v[e.Kind]||"Unsafe"})}Uppercase(v,A={}){return{...h.Map(a.Type(v),"Uppercase"),...A}}}e.JsonTypeBuilder=He;class pt extends He{AsyncIterator(v,A={}){return this.Create({...A,[e.Kind]:"AsyncIterator",type:"AsyncIterator",items:a.Type(v)})}Awaited(v,A={}){const $=b=>b.length>0?(()=>{const[w,...I]=b;return[this.Awaited(w),...$(I)]})():b;return s.TIntersect(v)?e.Type.Intersect($(v.allOf)):s.TUnion(v)?e.Type.Union($(v.anyOf)):s.TPromise(v)?this.Awaited(v.item):a.Type(v,A)}BigInt(v={}){return this.Create({...v,[e.Kind]:"BigInt",type:"bigint"})}ConstructorParameters(v,A={}){return this.Tuple([...v.parameters],{...A})}Constructor(v,A,$){const[b,w]=[a.Rest(v),a.Type(A)];return this.Create({...$,[e.Kind]:"Constructor",type:"Constructor",parameters:b,returns:w})}Date(v={}){return this.Create({...v,[e.Kind]:"Date",type:"Date"})}Function(v,A,$){const[b,w]=[a.Rest(v),a.Type(A)];return this.Create({...$,[e.Kind]:"Function",type:"Function",parameters:b,returns:w})}InstanceType(v,A={}){return a.Type(v.returns,A)}Iterator(v,A={}){return this.Create({...A,[e.Kind]:"Iterator",type:"Iterator",items:a.Type(v)})}Parameters(v,A={}){return this.Tuple(v.parameters,{...A})}Promise(v,A={}){return this.Create({...A,[e.Kind]:"Promise",type:"Promise",item:a.Type(v)})}RegExp(v,A={}){const $=o.IsString(v)?v:v.source;return this.Create({...A,[e.Kind]:"String",type:"string",pattern:$})}RegEx(v,A={}){return this.RegExp(v,A)}ReturnType(v,A={}){return a.Type(v.returns,A)}Symbol(v){return this.Create({...v,[e.Kind]:"Symbol",type:"symbol"})}Undefined(v={}){return this.Create({...v,[e.Kind]:"Undefined",type:"undefined"})}Uint8Array(v={}){return this.Create({...v,[e.Kind]:"Uint8Array",type:"Uint8Array"})}Void(v={}){return this.Create({...v,[e.Kind]:"Void",type:"void"})}}e.JavaScriptTypeBuilder=pt,e.JsonType=new He,e.Type=new pt})(f);const nT=f.Type.Object({prefix:f.Type.Optional(f.Type.String()),suffix:f.Type.Optional(f.Type.String()),volume:f.Type.Optional(f.Type.Number())}),ep=f.Type.Object({soundOnNewLine:f.Type.Optional(f.Type.String()),soundPerLetter:f.Type.Optional(nT)}),rT=f.Type.Object({defaultAudio:f.Type.Optional(ep),characterAudio:f.Type.Optional(f.Type.Record(f.Type.String(),ep))}),oT=f.Type.Object({src:f.Type.String(),path:f.Type.Optional(f.Type.String()),volume:f.Type.Optional(f.Type.Number()),rate:f.Type.Optional(f.Type.Number()),html5:f.Type.Optional(f.Type.Boolean()),fadeInTime:f.Type.Optional(f.Type.Number()),fadeInDelay:f.Type.Optional(f.Type.Number()),fadeOutTime:f.Type.Optional(f.Type.Number()),loop:f.Type.Optional(f.Type.Boolean())}),sT=f.Type.Record(f.Type.String(),oT),iT=f.Type.Object({volume:f.Type.Optional(f.Type.Number()),defaultMusic:f.Type.Optional(f.Type.String()),musicFadeInTime:f.Type.Optional(f.Type.Number()),musicFadeOutTime:f.Type.Optional(f.Type.Number()),musicFadeInDelay:f.Type.Optional(f.Type.Number())}),aT=f.Type.Record(f.Type.String(),f.Type.String()),Hh=f.Type.Object({files:sT,audioTriggers:aT,options:iT,dialogAudio:f.Type.Optional(rT)}),Kh={files:{},audioTriggers:{},options:{volume:1,musicFadeInTime:.5,musicFadeInDelay:.5,musicFadeOutTime:.5}},Gh=f.Type.Object({backgrounds:f.Type.Object({width:f.Type.Number(),height:f.Type.Number()}),dialogBottomPadding:f.Type.Union([f.Type.Number(),f.Type.String()]),minTextWidth:f.Type.Optional(f.Type.Number()),verticalLayoutThreshold:f.Type.Number(),defaultFontSize:f.Type.Optional(f.Type.Number()),portraits:f.Type.Object({width:f.Type.Number(),height:f.Type.Number(),offset:f.Type.Optional(f.Type.Object({landscape:f.Type.Optional(f.Type.Object({right:f.Type.Number(),bottom:f.Type.Number()})),portrait:f.Type.Optional(f.Type.Object({right:f.Type.Number(),bottom:f.Type.Number()}))}))})}),lT={backgrounds:{width:880,height:720},dialogBottomPadding:70,verticalLayoutThreshold:600,defaultFontSize:16,portraits:{width:100,height:100}},Ra=f.Type.Object({name:f.Type.String(),description:f.Type.Optional(f.Type.String())}),cT=f.Type.Intersect([Ra,f.Type.Object({type:f.Type.Literal("number"),defaultValue:f.Type.Number(),step:f.Type.Number(),minValue:f.Type.Number(),maxValue:f.Type.Number()})]),uT=f.Type.Intersect([Ra,f.Type.Object({type:f.Type.Literal("integer"),defaultValue:f.Type.Number(),step:f.Type.Number(),minValue:f.Type.Number(),maxValue:f.Type.Number()})]),dT=f.Type.Intersect([Ra,f.Type.Object({type:f.Type.Literal("boolean"),defaultValue:f.Type.Boolean()})]),pT=f.Type.Intersect([Ra,f.Type.Object({type:f.Type.Literal("string"),defaultValue:f.Type.String()})]),fT=f.Type.Union([cT,uT,dT,pT]);function hT(e){return e.type==="number"}function tp(e){return e.type==="integer"}function mT(e){return e.type==="boolean"}function yT(e){return e.type==="string"}const Wh=f.Type.Object({customSettings:f.Type.Optional(f.Type.Record(f.Type.String(),fT))});var Ur=(e=>(e[e.ERROR=3]="ERROR",e[e.WARN=2]="WARN",e[e.INFO=1]="INFO",e[e.DEBUG=0]="DEBUG",e[e.NONE=-1]="NONE",e))(Ur||{});const ra="###_--_~=:;_JUMP",Kc="###_--_~=:;_RETURN",gT="###_--_~=:;_OK",oa="###_--_~=:;_STOP";function vT(e){return e===ra||e===Kc||e===gT||e===oa}const bT="3.16.3",_T=new Date("2024-11-24T16:37:02.705Z"),np={branch:"main",commit:"d79571d582bb0e0f107e810a867e62629836ab6b"},TT=Ur.WARN,wT=400,sa=20,Fa="@empty",rp={background:Fa},kT=f.Type.Optional(f.Type.Record(f.Type.String(),f.Type.Union([f.Type.String(),f.Type.Boolean()]))),zh=f.Type.Optional(f.Type.Object({animateText:f.Type.Optional(f.Type.Boolean()),textSpeed:f.Type.Optional(f.Type.Number()),timeBetweenLines:f.Type.Optional(f.Type.Number()),overlayMode:f.Type.Optional(f.Type.Boolean()),rightOffset:f.Type.Optional(f.Type.Number()),bottomOffset:f.Type.Optional(f.Type.Number()),width:f.Type.Optional(f.Type.Number()),height:f.Type.Optional(f.Type.Number()),hideDuringTransition:f.Type.Optional(f.Type.Boolean()),historyLength:f.Type.Optional(f.Type.Number()),allowHistoryToggling:f.Type.Optional(f.Type.Boolean()),showAfterScriptEnd:f.Type.Optional(f.Type.Boolean())})),Qh=f.Type.Object({engineSplashScreen:f.Type.Optional(f.Type.Object({skip:f.Type.Optional(f.Type.Boolean()),fadeDuration:f.Type.Optional(f.Type.Number()),timeBeforeFadeout:f.Type.Optional(f.Type.Number()),overrideText:f.Type.Optional(f.Type.String()),overrideLogo:f.Type.Optional(f.Type.String())})),gameSplashScreen:f.Type.Optional(f.Type.Object({startButtonText:f.Type.Optional(f.Type.String())}))}),Jh=f.Type.Object({timeOnScreen:f.Type.Number(),alsoPrintInDialogue:f.Type.Optional(f.Type.Boolean())}),ST=f.Type.Object({name:f.Type.String(),icon:f.Type.String(),startingValue:f.Type.Number(),maxValue:f.Type.Optional(f.Type.Number()),minValue:f.Type.Optional(f.Type.Number()),decimals:f.Type.Optional(f.Type.Number()),prefix:f.Type.Optional(f.Type.String()),suffix:f.Type.Optional(f.Type.String()),hideName:f.Type.Optional(f.Type.Boolean()),formatting:f.Type.Optional(f.Type.Object({style:f.Type.Union([f.Type.Literal("decimal"),f.Type.Literal("currency"),f.Type.Literal("percent"),f.Type.Literal("unit")]),currency:f.Type.Optional(f.Type.String()),unit:f.Type.Optional(f.Type.String())}))}),Yh=f.Type.Record(f.Type.String(),ST),Xh=f.Type.Record(f.Type.String(),f.Type.Object({onlyInteractOutsideOfScripts:f.Type.Optional(f.Type.Boolean())})),CT=f.Type.Object({delay:f.Type.Optional(f.Type.Number()),duration:f.Type.Optional(f.Type.Number())}),Zh=f.Type.Record(f.Type.String(),CT),xT=f.Type.Object({text:f.Type.String(),cssClass:f.Type.Optional(f.Type.String())}),em=f.Type.Record(f.Type.String(),xT),tm=f.Type.Object({showScriptFinishedMessage:f.Type.Optional(f.Type.Boolean())}),nm=f.Type.Object({mode:f.Type.String(),slots:f.Type.Number(),runOnReload:f.Type.Optional(f.Type.String()),disabled:f.Type.Optional(f.Type.Boolean()),autosaveDisabledOnLabels:f.Type.Optional(f.Type.Array(f.Type.String())),autosaveFeedback:f.Type.Optional(f.Type.Object({enabled:f.Type.Boolean(),text:f.Type.Optional(f.Type.String()),backgroundImage:f.Type.Optional(f.Type.String()),foregroundImage:f.Type.Optional(f.Type.String()),duration:f.Type.Number()})),allowManualSave:f.Type.Optional(f.Type.Boolean())}),rm=f.Type.Object({allowFullscreen:f.Type.Optional(f.Type.Boolean())}),om=f.Type.Array(f.Type.String()),$T=[],OT=f.Type.Object({startMenuScene:f.Type.Optional(f.Type.String()),gameScene:f.Type.Optional(f.Type.String()),gameSplashScene:f.Type.Optional(f.Type.String())}),sm=f.Type.Object({showPromptsOnKeyboard:f.Type.Optional(f.Type.Boolean()),showPromptsOnGamepad:f.Type.Optional(f.Type.Boolean()),showBottomLegend:f.Type.Optional(f.Type.Boolean())}),im=f.Type.Object({baseAssetsPath:f.Type.Optional(f.Type.String()),baseDataPath:f.Type.Optional(f.Type.String()),gameTitle:f.Type.String(),saveFileName:f.Type.String(),images:f.Type.Optional(f.Type.Record(f.Type.String(),f.Type.String())),layout:Gh,settings:f.Type.Optional(Wh),graphics:f.Type.Optional(rm),gameFlow:f.Type.Optional(f.Type.Object({labelToJumpOnScriptEnd:f.Type.Optional(f.Type.String())})),dialogPanel:f.Type.Optional(zh),splashScreens:f.Type.Optional(Qh),notifications:f.Type.Optional(Jh),hudStats:Yh,interactionTags:f.Type.Optional(Xh),transitions:f.Type.Optional(Zh),menuButtons:f.Type.Optional(em),debugging:f.Type.Optional(tm),saves:f.Type.Optional(nm),input:f.Type.Optional(sm),hotkeys:kT,scenes:f.Type.Optional(OT)}),Gc={baseAssetsPath:"",baseDataPath:"",gameTitle:"Narrat Game",saveFileName:"narrat save",images:{},layout:lT,settings:{},graphics:{},gameFlow:{},dialogPanel:{overlayMode:!0,rightOffset:100,bottomOffset:50,width:475,height:680,textSpeed:sa,animateText:!0,timeBetweenLines:100,hideDuringTransition:!1,showAfterScriptEnd:!1},splashScreens:{},notifications:{timeOnScreen:2.5,alsoPrintInDialogue:!1},hudStats:{},interactionTags:{default:{onlyInteractOutsideOfScripts:!0}},transitions:{},menuButtons:{},debugging:{showScriptFinishedMessage:!1},saves:{mode:"manual",slots:10},input:{showPromptsOnKeyboard:!0,showPromptsOnGamepad:!0,showBottomLegend:!0},hotkeys:{},scenes:{}},AT=f.Type.Object({name:f.Type.String(),description:f.Type.String(),icon:f.Type.String(),onUse:f.Type.Optional(f.Type.Object({action:f.Type.String(),label:f.Type.String()})),tag:f.Type.Optional(f.Type.String()),category:f.Type.Optional(f.Type.String()),showIfEmpty:f.Type.Optional(f.Type.Boolean())}),am=f.Type.Object({id:f.Type.String(),title:f.Type.String()}),lm=f.Type.Record(f.Type.String(),AT);f.Type.Object({categories:f.Type.Array(am),items:lm});const cm=f.Type.Object({categories:f.Type.Optional(f.Type.Array(am)),items:f.Type.Optional(lm)}),um={categories:[{id:"default",title:"Items"}],items:{}},IT=f.Type.Object({description:f.Type.String(),succeededDescription:f.Type.Optional(f.Type.String()),failedDescription:f.Type.Optional(f.Type.String()),hidden:f.Type.Optional(f.Type.Boolean())}),PT=f.Type.Object({title:f.Type.String(),description:f.Type.String(),succeededDescription:f.Type.Optional(f.Type.String()),failedDescription:f.Type.Optional(f.Type.String()),endings:f.Type.Optional(f.Type.Record(f.Type.String(),f.Type.Object({success:f.Type.Boolean(),description:f.Type.String()}))),objectives:f.Type.Record(f.Type.String(),IT),category:f.Type.Optional(f.Type.String())}),jT=f.Type.Object({id:f.Type.String(),title:f.Type.String()}),ET=f.Type.Record(f.Type.String(),PT),dm=f.Type.Object({quests:ET,categories:f.Type.Array(jT)}),pm={quests:{},categories:[{id:"default",title:"Quests"}]},fm=f.Type.Object({enabled:f.Type.Boolean(),background:f.Type.Optional(f.Type.String()),text:f.Type.Optional(f.Type.String()),cssClass:f.Type.Optional(f.Type.String()),position:f.Type.Object({left:f.Type.Number(),top:f.Type.Number(),width:f.Type.Optional(f.Type.Number()),height:f.Type.Optional(f.Type.Number())}),anchor:f.Type.Optional(f.Type.Object({x:f.Type.Number(),y:f.Type.Number()})),action:f.Type.Optional(f.Type.String()),actionType:f.Type.Optional(f.Type.String()),scriptClickable:f.Type.Optional(f.Type.Boolean()),tag:f.Type.Optional(f.Type.String())}),NT=f.Type.Record(f.Type.String(),fm),hm=f.Type.Object({buttons:NT,clickableDuringScriptsByDefault:f.Type.Optional(f.Type.Boolean())}),mm={buttons:{},clickableDuringScriptsByDefault:!1},MT=f.Type.Intersect([fm,f.Type.Object({id:f.Type.String()})]),LT=f.Type.Object({muted:f.Type.Optional(f.Type.Boolean()),loop:f.Type.Optional(f.Type.Boolean())}),DT=f.Type.Object({background:f.Type.String(),video:f.Type.Optional(LT),buttons:f.Type.Optional(f.Type.Array(f.Type.Union([f.Type.String(),MT])))}),ym=f.Type.Record(f.Type.String(),DT);f.Type.Object({screens:ym});const gm=f.Type.Object({screens:f.Type.Optional(ym)}),vm={screens:{}},RT=f.Type.Object({name:f.Type.String(),description:f.Type.String(),startingLevel:f.Type.Number(),hidden:f.Type.Optional(f.Type.Boolean()),icon:f.Type.String()}),bm=f.Type.Record(f.Type.String(),RT),_m=f.Type.Object({xpPerLevel:f.Type.Number(),notifyLevelUp:f.Type.Boolean()});f.Type.Object({skills:bm,skillOptions:_m});const Tm=f.Type.Object({skills:f.Type.Optional(bm),skillOptions:f.Type.Optional(_m)}),wm={skills:{},skillOptions:{xpPerLevel:10,notifyLevelUp:!0}},FT=f.Type.Object({portraitCssClass:f.Type.Optional(f.Type.String()),color:f.Type.Optional(f.Type.String()),boxCss:f.Type.Optional(f.Type.Record(f.Type.String(),f.Type.Any())),nameCss:f.Type.Optional(f.Type.Record(f.Type.String(),f.Type.Any())),textCss:f.Type.Optional(f.Type.Record(f.Type.String(),f.Type.Any()))}),BT=f.Type.Object({video:f.Type.String(),autoplay:f.Type.Optional(f.Type.Boolean()),loop:f.Type.Optional(f.Type.Boolean()),muted:f.Type.Optional(f.Type.Boolean()),width:f.Type.Optional(f.Type.Number()),height:f.Type.Optional(f.Type.Number())}),UT=f.Type.Object({image:f.Type.String(),width:f.Type.Optional(f.Type.Number()),height:f.Type.Optional(f.Type.Number())}),qT=f.Type.Union([f.Type.String(),BT,UT]),VT=f.Type.Object({sprites:f.Type.Optional(f.Type.Record(f.Type.String(),qT)),name:f.Type.String(),style:f.Type.Optional(FT)}),km=f.Type.Object({config:f.Type.Object({imagesPath:f.Type.String(),playerCharacter:f.Type.Optional(f.Type.String()),gameCharacter:f.Type.Optional(f.Type.String())}),characters:f.Type.Record(f.Type.String(),VT)}),Sm={config:{imagesPath:"",playerCharacter:"player",gameCharacter:"game"},characters:{}},op=f.Type.Object({cssClass:f.Type.Optional(f.Type.String()),textCssClass:f.Type.Optional(f.Type.String()),titleCssClass:f.Type.Optional(f.Type.String())}),Cm=f.Type.Object({options:f.Type.Object({delay:f.Type.Optional(f.Type.Number()),width:f.Type.Number(),keywordsPrefix:f.Type.String(),screenEdgesMinimumMargin:f.Type.Optional(f.Type.Number()),styling:f.Type.Optional(op)}),tooltips:f.Type.Array(f.Type.Object({keywords:f.Type.Array(f.Type.String()),title:f.Type.String(),description:f.Type.String(),styling:f.Type.Optional(op)}))}),xm={options:{delay:0,width:350,keywordsPrefix:"@@"},tooltips:[]},HT=f.Type.Object({name:f.Type.String(),description:f.Type.String(),icon:f.Type.Optional(f.Type.String()),lockedIcon:f.Type.Optional(f.Type.String()),secret:f.Type.Optional(f.Type.Boolean()),category:f.Type.Optional(f.Type.String())}),$m=f.Type.Object({id:f.Type.String(),title:f.Type.String()}),Om=f.Type.Record(f.Type.String(),HT);f.Type.Object({defaultAchievementIcon:f.Type.String(),categories:f.Type.Array($m),achievements:Om,notifyNewAchievements:f.Type.Boolean(),secretAchievements:f.Type.Optional(f.Type.Object({censorDescription:f.Type.Optional(f.Type.Boolean()),censorName:f.Type.Optional(f.Type.Boolean()),hideUntilObtained:f.Type.Optional(f.Type.Boolean())}))});const Am=f.Type.Object({categories:f.Type.Optional(f.Type.Array($m)),achievements:f.Type.Optional(Om)}),Im={categories:[{id:"default",title:"Achievements"}],achievements:{},notifyNewAchievements:!0,defaultAchievementIcon:"img/achievements/trophy.png"},KT=f.Type.Object({diceRange:f.Type.Tuple([f.Type.Number(),f.Type.Number()]),diceCount:f.Type.Number(),difficultyText:f.Type.Array(f.Type.Tuple([f.Type.Number(),f.Type.String()])),extraPointsPerLevel:f.Type.Number(),extraDicePerLevel:f.Type.Optional(f.Type.Number()),successOnRollsBelowThreshold:f.Type.Boolean(),showDifficultyText:f.Type.Boolean(),showDifficultyNumber:f.Type.Boolean(),showDifficultyWithoutModifiers:f.Type.Boolean(),finalRollIsHighest:f.Type.Optional(f.Type.Boolean()),finalRollIsLowest:f.Type.Optional(f.Type.Boolean()),failOnRollsEqualToThreshold:f.Type.Optional(f.Type.Boolean())}),GT=f.Type.Object({skill:f.Type.String(),difficulty:f.Type.Number(),winsNeeded:f.Type.Optional(f.Type.Number()),hideAfterRoll:f.Type.Optional(f.Type.Boolean()),repeatable:f.Type.Optional(f.Type.Boolean())}),Pm=f.Type.Object({options:KT,skillChecks:f.Type.Record(f.Type.String(),GT)}),jm={options:{diceRange:[1,6],extraPointsPerLevel:1,extraDicePerLevel:0,diceCount:2,successOnRollsBelowThreshold:!1,showDifficultyText:!0,showDifficultyNumber:!1,showDifficultyWithoutModifiers:!1,finalRollIsHighest:!1,finalRollIsLowest:!1,difficultyText:[[2,"Very Easy"],[4,"Easy"],[6,"Medium"],[8,"Hard"],[10,"Very Hard"],[11,"Extremely Hard"],[12,"Near Impossible"]]},skillChecks:{}},WT=f.Type.Object({cssClass:f.Type.Optional(f.Type.String()),textTemplate:f.Type.Optional(f.Type.String())}),Em=f.Type.Record(f.Type.String(),WT);f.Type.Object({choiceTextTemplate:f.Type.String(),choicePrompts:Em});const Nm=f.Type.Object({choiceTextTemplate:f.Type.Optional(f.Type.String()),choicePrompts:f.Type.Optional(Em)}),Mm={choicePrompts:{},choiceTextTemplate:'<span class="choice-index">%{$index}. </span> <span class="choice-text">%{$choice}</span>'},Lm=f.Type.Object({delay:f.Type.Optional(f.Type.Number()),direction:f.Type.Optional(f.Type.String()),duration:f.Type.Optional(f.Type.Number()),easing:f.Type.Optional(f.Type.String()),endDelay:f.Type.Optional(f.Type.Number()),fill:f.Type.Optional(f.Type.String()),iterationStart:f.Type.Optional(f.Type.Number()),iterations:f.Type.Optional(f.Type.Number()),keyframes:f.Type.Optional(f.Type.Any())}),Wc=f.Type.Array(f.Type.Any()),zT=f.Type.Object({keyframes:f.Type.Union([f.Type.String(),Wc]),options:f.Type.Optional(Lm)});f.Type.Object({keyframes:Wc,options:f.Type.Optional(Lm)});const Dm=f.Type.Object({animations:f.Type.Record(f.Type.String(),zT),keyframes:f.Type.Record(f.Type.String(),Wc)}),Rm={animations:{},keyframes:{}},QT=f.Type.Object({name:f.Type.String(),type:f.Type.String(),optional:f.Type.Optional(f.Type.Boolean())}),JT=f.Type.Object({keyword:f.Type.String(),label:f.Type.String(),options:f.Type.Optional(f.Type.Array(QT))}),Fm=f.Type.Object({macros:f.Type.Array(JT)}),Bm={macros:[]},hl=f.Type.Object({assets:f.Type.Record(f.Type.String(),f.Type.String())}),Um=f.Type.Object({images:f.Type.Optional(hl),audio:f.Type.Optional(hl),video:f.Type.Optional(hl)}),qm={images:{assets:{}},audio:{assets:{}},video:{assets:{}}},YT=f.Type.Object({file:f.Type.String(),options:f.Type.Record(f.Type.String(),f.Type.Any())}),XT=f.Type.Object({name:f.Type.String(),files:f.Type.Array(f.Type.Union([f.Type.String(),YT])),fontFamily:f.Type.String()}),ZT=f.Type.Record(f.Type.String(),XT),Vm=f.Type.Object({fontSets:f.Type.Optional(f.Type.Record(f.Type.String(),ZT)),allowChoosingFont:f.Type.Optional(f.Type.Boolean())}),Hm={fontSets:{},allowChoosingFont:!1},ls={common:Gc,screens:vm,buttons:mm,skills:wm,skillChecks:jm,scripts:[],audio:Kh,tooltips:xm,achievements:Im,items:um,quests:pm,characters:Sm,choices:Mm,animations:Rm,macros:Bm,preload:qm,fonts:Hm};var ew=function(e){return tw(e)&&!nw(e)};function tw(e){return!!e&&typeof e=="object"}function nw(e){var t=Object.prototype.toString.call(e);return t==="[object RegExp]"||t==="[object Date]"||sw(e)}var rw=typeof Symbol=="function"&&Symbol.for,ow=rw?Symbol.for("react.element"):60103;function sw(e){return e.$$typeof===ow}function iw(e){return Array.isArray(e)?[]:{}}function ti(e,t){return t.clone!==!1&&t.isMergeableObject(e)?cs(iw(e),e,t):e}function aw(e,t,n){return e.concat(t).map(function(r){return ti(r,n)})}function lw(e,t){if(!t.customMerge)return cs;var n=t.customMerge(e);return typeof n=="function"?n:cs}function cw(e){return Object.getOwnPropertySymbols?Object.getOwnPropertySymbols(e).filter(function(t){return Object.propertyIsEnumerable.call(e,t)}):[]}function sp(e){return Object.keys(e).concat(cw(e))}function Km(e,t){try{return t in e}catch{return!1}}function uw(e,t){return Km(e,t)&&!(Object.hasOwnProperty.call(e,t)&&Object.propertyIsEnumerable.call(e,t))}function dw(e,t,n){var r={};return n.isMergeableObject(e)&&sp(e).forEach(function(o){r[o]=ti(e[o],n)}),sp(t).forEach(function(o){uw(e,o)||(Km(e,o)&&n.isMergeableObject(t[o])?r[o]=lw(o,n)(e[o],t[o],n):r[o]=ti(t[o],n))}),r}function cs(e,t,n){n=n||{},n.arrayMerge=n.arrayMerge||aw,n.isMergeableObject=n.isMergeableObject||ew,n.cloneUnlessOtherwiseSpecified=ti;var r=Array.isArray(t),o=Array.isArray(e),i=r===o;return i?r?n.arrayMerge(e,t,n):dw(e,t,n):ti(t,n)}cs.all=function(e,t){if(!Array.isArray(e))throw new Error("first argument should be an array");return e.reduce(function(n,r){return cs(n,r,t)},{})};var pw=cs,fw=pw;const Ao=Ch(fw),Bt=Ot("config",{state:()=>({config:ls,configModules:{}}),actions:{async setConfig(e){this.config=e},extendConfig(e){this.config=Ao(this.config,e)},generateSaveData(){return{playerCharacter:this.playerCharacter,gameCharacter:this.gameCharacter}},addConfigModule(e,t){this.configModules[e]=t},findConfigModuleKey(e){const t=Object.keys(this.configModules).find(n=>this.configModules[n].id===e.id);if(t)return t},reloadConfigModule(e,t){this.configModules[e].code=t,this.config[e]=t},loadSaveData(e){this.config.characters.config.playerCharacter=e.playerCharacter,this.config.characters.config.gameCharacter=e.gameCharacter}},getters:{playerCharacter(){return this.config.characters.config.playerCharacter??"player"},gameCharacter(){return this.config.characters.config.gameCharacter??"game"}}});function Gm(e){const t=Lt(),n=t.getSkillCheck(e.id);if(n&&n.happened&&(n.succeeded||!e.repeatable))return n;const r=tT(e);return Wm(Y_(r,e)),r?t.passSkillCheck(e.id,e.hideAfterRoll):t.failSkillCheck(e.id,e.hideAfterRoll),t.getSkillCheck(e.id)}function hw(e,t=[]){const n=e.options,r=e.staticOptions,o=!!n.condition;if(o)return r.success;if(!o){for(const[i,s]of r.elseifs.entries())if(t[i]===!0)return s.branch}if(!o&&r.failure)return r.failure}function zc(e){return typeof e=="object"}function Qc(e){return typeof e=="string"&&e.search(/\$/)===0}function Wm(e){const t={speaker:Bt().gameCharacter,text:e,interactive:!1};rt().addDialog(t)}async function Ba(e){rt().addDialog(e)}function mw(e,t){if(t<e.length)return e[t]}/*! js-yaml 4.1.0 https://github.com/nodeca/js-yaml @license MIT */function zm(e){return typeof e>"u"||e===null}function yw(e){return typeof e=="object"&&e!==null}function gw(e){return Array.isArray(e)?e:zm(e)?[]:[e]}function vw(e,t){var n,r,o,i;if(t)for(i=Object.keys(t),n=0,r=i.length;n<r;n+=1)o=i[n],e[o]=t[o];return e}function bw(e,t){var n="",r;for(r=0;r<t;r+=1)n+=e;return n}function _w(e){return e===0&&Number.NEGATIVE_INFINITY===1/e}var Tw=zm,ww=yw,kw=gw,Sw=bw,Cw=_w,xw=vw,Rt={isNothing:Tw,isObject:ww,toArray:kw,repeat:Sw,isNegativeZero:Cw,extend:xw};function Qm(e,t){var n="",r=e.reason||"(unknown reason)";return e.mark?(e.mark.name&&(n+='in "'+e.mark.name+'" '),n+="("+(e.mark.line+1)+":"+(e.mark.column+1)+")",!t&&e.mark.snippet&&(n+=`

`+e.mark.snippet),r+" "+n):r}function ni(e,t){Error.call(this),this.name="YAMLException",this.reason=e,this.mark=t,this.message=Qm(this,!1),Error.captureStackTrace?Error.captureStackTrace(this,this.constructor):this.stack=new Error().stack||""}ni.prototype=Object.create(Error.prototype);ni.prototype.constructor=ni;ni.prototype.toString=function(e){return this.name+": "+Qm(this,e)};var ln=ni;function ml(e,t,n,r,o){var i="",s="",l=Math.floor(o/2)-1;return r-t>l&&(i=" ... ",t=r-l+i.length),n-r>l&&(s=" ...",n=r+l-s.length),{str:i+e.slice(t,n).replace(/\t/g,"→")+s,pos:r-t+i.length}}function yl(e,t){return Rt.repeat(" ",t-e.length)+e}function $w(e,t){if(t=Object.create(t||null),!e.buffer)return null;t.maxLength||(t.maxLength=79),typeof t.indent!="number"&&(t.indent=1),typeof t.linesBefore!="number"&&(t.linesBefore=3),typeof t.linesAfter!="number"&&(t.linesAfter=2);for(var n=/\r?\n|\r|\0/g,r=[0],o=[],i,s=-1;i=n.exec(e.buffer);)o.push(i.index),r.push(i.index+i[0].length),e.position<=i.index&&s<0&&(s=r.length-2);s<0&&(s=r.length-1);var l="",u,c,p=Math.min(e.line+t.linesAfter,o.length).toString().length,a=t.maxLength-(t.indent+p+3);for(u=1;u<=t.linesBefore&&!(s-u<0);u++)c=ml(e.buffer,r[s-u],o[s-u],e.position-(r[s]-r[s-u]),a),l=Rt.repeat(" ",t.indent)+yl((e.line-u+1).toString(),p)+" | "+c.str+`
`+l;for(c=ml(e.buffer,r[s],o[s],e.position,a),l+=Rt.repeat(" ",t.indent)+yl((e.line+1).toString(),p)+" | "+c.str+`
`,l+=Rt.repeat("-",t.indent+p+3+c.pos)+`^
`,u=1;u<=t.linesAfter&&!(s+u>=o.length);u++)c=ml(e.buffer,r[s+u],o[s+u],e.position-(r[s]-r[s+u]),a),l+=Rt.repeat(" ",t.indent)+yl((e.line+u+1).toString(),p)+" | "+c.str+`
`;return l.replace(/\n$/,"")}var Ow=$w,Aw=["kind","multi","resolve","construct","instanceOf","predicate","represent","representName","defaultStyle","styleAliases"],Iw=["scalar","sequence","mapping"];function Pw(e){var t={};return e!==null&&Object.keys(e).forEach(function(n){e[n].forEach(function(r){t[String(r)]=n})}),t}function jw(e,t){if(t=t||{},Object.keys(t).forEach(function(n){if(Aw.indexOf(n)===-1)throw new ln('Unknown option "'+n+'" is met in definition of "'+e+'" YAML type.')}),this.options=t,this.tag=e,this.kind=t.kind||null,this.resolve=t.resolve||function(){return!0},this.construct=t.construct||function(n){return n},this.instanceOf=t.instanceOf||null,this.predicate=t.predicate||null,this.represent=t.represent||null,this.representName=t.representName||null,this.defaultStyle=t.defaultStyle||null,this.multi=t.multi||!1,this.styleAliases=Pw(t.styleAliases||null),Iw.indexOf(this.kind)===-1)throw new ln('Unknown kind "'+this.kind+'" is specified for "'+e+'" YAML type.')}var Kt=jw;function ip(e,t){var n=[];return e[t].forEach(function(r){var o=n.length;n.forEach(function(i,s){i.tag===r.tag&&i.kind===r.kind&&i.multi===r.multi&&(o=s)}),n[o]=r}),n}function Ew(){var e={scalar:{},sequence:{},mapping:{},fallback:{},multi:{scalar:[],sequence:[],mapping:[],fallback:[]}},t,n;function r(o){o.multi?(e.multi[o.kind].push(o),e.multi.fallback.push(o)):e[o.kind][o.tag]=e.fallback[o.tag]=o}for(t=0,n=arguments.length;t<n;t+=1)arguments[t].forEach(r);return e}function Wl(e){return this.extend(e)}Wl.prototype.extend=function(e){var t=[],n=[];if(e instanceof Kt)n.push(e);else if(Array.isArray(e))n=n.concat(e);else if(e&&(Array.isArray(e.implicit)||Array.isArray(e.explicit)))e.implicit&&(t=t.concat(e.implicit)),e.explicit&&(n=n.concat(e.explicit));else throw new ln("Schema.extend argument should be a Type, [ Type ], or a schema definition ({ implicit: [...], explicit: [...] })");t.forEach(function(o){if(!(o instanceof Kt))throw new ln("Specified list of YAML types (or a single Type object) contains a non-Type object.");if(o.loadKind&&o.loadKind!=="scalar")throw new ln("There is a non-scalar type in the implicit list of a schema. Implicit resolving of such types is not supported.");if(o.multi)throw new ln("There is a multi type in the implicit list of a schema. Multi tags can only be listed as explicit.")}),n.forEach(function(o){if(!(o instanceof Kt))throw new ln("Specified list of YAML types (or a single Type object) contains a non-Type object.")});var r=Object.create(Wl.prototype);return r.implicit=(this.implicit||[]).concat(t),r.explicit=(this.explicit||[]).concat(n),r.compiledImplicit=ip(r,"implicit"),r.compiledExplicit=ip(r,"explicit"),r.compiledTypeMap=Ew(r.compiledImplicit,r.compiledExplicit),r};var Jm=Wl,Ym=new Kt("tag:yaml.org,2002:str",{kind:"scalar",construct:function(e){return e!==null?e:""}}),Xm=new Kt("tag:yaml.org,2002:seq",{kind:"sequence",construct:function(e){return e!==null?e:[]}}),Zm=new Kt("tag:yaml.org,2002:map",{kind:"mapping",construct:function(e){return e!==null?e:{}}}),ey=new Jm({explicit:[Ym,Xm,Zm]});function Nw(e){if(e===null)return!0;var t=e.length;return t===1&&e==="~"||t===4&&(e==="null"||e==="Null"||e==="NULL")}function Mw(){return null}function Lw(e){return e===null}var ty=new Kt("tag:yaml.org,2002:null",{kind:"scalar",resolve:Nw,construct:Mw,predicate:Lw,represent:{canonical:function(){return"~"},lowercase:function(){return"null"},uppercase:function(){return"NULL"},camelcase:function(){return"Null"},empty:function(){return""}},defaultStyle:"lowercase"});function Dw(e){if(e===null)return!1;var t=e.length;return t===4&&(e==="true"||e==="True"||e==="TRUE")||t===5&&(e==="false"||e==="False"||e==="FALSE")}function Rw(e){return e==="true"||e==="True"||e==="TRUE"}function Fw(e){return Object.prototype.toString.call(e)==="[object Boolean]"}var ny=new Kt("tag:yaml.org,2002:bool",{kind:"scalar",resolve:Dw,construct:Rw,predicate:Fw,represent:{lowercase:function(e){return e?"true":"false"},uppercase:function(e){return e?"TRUE":"FALSE"},camelcase:function(e){return e?"True":"False"}},defaultStyle:"lowercase"});function Bw(e){return 48<=e&&e<=57||65<=e&&e<=70||97<=e&&e<=102}function Uw(e){return 48<=e&&e<=55}function qw(e){return 48<=e&&e<=57}function Vw(e){if(e===null)return!1;var t=e.length,n=0,r=!1,o;if(!t)return!1;if(o=e[n],(o==="-"||o==="+")&&(o=e[++n]),o==="0"){if(n+1===t)return!0;if(o=e[++n],o==="b"){for(n++;n<t;n++)if(o=e[n],o!=="_"){if(o!=="0"&&o!=="1")return!1;r=!0}return r&&o!=="_"}if(o==="x"){for(n++;n<t;n++)if(o=e[n],o!=="_"){if(!Bw(e.charCodeAt(n)))return!1;r=!0}return r&&o!=="_"}if(o==="o"){for(n++;n<t;n++)if(o=e[n],o!=="_"){if(!Uw(e.charCodeAt(n)))return!1;r=!0}return r&&o!=="_"}}if(o==="_")return!1;for(;n<t;n++)if(o=e[n],o!=="_"){if(!qw(e.charCodeAt(n)))return!1;r=!0}return!(!r||o==="_")}function Hw(e){var t=e,n=1,r;if(t.indexOf("_")!==-1&&(t=t.replace(/_/g,"")),r=t[0],(r==="-"||r==="+")&&(r==="-"&&(n=-1),t=t.slice(1),r=t[0]),t==="0")return 0;if(r==="0"){if(t[1]==="b")return n*parseInt(t.slice(2),2);if(t[1]==="x")return n*parseInt(t.slice(2),16);if(t[1]==="o")return n*parseInt(t.slice(2),8)}return n*parseInt(t,10)}function Kw(e){return Object.prototype.toString.call(e)==="[object Number]"&&e%1===0&&!Rt.isNegativeZero(e)}var ry=new Kt("tag:yaml.org,2002:int",{kind:"scalar",resolve:Vw,construct:Hw,predicate:Kw,represent:{binary:function(e){return e>=0?"0b"+e.toString(2):"-0b"+e.toString(2).slice(1)},octal:function(e){return e>=0?"0o"+e.toString(8):"-0o"+e.toString(8).slice(1)},decimal:function(e){return e.toString(10)},hexadecimal:function(e){return e>=0?"0x"+e.toString(16).toUpperCase():"-0x"+e.toString(16).toUpperCase().slice(1)}},defaultStyle:"decimal",styleAliases:{binary:[2,"bin"],octal:[8,"oct"],decimal:[10,"dec"],hexadecimal:[16,"hex"]}}),Gw=new RegExp("^(?:[-+]?(?:[0-9][0-9_]*)(?:\\.[0-9_]*)?(?:[eE][-+]?[0-9]+)?|\\.[0-9_]+(?:[eE][-+]?[0-9]+)?|[-+]?\\.(?:inf|Inf|INF)|\\.(?:nan|NaN|NAN))$");function Ww(e){return!(e===null||!Gw.test(e)||e[e.length-1]==="_")}function zw(e){var t,n;return t=e.replace(/_/g,"").toLowerCase(),n=t[0]==="-"?-1:1,"+-".indexOf(t[0])>=0&&(t=t.slice(1)),t===".inf"?n===1?Number.POSITIVE_INFINITY:Number.NEGATIVE_INFINITY:t===".nan"?NaN:n*parseFloat(t,10)}var Qw=/^[-+]?[0-9]+e/;function Jw(e,t){var n;if(isNaN(e))switch(t){case"lowercase":return".nan";case"uppercase":return".NAN";case"camelcase":return".NaN"}else if(Number.POSITIVE_INFINITY===e)switch(t){case"lowercase":return".inf";case"uppercase":return".INF";case"camelcase":return".Inf"}else if(Number.NEGATIVE_INFINITY===e)switch(t){case"lowercase":return"-.inf";case"uppercase":return"-.INF";case"camelcase":return"-.Inf"}else if(Rt.isNegativeZero(e))return"-0.0";return n=e.toString(10),Qw.test(n)?n.replace("e",".e"):n}function Yw(e){return Object.prototype.toString.call(e)==="[object Number]"&&(e%1!==0||Rt.isNegativeZero(e))}var oy=new Kt("tag:yaml.org,2002:float",{kind:"scalar",resolve:Ww,construct:zw,predicate:Yw,represent:Jw,defaultStyle:"lowercase"}),sy=ey.extend({implicit:[ty,ny,ry,oy]}),iy=sy,ay=new RegExp("^([0-9][0-9][0-9][0-9])-([0-9][0-9])-([0-9][0-9])$"),ly=new RegExp("^([0-9][0-9][0-9][0-9])-([0-9][0-9]?)-([0-9][0-9]?)(?:[Tt]|[ \\t]+)([0-9][0-9]?):([0-9][0-9]):([0-9][0-9])(?:\\.([0-9]*))?(?:[ \\t]*(Z|([-+])([0-9][0-9]?)(?::([0-9][0-9]))?))?$");function Xw(e){return e===null?!1:ay.exec(e)!==null||ly.exec(e)!==null}function Zw(e){var t,n,r,o,i,s,l,u=0,c=null,p,a,d;if(t=ay.exec(e),t===null&&(t=ly.exec(e)),t===null)throw new Error("Date resolve error");if(n=+t[1],r=+t[2]-1,o=+t[3],!t[4])return new Date(Date.UTC(n,r,o));if(i=+t[4],s=+t[5],l=+t[6],t[7]){for(u=t[7].slice(0,3);u.length<3;)u+="0";u=+u}return t[9]&&(p=+t[10],a=+(t[11]||0),c=(p*60+a)*6e4,t[9]==="-"&&(c=-c)),d=new Date(Date.UTC(n,r,o,i,s,l,u)),c&&d.setTime(d.getTime()-c),d}function e1(e){return e.toISOString()}var cy=new Kt("tag:yaml.org,2002:timestamp",{kind:"scalar",resolve:Xw,construct:Zw,instanceOf:Date,represent:e1});function t1(e){return e==="<<"||e===null}var uy=new Kt("tag:yaml.org,2002:merge",{kind:"scalar",resolve:t1}),Jc=`ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=
\r`;function n1(e){if(e===null)return!1;var t,n,r=0,o=e.length,i=Jc;for(n=0;n<o;n++)if(t=i.indexOf(e.charAt(n)),!(t>64)){if(t<0)return!1;r+=6}return r%8===0}function r1(e){var t,n,r=e.replace(/[\r\n=]/g,""),o=r.length,i=Jc,s=0,l=[];for(t=0;t<o;t++)t%4===0&&t&&(l.push(s>>16&255),l.push(s>>8&255),l.push(s&255)),s=s<<6|i.indexOf(r.charAt(t));return n=o%4*6,n===0?(l.push(s>>16&255),l.push(s>>8&255),l.push(s&255)):n===18?(l.push(s>>10&255),l.push(s>>2&255)):n===12&&l.push(s>>4&255),new Uint8Array(l)}function o1(e){var t="",n=0,r,o,i=e.length,s=Jc;for(r=0;r<i;r++)r%3===0&&r&&(t+=s[n>>18&63],t+=s[n>>12&63],t+=s[n>>6&63],t+=s[n&63]),n=(n<<8)+e[r];return o=i%3,o===0?(t+=s[n>>18&63],t+=s[n>>12&63],t+=s[n>>6&63],t+=s[n&63]):o===2?(t+=s[n>>10&63],t+=s[n>>4&63],t+=s[n<<2&63],t+=s[64]):o===1&&(t+=s[n>>2&63],t+=s[n<<4&63],t+=s[64],t+=s[64]),t}function s1(e){return Object.prototype.toString.call(e)==="[object Uint8Array]"}var dy=new Kt("tag:yaml.org,2002:binary",{kind:"scalar",resolve:n1,construct:r1,predicate:s1,represent:o1}),i1=Object.prototype.hasOwnProperty,a1=Object.prototype.toString;function l1(e){if(e===null)return!0;var t=[],n,r,o,i,s,l=e;for(n=0,r=l.length;n<r;n+=1){if(o=l[n],s=!1,a1.call(o)!=="[object Object]")return!1;for(i in o)if(i1.call(o,i))if(!s)s=!0;else return!1;if(!s)return!1;if(t.indexOf(i)===-1)t.push(i);else return!1}return!0}function c1(e){return e!==null?e:[]}var py=new Kt("tag:yaml.org,2002:omap",{kind:"sequence",resolve:l1,construct:c1}),u1=Object.prototype.toString;function d1(e){if(e===null)return!0;var t,n,r,o,i,s=e;for(i=new Array(s.length),t=0,n=s.length;t<n;t+=1){if(r=s[t],u1.call(r)!=="[object Object]"||(o=Object.keys(r),o.length!==1))return!1;i[t]=[o[0],r[o[0]]]}return!0}function p1(e){if(e===null)return[];var t,n,r,o,i,s=e;for(i=new Array(s.length),t=0,n=s.length;t<n;t+=1)r=s[t],o=Object.keys(r),i[t]=[o[0],r[o[0]]];return i}var fy=new Kt("tag:yaml.org,2002:pairs",{kind:"sequence",resolve:d1,construct:p1}),f1=Object.prototype.hasOwnProperty;function h1(e){if(e===null)return!0;var t,n=e;for(t in n)if(f1.call(n,t)&&n[t]!==null)return!1;return!0}function m1(e){return e!==null?e:{}}var hy=new Kt("tag:yaml.org,2002:set",{kind:"mapping",resolve:h1,construct:m1}),Yc=iy.extend({implicit:[cy,uy],explicit:[dy,py,fy,hy]}),Qr=Object.prototype.hasOwnProperty,ia=1,my=2,yy=3,aa=4,gl=1,y1=2,ap=3,g1=/[\x00-\x08\x0B\x0C\x0E-\x1F\x7F-\x84\x86-\x9F\uFFFE\uFFFF]|[\uD800-\uDBFF](?![\uDC00-\uDFFF])|(?:[^\uD800-\uDBFF]|^)[\uDC00-\uDFFF]/,v1=/[\x85\u2028\u2029]/,b1=/[,\[\]\{\}]/,gy=/^(?:!|!!|![a-z\-]+!)$/i,vy=/^(?:!|[^,\[\]\{\}])(?:%[0-9a-f]{2}|[0-9a-z\-#;\/\?:@&=\+\$,_\.!~\*'\(\)\[\]])*$/i;function lp(e){return Object.prototype.toString.call(e)}function or(e){return e===10||e===13}function So(e){return e===9||e===32}function hn(e){return e===9||e===32||e===10||e===13}function Ko(e){return e===44||e===91||e===93||e===123||e===125}function _1(e){var t;return 48<=e&&e<=57?e-48:(t=e|32,97<=t&&t<=102?t-97+10:-1)}function T1(e){return e===120?2:e===117?4:e===85?8:0}function w1(e){return 48<=e&&e<=57?e-48:-1}function cp(e){return e===48?"\0":e===97?"\x07":e===98?"\b":e===116||e===9?"	":e===110?`
`:e===118?"\v":e===102?"\f":e===114?"\r":e===101?"\x1B":e===32?" ":e===34?'"':e===47?"/":e===92?"\\":e===78?"":e===95?" ":e===76?"\u2028":e===80?"\u2029":""}function k1(e){return e<=65535?String.fromCharCode(e):String.fromCharCode((e-65536>>10)+55296,(e-65536&1023)+56320)}var by=new Array(256),_y=new Array(256);for(var Fo=0;Fo<256;Fo++)by[Fo]=cp(Fo)?1:0,_y[Fo]=cp(Fo);function S1(e,t){this.input=e,this.filename=t.filename||null,this.schema=t.schema||Yc,this.onWarning=t.onWarning||null,this.legacy=t.legacy||!1,this.json=t.json||!1,this.listener=t.listener||null,this.implicitTypes=this.schema.compiledImplicit,this.typeMap=this.schema.compiledTypeMap,this.length=e.length,this.position=0,this.line=0,this.lineStart=0,this.lineIndent=0,this.firstTabInLine=-1,this.documents=[]}function Ty(e,t){var n={name:e.filename,buffer:e.input.slice(0,-1),position:e.position,line:e.line,column:e.position-e.lineStart};return n.snippet=Ow(n),new ln(t,n)}function Pe(e,t){throw Ty(e,t)}function la(e,t){e.onWarning&&e.onWarning.call(null,Ty(e,t))}var up={YAML:function(e,t,n){var r,o,i;e.version!==null&&Pe(e,"duplication of %YAML directive"),n.length!==1&&Pe(e,"YAML directive accepts exactly one argument"),r=/^([0-9]+)\.([0-9]+)$/.exec(n[0]),r===null&&Pe(e,"ill-formed argument of the YAML directive"),o=parseInt(r[1],10),i=parseInt(r[2],10),o!==1&&Pe(e,"unacceptable YAML version of the document"),e.version=n[0],e.checkLineBreaks=i<2,i!==1&&i!==2&&la(e,"unsupported YAML version of the document")},TAG:function(e,t,n){var r,o;n.length!==2&&Pe(e,"TAG directive accepts exactly two arguments"),r=n[0],o=n[1],gy.test(r)||Pe(e,"ill-formed tag handle (first argument) of the TAG directive"),Qr.call(e.tagMap,r)&&Pe(e,'there is a previously declared suffix for "'+r+'" tag handle'),vy.test(o)||Pe(e,"ill-formed tag prefix (second argument) of the TAG directive");try{o=decodeURIComponent(o)}catch{Pe(e,"tag prefix is malformed: "+o)}e.tagMap[r]=o}};function Gr(e,t,n,r){var o,i,s,l;if(t<n){if(l=e.input.slice(t,n),r)for(o=0,i=l.length;o<i;o+=1)s=l.charCodeAt(o),s===9||32<=s&&s<=1114111||Pe(e,"expected valid JSON character");else g1.test(l)&&Pe(e,"the stream contains non-printable characters");e.result+=l}}function dp(e,t,n,r){var o,i,s,l;for(Rt.isObject(n)||Pe(e,"cannot merge mappings; the provided source object is unacceptable"),o=Object.keys(n),s=0,l=o.length;s<l;s+=1)i=o[s],Qr.call(t,i)||(t[i]=n[i],r[i]=!0)}function Go(e,t,n,r,o,i,s,l,u){var c,p;if(Array.isArray(o))for(o=Array.prototype.slice.call(o),c=0,p=o.length;c<p;c+=1)Array.isArray(o[c])&&Pe(e,"nested arrays are not supported inside keys"),typeof o=="object"&&lp(o[c])==="[object Object]"&&(o[c]="[object Object]");if(typeof o=="object"&&lp(o)==="[object Object]"&&(o="[object Object]"),o=String(o),t===null&&(t={}),r==="tag:yaml.org,2002:merge")if(Array.isArray(i))for(c=0,p=i.length;c<p;c+=1)dp(e,t,i[c],n);else dp(e,t,i,n);else!e.json&&!Qr.call(n,o)&&Qr.call(t,o)&&(e.line=s||e.line,e.lineStart=l||e.lineStart,e.position=u||e.position,Pe(e,"duplicated mapping key")),o==="__proto__"?Object.defineProperty(t,o,{configurable:!0,enumerable:!0,writable:!0,value:i}):t[o]=i,delete n[o];return t}function Xc(e){var t;t=e.input.charCodeAt(e.position),t===10?e.position++:t===13?(e.position++,e.input.charCodeAt(e.position)===10&&e.position++):Pe(e,"a line break is expected"),e.line+=1,e.lineStart=e.position,e.firstTabInLine=-1}function Dt(e,t,n){for(var r=0,o=e.input.charCodeAt(e.position);o!==0;){for(;So(o);)o===9&&e.firstTabInLine===-1&&(e.firstTabInLine=e.position),o=e.input.charCodeAt(++e.position);if(t&&o===35)do o=e.input.charCodeAt(++e.position);while(o!==10&&o!==13&&o!==0);if(or(o))for(Xc(e),o=e.input.charCodeAt(e.position),r++,e.lineIndent=0;o===32;)e.lineIndent++,o=e.input.charCodeAt(++e.position);else break}return n!==-1&&r!==0&&e.lineIndent<n&&la(e,"deficient indentation"),r}function Ua(e){var t=e.position,n;return n=e.input.charCodeAt(t),!!((n===45||n===46)&&n===e.input.charCodeAt(t+1)&&n===e.input.charCodeAt(t+2)&&(t+=3,n=e.input.charCodeAt(t),n===0||hn(n)))}function Zc(e,t){t===1?e.result+=" ":t>1&&(e.result+=Rt.repeat(`
`,t-1))}function C1(e,t,n){var r,o,i,s,l,u,c,p,a=e.kind,d=e.result,h;if(h=e.input.charCodeAt(e.position),hn(h)||Ko(h)||h===35||h===38||h===42||h===33||h===124||h===62||h===39||h===34||h===37||h===64||h===96||(h===63||h===45)&&(o=e.input.charCodeAt(e.position+1),hn(o)||n&&Ko(o)))return!1;for(e.kind="scalar",e.result="",i=s=e.position,l=!1;h!==0;){if(h===58){if(o=e.input.charCodeAt(e.position+1),hn(o)||n&&Ko(o))break}else if(h===35){if(r=e.input.charCodeAt(e.position-1),hn(r))break}else{if(e.position===e.lineStart&&Ua(e)||n&&Ko(h))break;if(or(h))if(u=e.line,c=e.lineStart,p=e.lineIndent,Dt(e,!1,-1),e.lineIndent>=t){l=!0,h=e.input.charCodeAt(e.position);continue}else{e.position=s,e.line=u,e.lineStart=c,e.lineIndent=p;break}}l&&(Gr(e,i,s,!1),Zc(e,e.line-u),i=s=e.position,l=!1),So(h)||(s=e.position+1),h=e.input.charCodeAt(++e.position)}return Gr(e,i,s,!1),e.result?!0:(e.kind=a,e.result=d,!1)}function x1(e,t){var n,r,o;if(n=e.input.charCodeAt(e.position),n!==39)return!1;for(e.kind="scalar",e.result="",e.position++,r=o=e.position;(n=e.input.charCodeAt(e.position))!==0;)if(n===39)if(Gr(e,r,e.position,!0),n=e.input.charCodeAt(++e.position),n===39)r=e.position,e.position++,o=e.position;else return!0;else or(n)?(Gr(e,r,o,!0),Zc(e,Dt(e,!1,t)),r=o=e.position):e.position===e.lineStart&&Ua(e)?Pe(e,"unexpected end of the document within a single quoted scalar"):(e.position++,o=e.position);Pe(e,"unexpected end of the stream within a single quoted scalar")}function $1(e,t){var n,r,o,i,s,l;if(l=e.input.charCodeAt(e.position),l!==34)return!1;for(e.kind="scalar",e.result="",e.position++,n=r=e.position;(l=e.input.charCodeAt(e.position))!==0;){if(l===34)return Gr(e,n,e.position,!0),e.position++,!0;if(l===92){if(Gr(e,n,e.position,!0),l=e.input.charCodeAt(++e.position),or(l))Dt(e,!1,t);else if(l<256&&by[l])e.result+=_y[l],e.position++;else if((s=T1(l))>0){for(o=s,i=0;o>0;o--)l=e.input.charCodeAt(++e.position),(s=_1(l))>=0?i=(i<<4)+s:Pe(e,"expected hexadecimal character");e.result+=k1(i),e.position++}else Pe(e,"unknown escape sequence");n=r=e.position}else or(l)?(Gr(e,n,r,!0),Zc(e,Dt(e,!1,t)),n=r=e.position):e.position===e.lineStart&&Ua(e)?Pe(e,"unexpected end of the document within a double quoted scalar"):(e.position++,r=e.position)}Pe(e,"unexpected end of the stream within a double quoted scalar")}function O1(e,t){var n=!0,r,o,i,s=e.tag,l,u=e.anchor,c,p,a,d,h,m=Object.create(null),y,T,g,C;if(C=e.input.charCodeAt(e.position),C===91)p=93,h=!1,l=[];else if(C===123)p=125,h=!0,l={};else return!1;for(e.anchor!==null&&(e.anchorMap[e.anchor]=l),C=e.input.charCodeAt(++e.position);C!==0;){if(Dt(e,!0,t),C=e.input.charCodeAt(e.position),C===p)return e.position++,e.tag=s,e.anchor=u,e.kind=h?"mapping":"sequence",e.result=l,!0;n?C===44&&Pe(e,"expected the node content, but found ','"):Pe(e,"missed comma between flow collection entries"),T=y=g=null,a=d=!1,C===63&&(c=e.input.charCodeAt(e.position+1),hn(c)&&(a=d=!0,e.position++,Dt(e,!0,t))),r=e.line,o=e.lineStart,i=e.position,us(e,t,ia,!1,!0),T=e.tag,y=e.result,Dt(e,!0,t),C=e.input.charCodeAt(e.position),(d||e.line===r)&&C===58&&(a=!0,C=e.input.charCodeAt(++e.position),Dt(e,!0,t),us(e,t,ia,!1,!0),g=e.result),h?Go(e,l,m,T,y,g,r,o,i):a?l.push(Go(e,null,m,T,y,g,r,o,i)):l.push(y),Dt(e,!0,t),C=e.input.charCodeAt(e.position),C===44?(n=!0,C=e.input.charCodeAt(++e.position)):n=!1}Pe(e,"unexpected end of the stream within a flow collection")}function A1(e,t){var n,r,o=gl,i=!1,s=!1,l=t,u=0,c=!1,p,a;if(a=e.input.charCodeAt(e.position),a===124)r=!1;else if(a===62)r=!0;else return!1;for(e.kind="scalar",e.result="";a!==0;)if(a=e.input.charCodeAt(++e.position),a===43||a===45)gl===o?o=a===43?ap:y1:Pe(e,"repeat of a chomping mode identifier");else if((p=w1(a))>=0)p===0?Pe(e,"bad explicit indentation width of a block scalar; it cannot be less than one"):s?Pe(e,"repeat of an indentation width identifier"):(l=t+p-1,s=!0);else break;if(So(a)){do a=e.input.charCodeAt(++e.position);while(So(a));if(a===35)do a=e.input.charCodeAt(++e.position);while(!or(a)&&a!==0)}for(;a!==0;){for(Xc(e),e.lineIndent=0,a=e.input.charCodeAt(e.position);(!s||e.lineIndent<l)&&a===32;)e.lineIndent++,a=e.input.charCodeAt(++e.position);if(!s&&e.lineIndent>l&&(l=e.lineIndent),or(a)){u++;continue}if(e.lineIndent<l){o===ap?e.result+=Rt.repeat(`
`,i?1+u:u):o===gl&&i&&(e.result+=`
`);break}for(r?So(a)?(c=!0,e.result+=Rt.repeat(`
`,i?1+u:u)):c?(c=!1,e.result+=Rt.repeat(`
`,u+1)):u===0?i&&(e.result+=" "):e.result+=Rt.repeat(`
`,u):e.result+=Rt.repeat(`
`,i?1+u:u),i=!0,s=!0,u=0,n=e.position;!or(a)&&a!==0;)a=e.input.charCodeAt(++e.position);Gr(e,n,e.position,!1)}return!0}function pp(e,t){var n,r=e.tag,o=e.anchor,i=[],s,l=!1,u;if(e.firstTabInLine!==-1)return!1;for(e.anchor!==null&&(e.anchorMap[e.anchor]=i),u=e.input.charCodeAt(e.position);u!==0&&(e.firstTabInLine!==-1&&(e.position=e.firstTabInLine,Pe(e,"tab characters must not be used in indentation")),!(u!==45||(s=e.input.charCodeAt(e.position+1),!hn(s))));){if(l=!0,e.position++,Dt(e,!0,-1)&&e.lineIndent<=t){i.push(null),u=e.input.charCodeAt(e.position);continue}if(n=e.line,us(e,t,yy,!1,!0),i.push(e.result),Dt(e,!0,-1),u=e.input.charCodeAt(e.position),(e.line===n||e.lineIndent>t)&&u!==0)Pe(e,"bad indentation of a sequence entry");else if(e.lineIndent<t)break}return l?(e.tag=r,e.anchor=o,e.kind="sequence",e.result=i,!0):!1}function I1(e,t,n){var r,o,i,s,l,u,c=e.tag,p=e.anchor,a={},d=Object.create(null),h=null,m=null,y=null,T=!1,g=!1,C;if(e.firstTabInLine!==-1)return!1;for(e.anchor!==null&&(e.anchorMap[e.anchor]=a),C=e.input.charCodeAt(e.position);C!==0;){if(!T&&e.firstTabInLine!==-1&&(e.position=e.firstTabInLine,Pe(e,"tab characters must not be used in indentation")),r=e.input.charCodeAt(e.position+1),i=e.line,(C===63||C===58)&&hn(r))C===63?(T&&(Go(e,a,d,h,m,null,s,l,u),h=m=y=null),g=!0,T=!0,o=!0):T?(T=!1,o=!0):Pe(e,"incomplete explicit mapping pair; a key node is missed; or followed by a non-tabulated empty line"),e.position+=1,C=r;else{if(s=e.line,l=e.lineStart,u=e.position,!us(e,n,my,!1,!0))break;if(e.line===i){for(C=e.input.charCodeAt(e.position);So(C);)C=e.input.charCodeAt(++e.position);if(C===58)C=e.input.charCodeAt(++e.position),hn(C)||Pe(e,"a whitespace character is expected after the key-value separator within a block mapping"),T&&(Go(e,a,d,h,m,null,s,l,u),h=m=y=null),g=!0,T=!1,o=!1,h=e.tag,m=e.result;else if(g)Pe(e,"can not read an implicit mapping pair; a colon is missed");else return e.tag=c,e.anchor=p,!0}else if(g)Pe(e,"can not read a block mapping entry; a multiline key may not be an implicit key");else return e.tag=c,e.anchor=p,!0}if((e.line===i||e.lineIndent>t)&&(T&&(s=e.line,l=e.lineStart,u=e.position),us(e,t,aa,!0,o)&&(T?m=e.result:y=e.result),T||(Go(e,a,d,h,m,y,s,l,u),h=m=y=null),Dt(e,!0,-1),C=e.input.charCodeAt(e.position)),(e.line===i||e.lineIndent>t)&&C!==0)Pe(e,"bad indentation of a mapping entry");else if(e.lineIndent<t)break}return T&&Go(e,a,d,h,m,null,s,l,u),g&&(e.tag=c,e.anchor=p,e.kind="mapping",e.result=a),g}function P1(e){var t,n=!1,r=!1,o,i,s;if(s=e.input.charCodeAt(e.position),s!==33)return!1;if(e.tag!==null&&Pe(e,"duplication of a tag property"),s=e.input.charCodeAt(++e.position),s===60?(n=!0,s=e.input.charCodeAt(++e.position)):s===33?(r=!0,o="!!",s=e.input.charCodeAt(++e.position)):o="!",t=e.position,n){do s=e.input.charCodeAt(++e.position);while(s!==0&&s!==62);e.position<e.length?(i=e.input.slice(t,e.position),s=e.input.charCodeAt(++e.position)):Pe(e,"unexpected end of the stream within a verbatim tag")}else{for(;s!==0&&!hn(s);)s===33&&(r?Pe(e,"tag suffix cannot contain exclamation marks"):(o=e.input.slice(t-1,e.position+1),gy.test(o)||Pe(e,"named tag handle cannot contain such characters"),r=!0,t=e.position+1)),s=e.input.charCodeAt(++e.position);i=e.input.slice(t,e.position),b1.test(i)&&Pe(e,"tag suffix cannot contain flow indicator characters")}i&&!vy.test(i)&&Pe(e,"tag name cannot contain such characters: "+i);try{i=decodeURIComponent(i)}catch{Pe(e,"tag name is malformed: "+i)}return n?e.tag=i:Qr.call(e.tagMap,o)?e.tag=e.tagMap[o]+i:o==="!"?e.tag="!"+i:o==="!!"?e.tag="tag:yaml.org,2002:"+i:Pe(e,'undeclared tag handle "'+o+'"'),!0}function j1(e){var t,n;if(n=e.input.charCodeAt(e.position),n!==38)return!1;for(e.anchor!==null&&Pe(e,"duplication of an anchor property"),n=e.input.charCodeAt(++e.position),t=e.position;n!==0&&!hn(n)&&!Ko(n);)n=e.input.charCodeAt(++e.position);return e.position===t&&Pe(e,"name of an anchor node must contain at least one character"),e.anchor=e.input.slice(t,e.position),!0}function E1(e){var t,n,r;if(r=e.input.charCodeAt(e.position),r!==42)return!1;for(r=e.input.charCodeAt(++e.position),t=e.position;r!==0&&!hn(r)&&!Ko(r);)r=e.input.charCodeAt(++e.position);return e.position===t&&Pe(e,"name of an alias node must contain at least one character"),n=e.input.slice(t,e.position),Qr.call(e.anchorMap,n)||Pe(e,'unidentified alias "'+n+'"'),e.result=e.anchorMap[n],Dt(e,!0,-1),!0}function us(e,t,n,r,o){var i,s,l,u=1,c=!1,p=!1,a,d,h,m,y,T;if(e.listener!==null&&e.listener("open",e),e.tag=null,e.anchor=null,e.kind=null,e.result=null,i=s=l=aa===n||yy===n,r&&Dt(e,!0,-1)&&(c=!0,e.lineIndent>t?u=1:e.lineIndent===t?u=0:e.lineIndent<t&&(u=-1)),u===1)for(;P1(e)||j1(e);)Dt(e,!0,-1)?(c=!0,l=i,e.lineIndent>t?u=1:e.lineIndent===t?u=0:e.lineIndent<t&&(u=-1)):l=!1;if(l&&(l=c||o),(u===1||aa===n)&&(ia===n||my===n?y=t:y=t+1,T=e.position-e.lineStart,u===1?l&&(pp(e,T)||I1(e,T,y))||O1(e,y)?p=!0:(s&&A1(e,y)||x1(e,y)||$1(e,y)?p=!0:E1(e)?(p=!0,(e.tag!==null||e.anchor!==null)&&Pe(e,"alias node should not have any properties")):C1(e,y,ia===n)&&(p=!0,e.tag===null&&(e.tag="?")),e.anchor!==null&&(e.anchorMap[e.anchor]=e.result)):u===0&&(p=l&&pp(e,T))),e.tag===null)e.anchor!==null&&(e.anchorMap[e.anchor]=e.result);else if(e.tag==="?"){for(e.result!==null&&e.kind!=="scalar"&&Pe(e,'unacceptable node kind for !<?> tag; it should be "scalar", not "'+e.kind+'"'),a=0,d=e.implicitTypes.length;a<d;a+=1)if(m=e.implicitTypes[a],m.resolve(e.result)){e.result=m.construct(e.result),e.tag=m.tag,e.anchor!==null&&(e.anchorMap[e.anchor]=e.result);break}}else if(e.tag!=="!"){if(Qr.call(e.typeMap[e.kind||"fallback"],e.tag))m=e.typeMap[e.kind||"fallback"][e.tag];else for(m=null,h=e.typeMap.multi[e.kind||"fallback"],a=0,d=h.length;a<d;a+=1)if(e.tag.slice(0,h[a].tag.length)===h[a].tag){m=h[a];break}m||Pe(e,"unknown tag !<"+e.tag+">"),e.result!==null&&m.kind!==e.kind&&Pe(e,"unacceptable node kind for !<"+e.tag+'> tag; it should be "'+m.kind+'", not "'+e.kind+'"'),m.resolve(e.result,e.tag)?(e.result=m.construct(e.result,e.tag),e.anchor!==null&&(e.anchorMap[e.anchor]=e.result)):Pe(e,"cannot resolve a node with !<"+e.tag+"> explicit tag")}return e.listener!==null&&e.listener("close",e),e.tag!==null||e.anchor!==null||p}function N1(e){var t=e.position,n,r,o,i=!1,s;for(e.version=null,e.checkLineBreaks=e.legacy,e.tagMap=Object.create(null),e.anchorMap=Object.create(null);(s=e.input.charCodeAt(e.position))!==0&&(Dt(e,!0,-1),s=e.input.charCodeAt(e.position),!(e.lineIndent>0||s!==37));){for(i=!0,s=e.input.charCodeAt(++e.position),n=e.position;s!==0&&!hn(s);)s=e.input.charCodeAt(++e.position);for(r=e.input.slice(n,e.position),o=[],r.length<1&&Pe(e,"directive name must not be less than one character in length");s!==0;){for(;So(s);)s=e.input.charCodeAt(++e.position);if(s===35){do s=e.input.charCodeAt(++e.position);while(s!==0&&!or(s));break}if(or(s))break;for(n=e.position;s!==0&&!hn(s);)s=e.input.charCodeAt(++e.position);o.push(e.input.slice(n,e.position))}s!==0&&Xc(e),Qr.call(up,r)?up[r](e,r,o):la(e,'unknown document directive "'+r+'"')}if(Dt(e,!0,-1),e.lineIndent===0&&e.input.charCodeAt(e.position)===45&&e.input.charCodeAt(e.position+1)===45&&e.input.charCodeAt(e.position+2)===45?(e.position+=3,Dt(e,!0,-1)):i&&Pe(e,"directives end mark is expected"),us(e,e.lineIndent-1,aa,!1,!0),Dt(e,!0,-1),e.checkLineBreaks&&v1.test(e.input.slice(t,e.position))&&la(e,"non-ASCII line breaks are interpreted as content"),e.documents.push(e.result),e.position===e.lineStart&&Ua(e)){e.input.charCodeAt(e.position)===46&&(e.position+=3,Dt(e,!0,-1));return}if(e.position<e.length-1)Pe(e,"end of the stream or a document separator is expected");else return}function wy(e,t){e=String(e),t=t||{},e.length!==0&&(e.charCodeAt(e.length-1)!==10&&e.charCodeAt(e.length-1)!==13&&(e+=`
`),e.charCodeAt(0)===65279&&(e=e.slice(1)));var n=new S1(e,t),r=e.indexOf("\0");for(r!==-1&&(n.position=r,Pe(n,"null byte is not allowed in input")),n.input+="\0";n.input.charCodeAt(n.position)===32;)n.lineIndent+=1,n.position+=1;for(;n.position<n.length-1;)N1(n);return n.documents}function M1(e,t,n){t!==null&&typeof t=="object"&&typeof n>"u"&&(n=t,t=null);var r=wy(e,n);if(typeof t!="function")return r;for(var o=0,i=r.length;o<i;o+=1)t(r[o])}function L1(e,t){var n=wy(e,t);if(n.length!==0){if(n.length===1)return n[0];throw new ln("expected a single document in the stream, but found more")}}var D1=M1,R1=L1,ky={loadAll:D1,load:R1},Sy=Object.prototype.toString,Cy=Object.prototype.hasOwnProperty,eu=65279,F1=9,ri=10,B1=13,U1=32,q1=33,V1=34,zl=35,H1=37,K1=38,G1=39,W1=42,xy=44,z1=45,ca=58,Q1=61,J1=62,Y1=63,X1=64,$y=91,Oy=93,Z1=96,Ay=123,ek=124,Iy=125,en={};en[0]="\\0";en[7]="\\a";en[8]="\\b";en[9]="\\t";en[10]="\\n";en[11]="\\v";en[12]="\\f";en[13]="\\r";en[27]="\\e";en[34]='\\"';en[92]="\\\\";en[133]="\\N";en[160]="\\_";en[8232]="\\L";en[8233]="\\P";var tk=["y","Y","yes","Yes","YES","on","On","ON","n","N","no","No","NO","off","Off","OFF"],nk=/^[-+]?[0-9_]+(?::[0-9_]+)+(?:\.[0-9_]*)?$/;function rk(e,t){var n,r,o,i,s,l,u;if(t===null)return{};for(n={},r=Object.keys(t),o=0,i=r.length;o<i;o+=1)s=r[o],l=String(t[s]),s.slice(0,2)==="!!"&&(s="tag:yaml.org,2002:"+s.slice(2)),u=e.compiledTypeMap.fallback[s],u&&Cy.call(u.styleAliases,l)&&(l=u.styleAliases[l]),n[s]=l;return n}function ok(e){var t,n,r;if(t=e.toString(16).toUpperCase(),e<=255)n="x",r=2;else if(e<=65535)n="u",r=4;else if(e<=4294967295)n="U",r=8;else throw new ln("code point within a string may not be greater than 0xFFFFFFFF");return"\\"+n+Rt.repeat("0",r-t.length)+t}var sk=1,oi=2;function ik(e){this.schema=e.schema||Yc,this.indent=Math.max(1,e.indent||2),this.noArrayIndent=e.noArrayIndent||!1,this.skipInvalid=e.skipInvalid||!1,this.flowLevel=Rt.isNothing(e.flowLevel)?-1:e.flowLevel,this.styleMap=rk(this.schema,e.styles||null),this.sortKeys=e.sortKeys||!1,this.lineWidth=e.lineWidth||80,this.noRefs=e.noRefs||!1,this.noCompatMode=e.noCompatMode||!1,this.condenseFlow=e.condenseFlow||!1,this.quotingType=e.quotingType==='"'?oi:sk,this.forceQuotes=e.forceQuotes||!1,this.replacer=typeof e.replacer=="function"?e.replacer:null,this.implicitTypes=this.schema.compiledImplicit,this.explicitTypes=this.schema.compiledExplicit,this.tag=null,this.result="",this.duplicates=[],this.usedDuplicates=null}function fp(e,t){for(var n=Rt.repeat(" ",t),r=0,o=-1,i="",s,l=e.length;r<l;)o=e.indexOf(`
`,r),o===-1?(s=e.slice(r),r=l):(s=e.slice(r,o+1),r=o+1),s.length&&s!==`
`&&(i+=n),i+=s;return i}function Ql(e,t){return`
`+Rt.repeat(" ",e.indent*t)}function ak(e,t){var n,r,o;for(n=0,r=e.implicitTypes.length;n<r;n+=1)if(o=e.implicitTypes[n],o.resolve(t))return!0;return!1}function ua(e){return e===U1||e===F1}function si(e){return 32<=e&&e<=126||161<=e&&e<=55295&&e!==8232&&e!==8233||57344<=e&&e<=65533&&e!==eu||65536<=e&&e<=1114111}function hp(e){return si(e)&&e!==eu&&e!==B1&&e!==ri}function mp(e,t,n){var r=hp(e),o=r&&!ua(e);return(n?r:r&&e!==xy&&e!==$y&&e!==Oy&&e!==Ay&&e!==Iy)&&e!==zl&&!(t===ca&&!o)||hp(t)&&!ua(t)&&e===zl||t===ca&&o}function lk(e){return si(e)&&e!==eu&&!ua(e)&&e!==z1&&e!==Y1&&e!==ca&&e!==xy&&e!==$y&&e!==Oy&&e!==Ay&&e!==Iy&&e!==zl&&e!==K1&&e!==W1&&e!==q1&&e!==ek&&e!==Q1&&e!==J1&&e!==G1&&e!==V1&&e!==H1&&e!==X1&&e!==Z1}function ck(e){return!ua(e)&&e!==ca}function As(e,t){var n=e.charCodeAt(t),r;return n>=55296&&n<=56319&&t+1<e.length&&(r=e.charCodeAt(t+1),r>=56320&&r<=57343)?(n-55296)*1024+r-56320+65536:n}function Py(e){var t=/^\n* /;return t.test(e)}var jy=1,Jl=2,Ey=3,Ny=4,Vo=5;function uk(e,t,n,r,o,i,s,l){var u,c=0,p=null,a=!1,d=!1,h=r!==-1,m=-1,y=lk(As(e,0))&&ck(As(e,e.length-1));if(t||s)for(u=0;u<e.length;c>=65536?u+=2:u++){if(c=As(e,u),!si(c))return Vo;y=y&&mp(c,p,l),p=c}else{for(u=0;u<e.length;c>=65536?u+=2:u++){if(c=As(e,u),c===ri)a=!0,h&&(d=d||u-m-1>r&&e[m+1]!==" ",m=u);else if(!si(c))return Vo;y=y&&mp(c,p,l),p=c}d=d||h&&u-m-1>r&&e[m+1]!==" "}return!a&&!d?y&&!s&&!o(e)?jy:i===oi?Vo:Jl:n>9&&Py(e)?Vo:s?i===oi?Vo:Jl:d?Ny:Ey}function dk(e,t,n,r,o){e.dump=function(){if(t.length===0)return e.quotingType===oi?'""':"''";if(!e.noCompatMode&&(tk.indexOf(t)!==-1||nk.test(t)))return e.quotingType===oi?'"'+t+'"':"'"+t+"'";var i=e.indent*Math.max(1,n),s=e.lineWidth===-1?-1:Math.max(Math.min(e.lineWidth,40),e.lineWidth-i),l=r||e.flowLevel>-1&&n>=e.flowLevel;function u(c){return ak(e,c)}switch(uk(t,l,e.indent,s,u,e.quotingType,e.forceQuotes&&!r,o)){case jy:return t;case Jl:return"'"+t.replace(/'/g,"''")+"'";case Ey:return"|"+yp(t,e.indent)+gp(fp(t,i));case Ny:return">"+yp(t,e.indent)+gp(fp(pk(t,s),i));case Vo:return'"'+fk(t)+'"';default:throw new ln("impossible error: invalid scalar style")}}()}function yp(e,t){var n=Py(e)?String(t):"",r=e[e.length-1]===`
`,o=r&&(e[e.length-2]===`
`||e===`
`),i=o?"+":r?"":"-";return n+i+`
`}function gp(e){return e[e.length-1]===`
`?e.slice(0,-1):e}function pk(e,t){for(var n=/(\n+)([^\n]*)/g,r=function(){var c=e.indexOf(`
`);return c=c!==-1?c:e.length,n.lastIndex=c,vp(e.slice(0,c),t)}(),o=e[0]===`
`||e[0]===" ",i,s;s=n.exec(e);){var l=s[1],u=s[2];i=u[0]===" ",r+=l+(!o&&!i&&u!==""?`
`:"")+vp(u,t),o=i}return r}function vp(e,t){if(e===""||e[0]===" ")return e;for(var n=/ [^ ]/g,r,o=0,i,s=0,l=0,u="";r=n.exec(e);)l=r.index,l-o>t&&(i=s>o?s:l,u+=`
`+e.slice(o,i),o=i+1),s=l;return u+=`
`,e.length-o>t&&s>o?u+=e.slice(o,s)+`
`+e.slice(s+1):u+=e.slice(o),u.slice(1)}function fk(e){for(var t="",n=0,r,o=0;o<e.length;n>=65536?o+=2:o++)n=As(e,o),r=en[n],!r&&si(n)?(t+=e[o],n>=65536&&(t+=e[o+1])):t+=r||ok(n);return t}function hk(e,t,n){var r="",o=e.tag,i,s,l;for(i=0,s=n.length;i<s;i+=1)l=n[i],e.replacer&&(l=e.replacer.call(n,String(i),l)),(xr(e,t,l,!1,!1)||typeof l>"u"&&xr(e,t,null,!1,!1))&&(r!==""&&(r+=","+(e.condenseFlow?"":" ")),r+=e.dump);e.tag=o,e.dump="["+r+"]"}function bp(e,t,n,r){var o="",i=e.tag,s,l,u;for(s=0,l=n.length;s<l;s+=1)u=n[s],e.replacer&&(u=e.replacer.call(n,String(s),u)),(xr(e,t+1,u,!0,!0,!1,!0)||typeof u>"u"&&xr(e,t+1,null,!0,!0,!1,!0))&&((!r||o!=="")&&(o+=Ql(e,t)),e.dump&&ri===e.dump.charCodeAt(0)?o+="-":o+="- ",o+=e.dump);e.tag=i,e.dump=o||"[]"}function mk(e,t,n){var r="",o=e.tag,i=Object.keys(n),s,l,u,c,p;for(s=0,l=i.length;s<l;s+=1)p="",r!==""&&(p+=", "),e.condenseFlow&&(p+='"'),u=i[s],c=n[u],e.replacer&&(c=e.replacer.call(n,u,c)),xr(e,t,u,!1,!1)&&(e.dump.length>1024&&(p+="? "),p+=e.dump+(e.condenseFlow?'"':"")+":"+(e.condenseFlow?"":" "),xr(e,t,c,!1,!1)&&(p+=e.dump,r+=p));e.tag=o,e.dump="{"+r+"}"}function yk(e,t,n,r){var o="",i=e.tag,s=Object.keys(n),l,u,c,p,a,d;if(e.sortKeys===!0)s.sort();else if(typeof e.sortKeys=="function")s.sort(e.sortKeys);else if(e.sortKeys)throw new ln("sortKeys must be a boolean or a function");for(l=0,u=s.length;l<u;l+=1)d="",(!r||o!=="")&&(d+=Ql(e,t)),c=s[l],p=n[c],e.replacer&&(p=e.replacer.call(n,c,p)),xr(e,t+1,c,!0,!0,!0)&&(a=e.tag!==null&&e.tag!=="?"||e.dump&&e.dump.length>1024,a&&(e.dump&&ri===e.dump.charCodeAt(0)?d+="?":d+="? "),d+=e.dump,a&&(d+=Ql(e,t)),xr(e,t+1,p,!0,a)&&(e.dump&&ri===e.dump.charCodeAt(0)?d+=":":d+=": ",d+=e.dump,o+=d));e.tag=i,e.dump=o||"{}"}function _p(e,t,n){var r,o,i,s,l,u;for(o=n?e.explicitTypes:e.implicitTypes,i=0,s=o.length;i<s;i+=1)if(l=o[i],(l.instanceOf||l.predicate)&&(!l.instanceOf||typeof t=="object"&&t instanceof l.instanceOf)&&(!l.predicate||l.predicate(t))){if(n?l.multi&&l.representName?e.tag=l.representName(t):e.tag=l.tag:e.tag="?",l.represent){if(u=e.styleMap[l.tag]||l.defaultStyle,Sy.call(l.represent)==="[object Function]")r=l.represent(t,u);else if(Cy.call(l.represent,u))r=l.represent[u](t,u);else throw new ln("!<"+l.tag+'> tag resolver accepts not "'+u+'" style');e.dump=r}return!0}return!1}function xr(e,t,n,r,o,i,s){e.tag=null,e.dump=n,_p(e,n,!1)||_p(e,n,!0);var l=Sy.call(e.dump),u=r,c;r&&(r=e.flowLevel<0||e.flowLevel>t);var p=l==="[object Object]"||l==="[object Array]",a,d;if(p&&(a=e.duplicates.indexOf(n),d=a!==-1),(e.tag!==null&&e.tag!=="?"||d||e.indent!==2&&t>0)&&(o=!1),d&&e.usedDuplicates[a])e.dump="*ref_"+a;else{if(p&&d&&!e.usedDuplicates[a]&&(e.usedDuplicates[a]=!0),l==="[object Object]")r&&Object.keys(e.dump).length!==0?(yk(e,t,e.dump,o),d&&(e.dump="&ref_"+a+e.dump)):(mk(e,t,e.dump),d&&(e.dump="&ref_"+a+" "+e.dump));else if(l==="[object Array]")r&&e.dump.length!==0?(e.noArrayIndent&&!s&&t>0?bp(e,t-1,e.dump,o):bp(e,t,e.dump,o),d&&(e.dump="&ref_"+a+e.dump)):(hk(e,t,e.dump),d&&(e.dump="&ref_"+a+" "+e.dump));else if(l==="[object String]")e.tag!=="?"&&dk(e,e.dump,t,i,u);else{if(l==="[object Undefined]"||e.skipInvalid)return!1;throw new ln("unacceptable kind of an object to dump "+l)}e.tag!==null&&e.tag!=="?"&&(c=encodeURI(e.tag[0]==="!"?e.tag.slice(1):e.tag).replace(/!/g,"%21"),e.tag[0]==="!"?c="!"+c:c.slice(0,18)==="tag:yaml.org,2002:"?c="!!"+c.slice(18):c="!<"+c+">",e.dump=c+" "+e.dump)}return!0}function gk(e,t){var n=[],r=[],o,i;for(Yl(e,n,r),o=0,i=r.length;o<i;o+=1)t.duplicates.push(n[r[o]]);t.usedDuplicates=new Array(i)}function Yl(e,t,n){var r,o,i;if(e!==null&&typeof e=="object")if(o=t.indexOf(e),o!==-1)n.indexOf(o)===-1&&n.push(o);else if(t.push(e),Array.isArray(e))for(o=0,i=e.length;o<i;o+=1)Yl(e[o],t,n);else for(r=Object.keys(e),o=0,i=r.length;o<i;o+=1)Yl(e[r[o]],t,n)}function vk(e,t){t=t||{};var n=new ik(t);n.noRefs||gk(e,n);var r=e;return n.replacer&&(r=n.replacer.call({"":r},"",r)),xr(n,0,r,!0,!0)?n.dump+`
`:""}var bk=vk,_k={dump:bk};function tu(e,t){return function(){throw new Error("Function yaml."+e+" is removed in js-yaml 4. Use yaml."+t+" instead, which is now safe by default.")}}var Tk=Kt,wk=Jm,kk=ey,Sk=sy,Ck=iy,xk=Yc,$k=ky.load,Ok=ky.loadAll,Ak=_k.dump,Ik=ln,Pk={binary:dy,float:oy,map:Zm,null:ty,pairs:fy,set:hy,timestamp:cy,bool:ny,int:ry,merge:uy,omap:py,seq:Xm,str:Ym},jk=tu("safeLoad","load"),Ek=tu("safeLoadAll","loadAll"),Nk=tu("safeDump","dump"),Mk={Type:Tk,Schema:wk,FAILSAFE_SCHEMA:kk,JSON_SCHEMA:Sk,CORE_SCHEMA:Ck,DEFAULT_SCHEMA:xk,load:$k,loadAll:Ok,dump:Ak,YAMLException:Ik,types:Pk,safeLoad:jk,safeLoadAll:Ek,safeDump:Nk};function nu(e){return new Promise((t,n)=>{const r=new XMLHttpRequest;r.onload=function(){r.status>=200&&r.status<300?t(r.responseText):(Te(`Failed to load file ${e}`,r.status),n(r.status))},r.open("GET",e),r.send()})}async function qa(e){try{const t=await nu(e);let n;if(e.endsWith(".json"))n=JSON.parse(t);else if(e.endsWith(".yaml"))n=Mk.load(t);else{const r=`Unsupported file type for data file ${e} (must be .json or .yaml)`;throw new Error(r)}if(!n)throw new Error(`Data loaded from ${e} is empty`);return n}catch(t){throw console.error(`Failed to load data file ${e}: ${t}`),t}}const Lk=(e,t)=>{const n={};for(const r in e)n[r]=t(e[r]);return n},My=(e,t)=>{for(const n in e){const r=e[n];t(r,n,e),typeof r=="object"&&r!==null&&My(r,t)}},mo={};async function Dk(e){return mo[e]?mo[e]:Ly(e,e)}async function Rk(e){qn.log("Loading images");const t=[],n=async(o,i)=>await Ly(o,i),r=(o,i)=>{t.push(n(o,i))};for(const o in e.common.images){const i=e.common.images[o];r(o,i)}if(e.preload.images)for(const o in e.preload.images.assets){const i=e.preload.images.assets[o];r(o,i)}for(const o in e.screens.screens){const i=e.screens.screens[o];if(i.background&&!e.common.images[i.background]&&!i.video&&r(i.background,i.background),i.buttons)for(const s in i.buttons){const l=i.buttons[s];typeof l=="object"&&l.background&&!e.common.images[l.background]&&r(l.background,l.background)}}return Promise.all(t)}async function Ly(e,t){if(mo[e])return mo[e];if(t===Fa){const r=new Image;return mo[e]=r,r}const n=new Promise((r,o)=>{const i=new Image;i.onload=()=>{mo[e]=i,r(i)},i.onerror=s=>{Te(`Failed to load image ${e} at ${t}`,s),o(s)},i.src=Zt(t)});return mo[e]=n,n}const Vi={};function Fk(e){return Vi[e]??{}}function Tp(e,t,n){const r=Fk(e.transition),o=e.duration??r.duration??500,i=e.delay??r.delay??0;return{...e,resolve:n,duration:o,delay:i,oldScreen:t}}const un=Ot("notifications",{state:()=>({notifications:[],enabled:!0}),actions:{async addNotification(e,t,n){if(!this.enabled)return;e=Cr(e);const r=`${Date.now()}-${Math.random()*1e4}`;this.notifications.push({id:r,text:e,description:t,icon:n}),ve().notifications.alsoPrintInDialogue&&Wm(`[NOTIFICATION] ${e}`),await cn(ve().notifications.timeOnScreen*1e3),this.deleteNotification(r)},deleteNotification(e){const t=this.findNotifications(e);t&&this.notifications.splice(this.notifications.indexOf(t),1)},findNotifications(e){return this.notifications.find(t=>t.id===e)},disableNotifications(){this.enabled=!1;for(const e in this.notifications)this.deleteNotification(e)},enableNotifications(){this.enabled=!0}}}),Xt=Ot("inventory",{state:()=>({items:{},interactionTags:{}}),actions:{generateSaveData(){return{items:ze(this.items),interactionTags:ze(this.interactionTags)}},loadSaveData(e){this.items={...this.items,...ze(e.items)},this.interactionTags={...ze(e.interactionTags)}},updateConfig(e){Object.keys(e.items).forEach(t=>{this.items[t]||(this.items[t]={amount:0,id:t})})},reset(e){this.$reset(),this.updateConfig(e)},hasItem(e,t){var n;return t||(t=1),((n=this.items[e])==null?void 0:n.amount)>=t},getExistingItem(e){return this.items[e]},getItemAmount(e){var t;return((t=this.getExistingItem(e))==null?void 0:t.amount)||0},add(e){const t=this.getExistingItem(e.id);t?t.amount+=e.amount:this.items[e.id]={...e};const n=tr(e.id).name,r=e.amount>1?`${n} x ${e.amount}`:n;un().addNotification(`Received item: ${r}`)},enableInteraction(e){e||(e="default"),this.interactionTags[e]={blockedInteraction:!1}},disableInteraction(e){e||(e="default"),this.interactionTags[e]={blockedInteraction:!0}},onScriptStart(){const e=ve().interactionTags;Object.keys(e).forEach(t=>{e[t].onlyInteractOutsideOfScripts&&this.disableInteraction(t)})},onScriptEnd(){const e=ve().interactionTags;Object.keys(e).forEach(t=>{e[t].onlyInteractOutsideOfScripts&&this.enableInteraction(t)})},isInteractionTagBlocked(e){return e||(e="default"),this.interactionTags[e]?this.interactionTags[e].blockedInteraction:!1},remove(e){const t=this.getExistingItem(e.id);t&&(t.amount-=e.amount,un().addNotification(`Lost item: ${tr(e.id).name} x ${e.amount}`),t.amount<=0&&this.deleteItem(e.id))},deleteItem(e){this.getExistingItem(e)&&(this.items[e].amount=0)},canUseItem(e){var t;const n=tr(e.id);return!!(n&&n.onUse&&!this.isInteractionTagBlocked(n.tag)&&!((t=rt().currentDialog)!=null&&t.choices))},useItem(e){let t=!1;const n=tr(e.id);if(e&&this.canUseItem(e)&&n){const r=n.onUse;t=!0,ms("onItemUsed"),r.action==="jump"?Ue().jumpToLabel(r.label):r.action==="run"?Ue().runThenGoBackToPreviousDialog(r.label,!0):(t=!1,Te(`Unknown action ${r.action}`))}return t}}}),Bk=()=>({layers:[{screen:"default"}],buttons:{}}),Vn=Ot("screens",{state:Bk,actions:{setScreen(e,t,n){return new Promise(r=>{const o=this.layers[t||0];let i;const s=(o==null?void 0:o.screen)??null;if(s===e){r();return}n&&(i=Tp(n,s,r)),this.layers[t||0]={screen:e,transition:i},i||r()})},finishTransition(e){const t=this.layers[e];if(!t)Te(`Tried to finish transition on layer ${e} but it doesn't exist`);else if(t.transition){const n=t.transition.resolve;delete t.transition,n()}},transitionScreen(e,t,n){return this.setScreen(e,n??0,t)},emptyLayer(e,t){return new Promise(n=>{const r=this.layers[e];if(!r){ys(`Tried to empty layer ${e} but it doesn't exist`);return}if(t){const o=r.screen,i=Tp(t,o,n);r.transition=i}r.screen="@empty",t||n()})},updateConfig(e){console.log("update config!");const t=ft().buttons.buttons;for(const n in t)this.buttons[n]||(this.buttons[n]={state:t[n].enabled})},reset(e){this.$reset(),this.updateConfig(e)},changeButton(e,t){if(!this.buttons[e]){Te(`Tried to change button ${e} but it doesn't exist`);return}this.buttons[e].state=t},generateSaveData(){return{layers:ze(this.layers).filter(e=>e).map(e=>e.screen??null),buttons:ze(this.buttons)}},loadSaveData(e){this.layers=ze(e.layers).map(t=>(t!==null&&typeof t!="string"&&(t=null),{screen:t})),this.buttons=Ao(this.buttons,ze(e.buttons))},isButtonDisabled(e){const t=this.getButtonState(e);return t==="hidden"||t==="greyed"||t===!1},isButtonInteractible(e){const t=this.getButtonState(e);return t?t===!0:!1},isButtonClickable(e){if(!this.isButtonInteractible(e))return!1;const t=xo(e);return!!Va(t)},getButtonState(e){const t=xo(e),n=this.buttons[e],r=t.tag||"default",o=n.state;return o===!0&&Xt().isInteractionTagBlocked(r)?"greyed":o},clickOnButton(e){if(!this.isButtonClickable(e))return;const t=Ue(),n=xo(e);ms("onButtonClicked");const r=n.action;r&&(n.actionType==="run"?t.runLabelFunction(r):t.jumpToLabel(r))}},getters:{nonEmptyLayers(e){return e.layers.filter(t=>t)},isTransitioning(e){return e.layers.some(t=>t==null?void 0:t.transition)}}});function Va(e){if(!Le().inScript)return!0;const t=Qu().clickableDuringScriptsByDefault;if(t)return e.scriptClickable!==!1;if(!t)return e.scriptClickable===!0}const Uk=["screenObject","sprite"];function wp(e){return typeof e=="object"&&e!==null&&Uk.includes(e._entityType)}function qk(e){return typeof e=="object"&&e!==null&&e._entityType==="sprite"}function Vk(e){if(e.includes(" ")){const t=e.split(" ");return{label:t[0],args:t.slice(1)}}else return{label:e}}const An=Ot("screenObjects",{state:()=>({tree:[],objectsList:{}}),actions:{addObject(e){e.parent?e.parent.children.push(e):this.tree.push(e),this.objectsList[e.id]=e},createObject(e){const t={_entityType:"screenObject",id:as(),name:"Screen Object",tags:[],x:0,y:0,anchor:{x:0,y:0},width:1,height:1,opacity:1,scale:1,layer:0,children:[],...e};return this.addObject(t),t},destroyObject(e){let t=e;typeof t=="string"&&(t=this.getObject(t));for(let n=t.children.length-1;n>=0;n--)this.destroyObject(t.children[n]);if(t.parent){const n=t.parent,r=n.children.indexOf(t);r!==-1?n.children.splice(r,1):console.warn(`Could not find object ${t.id} in parent's children`)}else{const n=this.tree.indexOf(t);n!==-1?this.tree.splice(n,1):console.warn(`Object to destroy not found in store (${t.id})`)}delete this.objectsList[t.id]},createSprite(e){const t=this.createObject(e);return t._entityType="sprite",Dk(e.image).then(n=>{const r=this.getObject(t.id);r.width===1&&r.height===1&&(r.width=n.width,r.height=n.height)}),t},getObject(e){return this.objectsList[e]},isScreenObjectClickable(e){return Va(e)?!!e.onClick:!1},clickObject(e){if(this.isScreenObjectClickable(e)&&e.onClick){ms("onSpriteClicked");let t;if(typeof e.onClick=="string"){const n=Vk(e.onClick);t={label:n.label,args:n.args}}else t=e.onClick;t.method=t.method??e.clickMethod??"jump",t.args=t.args??[],t.method==="run"?Ue().runThenGoBackToPreviousDialog(t.label,...t.args):t.method==="jump"?Ue().jumpToLabel(t.label,...t.args):Te(`Unknown sprite click method ${e.clickMethod}`)}},generateSaveData(){return{tree:ze(this.tree.map(e=>e.id)),objectsList:ze(Lk(this.objectsList,e=>this.screenObjectToSave(e)))}},loadSaveData(e){this.objectsList=this.loadAllObjects(ze(e.objectsList)),this.tree=e.tree.map(t=>this.objectsList[t])},reset(){this.$reset()},screenObjectToSave(e){return{...e,children:e.children.map(t=>t.id),parent:e.parent?e.parent.id:void 0}},loadAllObjects(e){for(const t of Object.values(e)){const n=t;n.parent=n.parent?e[n.parent]:void 0,n.children=n.children.map(r=>e[r])}return e},emptyLayer(e){for(let t=this.tree.length-1;t>=0;t--){const n=this.tree[t];n.layer===e&&this.destroyObject(n)}},emptyAllLayers(){for(let e=this.tree.length-1;e>=0;e--){const t=this.tree[e];this.destroyObject(t)}}}});function Dy(e){return"save"in e}function Ry(e){return"globalSave"in e}function Hk(e){return"config"in e}const Kk=je({props:{percentage:Number,step:String},methods:{loadingStyle(){return{width:`${this.percentage*60}vw`}}},computed:{}}),Gk={id:"loading-bar"},Wk={id:"loading-text"};function zk(e,t,n,r,o,i){return R(),ee("div",Gk,[H("div",{id:"inner-loading-bar",style:Ye(e.loadingStyle())},null,4),H("div",Wk,[H("h3",null,"Loading "+Se(Math.floor(e.percentage*100))+"% - "+Se(e.step),1)])])}const Qk=Pn(Kk,[["render",zk]]),Jk="data:image/svg+xml,%3c?xml%20version='1.0'%20encoding='utf-8'?%3e%3c!--%20Generator:%20Adobe%20Illustrator%2019.0.0,%20SVG%20Export%20Plug-In%20.%20SVG%20Version:%206.00%20Build%200)%20--%3e%3csvg%20version='1.1'%20id='Rat'%20xmlns='http://www.w3.org/2000/svg'%20xmlns:xlink='http://www.w3.org/1999/xlink'%20x='0px'%20y='0px'%20viewBox='0%200%20595.3%20595.3'%20style='enable-background:new%200%200%20595.3%20595.3;'%20xml:space='preserve'%3e%3cstyle%20type='text/css'%3e%20.st0{fill:%23E23B33;}%20%3c/style%3e%3cpath%20id='Rat_Shape'%20class='st0'%20d='M556.9,82.5c-10.8-24.3-47-57.1-71.3-65.6c-24.3-8.4-64.1-0.3-88.7,22.3%20c-20,18.4-26,28.2-29.1,37c-2.1,5.9-4.8,13.5-6,20.9v0c-0.5,4.1-4.5,7-8.6,6.1c-10.4-2.3-29.5-6-44.4-6.3%20c-13.7-0.2-30.1,3.2-40.4,5.7c-4.5,1.1-8.8-2.2-8.8-6.8c-0.1-5.3-1.1-12.3-4.8-19.6c-8.5-16.9-19.6-32.6-57.8-47.4%20c-31.9-12.4-75.1-9.7-100.8,1.8c-28.1,12.6-42.4,37.9-54,61.8c-14.4,29.8-14.9,83.6-6.4,104c12.8,30.7,35.8,47.2,52.6,53%20c11.3,3.8,28.2,3.7,38.2,3.3c4.2-0.2,7.7,3.3,7.5,7.5c-0.7,13.6-0.9,41.5,7,61.4c7.7,19.4,29.7,62.3,50.7,101.2%20c0,0.1-14.6,2.9-31.4,6.8c-23.9,5.5-52.6,12.7-54.3,13.7c-3.5,2.1-3,10-2.7,12c0.5,3.4,5.3,8.1,6.9,8.3c3.9,0.3,31.3-7.6,55.7-14.6%20c18.5-5.3,34.9-9.3,35.5-8.2c5.1,9.3,10,18,14.4,25.8c5.2,9.1,10.7,16.4,14.1,23.6c1.1,2.3-16.6,5.8-32.5,14.7%20c-16.4,9.1-29.7,21-32.3,24c-1.8,2.1-3,6-1.2,10.7c1.1,2.9,10,5.7,12.4,5.1c6.8-1.7,16.5-12.5,33.1-21.1%20c16.3-8.5,32.9-14.9,33.8-13.6c9.7,14.3,16.9,21.6,22.6,31.2c9.8,16.5,27.3,45.9,46.6,39.5c6.4-2.1,31.1-33.6,53.3-68.6%20c1.3-2.1,16.1,11.3,30.4,23.2c13.8,11.4,22.7,20.6,27.1,21.4c5.4,1,14.2-7.7,14.1-14.7c-0.1-2.7-14.3-13.8-29.1-26.2%20c-14.5-12.1-30.1-22.8-29.2-24.3c7.6-12,14.5-23.7,20.1-33.9c4.3-7.8,8.9-16,13-24.7c0.6-1.2,15.9,3,31.4,7.1c15.3,4,26.7,10,31,8%20c6.9-3,11.6-13.8,9.4-18.3c-1.1-2.3-17-7.3-33.2-12c-14.2-4.1-28-6.5-27.7-7.3c15.5-34,28.8-64.8,27.6-69.6%20c-1.7-7.1,2.6-11.9,7-36.5c3.2-18.1,4.7-40.9,5.2-51.7c0.2-3.5,2.8-6.3,6.3-6.7c3.1-0.3,6.9-0.9,10.5-1.9c7.8-2,18.6-7.8,36.4-20.6%20c17.9-12.8,38.7-49.6,44.4-67.8S567.6,106.8,556.9,82.5z%20M265.1,336.2c-8.1,4-13,7-26.4,9.6c-6.9,1.4-29.4-0.2-40.7-4.6%20c-10.5-4.1-19.9-7.6-30-15.4s-15.7-13.2-15.7-15.3c0-4.4,6-9.4,11-9.4c5.1,0,14.5,9.2,29.7,16.6c14.3,7,17.9,6.1,25.4,7.3%20c2.9,0.5,7.7,0.6,10.7,0.4c14.1-1.3,21.4-5.9,25.3-8.8c4-3,13.7-12.9,17.2-12.5c8,1,18.9,3.4,18.9,7.1%20C290.4,319,273.2,332.1,265.1,336.2z%20M320.9,521.4c-4.3,3.7-17.7,13.5-23.3,13.5c-2.8,0-7.4-8.2-11.5-16.8%20c-4.1-8.5-9.1-21.1-9.1-31.6c0-4.6,6-7.4,13.4-9.2c7.2-1.7,27.3-1.8,29.9-1.1c6.8,1.7,12.9,2.2,12.7,6.4c-0.4,12.7-7,18.9-8.3,24.3%20C323.4,512.3,323.4,519.2,320.9,521.4z%20M431.1,320.3c-9.2,7.4-10.6,8.1-24.9,13.7c-11.3,4.4-28.6,5.8-41.6,3.6%20c-12.2-2.1-22.3-4.6-29.5-10.1c-9.7-7.3-16.4-15.1-16.4-19.8c0-3.7,6.4-4.3,14.5-4.9c3.5-0.3,9.3,5.9,13.2,9.2%20c8.1,6.8,14.8,8,28.8,9.9c2.9,0.4,7.8,0.4,10.7,0.1c7.5-0.9,12-0.4,25.8-8.2c20-11.2,17.8-14.4,25.1-12.6c2.2,0.6,5.8,1.2,5.6,5.6%20C442.4,309,440.5,312.7,431.1,320.3z'/%3e%3c/svg%3e",Yk={id:"engine-splash-screen",class:"flex justify-center items-center"},Xk={id:"engine-splash-title"},Zk=["src"],Fy=je({__name:"engine-splash",emits:["finished"],setup(e,{emit:t}){const n=t,r=be("hidden"),o=z(()=>({transitionDuration:`${p.value}s`})),i=z(()=>({invisible:r.value!=="appear"})),s=Le(),l=z(()=>{var h;return((h=ve().splashScreens)==null?void 0:h.engineSplashScreen)??{}}),u=z(()=>typeof l.value.overrideText=="string"?l.value.overrideText:"Made with narrat engine"),c=z(()=>l.value.overrideLogo??Jk),p=z(()=>typeof l.value.fadeDuration=="number"?l.value.fadeDuration:.8),a=z(()=>typeof l.value.timeBeforeFadeout=="number"?l.value.timeBeforeFadeout:1.5);St(async()=>{if(await cn(10),r.value="appear",l.value.skip||s.options.debug){d();return}await cn(p.value*1e3),await cn(a.value*1e3),r.value="disappear",await cn(p.value*1e3),d()});function d(){s.loading.loaded?n("finished"):s.listener.once("gameLoaded",()=>{n("finished")})}return(h,m)=>(R(),ee("div",Yk,[H("div",{id:"engine-splash-header",class:Xe(["flex justify-center flex-col items-center",i.value]),style:Ye(o.value)},[H("h1",Xk,Se(u.value),1),H("img",{src:c.value,alt:"Narrat Logo",id:"engine-splash-logo"},null,8,Zk),Re(Qk,{percentage:st(s).loading.percentage,step:st(s).loading.step},null,8,["percentage","step"])],6)]))}});class ru{constructor(){ot(this,"listeners",{})}on(t,n){return this.listeners[t]||this.addEventToMap(t),this.listeners[t].add(n),n}off(t,n){return this.listeners[t]&&this.listeners[t].delete(n),n}once(t,n){const r=(...o)=>{this.off(t,r),n(...o)};return this.on(t,r)}emit(t,...n){this.listeners[t]&&this.listeners[t].forEach(r=>r(...n))}clear(){Object.keys(this.listeners).forEach(t=>{delete this.listeners[t]})}addEventToMap(t){this.listeners[t]=new Set}}class eS extends ru{setup(){const t=()=>{this.emit("preUpdate"),this.emit("update"),this.emit("postUpdate"),requestAnimationFrame(t)};t()}}const Ha=new eS;var es;(e=>{function t(m,y){return{x:m??0,y:y??0}}e.create=t;function n(m){return Math.sqrt(m.x*m.x+m.y*m.y)}e.magnitude=n;function r(m){const y=n(m);return y===0?t(0,0):{x:m.x/y,y:m.y/y}}e.normalize=r;function o(m,y){return{x:m.x+y.x,y:m.y+y.y}}e.add=o;function i(m,y){return{x:m.x-y.x,y:m.y-y.y}}e.subtract=i;function s(m,y){return{x:m.x*y.x,y:m.y*y.y}}e.multiply=s;function l(m,y){return{x:m.x*y,y:m.y*y}}e.scale=l;function u(m,y){return{x:m.x/y.x,y:m.y/y.y}}e.divide=u;function c(m,y){return n(i(m,y))}e.distance=c;function p(m,y,T){return{x:m.x+(y.x-m.x)*T,y:m.y+(y.y-m.y)*T}}e.lerp=p;function a(m,y){const T=Math.cos(y),g=Math.sin(y);return{x:m.x*T-m.y*g,y:m.x*g+m.y*T}}e.rotate=a;function d(m,y){const T=i(y,m);return e.normalize({x:-T.y,y:T.x})}e.normal=d;function h(m,y){return m.x*y.x+m.y*y.y}e.dot=h})(es||(es={}));function By(e,t,n,r){const o=e/n,i=t/r;return Math.min(o,i)}const sr=Ot("settings",{state:()=>({baseSettings:{textSpeed:30,animateText:!0,fontSize:16},settingsSchema:{textSpeed:{type:"number",defaultValue:30,minValue:1,maxValue:100,step:5,name:"Text Speed",description:"The speed at which text plays."},animateText:{type:"boolean",defaultValue:!0,name:"Animate Text",description:"Whether or not text should animate."},fontSize:{type:"integer",defaultValue:16,minValue:8,maxValue:64,step:1,name:"Font Size",description:"The base font size for the game."}},customSettings:{},customSettingsSchema:{}}),actions:{reset(e){this.$reset(),this.updateConfig(e)},getSetting(e){if(typeof this.baseSettings[e]<"u")return this.baseSettings[e];if(typeof this.customSettings[e]<"u")return this.customSettings[e];Te(`Setting ${e} does not exist.`)},getSettingSchema(e){if(typeof this.settingsSchema[e]<"u")return this.settingsSchema[e];if(typeof this.customSettingsSchema[e]<"u")return this.customSettingsSchema[e];Te(`Setting ${e} does not exist.`)},getAllSettingSchemas(){return{...this.settingsSchema,...this.customSettingsSchema}},setSetting(e,t){typeof this.baseSettings[e]<"u"?this.baseSettings[e]=t:typeof this.customSettings[e]<"u"?this.customSettings[e]=t:Te(`Setting ${e} does not exist.`),e==="fontSize"&&document.documentElement.style.setProperty("font-size",`${t}px`),e==="textSpeed"&&(ve().dialogPanel.textSpeed=t),e==="animateText"&&(ve().dialogPanel.animateText=t)},updateConfig(e){var t;if(this.setSetting("textSpeed",e.dialogPanel.textSpeed??sa),this.setSetting("animateText",e.dialogPanel.animateText??!0),this.setSetting("fontSize",e.layout.defaultFontSize??16),(t=e.settings)!=null&&t.customSettings)for(const n in e.settings.customSettings)this.addCustomSetting(n,e.settings.customSettings[n])},addCustomSetting(e,t){this.customSettings[e]=t.defaultValue,this.customSettingsSchema[e]=t},generateSaveData(){return{baseSettings:ze(this.baseSettings),customSettings:ze(this.customSettings)}},loadSaveData(e){for(const t in e.baseSettings)this.setSetting(t,ze(e.baseSettings[t]));for(const t in e.customSettings)typeof this.customSettings[t]<"u"&&this.setSetting(t,ze(e.customSettings[t]))}}});function Ka(e,t=50,n={}){let r;const o=n.isImmediate??!1,i=n.callback??!1,s=n.maxWait;let l=Date.now(),u=[];function c(){if(s!==void 0){const a=Date.now()-l;if(a+t>=s)return s-a}return t}const p=function(...a){const d=this;return new Promise((h,m)=>{const y=function(){if(r=void 0,l=Date.now(),!o){const C=e.apply(d,a);i&&i(C),u.forEach(({resolve:N})=>N(C)),u=[]}},T=o&&r===void 0;r!==void 0&&clearTimeout(r);const g=c();if(r=setTimeout(y,g),T){const C=e.apply(d,a);return i&&i(C),h(C)}u.push({resolve:h,reject:m})})};return p.cancel=function(a){r!==void 0&&clearTimeout(r),u.forEach(({reject:d})=>d(a)),u=[]},p}const Et=Ot("rendering",{state:()=>({screenHeight:window.innerHeight,screenWidth:window.innerWidth,layoutMode:"horizontal",resizeObserver:null,containerElement:null,narratAppElement:null,dialogPanelMode:"auto"}),actions:{generateSaveData(){return{dialogPanelMode:this.dialogPanelMode}},loadSaveData(e){this.dialogPanelMode=e.dialogPanelMode},reset(){this.dialogPanelMode="auto"},updateScreenSize(e,t){this.screenHeight=t,this.screenWidth=e,e<ve().layout.verticalLayoutThreshold?(this.layoutMode="vertical",document.querySelector("html").style.fontSize=`${sr().baseSettings.fontSize??40}px`):(this.layoutMode="horizontal",document.querySelector("html").style.fontSize=`${sr().baseSettings.fontSize??16}px`)},setContainer(e){this.containerElement=e,this.resizeObserver&&this.resizeObserver.disconnect(),this.resizeObserver=new ResizeObserver(Ka(()=>{this.refreshScreenSize()},100,{maxWait:200})),this.resizeObserver.observe(e),this.refreshScreenSize()},refreshScreenSize(){const e=this.containerElement;e&&this.updateScreenSize(e.clientWidth,e.clientHeight)}},getters:{gameScaleRatio(e){return By(this.screenWidth,this.screenHeight,this.gameWidth,this.gameHeight)},overlayMode(e){return!!(ve().dialogPanel.overlayMode&&e.layoutMode==="horizontal")},gameWidth(){const e=ve();return this.layoutMode==="vertical"||this.overlayMode?e.layout.backgrounds.width:e.layout.backgrounds.width+_a()},gameHeight(){const e=ve();return this.layoutMode,e.layout.backgrounds.height},dialogWidth(){return this.layoutMode==="vertical"?this.viewportWidth:_a()},dialogHeight(){return this.layoutMode==="vertical"?this.actualGameHeight-this.gameHeight:ve().dialogPanel.height??this.gameHeight},actualGameHeight(){let e=this.gameHeight;return this.layoutMode==="vertical"&&(e=this.screenHeight/this.gameScaleRatio),e},viewportRatio(e){if(this.layoutMode==="vertical"){const t=ve().layout.backgrounds;return e.screenWidth/t.width}return 1},viewportHeight(e){return ve().layout.backgrounds.height*this.viewportRatio},viewportWidth(e){return ve().layout.backgrounds.width*this.viewportRatio},showDialog(e){if(this.dialogPanelMode==="on")return!0;if(this.dialogPanelMode==="off")return!1;if(!this.overlayMode||this.layoutMode==="vertical")return!0;const t=Le().inScript;let n=!0;return Vn().isTransitioning&&ve().dialogPanel.hideDuringTransition&&(n=!1),!ve().dialogPanel.showAfterScriptEnd&&!t&&(n=!1),n},container(){return this.containerElement?this.containerElement:document.body},inputsContainer(){return Le().hasCustomContainer?this.container:window},narratApp(){return this.narratAppElement?this.narratAppElement:document.body}}});class tS extends EventTarget{constructor(){super(...arguments),ot(this,"gamepadAvailable",!0),ot(this,"gameActions",{}),ot(this,"keyboardState",{}),ot(this,"actions",{}),ot(this,"lastInputMethodUsed","km"),ot(this,"gamepad",null)}kbEvent(){this.changeLastInput("km")}getGamepads(){return navigator.getGamepads?navigator.getGamepads():(this.gamepadAvailable=!1,[])}gamepadEvent(){this.changeLastInput("gamepad")}mouseEvent(){this.changeLastInput("km")}changeLastInput(t){this.lastInputMethodUsed!==t&&(this.lastInputMethodUsed=t,this.dispatchEvent(new CustomEvent("change-input",{detail:t})))}getGamepad(){const t=this.getGamepads().filter(n=>n!==null);if(t.length>0)return t[0]}startListening(){this.updateGamepad();const t=Et().inputsContainer;t.addEventListener("mousemove",n=>{this.mouseEvent()}),t.addEventListener("keydown",n=>{this.kbEvent();const r=this.getKeyboardState(n.key).current;this.keyboardState[n.key]={previous:r,current:!0}}),t.addEventListener("keyup",n=>{this.kbEvent();const r=this.getKeyboardState(n.key).current;this.keyboardState[n.key]={previous:r,current:!1}}),Ha.on("preUpdate",()=>{this.update()})}updateGamepad(){const t=this.getGamepad();t?this.gamepad?this.updateAllNarratButtons(t,this.gamepad):this.gamepad=this.setupNarratGamepad(t):this.gamepad=null}setupNarratGamepad(t){return{id:t.id,gamepad:t,buttons:t.buttons.map((n,r)=>this.getNarratButtonFromGamepad(n,n,r)),axes:t.axes.map((n,r)=>({index:r,value:n,previous:n}))}}updateAllNarratButtons(t,n){for(const[r,o]of t.buttons.entries()){const i=n.buttons[r];i.previous=ze(i.state),i.state=ze(o),i.previous.pressed!==i.state.pressed&&this.gamepadEvent()}for(const[r,o]of t.axes.entries()){const i=n.axes[r];i.previous=i.value,i.value=o,i.previous!==i.value&&this.gamepadEvent()}}getNarratButtonFromGamepad(t,n,r){return{index:r,state:ze(n),previous:ze(n)}}addAction(t){if(this.gameActions[t.id]=t,t.type==="button"){const n={config:t,active:!1,justPressed:!1,justReleased:!1};this.actions[t.id]={state:n,previous:ze(n)}}else{const n={config:t,value:es.create(0,0),fullState:{left:0,right:0,up:0,down:0}};this.actions[t.id]={state:n,previous:ze(n)}}}getAnalog(t){return this.actions[t]||Te(`Action ${t} does not exist`),this.actions[t].state}getButton(t){return this.actions[t]||Te(`Action ${t} does not exist`),this.actions[t].state}getKeyboardState(t){return this.keyboardState[t]?this.keyboardState[t]:(this.keyboardState[t]={current:!1,previous:!1},this.keyboardState[t])}getGamepadState(t){return this.gamepad&&this.gamepad.buttons.length>t?{current:this.gamepad.buttons[t].state,previous:this.gamepad.buttons[t].previous}:null}debugGamepad(){if(this.gamepad)for(const[t,n]of this.gamepad.buttons.entries())n.state.pressed,n.previous.pressed}getKeybindKey(t,n){const r=t.id,o=ve().hotkeys[r];return typeof o<"u"?{...n,keyboardKey:o}:n}update(){this.updateGamepad(),this.debugGamepad();for(const t of Object.values(this.gameActions))if(t.type==="button"){const n=this.actions[t.id],r=ze(n.state),o=n.state;n.previous=r,t.action==="press"&&(t.keybinds.some(i=>{let s=!1;if(i=this.getKeybindKey(t,i),typeof i.keyboardKey=="string"&&this.getKeyboardState(i.keyboardKey).current===!0&&(s=!0),typeof i.gamepadButton=="number"){const l=this.getGamepadState(i.gamepadButton);l&&l.current.pressed===!0&&(s=!0)}return s})?o.active=!0:o.active=!1,o.active&&!r.active?o.justPressed=!0:o.justPressed=!1,!o.active&&r.active?o.justReleased=!0:o.justReleased=!1)}else if(t.type==="analog"){const n=this.actions[t.id],r=n.state;ze(n.state),n.previous=ze(r);let o=es.create(0,0);t.keybinds.forEach(i=>{this.getKeyboardState(i.left).current&&(r.fullState.left=1,o.x-=1),this.getKeyboardState(i.right).current&&(r.fullState.right=1,o.x+=1),this.getKeyboardState(i.up).current&&(r.fullState.up=1,o.y-=1),this.getKeyboardState(i.down).current&&(r.fullState.down=1,o.y+=1)}),o=es.normalize(o),r.value=o}}}const Jn=new tS,Jt=Ot("menu",{state:()=>({menus:{},activeMenu:!1}),getters:{showSkills(){return Object.entries(kr().skills).length>0},showInventory(){return Object.entries(zu().items).length>0},showQuests(){return Object.entries(Xa().quests).length>0},showAchievements(){return Object.entries(ci().achievements).length>0},menuTabsToShow(e){return e.menus.menu.tabs.map(t=>{const n=ve().menuButtons[t.id]||{};return{...t,...n}}).filter(t=>t.condition?t.condition():!0)},menu(e){return e.activeMenu?e.menus[e.activeMenu]:void 0},tab(){if(this.menu)return this.menu.tabs[this.menu.activeTab]}},actions:{setup(){},addMenu(e,t){this.menus[e]={...t,id:e}},addMenuOption(e,t){this.menus[e]||(this.menus[e]={id:e,label:e,tabs:[],activeTab:0}),this.menus[e].tabs.push(t)},setActiveTab(e){this.menu&&(this.menu.activeTab=e)},openMenu(e){this.activeMenu=e},closeMenu(){this.activeMenu=!1},toggleMenu(){this.activeMenu?this.activeMenu=!1:this.activeMenu="menu"},reset(){this.activeMenu=!1}}}),nS=[{id:"movement",type:"button",label:"Choose",keyboardIcon:"img/ui/button-prompts/keyboard/key-arrows.png",gamepadIcon:"img/ui/button-prompts/gamepad/dpad.png",action:"press",showInLegend:!0,keybinds:[{keyboardKey:"ArrowLeft",gamepadButton:14}]},{id:"left",type:"button",label:"Left",keyboardIcon:"img/ui/button-prompts/keyboard/arrow-left.png",gamepadIcon:"img/ui/button-prompts/gamepad/dpad-left.png",action:"press",showInLegend:!1,keybinds:[{keyboardKey:"ArrowLeft",gamepadButton:14}]},{id:"right",type:"button",action:"press",label:"Right",keyboardIcon:"img/ui/button-prompts/keyboard/arrow-right.png",gamepadIcon:"img/ui/button-prompts/gamepad/dpad-right.png",showInLegend:!1,keybinds:[{keyboardKey:"ArrowRight",gamepadButton:15}]},{id:"up",type:"button",action:"press",label:"Up",keyboardIcon:"img/ui/button-prompts/keyboard/arrow-up.png",gamepadIcon:"img/ui/button-prompts/gamepad/dpad-up.png",showInLegend:!1,keybinds:[{keyboardKey:"ArrowUp",gamepadButton:12}]},{id:"down",type:"button",action:"press",label:"Down",keyboardIcon:"img/ui/button-prompts/keyboard/arrow-down.png",gamepadIcon:"img/ui/button-prompts/gamepad/dpad-down.png",showInLegend:!1,keybinds:[{keyboardKey:"ArrowDown",gamepadButton:13}]},{id:"continue",type:"button",action:"press",label:"Continue",keyboardIcon:"img/ui/button-prompts/keyboard/key-space.png",gamepadIcon:"img/ui/button-prompts/gamepad/facebutton-down.png",showInLegend:!1,keybinds:[{keyboardKey:"Space",gamepadButton:0}]},{id:"confirm",type:"button",action:"press",label:"Confirm",keyboardIcon:"img/ui/button-prompts/keyboard/key-enter.png",gamepadIcon:"img/ui/button-prompts/gamepad/facebutton-down.png",showInLegend:!0,keybinds:[{keyboardKey:"Enter",gamepadButton:0}]},{id:"cancel",type:"button",action:"press",label:"Cancel",keyboardIcon:"img/ui/button-prompts/keyboard/key-escape.png",gamepadIcon:"img/ui/button-prompts/gamepad/facebutton-right.png",showInLegend:!0,keybinds:[{keyboardKey:"Escape",gamepadButton:1}]},{id:"system",type:"button",action:"press",label:"System Menu",keyboardIcon:"img/ui/button-prompts/keyboard/key-n.png",gamepadIcon:"img/ui/button-prompts/gamepad/special-right.png",showInLegend:!1,keybinds:[{keyboardKey:"n",gamepadButton:9}]},{id:"menu",type:"button",action:"press",label:"Game Menu",keyboardIcon:"img/ui/button-prompts/keyboard/key-m.png",gamepadIcon:"img/ui/button-prompts/gamepad/special-left.png",showInLegend:!1,keybinds:[{keyboardKey:"m",gamepadButton:8}]},{id:"previousTab",type:"button",action:"press",label:"Previous",keyboardIcon:"img/ui/button-prompts/keyboard/key-p.png",gamepadIcon:"img/ui/button-prompts/gamepad/shoulder-left.png",showInLegend:!0,keybinds:[{keyboardKey:"p",gamepadButton:4}]},{id:"nextTab",type:"button",action:"press",label:"Next",keyboardIcon:"img/ui/button-prompts/keyboard/key-o.png",gamepadIcon:"img/ui/button-prompts/gamepad/shoulder-right.png",showInLegend:!0,keybinds:[{keyboardKey:"o",gamepadButton:5}]},{id:"subPreviousTab",type:"button",action:"press",label:"Previous Tab",keyboardIcon:"img/ui/button-prompts/keyboard/key-i.png",gamepadIcon:"img/ui/button-prompts/gamepad/trigger-left.png",showInLegend:!0,keybinds:[{keyboardKey:"i",gamepadButton:6}]},{id:"subNextTab",type:"button",action:"press",label:"Next Tab",keyboardIcon:"img/ui/button-prompts/keyboard/key-u.png",gamepadIcon:"img/ui/button-prompts/gamepad/trigger-right.png",showInLegend:!0,keybinds:[{keyboardKey:"u",gamepadButton:7}]},{id:"viewportSelect",type:"button",action:"press",label:"Interact",keyboardIcon:"img/ui/button-prompts/keyboard/key-v.png",gamepadIcon:"img/ui/button-prompts/gamepad/facebutton-left.png",showInLegend:!0,keybinds:[{keyboardKey:"v",gamepadButton:2}]},{id:"autoPlay",type:"button",action:"press",label:"Toggle Autoplay",keyboardIcon:"img/ui/button-prompts/keyboard/key-a.png",gamepadIcon:"img/ui/button-prompts/gamepad/trigger-left.png",showInLegend:!1,keybinds:[{keyboardKey:"a",gamepadButton:6}]},{id:"skip",type:"button",action:"press",label:"Skip",keyboardIcon:"img/ui/button-prompts/keyboard/key-s.png",gamepadIcon:"img/ui/button-prompts/gamepad/trigger-right.png",showInLegend:!1,keybinds:[{keyboardKey:"s",gamepadButton:7}]}],ut=Ot("inputs",{state:()=>({inputStack:[],baseInputListener:null,inputMode:"km",isTyping:!1,inGameInputListener:null}),actions:{setupInputs(){Jn.addEventListener("change-input",e=>{this.inputMode=e.detail});for(const e of nS)Jn.addAction(e);this.listenToBaseNarratInputs(),Ha.on("preUpdate",()=>{for(const[e,t]of Object.entries(Jn.actions))if(t.state.config.type==="button"){const n=t;n.state.justPressed&&this.triggerListeners(e,"press",n),n.state.justReleased&&this.triggerListeners(e,"release",n)}else t.state.config.type})},createInGameInputListener(){this.inGameInputListener||(this.inGameInputListener=this.registerInputListener("in-game",{system:{press:()=>{Jt().openMenu("system")}},menu:{press:()=>{Jt().openMenu("menu")}}}))},startTyping(){this.isTyping=!0},stopTyping(){this.isTyping=!1},removeInGameInputListener(){this.inGameInputListener&&(this.unregisterInputListener(this.inGameInputListener),this.inGameInputListener=null)},listenToContainerInputs(){Jn.startListening()},listenToBaseNarratInputs(){},getAction(e){return Jn.gameActions[e]},triggerListeners(e,t,n){const r=this.inputStack[this.inputStack.length-1];if(r&&r.actions[e]&&r.actions[e][t])if(n.state.config.type==="button"){const o=r.actions[e][t],i=n;o(n.state.config,i.state,i.previous)}else console.warn("Analog events not implemented yet")},getInputs(){return Jn},registerInputListener(e,t){const n={id:`${Date.now()}-${Math.floor(Math.random()*1e8)}`,name:e,actions:t??{}};return this.inputStack.push(n),n},unregisterInputListener(e){const t=this.inputStack.findIndex(n=>n.id===e.id);if(t===-1)throw new Error("Input listener not found");this.inputStack.splice(t,1)},registerActions(e,t,n){e.actions[t]=n},getInputEvents(e){const t=this.inputStack[this.inputStack.length-1];return t?t.actions[e]??null:null},isInputActive(e){const t=this.getInputEvents(e);return t?typeof t.active=="boolean"?t.active:!0:!1}},getters:{showPrompts(e){var t,n;return e.inputMode==="gamepad"&&((t=ve().input)==null?void 0:t.showPromptsOnGamepad)!==!1||e.inputMode==="km"&&((n=ve().input)==null?void 0:n.showPromptsOnKeyboard)!==!1},allListeners(e){return e.inputStack.map(t=>Object.keys(t.actions)).flat().filter((t,n,r)=>r.indexOf(t)===n)},inputLegend(e){return this.allListeners.filter(t=>{var n;const r=this.inputStack[this.inputStack.length-1];if(!r)return null;const o=r.actions[t]??null;return!o||o.active===!1?!1:(n=Jn.gameActions[t])==null?void 0:n.showInLegend})}}}),vn=Ot("scenes-store",{state:()=>({scenes:{},activeScene:Yn.EngineSplash,currentOptions:{}}),getters:{isPlaying(e){return e.activeScene!==Yn.EngineSplash&&e.activeScene!==Yn.GameSplash&&e.activeScene!==Yn.StartMenu}},actions:{generateSaveData(){return{activeScene:this.activeScene}},loadSaveData(e){},changeScene(e,t){const n=this.activeScene;if(n&&n!==e){const r=this.scenes[n];r.onLeaving&&r.onLeaving(),this.currentOptions={},this.activeScene=e,this.currentOptions=t||{},this.scenes[e].onStarting&&this.scenes[e].onStarting()}},getSceneConfig(e){return this.scenes[e]},onEngineSplashFinished(){this.goToGameSplashScene()},finishedScene(e){this.scenes[e].onFinished&&this.scenes[e].onFinished()},goToGameSplashScene(){let e=Yn.GameSplash;ve().scenes.gameSplashScene&&(e=ve().scenes.gameSplashScene),this.changeScene(e)},goToStartMenuScene(){let e=Yn.StartMenu;ve().scenes.startMenuScene&&(e=ve().scenes.startMenuScene),this.changeScene(e)},goToGameScene(){let e=Yn.Playing;ve().scenes.gameScene&&(e=ve().scenes.gameScene),this.changeScene(e)},addNewScene(e){this.scenes[e.id]=e}}}),rS={id:"game-splash-screen",style:{height:"100%",padding:"20px"},class:"flex justify-center items-center"},oS={id:"game-splash-screen-header flex justify-center flex-col items-center",class:"flex justify-center flex-col items-center"},sS={class:"title",id:"game-splash-title"},Uy=je({__name:"game-splash",setup(e){const t=be(null),n=Le(),r=z(()=>{var u;return((u=ve().splashScreens)==null?void 0:u.gameSplashScreen)??{}}),o=z(()=>typeof r.value.startButtonText=="string"?r.value.startButtonText:"Press to start"),i=z(()=>n.loading.loaded),s=z(()=>ve().gameTitle||"Narrat Game");function l(){vn().goToStartMenuScene()}return St(()=>{t.value=ut().registerInputListener("game-splash",{confirm:{press:()=>{l()}},system:{press:()=>{l()}}}),n.options.debug&&l()}),Ct(()=>{t.value&&ut().unregisterInputListener(t.value)}),(u,c)=>(R(),ee("div",rS,[H("div",oS,[H("h1",sS,Se(s.value),1),i.value?(R(),ee("button",{key:0,class:"nrt-button menu-button main-menu-button large splash-start-button override",onClick:l},Se(o.value),1)):xe("",!0)])]))}});function Ar(e){if(!e.listener)return console.warn("No input listener provided for navigation"),null;const t=be(-1),n=z(()=>e.mode==="grid"?t.value%e.columns:0),r=be([]),o=be(Jn.lastInputMethodUsed),i=be(null);function s(){var q,ue;return(q=e.container)!=null&&q.value?e.container.value.children:(ue=e.elements)!=null&&ue.value?e.elements.value.filter(ce=>ce!==null):[]}function l(){r.value=s()}const u=z(()=>a(t.value));function c(q){return r.value?q>=0&&q<r.value.length:!1}function p(q){const ue=t.value;if(c(q)&&(t.value=q,u.value)){o.value==="gamepad"&&u.value.classList.add("selected");const ce=a(ue);ce&&ue!==q&&ce.classList.remove("selected"),e.onSelected&&e.onSelected(q)}}function a(q){return r.value?r.value[q]:null}function d(){r.value&&(t.value===0?e.loopForbidden||p(r.value.length-1):p(t.value-1))}function h(){r.value&&(t.value===r.value.length-1?e.loopForbidden||p(0):p(t.value+1))}function m(){if(!r.value)return;const q=e,ue=t.value;!e.loopForbidden&&ue<q.columns?p(r.value.length-1):p(t.value-e.columns)}function y(){if(!r.value)return;const q=e,ue=t.value;!e.loopForbidden&&ue>=r.value.length-q.columns?p(0):p(t.value+e.columns)}function T(){e.mode==="grid"?m():e.mode==="list"&&d()}function g(){e.mode==="grid"?y():e.mode==="list"&&h()}function C(){(e.mode==="grid"||e.mode==="list")&&d()}function N(){(e.mode==="grid"||e.mode==="list")&&h()}function L(){e.onChosen&&e.onChosen(t.value)}St(()=>{W()});function B(){e.listener&&(e.onlyVertical||(delete e.listener.actions.left,delete e.listener.actions.right),e.onlyHorizontal||(delete e.listener.actions.up,delete e.listener.actions.down),e.noChoosing||delete e.listener.actions.confirm,i.value&&Jn.removeEventListener("change-input",i.value))}function M(){u.value&&u.value.classList.add("selected")}function E(){u.value&&u.value.classList.remove("selected")}function W(){e.listener&&(l(),i.value=q=>{o.value=q.detail,q.detail==="gamepad"?M():E()},Jn.addEventListener("change-input",i.value),e.onlyVertical||(e.listener.actions.left={press:C},e.listener.actions.right={press:N}),e.onlyHorizontal||(e.listener.actions.up={press:T},e.listener.actions.down={press:g}),e.noChoosing||(e.listener.actions.confirm={press:L}),p(0))}return Ct(()=>{B()}),Cn(()=>{var q;return(q=e.elements)==null?void 0:q.value},q=>{q&&l()}),{selectedIndex:t,selectedElement:u,currentColumn:n,buttonDown:g,buttonUp:T,buttonLeft:C,buttonRight:N,selectUp:m,selectDown:y,selectPrevious:d,selectNext:h,select:p,disable:B,mount:W}}const iS={class:"used-save-slot flex flex-row justify-between items-center grow"},aS={class:"flex flex-col save-slot-number-container"},lS={class:"save-slot-number"},cS={class:"flex flex-col justify-center save-info"},uS={key:1,class:"save-name"},dS={class:"flex flex-col"},pS={key:0},fS={key:1},hS={key:2},mS=["onClick"],vl=je({__name:"save-slot-ui",props:{saveSlot:{},id:{},actions:{},selected:{type:Boolean},inputListener:{}},emits:["choice","cancel"],setup(e,{expose:t,emit:n}){var r;const o=e,i=be(null),s=be(null),l=be(null);t({slotContainer:l});const u=be(((r=o.saveSlot.saveData)==null?void 0:r.metadata.name)??"Empty Save"),c=be(0),p=z(()=>o.saveSlot.saveData!==null),a=z(()=>o.saveSlot.saveData),d=z(()=>ve().saves.mode),h=z(()=>{const B=o.saveSlot.saveData;if(B&&B.screens.layers[0]){const M=Ti(B.screens.layers[0]);if(M)return{backgroundImage:`url(${Jr(M.background)})`}}return!1}),m=n;function y(B){m("choice",B)}function T(B){return a.value?qc(a.value.main.playTime/1e3):"00:00:00"}function g(){a.value&&$_(o.saveSlot.id,u.value)}function C(){const B=ve().saves.slots;let M="";const E=o.saveSlot.slotNumber;return E===0&&ve().saves.mode==="manual"?"AUTO":(B>=10&&E<10&&(M+="0"),B>=100&&E<100&&(M+="0"),M+E)}function N(){i.value=Ar({mode:"list",container:s,listener:o.inputListener,onlyHorizontal:!0,onSelected:B=>{c.value=B},onChosen:B=>{y(B)}}),i.value.mount()}function L(){i.value.disable(),i.value=null}return Cn(()=>o.selected,(B,M)=>{B&&!i.value&&N(),!B&&i.value&&L()}),Ct(()=>{i.value&&L()}),(B,M)=>(R(),ee("div",{class:"save-slot flex flex-row",ref_key:"slotContainer",ref:l},[H("div",iS,[H("div",aS,[H("h1",lS,Se(C()),1)]),h.value?(R(),ee("div",{key:0,class:"save-slot-screenshot",style:Ye(h.value)},null,4)):xe("",!0),H("div",cS,[p.value?Kr((R(),ee("input",{key:0,type:"text",class:"save-name","onUpdate:modelValue":M[0]||(M[0]=E=>u.value=E),onInput:g},null,544)),[[is,u.value]]):(R(),ee("h3",uS,Se(u.value),1)),H("div",dS,[a.value?(R(),ee("p",pS,Se(new Date(a.value.metadata.saveDate).toLocaleString()),1)):xe("",!0),a.value?(R(),ee("p",fS,"Play time: "+Se(T(B.saveSlot)),1)):xe("",!0),d.value==="game-slots"?(R(),ee("p",hS,Se(B.saveSlot.slotType==="auto"?"Auto Save":"Manual Save"),1)):xe("",!0)])]),H("div",{class:"flex flex-row",ref_key:"actionsContainer",ref:s},[(R(!0),ee(Be,null,lt(B.actions,(E,W)=>(R(),ee("button",{class:Xe(["nrt-button",{selected:B.selected&&W===c.value}]),onClick:()=>y(W),key:W},[H("h3",null,Se(E),1)],10,mS))),128))],512)])],512))}}),yS=H("h3",{class:"title"},"Confirmation",-1),da=je({__name:"yes-no",props:{prompt:{type:String,required:!0},onConfirm:{type:Function,required:!1},onRefuse:{type:Function,required:!1}},emits:["choice"],setup(e,{emit:t}){const n=be(ut().registerInputListener("yes-no",{cancel:{press:()=>{s(!1)}},confirm:{press:()=>{s(!0)}}})),r=be(null);Ar({mode:"list",container:r,listener:n.value,onChosen:l=>{s(l===0)}});const o=e,i=t;function s(l){l===!0&&o.onConfirm?o.onConfirm():l===!1&&o.onRefuse&&o.onRefuse(),i("choice",l)}return St(()=>{}),Ct(()=>{n.value&&ut().unregisterInputListener(n.value)}),(l,u)=>(R(),Oe(eo,{onClose:u[2]||(u[2]=()=>s(!1)),containerCssClass:"yes-no-modal"},{header:et(()=>[yS]),body:et(()=>[H("h3",null,Se(e.prompt),1),H("div",{class:"flex justify-center",ref_key:"buttonsContainer",ref:r},[H("button",{class:"nrt-button",onClick:u[0]||(u[0]=()=>s(!0))},"Yes"),H("button",{class:"nrt-button",onClick:u[1]||(u[1]=()=>s(!1))},"No")],512)]),_:1}))}}),gS={class:"nrt-title"},vS={key:0},bS={class:"saves-section"},_S=H("h3",{class:"saves-section-title"},"Auto save",-1),TS={class:"saves-section"},wS=H("h3",{class:"saves-section-title"},"Manual Saves",-1),kS={key:1,class:"saves-section"},SS=H("h3",{class:"saves-section-title"},"Save Slots",-1),CS={class:"saves-container flex flex-col"},qy=je({__name:"save-slots",props:{mode:{}},emits:["chosen","close"],setup(e,{emit:t}){const n=e,r=be(ut().registerInputListener("save-slots",{cancel:{press:()=>{W()}}})),o=be(0),i=br([]),s=z(()=>i.slice(0,1)),l=z(()=>i.slice(1)),u=be([]),c=be([]),p=be([]),a=be([]),d=be([]);be({mode:"list",elements:a,listener:r.value,onlyVertical:!0,noChoosing:!0,onSelected:ce=>{o.value=ce}});const h=Ar({mode:"list",elements:a,listener:r.value,onlyVertical:!0,noChoosing:!0,onSelected:ce=>{o.value=ce}}),m=z(()=>{const ce=o.value;return d.value.length<ce+1?null:d.value[ce].id}),y=br(n.mode==="load"?["Load","Delete"]:["Choose"]),T=z(()=>ve().saves.mode),g=br({prompt:"Are you sure you want to delete this save file?",saveToDelete:null,onConfirm:()=>{E(g.saveToDelete),g.saveToDelete=null},onRefuse:()=>{g.saveToDelete=null}}),C=br({prompt:"Are you sure you want to overwrite this save file?",saveToOverwrite:null,onConfirm:()=>{B(C.saveToOverwrite),C.saveToOverwrite=null},onRefuse:()=>{C.saveToOverwrite=null}}),N=t;Pc(()=>{ir().slots.forEach((ce,te)=>{i[te]=ce})});function L(){a.value=T.value==="manual"?[...c.value.map(te=>te.slotContainer),...p.value.map(te=>te.slotContainer)]:u.value.map(te=>te.slotContainer);const ce=T.value==="manual"?[...s.value,...l.value]:i;d.value=ce.map(te=>({id:te.id}))}St(()=>{L()}),Ct(()=>{h.value&&(h.value.disable(),h.value=null),r.value&&ut().unregisterInputListener(r.value)});function B(ce){N("chosen",{slotId:ce})}function M(ce){const te=ue(ce);if(te){if(ve().saves.mode==="manual"&&te.slotType==="auto"){Le().alert("Sorry","Can't delete the auto save slot!");return}g.saveToDelete=ce}}function E(ce){x_(ce);const te=i.find(Q=>Q.id===ce);te&&(te.saveData=null),L()}function W(){N("close")}function q(ce,te){const Q=y[te];Q==="Load"?B(ce):Q==="Delete"?M(ce):Q==="Choose"&&(C.saveToOverwrite=ce)}function ue(ce){return i.find(te=>te.id===ce)}return(ce,te)=>(R(),Oe(eo,{onClose:W,containerCssClass:"save-modal",cantClose:!1},{header:et(()=>[H("h3",gS,Se(ce.mode==="load"?"Choose a save to load":"Pick a slot to save the game"),1)]),body:et(()=>[T.value==="manual"?(R(),ee("div",vS,[H("div",bS,[_S,Re(Rs,{name:"list",tag:"div"},{default:et(()=>[(R(!0),ee(Be,null,lt(s.value,Q=>(R(),Oe(vl,{key:Q.id,saveSlot:Q,id:Q.id,actions:y,onChoice:ae=>q(Q.id,ae),inputListener:r.value,selected:m.value===Q.id,ref_for:!0,ref_key:"autoSlotsElements",ref:c},null,8,["saveSlot","id","actions","onChoice","inputListener","selected"]))),128))]),_:1})]),H("div",TS,[wS,Re(Rs,{name:"list",tag:"div"},{default:et(()=>[(R(!0),ee(Be,null,lt(l.value,Q=>(R(),Oe(vl,{key:Q.id,saveSlot:Q,id:Q.id,actions:y,onChoice:ae=>q(Q.id,ae),inputListener:r.value,selected:m.value===Q.id,ref_for:!0,ref_key:"manualSlotsElements",ref:p},null,8,["saveSlot","id","actions","onChoice","inputListener","selected"]))),128))]),_:1})])])):(R(),ee("div",kS,[SS,H("div",CS,[Re(Rs,{name:"list",tag:"div"},{default:et(()=>[(R(!0),ee(Be,null,lt(i,Q=>(R(),Oe(vl,{key:Q.id,saveSlot:Q,id:Q.id,actions:y,onChoice:ae=>q(Q.id,ae),selected:m.value===Q.id,inputListener:r.value,ref_for:!0,ref_key:"saveSlotsElements",ref:u},null,8,["saveSlot","id","actions","onChoice","selected","inputListener"]))),128))]),_:1})])])),g.saveToDelete?(R(),Oe(da,{key:2,prompt:g.prompt,onRefuse:g.onRefuse,onConfirm:g.onConfirm},null,8,["prompt","onRefuse","onConfirm"])):xe("",!0),C.saveToOverwrite?(R(),Oe(da,{key:3,prompt:C.prompt,onRefuse:C.onRefuse,onConfirm:C.onConfirm},null,8,["prompt","onRefuse","onConfirm"])):xe("",!0)]),_:1}))}}),xS=je({__name:"start-menu-button",props:{button:{}},emits:["click"],setup(e){return(t,n)=>(R(),ee("button",{class:Xe(["nrt-button menu-button main-menu-button large override",t.button.cssClass]),onClick:n[0]||(n[0]=r=>t.$emit("click"))},Se(t.button.title),3))}});class Vy extends ru{setup(t=!1){const n=t?"keydown":"keyup",r=Ka(i=>{Hn.emit("debouncedKeydown",i)},10,{isImmediate:!0,maxWait:10}),o=Et().inputsContainer;o.addEventListener("keydown",i=>{Hn.emit("keydown",i)}),o.addEventListener(n,i=>{r(i)})}}const Hn=new Vy,ou=Ot("startMenu",{state:()=>({buttons:[]}),actions:{addButtonsFromPlugins(){Ge.plugins.forEach(e=>{e.startMenuButtons&&e.startMenuButtons.forEach(t=>{const n=window.narrat.app;t.popupComponent&&n.component(t.popupComponent.name,t.popupComponent.component),this.buttons.push(t)})})}}});function $S(){ng()}function Hy(){$S(),Le().menuReturn()}async function OS(e){if(ve().saves.mode==="manual"){const t=Vc();t&&(e=t.id)}Le().setSaveSlot(e),og(ir().globalSave),Ky(),Ue().runGame()}function Ky(){Yt().stopAll(),ms("onPressStart"),Ue().start(),Le().prepareToPlay(),Ge.callHook("onGameStart")}async function AS(e,t){if(ve().saves.mode==="manual"){const n=Vc();n&&(t=n.id)}if(Le().setSaveSlot(t),Ky(),e.saveData){tx({gameSave:e.saveData,globalSave:ir().globalSave}),Yt().reloadAudio(e.saveData.audio);const n=Ue(),r=ve().saves.runOnReload;typeof r=="string"&&await Ue().runLabelFunction(r),n.jumpToLabel(e.saveData.vm.lastLabel)}}const IS={id:"game-menu"},PS={id:"game-header",class:"flex flex-col justify-between items-center"},jS={id:"game-title-container"},ES={id:"game-title-text"},NS={class:"nrt-title"},MS=je({__name:"StartMenu",setup(e){const t=be(ut().registerInputListener("start-menu",{})),n=be([]),r=be(null),o=be(!1),i=be(!1),s=be(null),l=be(null),u=be(!1),c=be(!1),p=be(null),a=ou(),d=be(!1),h=be(null),m=z(()=>a.buttons),y=Ar({mode:"list",container:r,listener:t.value,onChosen:Q=>{T(n.value[Q])}});function T(Q){switch(Q.id){case"continue":E();break;case"new-game":g();break;case"load-game":W();break;case"exit":Le().exitGame();break;default:N(Q);break}}async function g(){o.value&&ve().saves.mode==="manual"&&!ve().saves.disabled?c.value=!0:C()}async function C(){if(l.value===null)if(ve().saves.mode==="manual"){const Q=Vc();if(!Q){Te("No autosave found");return}l.value=Q.id}else{const Q=S_();if(!Q){Te("No free slot found");return}l.value=Q}c.value=!1,await OS(l.value)}function N(Q){const ae=m.value.findIndex(Ee=>Ee.id===Q.id),ke=m.value[ae];ke.action&&ke.action(),ke.popupComponent&&(d.value=ke)}function L(){d.value=!1}function B(){c.value=!1}async function M(){if(!l.value)return;const Q=Fs(l.value);if(!Q){Te("No save file found");return}AS(Q,l.value)}function E(){typeof s.value=="string"&&(l.value=s.value,M())}function W(){u.value=!0}function q({slotId:Q}){const ae=Fs(Q);ae&&ae.saveData?(l.value=Q,M()):g()}St(()=>{const Q=ir();Q.slots.some(ae=>ae.saveData)&&(o.value=!0),(ve().saves.mode==="manual"||Q.slots.some(ae=>!ae.saveData))&&(i.value=!0),Q.lastSaveSlot&&Fs(Q.lastSaveSlot)&&(s.value=Q.lastSaveSlot),ue(),p.value=Hn.on("debouncedKeydown",ae=>{ae.key===" "&&C(),ae.key==="c"&&E()}),pi(()=>{y.select(0)}),xn().options.defaultMusic&&(h.value=W_(xn().options.defaultMusic)),Ge.callHook("onStartScreenMounted")});function ue(){const Q=ve().saves.disabled;s.value&&!Q&&n.value.push(ce({id:"continue",title:"Continue",cssClass:"continue-button"})),i.value&&n.value.push(ce({id:"new-game",title:"New Game",cssClass:"start-button"})),o.value&&!Q&&n.value.push(ce({id:"load-game",title:"Load Game",cssClass:"continue-button"}));for(const ae of m.value)n.value.push({id:ae.id,title:ae.text,cssClass:`${ae.id}-start-menu-button`});n.value.push(ce({id:"exit",title:"Exit",cssClass:"exit-button"}))}function ce({id:Q,title:ae,cssClass:ke}){const Ee=ve().menuButtons[Q];if(Ee){let qe=ke;return Ee.cssClass&&(qe=`${Ee.cssClass} ${ke}`),{id:Q,title:Ee.text??ae,cssClass:qe}}return{id:Q,title:ae,cssClass:ke}}Ct(()=>{if(t.value&&ut().unregisterInputListener(t.value),p.value&&Hn.off("debouncedKeydown",p.value),typeof h.value=="number"){const Q=xn().options.defaultMusic;z_(Q,h.value)}});const te=z(()=>ve().gameTitle);return(Q,ae)=>(R(),ee("div",IS,[u.value?(R(),Oe(qy,{key:0,mode:"load",onChosen:q,onClose:ae[0]||(ae[0]=ke=>u.value=!1)})):xe("",!0),c.value?(R(),Oe(da,{key:1,prompt:"This will override your previous autosave, are you sure?",onConfirm:C,onRefuse:B})):xe("",!0),H("div",PS,[H("div",jS,[H("h1",ES,Se(te.value),1)]),H("div",{class:"flex flex-col start-menu-buttons-container",ref_key:"buttonsContainer",ref:r},[(R(!0),ee(Be,null,lt(n.value,ke=>(R(),Oe(xS,{key:ke.id,button:ke,onClick:Ee=>T(ke)},null,8,["button","onClick"]))),128))],512)]),d.value?(R(),Oe(Js,{key:2,to:"#narrat-app-container"},[Re(eo,{onClose:L,class:Xe(`start-menu-popup-${d.value.id}`)},{header:et(()=>[H("h3",NS,Se(d.value.text),1)]),body:et(()=>[d.value.popupComponent?(R(),Oe(Ea(d.value.popupComponent.component),{key:0,onClose:L},null,32)):xe("",!0)]),_:1},8,["class"])])):xe("",!0)]))}}),Gy=Pn(MS,[["__scopeId","data-v-6a89804b"]]);function Ga(e){const t=Ju().characters[e];return t||Te(`Character ${e} not found`),t}function LS(e,t){const n=Ga(e);if(n&&(t||(t="default"),n.sprites)){const r=n.sprites[t];return r==="none"?void 0:typeof r=="string"?{image:r}:r}}function kp(e){return`${Ju().config.imagesPath}${e}`}function DS(e){return typeof e=="object"&&Object.hasOwn(e,"image")}function RS(e){return typeof e=="object"&&Object.hasOwn(e,"video")}function bl(e){var t;return e?((t=Ga(e))==null?void 0:t.style)||{}:{}}const FS=["src"],BS=["autoplay","loop","muted"],US=["src"],qS=je({__name:"dialog-picture",props:{picture:{},video:{},character:{},pose:{}},setup(e){const t=e,n=z(()=>t.video),r=z(()=>Et().layoutMode),o=z(()=>{var s;const l={};if(!t.character)return{};t.character&&(l[t.character]=!0);const u=Ga(t.character);return(s=u==null?void 0:u.style)!=null&&s.portraitCssClass&&(l[u.style.portraitCssClass]=!0),l}),i=z(()=>{var s,l;const u=Et(),c=ve().layout;let p=0,a=0;const d=c.portraits;if(r.value==="vertical"){const y=((s=d.offset)==null?void 0:s.portrait)??{right:0,bottom:0};p=20+y.right,a=u.dialogHeight+y.bottom}else{const y=((l=d.offset)==null?void 0:l.landscape)??{right:0,bottom:0},T=ve().dialogPanel.rightOffset??Gc.dialogPanel.rightOffset;p=_a()-10+y.right+T,a=200+y.bottom}let h=c.portraits.width,m=c.portraits.height;return t.video&&(h=t.video.width??h,m=t.video.height??m),t.picture&&(h=t.picture.width??h,m=t.picture.height??m),{right:`${p}px`,bottom:`${a}px`,width:`${h}px`,height:`${m}px`}});return(s,l)=>{var u;return R(),ee("div",{class:Xe(["dialog-picture override",o.value]),style:Ye(i.value)},[s.picture?(R(),ee("img",{key:0,src:st(Zt)(st(kp)((u=s.picture)==null?void 0:u.image)),class:Xe(["picture override",o.value])},null,10,FS)):xe("",!0),n.value?(R(),ee("video",{key:1,class:"picture override",autoplay:n.value.autoplay!==!1,loop:n.value.loop!==!1,muted:!!n.value.muted},[H("source",{src:st(Zt)(st(kp)(n.value.video))},null,8,US)],8,BS)):xe("",!0)],6)}}});function VS(){return xn().dialogAudio}function Wy(e){const t=VS();if(t){if(t.characterAudio&&t.characterAudio[e])return t.characterAudio[e];if(t.defaultAudio)return t.defaultAudio}}function zy(e,t){if(typeof t!="string")return;const n=Wy(e);return n==null?void 0:n.soundPerLetter}function HS(e,t){if(typeof t!="string")return;const n=zy(e,t);if(!n)return;const r=n;let o="";return r.prefix&&(o+=r.prefix),o+=t,r.suffix&&(o+=r.suffix),o}function KS(e,t){if(typeof t!="string")return;const n=t.toLowerCase(),r=HS(e,n);if(typeof r!="string")return;const o=Mn(r);if(o){const i=zy(e,n);let s=1;i.volume&&(s=i.volume);const l=Yt().audioVolume("sound",r)*s;o.volume(l),o.play()}}function GS(e){const t=Wy(e);if(t!=null&&t.soundOnNewLine){const n=Mn(t.soundOnNewLine);if(n){const r=Yt().audioVolume("sound",t.soundOnNewLine);n.volume(r),n.play()}}}const WS={key:0,class:"input-prompt-container"},zS={key:0,class:"input-prompt-label"},QS=["src"],ii=je({__name:"input-prompt",props:{input:{},label:{},showLabel:{type:Boolean}},setup(e){const t=ut(),n=e,r=z(()=>{const s=t.getAction(n.input);return s||Te(`Input action ${n.input} does not exist.`),s}),o=z(()=>{var s,l;return t.inputMode==="gamepad"?(s=r.value)==null?void 0:s.gamepadIcon:(l=r.value)==null?void 0:l.keyboardIcon}),i=z(()=>{var s;return n.label?n.label:((s=r.value)==null?void 0:s.label)??"NONE"});return(s,l)=>st(t).showPrompts&&r.value?(R(),ee("span",WS,[s.showLabel||s.label?(R(),ee("span",zS,Se(i.value),1)):xe("",!0),H("img",{src:st(Jr)(o.value),class:"input-prompt-icon"},null,8,QS)])):xe("",!0)}}),JS=["innerHTML"],YS=["innerHTML"],XS=["innerHTML"],ZS={key:1},eC=["onClick","innerHTML"],tC={key:1},nC={key:2,class:"buttons-container"},rC=je({__name:"dialog-box",props:{options:{},active:{type:Boolean},inputListener:{},index:{}},setup(e,{expose:t}){const n=be(null),r=be(""),o=be(!1),i=be(null),s=be(null),l=be(!1),u=be(null),c=be(null),p=be(null),a=be(null),d=be(null),h=e,m=be(null);h.active&&(m.value=Ar({mode:"list",container:n,listener:h.inputListener,onlyVertical:!0,onChosen:_=>{le.value&&G.value?B(G.value[_]):C(" ")}})),St(()=>{ke(),l.value=!0}),Ct(()=>{y(),te(),pt({unmounted:!0})});function y(){i.value&&(clearTimeout(i.value),i.value=null),T()}function T(){m.value&&(m.value.disable(),m.value=null)}function g(_){C(_.key)}function C(_){if(!le.value){l.value&&s&&_===" "&&pt({pressedSpace:!0});return}if(le.value&&h.options.textField&&_==="Enter"&&ue(),le.value&&!h.options.textField){let O=-1;switch(_){case" ":O=0;break;case"1":O=0;break;case"2":O=1;break;case"3":O=2;break;case"4":O=3;break;case"5":O=4;break;case"6":O=5;break;case"7":O=6;break;case"8":O=7;break}O!==-1&&G.value&&O<G.value.length?B(G.value[O]):O===0&&B(O)}}function N(){le.value||l.value&&s&&pt({pressedSpace:!0})}function L(){o.value||B(0)}function B(_){M();let O;typeof _=="object"?O=_.originalIndex:O=_,Le().playerAnswered(O)}function M(){y(),pt({unmounted:!0}),o.value=!0}function E(_){const O={};return _.allowed||(O.pointerEvents="none",O.textDecoration="line-through"),O}function W(_,O){const V={index:_+1,choice:O.choice};let J='<span class="choice-index">%{$index}. </span> <span class="choice-text">%{$choice}</span>';if(ac().choiceTextTemplate&&(J=ac().choiceTextTemplate),O.flag){const X=zp(O.flag);X!=null&&X.textTemplate&&(J=X.textTemplate)}return Lh(V,J)}function q(_){const O={};if(_.allowed||(O["strike-anim"]=!0),_.seenBefore&&(O["seen-before"]=!0),_.flag){const V=zp(_.flag);V!=null&&V.cssClass&&(O[V.cssClass]=!0)}return O}function ue(){const _=r.value;te(),Le().playerAnswered(_)}function ce(){h.options.textField&&(ut().startTyping(),i.value=setTimeout(()=>{le.value&&(d.value=ut().registerInputListener("text-field-input-grabber",{}),a.value&&a.value.focus())},100))}function te(){ut().stopTyping(),d.value&&(ut().unregisterInputListener(d.value),d.value=null)}function Q(_,O){const V=h.options.text.substring(_,O);s.value.text+=V;const J=V.substring(0,1);return KS(h.options.styleId,J),O}function ae(_){const O=_[0];return s.value.text+=O,s.value.skippedChars+=O.length,O.length}function ke(){if(!h.options.old)if(rt().playMode==="skip")Ee();else if(GS(h.options.styleId),ve().dialogPanel.animateText){s.value={text:"",index:0,startTime:Date.now(),timer:null,skippedChars:0,tags:V_(h.options.text),finished:!1};const _=s.value;_.timer=setInterval(()=>{He()},30)}else A.value&&(u.value=setTimeout(()=>{pt()},(ve().dialogPanel.textSpeed??sa)*h.options.text.length))}function Ee(){rt().playMode==="skip"&&!h.options.old&&(A.value?c.value=setTimeout(()=>{pt()},100):(rt().toggleSkip(),pt({unmounted:!0})))}function qe(){rt().playMode==="auto"&&!h.options.old&&A.value&&le&&L()}function He(){const _=s.value;if(!_)return;const O=_.index,V=Date.now()-_.startTime;let J=!1,X=Math.round(V/(ve().dialogPanel.textSpeed??sa))+_.skippedChars;if(X>h.options.text.length&&(J=!0,_.finished=!0,X=h.options.text.length),X!==_.index){let ne=O;for(;_.tags.length>0&&X>=_.tags[0].index;){ne=Q(ne,_.tags[0].index);const de=ae(_.tags.shift());ne+=de,X+=de}ne=Q(ne,X),_.index=ne}J&&pt()}function pt({unmounted:_,pressedSpace:O}={}){Ue().endTextAnimation(),_||ce(),setTimeout(()=>{m.value&&m.value.select(0)},10),s.value&&(s.value.timer&&clearInterval(s.value.timer),s.value=null),u.value&&!O&&clearTimeout(u.value),c.value&&clearTimeout(c.value),p.value&&clearTimeout(p.value),!_&&!O&&rt().playMode!=="normal"&&A&&(p.value=setTimeout(()=>{L()},rt().playMode==="auto"?ve().dialogPanel.timeBetweenLines??ls.common.dialogPanel.timeBetweenLines:0))}const D=z(()=>h.options.title?" &nbsp;–&nbsp; ":""),v=z(()=>({...bl(h.options.styleId).boxCss})),A=z(()=>!G.value&&!h.options.textField),$=z(()=>{const _={};return h.options.title&&(_["dialog-box-followup"]=!0),rt().isDialogCleared(h.index)&&(rt().clearedDialogVisible?_["dialog-box-cleared-visible"]=!0:_["dialog-box-cleared-disabled"]=!0),h.options.old?_["dialog-box-old"]=!0:_["dialog-box-new"]=!0,_}),b=z(()=>{const _=bl(h.options.styleId);return{color:_.color,..._.nameCss}}),w=z(()=>bl(h.options.styleId).textCss),I=z(()=>s.value?s.value.text:h.options.text),G=z(()=>{if(h.options.choices)return h.options.choices}),Z=z(()=>rt().playMode==="skip"),he=z(()=>rt().playMode==="auto"),le=z(()=>h.active&&l.value&&!o.value&&!p.value&&!s.value&&h.options.interactive&&!Fe.value),me=Le(),Fe=z(()=>me.paused);return Cn(()=>h.options,(_,O)=>{!O.old&&_.old&&s&&pt({unmounted:!0})}),Cn(Z,(_,O)=>{_&&!O&&Ee()}),Cn(he,(_,O)=>{_&&!O&&qe()}),t({keyboardEvent:g}),(_,O)=>{const V=D0("visible");return R(),ee("div",{class:Xe(["dialog-box w-full override",$.value]),style:Ye(v.value)},[H("div",{class:"dialog-content",onClick:N},[_.options.title?(R(),ee("span",{key:0,class:"dialog-title override",style:Ye(b.value),innerHTML:_.options.title},null,12,JS)):xe("",!0),H("span",{class:"dialog-text dialog-separator override",style:Ye(w.value),innerHTML:D.value},null,12,YS),H("span",{class:Xe(["dialog-text override",_.options.cssClass]),style:Ye(w.value),innerHTML:I.value},null,14,XS),_.options.old?xe("",!0):Kr((R(),ee("div",ZS,[G.value?(R(),ee("div",{key:0,class:"dialog-choices",ref_key:"choicesDiv",ref:n},[(R(!0),ee(Be,null,lt(G.value,(J,X)=>(R(),ee("p",{key:X,style:Ye(E(J)),class:Xe([q(J),"dialog-choice override"]),onClick:ne=>B(J),innerHTML:W(X,J)},null,14,eC))),128))],512)):_.options.textField?(R(),ee("div",tC,[Kr(H("input",{autofocus:"",type:"text",class:"label-input nrt-input",ref_key:"playerInput",ref:a,id:"player-input-field","onUpdate:modelValue":O[0]||(O[0]=J=>r.value=J)},null,512),[[is,r.value]]),H("button",{onClick:ue,class:"nrt-button",id:"player-input-submit"}," Submit ")])):(R(),ee("div",nC,[H("div",{onClick:O[1]||(O[1]=J=>B(0)),ref:"continue",class:"interact-button nrt-button override"},[On(" Continue "),Re(ii,{input:"continue"})],512)]))])),[[V,le.value]])])],6)}}}),oC={key:0,class:"auto-play-feedback-container"},sC=je({__name:"AutoPlayFeedback",setup(e){const t=rt(),n=z(()=>t.playMode==="auto"),r=z(()=>t.playMode==="skip"),o=z(()=>n.value?"auto-play-feedback-auto":r.value?"auto-play-feedback-skip":{}),i=z(()=>n.value?"Auto Play":r.value?"Skip":"");return(s,l)=>i.value?(R(),ee("div",oC,[H("div",{class:Xe(["auto-play-feedback",o.value])},Se(i.value),3)])):xe("",!0)}}),iC={key:0,class:"auto-save-feedback-container"},aC={key:1,class:"auto-save-feedback-text"},lC=je({__name:"auto-save-feedback",setup(e){const t=Le(),n=z(()=>t.autosaveFeedback),r=z(()=>ve().saves.autosaveFeedback),o=z(()=>{var s,l;return(s=r.value)!=null&&s.backgroundImage?{backgroundImage:`url(${Jr((l=r.value)==null?void 0:l.backgroundImage)})`}:{}}),i=z(()=>{var s,l;return(s=r.value)!=null&&s.foregroundImage?{backgroundImage:`url(${Jr((l=r.value)==null?void 0:l.foregroundImage)})`}:{}});return(s,l)=>(R(),Oe(ss,{name:"fade"},{default:et(()=>{var u,c,p,a;return[n.value?(R(),ee("div",iC,[(u=r.value)!=null&&u.backgroundImage?(R(),ee("div",{key:0,class:"auto-save-feedback-background",style:Ye(o.value)},null,4)):xe("",!0),(c=r.value)!=null&&c.text?(R(),ee("div",aC,Se((p=r.value)==null?void 0:p.text),1)):xe("",!0),(a=r.value)!=null&&a.foregroundImage?(R(),ee("div",{key:2,class:"auto-save-feedback-foreground",style:Ye(i.value)},null,4)):xe("",!0)])):xe("",!0)]}),_:1}))}}),cC={class:"auto-skip-buttons flex"},uC=H("div",{class:"anchor"},null,-1),Qy=je({__name:"game-dialog",setup(e){const t=z(()=>Et().layoutMode),n=z(()=>ut().inGameInputListener),r=be(Le().inScript),o=be(null),i=Et(),s=Ue(),l=z(()=>s.stack),u=rt(),c=z(()=>u.dialog),p=be(null),a=be(null),d=be(null),h=z(()=>{let Q="0px";const ae=ve().layout.dialogBottomPadding;return typeof ae=="number"?Q=`${ae}px`:typeof ae=="string"&&(Q=ae),{paddingBottom:Q}}),m=z(()=>{if(c.value.length>0){const Q=c.value[c.value.length-1];return u.isDialogCleared(c.value.length-1)?void 0:Q}}),y=z(()=>{if(m.value)return m.value.speaker}),T=z(()=>{if(m.value)return m.value.pose}),g=z(()=>{if(m.value){const Q=y.value;let ae=T.value;return Q?(ae||(ae="idle"),ae):void 0}}),C=z(()=>{if(!g.value)return;const Q=y.value;return LS(Q,g.value)}),N=z(()=>{const Q=C.value;if(DS(Q))return Q}),L=z(()=>{const Q=C.value;if(RS(Q))return Q}),B=z(()=>i.dialogWidth),M=z(()=>Le().inScript);Cn(M,Q=>{Q?r.value=!0:rt().playMode!=="normal"?(rt().playMode==="skip"&&(rt().playMode="normal"),o.value=setTimeout(()=>{r.value=!1},500)):r.value=!1}),St(()=>{if(n.value){const ae=n.value;ae.actions.autoPlay={press:()=>{rt().toggleAutoPlay()}},ae.actions.skip={press:()=>{rt().toggleSkip()}}}const Q=ae=>{a.value&&a.value.keyboardEvent&&a.value.keyboardEvent(ae)};Q.value=Hn.on("debouncedKeydown",Q)}),Ct(()=>{n.value&&(delete n.value.actions.autoPlay,delete n.value.actions.skip),d.value&&Hn.off("debouncedKeydown",d.value),o.value&&clearTimeout(o.value)});const E=z(()=>{let Q;const ae=`${Et().dialogHeight}px`,ke={};if(Et().overlayMode){ke.position="absolute";const Ee=ve().dialogPanel.rightOffset??ls.common.dialogPanel.rightOffset;ke.right=`${Ee}px`;const qe=ve().dialogPanel.bottomOffset??ls.common.dialogPanel.bottomOffset;ke.bottom=`${qe}px`}return{...ke,width:t.value==="horizontal"?`${B.value}px`:"100%",height:ae,transform:Q,transformOrigin:"right"}});function W(){rt().toggleAutoPlay()}function q(){rt().toggleSkip()}function ue(){rt().toggleHistory()}function ce(Q,ae){const ke=Ga(Q.speaker),Ee=rt();let qe=(ke==null?void 0:ke.name)??"Missing Character";if(ae>=1){const He=c.value[ae-1];!Ee.isDialogCleared(ae-1)&&He.speaker===Q.speaker&&(qe=void 0)}return Q.choices&&Q.choices.forEach(He=>{He.choice=Cr(He.choice)}),{title:qe??"",text:Q.text,cssClass:Q.cssClass,styleId:Q.speaker,choices:Q.choices,old:ae<c.value.length-1,interactive:Q.interactive,textField:Q.textField}}function te(Q){return Q===u.dialog.length-1&&l.value.length>0}return Cn(c.value,Q=>{if(p.value){const ae=p.value;ae.scrollTop=ae.scrollHeight+1e8}}),(Q,ae)=>(R(),ee(Be,null,[Re(sC),Re(lC),Re(ss,{name:"fade"},{default:et(()=>[(N.value||L.value)&&st(i).showDialog?(R(),Oe(qS,{key:0,picture:N.value,video:L.value,character:y.value,pose:T.value},null,8,["picture","video","character","pose"])):xe("",!0)]),_:1}),Re(ss,{name:"dialog-transition"},{default:et(()=>[st(i).showDialog?(R(),ee("div",{key:0,class:"dialog override",ref_key:"dialogRef",ref:p,style:Ye(E.value)},[Re(Rs,{name:"list",tag:"div",class:"dialog-container w-full override",style:Ye(h.value)},{default:et(()=>[(R(!0),ee(Be,null,lt(c.value,(ke,Ee)=>(R(),Oe(rC,{ref_for:!0,ref:qe=>a.value=qe,key:ke.id,options:ce(ke,Ee),active:te(Ee),index:Ee,inputListener:n.value},null,8,["options","active","index","inputListener"]))),128))]),_:1},8,["style"]),(R(),Oe(Js,{to:"#narrat-app"},[H("div",cC,[H("div",{class:"nrt-button menu-toggle-button auto-button auto",onClick:W},[On(" Auto "),Re(ii,{input:"autoPlay"})]),H("div",{class:"nrt-button menu-toggle-button auto-button skip",onClick:q},[On(" Skip "),Re(ii,{input:"skip"})]),st(ve)().dialogPanel.allowHistoryToggling!==!1?(R(),ee("div",{key:0,class:"nrt-button menu-toggle-button auto-button toggle-history",onClick:ue}," Toggle History ")):xe("",!0)])])),uC],4)):xe("",!0)]),_:1})],64))}}),dC=["id"],pC=["src"],fC={class:"tab-title"},Jy=je({__name:"tab-selector",props:{tab:{},active:{type:Boolean}},emits:["click"],setup(e,{emit:t}){const n=e,r=t,o=z(()=>n.active?"tab-active":"tab-inactive");function i(){r("click")}return(s,l)=>(R(),ee("div",{class:Xe(["tab",o.value]),id:`tab-${s.tab.id}`,onClick:i},[H("div",{class:Xe(["tab-title-container",s.active?"active":""])},[s.tab.icon?(R(),ee("img",{key:0,src:s.tab.icon,alt:"tab icon",class:"tab-icon"},null,8,pC)):xe("",!0),H("span",fC,Se(s.tab.label),1)],2)],10,dC))}}),hC={class:"tabs-controller"},mC={key:0,class:"tabs-controller__tabs"},yC={key:1,class:"tab-content"},gC={key:2},vC=H("div",{class:"tab-content__empty"},[H("p",null,"No tab selected")],-1),bC=[vC],_C=je({__name:"TabsController",props:{tabs:{},defaultTab:{}},emits:["tab-change","close"],setup(e,{emit:t}){const n=be(ut().registerInputListener("tabs-controller",{cancel:{press:()=>{r("close")}},system:{press:()=>{r("close")}},menu:{press:()=>{r("close")}},previousTab:{press:()=>{i.value>0&&s(i.value-1)}},nextTab:{press:()=>{i.value<o.tabs.length-1&&s(i.value+1)}}})),r=t,o=e,i=be(o.defaultTab);function s(u){i.value=u,r("tab-change",u)}const l=z(()=>o.tabs[i.value]);return Ct(()=>{n.value&&(ut().unregisterInputListener(n.value),n.value=null)}),(u,c)=>(R(),ee("div",hC,[u.tabs.length>1?(R(),ee("div",mC,[(R(!0),ee(Be,null,lt(u.tabs,(p,a)=>(R(),Oe(Jy,{key:p.id,tab:p,active:a===i.value,onClick:()=>s(a),inputListener:n.value},null,8,["tab","active","onClick","inputListener"]))),128))])):xe("",!0),l.value?(R(),ee("div",yC,[l.value?(R(),Oe(Ea(l.value.component),{key:0,inputListener:n.value,onClose:c[0]||(c[0]=p=>u.$emit("close"))},null,40,["inputListener"])):xe("",!0)])):(R(),ee("div",gC,bC))]))}}),TC={class:"menu-container menu-toggle"},wC=["onClick","id"],kC={class:"nrt-title"},Yy=je({__name:"menu-buttons",setup(e){const t=Jt(),n=be(null);St(()=>{Ge.callHook("onGameMounted")}),Ct(()=>{n.value&&Hn.off("keydown",n.value),Ge.callHook("onGameUnmounted")});function r(p){Jt().activeMenu=p}const o=z(()=>t.menus),i=z(()=>t.menu),s=z(()=>{var p;return(((p=i.value)==null?void 0:p.tabs)??[]).filter(a=>a.condition?a.condition():!0).map(a=>({id:a.id,label:a.text,component:a.component}))});function l(){t.closeMenu()}function u(p){t.setActiveTab(p)}function c(){return l()}return(p,a)=>(R(),ee("div",TC,[(R(!0),ee(Be,null,lt(o.value,(d,h)=>(R(),ee("button",{key:d.id,onClick:m=>r(d.id),id:d.cssId??`${h}-menu-button`,class:"nrt-button menu-toggle-button"},[On(Se(d.label)+" ",1),d.inputPrompt?(R(),Oe(ii,{key:0,input:d.inputPrompt},null,8,["input"])):xe("",!0)],8,wC))),128)),i.value?(R(),Oe(Js,{key:0,to:"#narrat-app-container"},[Re(eo,{containerCssClass:{[i.value.cssClass]:!0,"menu-modal":!0},onClose:l},{header:et(()=>{var d;return[H("h3",kC,Se(((d=st(t).tab)==null?void 0:d.text)??i.value.label),1)]}),body:et(()=>[Re(_C,{onTabChange:u,onClose:c,tabs:s.value,defaultTab:i.value.activeTab},null,8,["tabs","defaultTab"])]),_:1},8,["containerCssClass"])])):xe("",!0)]))}});function Xy(e){const t={};return e.selected&&(t.selected=!0),e.clickable&&e.viewportClickable&&!e.transitioning&&(t.interactable=!0),(!e.clickable||!e.viewportClickable)&&(t["nrt-disabled"]=!0),e.transitioning&&(t.transitioning=!0),e.greyed&&(t.greyed=!0),e.hidden&&(t.hidden=!0),e.cssClass&&(t[e.cssClass]=!0),t}function SC(e,t,n){return{selected:t,clickable:e.onClick!==void 0,viewportClickable:Va(e),transitioning:n,greyed:!1,hidden:!1,cssClass:e.cssClass}}function CC(e,t,n){const r=xo(e),o=Vn().getButtonState(e),i=ut().inputMode;return{selected:t&&i==="gamepad",clickable:Vn().isButtonInteractible(e),viewportClickable:Va(r),transitioning:n,greyed:o==="greyed",hidden:o==="hidden"||o===!1,cssClass:r.cssClass}}function xC(e,t,n){return Xy(CC(e,t,n))}function $C(e,t,n){return Xy(SC(e,t,n))}const OC=["id"],AC=["innerHTML"],IC=je({__name:"screen-object",props:{screenObject:{},layerSelected:{type:Boolean},transitioning:{type:Boolean},activeInteractive:{}},setup(e){const t=e,n=An();function r(l){t.transitioning||t.screenObject.onClick&&n.clickObject(l)}const o=z(()=>{if(!t.layerSelected)return!1;const l=t.activeInteractive;return l.type==="screenObject"&&l.id===t.screenObject.id}),i=z(()=>$C(t.screenObject,o.value,t.transitioning)),s=z(()=>{const l={};t.screenObject.opacity!==1&&(l.opacity=t.screenObject.opacity);let u=t.screenObject.x,c=t.screenObject.y,p=t.screenObject.width,a=t.screenObject.height;if(t.screenObject.anchor){const h=t.screenObject.anchor;u=t.screenObject.x-p*h.x,c=t.screenObject.y-a*h.y,l.transformOrigin=`${h.x*100}% ${h.y*100}%`}t.screenObject.scale&&(p=p*t.screenObject.scale,a=a*t.screenObject.scale);const d={...l,left:`${u}px`,top:`${c}px`,width:`${p}px`,height:`${a}px`};return qk(t.screenObject)&&(d.backgroundImage=`url(${Jr(t.screenObject.image)})`),d});return(l,u)=>{const c=wo("ScreenObject",!0);return R(),ee("div",{tabindex:"-1",class:Xe(["viewport-object",i.value]),id:`viewport-object-${t.screenObject.id}`,onClick:u[0]||(u[0]=p=>r(l.screenObject)),style:Ye(s.value)},[H("span",{innerHTML:t.screenObject.text?st(Cr)(t.screenObject.text):void 0},null,8,AC),(R(!0),ee(Be,null,lt(t.screenObject.children,p=>(R(),Oe(c,{transitioning:l.transitioning,key:p.id,screenObject:p},null,8,["transitioning","screenObject"]))),128))],14,OC)}}}),PC=["id","innerHTML"],jC=je({__name:"viewport-button",props:{id:{},layerSelected:{type:Boolean},transitioning:{type:Boolean},activeInteractive:{}},setup(e){const t=e,n=Vn();z(()=>n.getButtonState(t.id));const r=z(()=>xo(t.id)),o=r.value.background?Jr(r.value.background):null,i=z(()=>{if(!t.layerSelected)return!1;const p=t.activeInteractive;return p.type==="button"&&p.id===t.id});z(()=>n.isButtonClickable(t.id));const s=z(()=>{const p=r.value.text??"";return Cr(p)}),l=z(()=>xC(t.id,i.value,t.transitioning)),u=z(()=>{const p={};r.value.position.width&&(p.width=`${r.value.position.width}px`),r.value.position.height&&(p.height=`${r.value.position.height}px`),r.value.background&&(p.backgroundImage=`url(${o})`);let a=r.value.position.left,d=r.value.position.top;return r.value.anchor&&(a=r.value.position.left-r.value.position.width*r.value.anchor.x,d=r.value.position.top-r.value.position.height*r.value.anchor.y),{...p,left:`${a}px`,top:`${d}px`}});function c(){n.clickOnButton(t.id)}return(p,a)=>(R(),ee("div",{tabindex:"-1",class:Xe(["viewport-button",l.value]),id:`viewport-button-${p.id}`,onClick:a[0]||(a[0]=d=>c()),style:Ye(u.value),innerHTML:s.value},null,14,PC))}}),EC=["id"],NC=["id","loop","muted"],MC=["src"],LC=["id"],_l=je({__name:"screen-layer",props:{layer:{},layerIndex:{},transitioning:{type:Boolean},activeInteractive:{}},setup(e){const t=e,n=Le(),r=An(),o=z(()=>!!(t.activeInteractive&&t.activeInteractive.layer===t.layerIndex)),i=z(()=>r.tree.filter(T=>T.layer===t.layerIndex)),s=z(()=>ve().layout.backgrounds.width),l=z(()=>ve().layout.backgrounds.height),u=z(()=>t.layer),c=z(()=>{const T=Ti(u.value);return T||Te(`Screen ${u.value} doesn't have a config`),T}),p=z(()=>n.isInGame),a=z(()=>c.value.buttons||[]),d=z(()=>c.value.video),h=z(()=>({width:`${s.value}px`,height:`${l.value}px`})),m=z(()=>{let T;return c.value.background!==Fa&&(T=`url(${Jr(c.value.background)})`),{backgroundImage:T,position:"absolute",left:0,top:0,width:`${s.value}px`,height:`${l.value}px`}}),y=z(()=>({position:"absolute",left:0,top:0,width:`${s.value}px`,height:`${l.value}px`}));return(T,g)=>p.value?(R(),ee("div",{key:0,class:"viewport-layer",id:`viewport-layer-${u.value}`,style:Ye(h.value)},[d.value?(R(),ee("video",{key:0,class:"viewport-layer-background",id:`viewport-layer-background-${u.value}`,style:Ye(y.value),autoplay:"",loop:d.value.loop!==!1,muted:!!d.value.muted},[H("source",{src:st(Zt)(c.value.background)},null,8,MC)],12,NC)):(R(),ee("div",{key:1,class:"viewport-layer-background",id:`viewport-layer-background-${u.value}`,style:Ye(m.value)},null,12,LC)),(R(!0),ee(Be,null,lt(a.value,C=>(R(),Oe(jC,{key:C,id:C,layerSelected:o.value,transitioning:T.transitioning,activeInteractive:T.activeInteractive},null,8,["id","layerSelected","transitioning","activeInteractive"]))),128)),(R(!0),ee(Be,null,lt(i.value,C=>(R(),Oe(IC,{key:C.id,screenObject:C,transitioning:T.transitioning,layerSelected:o.value,activeInteractive:T.activeInteractive},null,8,["screenObject","transitioning","layerSelected","activeInteractive"]))),128))],12,EC)):xe("",!0)}}),DC=je({__name:"NarratTransition",props:{name:{type:String,required:!0},duration:{type:Number,required:!0},delay:Number},emits:["complete"],setup(e,{emit:t}){F0();const n=t,r=e,o=be("start"),i=br({oldSlotClasses:{},oldSlotStyle:{},newSlotClasses:{},newSlotStyle:{}});return St(async()=>{const s=`narrat-transition-${r.name}`;i.newSlotClasses={[`${s}-enter-from`]:!0},i.oldSlotClasses={[`${s}-leave-active`]:!0},await cn(30),i.oldSlotStyle={transitionDuration:`${r.duration/1e3}s`},i.newSlotStyle={transitionDuration:`${r.duration/1e3}s`},i.oldSlotClasses[`${s}-leave-to`]=!0,i.newSlotClasses[`${s}-enter-active`]=!0,await cn(r.delay??0),delete i.newSlotClasses[`${s}-enter-from`],await cn(r.duration),o.value="end",n("complete")}),(s,l)=>(R(),ee(Be,null,[o.value!=="end"?(R(),ee("div",{key:0,class:Xe(["transition-holder",i.oldSlotClasses]),style:Ye(i.oldSlotStyle)},[Yo(s.$slots,"oldElement")],6)):xe("",!0),H("div",{class:Xe(["transition-holder",i.newSlotClasses]),style:Ye(i.newSlotStyle)},[Yo(s.$slots,"newElement")],6)],64))}});function Sp(e,t,n){return e<t?t:e>n?n:e}const Zy=je({__name:"screens",setup(e){const t=z(()=>ut().inGameInputListener),n=Le(),r=Vn(),o=An(),i=be(0),s=z(()=>r.nonEmptyLayers),l=z(()=>{const y=[];return s.value.reduce((T,g,C)=>{const N=Ti(g.screen).buttons;if(N)for(const B of N)r.isButtonClickable(B)&&T.push({id:B,type:"button",layer:C});const L=o.tree.filter(B=>B.layer===C);for(const B of L)o.isScreenObjectClickable(B)&&T.push({id:B.id,type:"screenObject",layer:C});return T},y)}),u=z(()=>{if(l.value.length===0)return null;let y=i.value;return y>l.value.length-1&&(y=l.value.length-1),l.value[y]}),c=z(()=>ve().layout.backgrounds.width),p=z(()=>ve().layout.backgrounds.height),a=z(()=>n.isInGame);function d(y){r.finishTransition(y)}const h=z(()=>{const y=c.value;return{height:`${p.value}px`,width:`${y}px`}}),m=z(()=>l.value.length>0);return St(()=>{pi(()=>{if(t.value){const y=t.value.actions;y.previousTab={press:()=>{i.value>0?i.value--:i.value=l.value.length-1,i.value=Sp(i.value,0,l.value.length-1)},active:m},y.left=y.previousTab,y.nextTab={press:()=>{i.value<l.value.length-1?i.value++:i.value=0,i.value=Sp(i.value,0,l.value.length-1)},active:m},y.right=y.nextTab,y.viewportSelect={press:()=>{if(u.value){const T=u.value;T.type==="button"?r.clickOnButton(T.id):T.type==="screenObject"&&o.clickObject(o.getObject(T.id))}},active:m}}})}),Ct(()=>{if(t.value){const y=t.value;delete y.actions.previousTab,delete y.actions.left,delete y.actions.nextTab,delete y.actions.right}}),(y,T)=>a.value?(R(),ee("div",{key:0,class:"viewport",id:"narrat-viewport",style:Ye(h.value)},[(R(!0),ee(Be,null,lt(s.value,(g,C)=>(R(),ee("div",{key:g.screen??"",class:"layer-container"},[g.transition?(R(),Oe(DC,{key:0,name:g.transition.transition,duration:g.transition.duration,delay:g.transition.delay,onComplete:()=>d(C)},{oldElement:et(()=>[g.transition.oldScreen?(R(),Oe(_l,{key:0,layer:g.transition.oldScreen,layerIndex:C,transitioning:!0},null,8,["layer","layerIndex"])):xe("",!0)]),newElement:et(()=>[g.screen?(R(),Oe(_l,{key:0,layer:g.screen,layerIndex:C,transitioning:!0},null,8,["layer","layerIndex"])):xe("",!0)]),_:2},1032,["name","duration","delay","onComplete"])):g.screen?(R(),Oe(_l,{key:1,layer:g.screen,layerIndex:C,transitioning:!1,activeInteractive:u.value},null,8,["layer","layerIndex","activeInteractive"])):xe("",!0)]))),128))],4)):xe("",!0)}}),bn=Ot("hud",{state:()=>({hudStats:{},visible:!0}),actions:{updateConfig(e){for(const t in e.hudStats)this.hudStats[t]||(this.hudStats[t]={value:e.hudStats[t].startingValue})},reset(e){this.$reset(),this.updateConfig(e)},setStat(e,t){this.hudStats[e].value=t,this.getStat(e).value<(_o(e).minValue??0)&&(this.hudStats[e].value=_o(e).minValue??0),this.getStat(e).value>(_o(e).maxValue??1/0)&&(this.hudStats[e].value=_o(e).maxValue??1/0)},addStat(e,t){this.setStat(e,this.getStatValue(e)+t)},getStat(e){return this.hudStats[e]},getStatValue(e){return this.hudStats[e].value},generateSaveData(){return{hudStats:ze(this.hudStats),visible:this.visible}},loadSaveData(e){this.hudStats=Ao(this.hudStats,e.hudStats),this.visible=e.visible},setVisibility(e){this.visible=e}}}),RC=je({data(){return{}},methods:{getStatImage(e){return Zt(this.statsConfig[e].icon)},formatStat(e,t){var n;const r=_o(e),o=r.decimals??2,i=Math.floor(t*10**o)/10**o,s={};(n=r.formatting)!=null&&n.style&&(s.style=r.formatting.style,r.formatting.style==="currency"&&(s.currency=r.formatting.currency??"USD",s.currencyDisplay="narrowSymbol"),r.formatting.style==="unit"&&(s.unit=r.formatting.unit??"day"));let l;try{l=i.toLocaleString(void 0,s)}catch(u){Te(`Error formatting HUD stat, probably using an invalid config: ${u}`),console.error(u),l=i.toLocaleString()}return l},statPrefix(e){const t=_o(e);return t.prefix??(t.suffix||t.hideName?"":t.name)},statSuffix(e){return _o(e).suffix??""}},computed:{...Us(bn,["hudStats"]),...Us(Et,["layoutMode"]),statsConfig(){return ve().hudStats},stats(){return this.hudStats},hudStyle(){let e="0";return this.layoutMode==="horizontal"&&(e=`${_a()+(ve().dialogPanel.rightOffset??ls.common.dialogPanel.rightOffset)}px`),{right:e}},hasHud(){return bn().visible===!1?!1:Object.keys(bn().hudStats).length>0}}}),FC=["src"],BC=["innerHTML"],UC=["innerHTML"];function qC(e,t,n,r,o,i){return e.hasHud?(R(),ee("div",{key:0,class:"hud",style:Ye(e.hudStyle)},[(R(!0),ee(Be,null,lt(e.stats,(s,l)=>(R(),ee("div",{key:l,class:"hud-stat"},[H("img",{class:"hud-icon",src:e.getStatImage(l)},null,8,FC),H("span",{class:"bold hud-text",innerHTML:e.statPrefix(l)},null,8,BC),H("span",null,Se(e.formatStat(l,s.value)),1),e.statSuffix?(R(),ee("span",{key:0,innerHTML:e.statSuffix(l)},null,8,UC)):xe("",!0)]))),128))],4)):xe("",!0)}const eg=Pn(RC,[["render",qC]]),tg=je({__name:"in-game",setup(e){const t=ut(),n=z(()=>t.inGameInputListener),r=Le(),o=Et(),i=z(()=>o.layoutMode),s=z(()=>r.saving),l=be(null),u=rt(),c=be(null),p=z(()=>s.value&&!s.value.withPrompt||s.value&&l.value),a=z(()=>{let y="row";return i.value==="vertical"&&(y="column"),{flexDirection:y}});function d(y){if(l.value=null,y===null){Tl(y,!1);return}Tl(y,!0)}function h(){l.value=!0}function m(){l.value=!1,Tl(null,!1),l.value=null}return Pc(()=>{t.createInGameInputListener()}),St(()=>{c.value=Hn.on("debouncedKeydown",y=>{Le().debugMode||((y.key==="a"||y.key==="A")&&u.toggleAutoPlay(),(y.key==="s"||y.key==="S")&&u.toggleSkip())})}),Ct(()=>{n.value&&t.removeInGameInputListener(),c.value&&Hn.off("debouncedKeydown",c.value)}),z(()=>bn().visible===!1?!1:Object.keys(bn().hudStats).length>0),(y,T)=>(R(),ee("div",{class:"game",style:Ye(a.value)},[Re(eg),Re(Yy),Re(Zy),Re(Qy),p.value?(R(),Oe(qy,{key:0,mode:"pick",onChosen:d,onClose:T[0]||(T[0]=()=>d(null))})):xe("",!0),s.value&&s.value.withPrompt&&l.value===null?(R(),Oe(da,{key:1,prompt:"Would you like to save the game?",onConfirm:h,onRefuse:m})):xe("",!0)],4))}}),VC={class:"chapter-title-scene"},HC=["innerHTML"],KC=["innerHTML"],GC=je({__name:"chapter-title",props:{options:{}},setup(e){const t=e,n=be(null);function r(){n.value=null,vn().changeScene(Yn.Playing),Ue().jumpToLabel(t.options.next_label)}return St(()=>{n.value=setTimeout(r,t.options.duration??2e3)}),Ct(()=>{n.value&&(clearTimeout(n.value),n.value=null)}),(o,i)=>(R(),ee("div",VC,[H("h1",{class:"title chapter-title",innerHTML:t.options.title},null,8,HC),t.options.subtitle?(R(),ee("h2",{key:0,class:"subtitle chapter-subtitle",innerHTML:t.options.subtitle},null,8,KC)):xe("",!0)]))}});var Yn=(e=>(e.EngineSplash="engine-splash",e.GameSplash="game-splash",e.StartMenu="start-menu",e.Playing="playing",e.ChapterTitle="chapter-title",e))(Yn||{});const Cp={"engine-splash":{id:"engine-splash",component:Ss(Fy),props:{}},"game-splash":{id:"game-splash",component:Ss(Uy),props:{}},"start-menu":{id:"start-menu",component:Ss(Gy),props:{}},playing:{id:"playing",component:Ss(tg),props:{}},"chapter-title":{id:"chapter-title",component:Ss(GC),props:{}}};let In={};function WC(e){In=e}function zC(){Cp["engine-splash"].onFinished=()=>{vn().onEngineSplashFinished()},vn().scenes=Cp}function QC(){return In}function ng(){for(const e in In){const t=In[e],n=t.store();let r;Hk(t)&&(r=ft()[t.config]),n.reset&&!t.avoidReset&&n.reset(r)}Ge.plugins.forEach(e=>{e.reset&&e.reset()})}function JC(){const e={};for(const t in In){const n=In[t];if(Dy(n)){const r=n.store();r.generateSaveData?e[n.save]=r.generateSaveData():Te(`Store ${t} has no generateSaveData method. Trying to generate save data for ${n.save}`)}}return Ge.plugins.forEach(t=>{t.save&&(e.plugins[t.pluginId]=t.save())}),Ge.customStores().forEach(([t,n])=>{if(n.save){const r=n.save();r&&(e.customStores==null&&(e.customStores={}),e.customStores[t]=r)}}),e}function rg(){const e={};for(const t in In){const n=In[t];if(Ry(n)){const r=n.store();r.generateGlobalSaveData?e[n.globalSave]=r.generateGlobalSaveData():Te(`Store ${t} has no generateGlobalSaveData method. Trying to generate save data for ${n.globalSave}`)}}return e}function YC(){const e=JC(),t=rg();return{gameSave:e,globalSave:t}}function XC(e){for(const t in In){const n=In[t];if(Dy(n)){const r=n.store();r.loadSaveData?r.loadSaveData(e[n.save]):Te(`Store ${t} has no loadSaveData method. Trying to load save data for ${n.save}`)}}Ge.plugins.forEach(t=>{t.load&&e.plugins[t.pluginId]&&t.load(e.plugins[t.pluginId])}),Ge.customStores().forEach(([t,n])=>{n.load&&n.load(e.customStores[t])})}function og(e){for(const t in In){const n=In[t];if(Ry(n)){const r=n.store();r.loadGlobalSaveData?r.loadGlobalSaveData(e[n.globalSave]):Te(`Store ${t} has no loadGlobalSaveData method. Trying to load global save data for ${n.globalSave}`)}}}function ZC(e){XC(e.gameSave),og(e.globalSave)}function su({slotId:e,name:t}){const n=Le(),r=e??n.saveSlot;n.saveData=A_({slot:r,name:t,extractedSave:YC()}),Le().triggerAutosaveFeedback()}function ex(){const e=rg();I_(e)}function tx(e){ZC(e)}function sg(){Ue().globalData={},ir().globalSave.data={},su({})}function iu({saveName:e,withPrompt:t}){return new Promise(n=>{Ue().hasJumped?Le().startManualSave(n,e,t):n()})}function Tl(e,t){var n;const r=Le();if(!r.saving){Te("No saving in progress!");return}if(!t||!e){r.cancelManualSave();return}r.saveData?(P_(r.saveData,Zo(r.playTime.start,r.playTime.previousPlaytime),e.slotId,(n=r.saving)==null?void 0:n.name),r.alert("Success","Game saved!")):Te("There was no data to save!"),r.cancelManualSave()}const Ue=Ot("vm",{state:()=>({stack:[],data:{},globalData:{},lastLabel:"main",script:{},labelStack:["main"],commandsWaitingForPlayerAnswer:[],promisesWaitingForTextAnimation:[],hasJumped:!1}),actions:{generateSaveData(){return{lastLabel:this.lastLabel,data:cc(this.data,e=>wp(e)?{_entityType:e._entityType,id:e.id}:null)}},generateGlobalSaveData(){return{data:ze(this.globalData)}},loadSaveData(e){this.lastLabel=e.lastLabel,this.data=ze(e.data),this.findEntitiesInData(this.data)},loadGlobalSaveData(e){this.globalData=e.data},findEntitiesInData(e){My(this.data,(t,n,r)=>{if(wp(t)){const o=An().getObject(t.id);o?r[n]=o:ys(`Trying to reload sprite ${n} (${JSON.stringify(t)} - ${t.id}) but it does not exist.`)}})},setReturnValue(e){this.currentFrame.returnValue=e},waitForPlayerAnswer(e){this.commandsWaitingForPlayerAnswer.push(e)},waitForEndTextAnimation(){return new Promise(e=>{this.promisesWaitingForTextAnimation.push(e)})},endTextAnimation(){for(const e of this.promisesWaitingForTextAnimation)e();this.promisesWaitingForTextAnimation=[]},popAnswerQueue(){return this.commandsWaitingForPlayerAnswer.pop()},addScopedVariable(e,t){this.currentFrame&&(this.currentFrame.scope[e]=t)},async loadScripts(e){this.readGlobalData();const t=await this.loadConfigScriptFiles(e),n=Le().options.scripts;this.addAllScripts([...t,...n])},async loadConfigScriptFiles(e){const t=[];for(const n of e)t.push(nu(Xu(n)));return(await Promise.all(t)).map((n,r)=>({fileName:e[r],code:n,id:e[r],type:"script"}))},addAllScripts(e){const t=Date.now();for(const r of e)Ge.addNarratScript(r);const n=Date.now();qn.log(`scripts parsed in ${n-t} ms`)},start(){this.setStack({currentIndex:0,branchData:{branch:Ge.script.main.branch},label:"main"}),this.setStack({currentIndex:0,branchData:{branch:Ge.script.main.branch},label:"main"})},setLastLabel(e){this.lastLabel=e},reset(){this.$reset(),this.stack=[],this.data={},this.hasJumped=!1,this.setStack({currentIndex:0,branchData:{branch:Ge.script.main.branch},label:"main"})},readGlobalData(){this.globalData=ir().globalSave.data},setScript(e){Ge.script=e},overrideData(e){this.data=e},setStack(e){this.stack=[];const t=this.frameOptionsToFrame(e);this.lastLabel=e.label,this.stack.push(t)},frameOptionsToFrame(e){const t=e.branchData,n={...e,blocks:[],scope:{},returnValue:null};if(this.addBlock(n,{branchData:t,currentIndex:e.currentIndex}),e.scope&&(n.scope=e.scope),e.args&&e.branchData.args)for(const[r,o]of e.branchData.args.entries())e.args.length>r&&(n.scope[o]=e.args[r]);return n},addBlock(e,t){e.blocks.push(t)},async addAndRunBlock(e){const t=this.currentFrame;if(!t)throw new Error("No frame to add block to");return this.addBlock(t,e),await this.runBlock()},setData(e,t){const n=fs();cv(n,e,t)},addInstruction(e,t){const n=fs();uv(n,e,t)},addFrame(e){if(!e.label)if(this.currentFrame)e.label=this.currentFrame.label;else throw new Error("Tried to add a new frame but no label was passed and there is no current frame label");const t=this.frameOptionsToFrame(e);this.stack.push(t)},async addAndRunFrame(e){return await this.addFrame(e),await this.runFrame()},async runFrame(){if(!this.currentFrame)throw new Error("Tried to run a frame but there is no current frame");let e;for(;this.currentBlock;){const t=await this.runBlock();if(t===ra||t===oa)return this.cleanFrame(),t;if(t===Kc)return this.cleanFrame()}return this.cleanFrame(),e},cleanFrame(){const e=this.currentFrame,{returnValue:t}=e;return this.stack.splice(this.stack.length-1,1),t},async runBlock(){const e=this.currentBlock;if(!e)throw new Error("Tried to run a block but there is no current block");let t;for(;this.currentLine;){if(t=await this.runLineOnly(),vT(t))return this.cleanBlock(),t;e.currentIndex++}return this.cleanBlock(),t},cleanBlock(){if(!this.currentFrame){Te("Tried to clean a block but there is no current frame");return}if(!this.currentFrame.blocks){Te("Tried to clean a block but there is no current block");return}this.currentFrame.blocks.splice(this.currentFrame.blocks.length-1,1)},async runGame(){let e=await this.runFrame();for(;e===ra;){const t=this.jumpTarget;if(!t){Te("Tried to jump but no target was set");return}this.hasJumped=!0,this.setStack(t);const n=ve().saves.autosaveDisabledOnLabels;(!n||!n.includes(t.label))&&await su({}),e=await this.runFrame()}e!==oa&&this.stack.length===0&&this.reachedEndOfScript()},async nextLineOnly(){return this.stack.length===0||this.isBlockFinished()?!1:(this.currentBlock.currentIndex++,!0)},isBlockFinished(){return!this.currentBlock||this.currentBlock&&this.currentBlock.currentIndex>=this.currentBlock.branchData.branch.length},reachedEndOfScript(){if(ve().gameFlow.labelToJumpOnScriptEnd&&this.lastLabel!==ve().gameFlow.labelToJumpOnScriptEnd){this.jumpToLabel(ve().gameFlow.labelToJumpOnScriptEnd);return}Le().endingScript(),Le().options.debug&&ve().debugging.showScriptFinishedMessage},async runLineOnly(){const e=this.currentLine;if(!e){Te("There is no line of script to run.");return}return Le().startingScript(),await dg(e)},async runLabelFunction(e,...t){const n=Ge.script[e];if(!n){Te(`Tried to run a label that doesn't exist: ${e}`);return}const r={currentIndex:0,branchData:n,label:e,args:t};return this.addAndRunFrame(r)},runCustomFrame(e){this.addAndRunFrame(e)},async jumpToLabel(e,...t){const n=Ge.script[e];if(!n){Te(`Label ${e} doesn't exist. Is the file with this label added in the list of script files to load in the config?`);return}e!==this.lastLabel&&(this.hasJumped=!0),this.setLastLabel(e),this.setStack({currentIndex:0,branchData:n,args:t,label:e}),this.runGame()},async runThenGoBackToPreviousDialog(e,...t){const n=rt(),r=n.dialog[n.dialog.length-1],o=Le().inScript,i=await this.runLabelFunction(e,...t);return o?n.dialog.push(r):Le().endingScript(),i}},getters:{currentFrame(e){return e.stack[e.stack.length-1]},scope(){var e;return((e=this.currentFrame)==null?void 0:e.scope)??{}},currentBlock(){const e=this.currentFrame;return e?e.blocks[e.blocks.length-1]:void 0},currentLine(){const e=this.currentBlock;if(e&&e.branchData.branch.length>e.currentIndex)return e.branchData.branch[e.currentIndex]},commandWaitingForAnswer(){if(this.commandsWaitingForPlayerAnswer.length>0)return this.commandsWaitingForPlayerAnswer[0]}}}),ig=new Bc;ig.setupDebugger(!1);const wn=ig.logger;function nx(e){return rx((t,n,r)=>gx(t,n,r),e.code,e.fileName)}function rx(e,t,n){const r={fileName:n,currentLine:0,error:(s,l)=>e(r,s,l),processCommandsFunction:Xl,indentSize:0};r.indentSize=px(r,t);const o=cx(r,t);r.currentLine=0,wn.log(o);const i={};for(const s of o){s.code.search(":")===-1&&r.error(s.line,"First indentation level should only be used to specify labels");const l=s.code.replace(":","").split(/ +/g),u=l[0],c=l.slice(1);s.branch||r.error(s.line,"This line should have a branch but doesn't"),i[u]={branch:Xl(r,s.branch,void 0),args:c}}return i}function Xl(e,t,n){const r=e.currentLine;if(!t){let s=0;return n&&(s=n.line),e.error(s,"Processing of command failed because the current branch has no lines inside"),[]}const o={processCommandsFunction:Xl,parserContext:e,lines:t,currentLine:0,line:t[0]},i=[];for(;o.currentLine<t.length;){const s=t[o.currentLine];o.line=s;const l=ag(e,s,s.expression),u=Ge.commands[l.command.operator];let c=u==null?void 0:u.parser;c||(c=Ge.commands.text.parser),wn.log(Ge.commands.text);const{newLine:p}=c(o,l);o.currentLine=p,e.currentLine=r+p,i.push(l)}return i}function ag(e,t,n){Array.isArray(n)||e.error(t.line,`Expression should be an array. Something is wrong. ${e.fileName}:${e.currentLine} - ${t.code}`),wn.log(n),typeof n[0]!="string"&&e.error(t.line,`Expression operator should be a string ${e.fileName}:${e.currentLine} - ${t.code}`);const r={code:t.code,fileName:e.fileName,line:t.line,command:{staticOptions:{},commandType:n[0],operator:n[0],args:n.slice(1).map(i=>lg(e,t,i)),options:{}}},o=n[0];if(!Ge.commands[o]){const i=["else","success","failure"];!q_(o)&&!i.includes(o)&&e.error(t.line,`Unknown command ${o}`)}return r}function lg(e,t,n){return Array.isArray(n)?ag(e,t,n):n}function ox(e){return e==="true"?!0:e==="false"?!1:e==="undefined"?void 0:e===null?null:isNaN(Number(e))?e:Number(e)}function sx(e,t){t.charAt(t.length-1)===":"&&(t=t.substr(0,t.length-1));const n=ix(t),[r]=cg(e,n);return r}function ix(e){const t=/(["'])(?:\\\1|.)*?\1/g,n=[];let r;for(;(r=t.exec(e))!=null;)n.push(r);let o=0,i=[];for(const s of n){const l=s.index;if(l>o){const c=e.substr(o,l-o),p=xp(c);i=[...i,...p]}const u=s[0].replace(/\\/g,"");i.push(`$$"${u.substring(1,u.length-1)}`),o=l+s[0].length}return i=[...i,...xp(e.substr(o))],i.push(")"),i}function xp(e){e=e.replace(/: *$/g,"");let t=e.split(" ").filter(n=>n);return t=t.reduce((n,r)=>[...n,...r.split(/(\(|\))/g)].filter(o=>o&&o),[]),t.map(n=>ox(n))}function cg(e,t){wn.log("===============");let n=[],r=0,o=$p(t)+r,i=wl(t)+r;for(wn.log(`Parsing expression: ${t}`),wn.log(`Parenthesis start index: ${o} - end: ${i}`);o!==-1&&i>o;){n=[...n,...t.slice(r,o)];const u=t.slice(o+1);wn.log(`Found a sub expression. Before: ${n} - After: ${u}`),r=o;const[c,p]=cg(e,u),a=r+p;n.push(c),r=a+1;const d=t.slice(r);wn.log(`Sub expression came back: ${c} - rest of string: ${d}`),o=$p(d),o!==-1&&(o+=r),i=wl(d),i!==-1&&(i+=r)}i!==-1&&wn.log("Found parenthesis end before new opening parenthesis, close this expression");const s=wl(t.slice(r))+r;if(s===-1)return e.error(e.currentLine,'Expression is not closed (missing ")" closing parenthesis)'),[n,s];const l=t.slice(r,s);return wn.log(`End of expression: ${s} - ${l}`),wn.log("==================="),n=[...n,...l],ax(e,n),[n,s+1]}function ax(e,t){t.length<1&&e.error(e.currentLine,"Expression is empty")}function $p(e){return e.findIndex(t=>t==="(")}function wl(e){return e.findIndex(t=>t===")")}function lx(e,t){return t.split(/\r?\n|$/).reduce((n,r,o)=>{const i={code:r,line:o,multiline:!1},s=r.search(/\\$/);s!==-1&&(i.multiline=!0,r=r.substring(0,s));const l=r.search(/ *\/\//g);return l!==-1&&(r=r.substring(0,l)),i.code=r,i.code.search(/^\s*$/)===-1&&(n.length>0&&n[n.length-1].multiline?(n[n.length-1].code+=r,n[n.length-1].multiline=i.multiline):n.push(i)),n},[])}function cx(e,t){const n=lx(e,t);return ug(e,n,0,0).lines}function ug(e,t,n,r){let o=!0,i=n;const s=[];for(;o&&!(i>=t.length);){const l=t[i];let u=l.code;const c=dx(e,u);if(u=u.substring(c*e.indentSize),ux(e,c,i),c<r)o=!1;else if(c>r){(s.length===0||c-r!==1)&&e.error(l.line,"Wrong double indentation");const p=ug(e,t,i,c);s[s.length-1].branch=p.lines,i=p.endLine}else{const p=sx(e,u),a={code:u,indentation:c,line:l.line,expression:p};s.push(a),i++,e.currentLine=i}}return{lines:s,endLine:i}}function ux(e,t,n){t%1!==0&&e.error(n,`Indentation level of ${t} incorrect. Expected indentation of ${e.indentSize} spaces for this file.`)}function dx(e,t){return t.search(/[^ ]/)/e.indentSize}function px(e,t){const n=t.match(/: *[\n\r]+( *)/);return!n||n.length<2?(e.error(0,"Can't detect indentation level. Make sure you indent with at least 2 spaces and consistently"),0):(wn.log(n),n[1].length)}class fx{constructor(){ot(this,"plugins",[]),ot(this,"pinia"),ot(this,"script",{}),ot(this,"scripts",[]),ot(this,"commands",{})}addCommand(t){this.commands[t.keyword]=t}addPlugin(t){if(this.plugins.push(t),t.customCommands)for(const n of t.customCommands)this.addCommand(n)}callHook(t,...n){for(const r of this.plugins)typeof r[t]=="function"&&r[t](...n)}addNarratScript(t){const n=nx(t);this.script={...this.script,...n},this.scripts.push(t)}customStores(){const t=[];for(const n of this.plugins)if(n.customStores)for(const r in n.customStores)t.push([r,n.customStores[r](this.pinia)]);return t}addCustomSettings(){for(const t of this.plugins)if(t.customSettings)for(const n in t.customSettings)sr().addCustomSetting(n,t.customSettings[n])}}const Ge=new fx;async function dg(e,t){var n;const r=Ue();try{return await Wa(e,t)}catch(o){console.error(o),console.error(e),Te(`Narrat script runtime error at  <span class="error-filename">${e.fileName}:${e.line+1}</span>
      <b>${o}</b>
      Script: ${e.code}
      Label: ${((n=r.currentFrame)==null?void 0:n.label)||"none"}`)}}async function hx(e,t){const n=e.command,r=Ge.commands[n.commandType];if(r){const o={args:[],options:{},operator:n.operator,staticOptions:n.staticOptions,code:e.code,commandType:n.commandType,fileName:e.fileName,line:e.line},i=r.argTypes;o.options={};for(const[s,l]of n.args.entries()){let u;if(zc(l)?u=await Wa(l,t):typeof l=="string"?l.search(Rh)===0?u=Cr(l.substring(3)):Qc(l)?u=pg(l):u=l:u=l,o.args.push(u),Array.isArray(i)&&i.length>s){const c=i[s];u!==null&&(o.options[c.name]=u)}}return o}else throw new Error(`${n.commandType} is not a valid command`)}function pg(e){const t=fs(),n=SI(t,e);if(n){const[r,o]=n;return r[o]}else return e}async function Wa(e,t){const n=await hx(e,t),r=Ge.commands[n.commandType];if(r)return await r.run(n,t);throw new Error(`${n.commandType} is not a valid command`)}async function fg(e){ms("onPlayerAnswered");const t=Ue(),n=t.popAnswerQueue(),r=t.currentLine;try{if(n){const o=Ge.commands[n.commandType];if(o)return await o.processPlayerAnswer(n,e)}}catch(o){console.error(o),Te(`Error after player answer at ${r.fileName}:${r.line+1} (${r.code}<br /> - Error: ${o}`)}}function mx(){return{baseAssetsPath:"",baseDataPath:"",configPath:"data/config.json",logging:!1,debug:!1,scripts:[],container:"#game-holder"}}class yx extends ru{}const Le=Ot("main",{state:()=>({ready:!1,playing:!1,errors:[],playTime:{start:0,previousPlaytime:0},saveSlot:"",paused:!1,debugMode:!0,options:{baseAssetsPath:"",baseDataPath:"",configPath:"data/config.json",logging:!1,debug:!1,scripts:[]},loading:{step:"Loading",percentage:.1,loaded:!1},alerts:[],saving:null,listener:new yx,inScript:!1,autosaveFeedback:!1}),actions:{setLoadingStep(e,t){this.loading.step=e,this.loading.percentage=t},gameLoaded(){this.loading.loaded=!0,this.listener.emit("gameLoaded")},async alert(e,t){return new Promise(n=>{this.alerts.push({title:e,text:t,resolver:n,id:as()})})},closeAlert(e){const t=this.alerts.findIndex(n=>n.id===e);t!==-1&&(this.alerts[t].resolver(),this.alerts.splice(t,1))},startingScript(){Xt().onScriptStart(),this.inScript=!0},endingScript(){Xt().onScriptEnd(),this.inScript=!1},prepareToPlay(){this.ready=!0,this.startPlaying(),vn().goToGameScene()},setSaveSlot(e){this.saveSlot=e,k_(e)},startManualSave(e,t,n){this.saving={name:t,withPrompt:n,resolver:e}},cancelManualSave(){this.saving&&(this.saving.resolver(),this.saving=null)},playerAnswered(e){fg(e)},menuReturn(){vn().goToStartMenuScene()},createError(e){this.errors.push({text:e,type:"error"})},createWarning(e){this.errors.push({text:e,type:"warning"})},clearErrors(){this.errors=[]},pause(){this.paused=!0},unpause(){this.paused=!1},setOptions(e){this.options=e},startPlaying(){this.playing=!0,this.playTime.start=Date.now()},reset(){this.ready=!1,this.paused=!1,this.playing=!1,this.ready=!0},generateSaveData(){return{playTime:Zo(this.playTime.start,this.playTime.previousPlaytime)}},loadSaveData(e){this.playTime.previousPlaytime=e.playTime},async triggerAutosaveFeedback(){const e=ve().saves.autosaveFeedback;e&&e.enabled&&(this.autosaveFeedback=!0,await cn(e.duration*1e3),this.autosaveFeedback=!1)},exitGame(){window.close()}},getters:{isInGame(e){return vn().isPlaying},totalPlayTime(e){return Zo(e.playTime.start,e.playTime.previousPlaytime)},sessionPlayTime(e){return Zo(e.playTime.start,0)},hasCustomContainer(e){return(e.options.container??"")!=="#game-holder"}}});function gx(e,t,n){console.error(`Parser error: ${e.fileName}:${e.currentLine}`,n);const r=`[Parser Error] in <span class="error-filename">${e.fileName}:${t+1}</span> - <b>${n}</b>`;Te(r)}function Te(e,...t){const n=Le();console.error(e,...t),e=e.replace(/[\r\n]/g,`
<br />`),n.createError(`❌ ${e}`)}function ys(e,...t){const n=Le();console.warn(e,...t),e=e.replace(/[\r\n]/g,`
<br />`),n.createWarning(`⚠️ ${e}`)}const au=f.Type.Object({screens:f.Type.Union([f.Type.String(),gm]),buttons:f.Type.Optional(f.Type.Union([f.Type.String(),hm])),skills:f.Type.Optional(f.Type.Union([f.Type.String(),Tm])),skillChecks:f.Type.Optional(f.Type.Union([f.Type.String(),Pm])),scripts:f.Type.Optional(f.Type.Union([f.Type.String(),om])),audio:f.Type.Union([f.Type.String(),Hh]),tooltips:f.Type.Optional(f.Type.Union([f.Type.String(),Cm])),items:f.Type.Optional(f.Type.Union([f.Type.String(),cm])),achievements:f.Type.Optional(f.Type.Union([f.Type.String(),Am])),quests:f.Type.Optional(f.Type.Union([f.Type.String(),dm])),characters:f.Type.Union([f.Type.String(),km]),choices:f.Type.Optional(f.Type.Union([f.Type.String(),Nm])),animations:f.Type.Optional(f.Type.Union([f.Type.String(),Dm])),macros:f.Type.Optional(Fm),preload:f.Type.Optional(Um),fonts:f.Type.Optional(Vm)}),hg=f.Type.Intersect([au,f.Type.Object({common:im})]),mg=f.Type.Intersect([au,f.Type.Object({baseAssetsPath:f.Type.Optional(f.Type.String()),baseDataPath:f.Type.Optional(f.Type.String()),gameTitle:f.Type.String(),saveFileName:f.Type.String(),images:f.Type.Optional(f.Type.Record(f.Type.String(),f.Type.String())),layout:Gh,settings:f.Type.Optional(Wh),gameFlow:f.Type.Optional(f.Type.Object({labelToJumpOnScriptEnd:f.Type.Optional(f.Type.String())})),dialogPanel:f.Type.Optional(zh),splashScreens:f.Type.Optional(Qh),notifications:f.Type.Optional(Jh),hudStats:Yh,interactionTags:f.Type.Optional(Xh),transitions:f.Type.Optional(Zh),menuButtons:f.Type.Optional(em),debugging:f.Type.Optional(tm),saves:f.Type.Optional(nm),input:f.Type.Optional(sm),graphics:f.Type.Optional(rm)})]),yg=f.Type.Union([hg,mg]);function lu(e){return"common"in e}var Zl={exports:{}},gg={},Fn={},ds={},mi={},Je={},ai={};(function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.regexpCode=e.getEsmExportName=e.getProperty=e.safeStringify=e.stringify=e.strConcat=e.addCodeArg=e.str=e._=e.nil=e._Code=e.Name=e.IDENTIFIER=e._CodeOrName=void 0;class t{}e._CodeOrName=t,e.IDENTIFIER=/^[a-z$_][a-z$_0-9]*$/i;class n extends t{constructor(C){if(super(),!e.IDENTIFIER.test(C))throw new Error("CodeGen: name must be a valid identifier");this.str=C}toString(){return this.str}emptyStr(){return!1}get names(){return{[this.str]:1}}}e.Name=n;class r extends t{constructor(C){super(),this._items=typeof C=="string"?[C]:C}toString(){return this.str}emptyStr(){if(this._items.length>1)return!1;const C=this._items[0];return C===""||C==='""'}get str(){var C;return(C=this._str)!==null&&C!==void 0?C:this._str=this._items.reduce((N,L)=>`${N}${L}`,"")}get names(){var C;return(C=this._names)!==null&&C!==void 0?C:this._names=this._items.reduce((N,L)=>(L instanceof n&&(N[L.str]=(N[L.str]||0)+1),N),{})}}e._Code=r,e.nil=new r("");function o(g,...C){const N=[g[0]];let L=0;for(;L<C.length;)l(N,C[L]),N.push(g[++L]);return new r(N)}e._=o;const i=new r("+");function s(g,...C){const N=[h(g[0])];let L=0;for(;L<C.length;)N.push(i),l(N,C[L]),N.push(i,h(g[++L]));return u(N),new r(N)}e.str=s;function l(g,C){C instanceof r?g.push(...C._items):C instanceof n?g.push(C):g.push(a(C))}e.addCodeArg=l;function u(g){let C=1;for(;C<g.length-1;){if(g[C]===i){const N=c(g[C-1],g[C+1]);if(N!==void 0){g.splice(C-1,3,N);continue}g[C++]="+"}C++}}function c(g,C){if(C==='""')return g;if(g==='""')return C;if(typeof g=="string")return C instanceof n||g[g.length-1]!=='"'?void 0:typeof C!="string"?`${g.slice(0,-1)}${C}"`:C[0]==='"'?g.slice(0,-1)+C.slice(1):void 0;if(typeof C=="string"&&C[0]==='"'&&!(g instanceof n))return`"${g}${C.slice(1)}`}function p(g,C){return C.emptyStr()?g:g.emptyStr()?C:s`${g}${C}`}e.strConcat=p;function a(g){return typeof g=="number"||typeof g=="boolean"||g===null?g:h(Array.isArray(g)?g.join(","):g)}function d(g){return new r(h(g))}e.stringify=d;function h(g){return JSON.stringify(g).replace(/\u2028/g,"\\u2028").replace(/\u2029/g,"\\u2029")}e.safeStringify=h;function m(g){return typeof g=="string"&&e.IDENTIFIER.test(g)?new r(`.${g}`):o`[${g}]`}e.getProperty=m;function y(g){if(typeof g=="string"&&e.IDENTIFIER.test(g))return new r(`${g}`);throw new Error(`CodeGen: invalid export name: ${g}, use explicit $id name mapping`)}e.getEsmExportName=y;function T(g){return new r(g.toString())}e.regexpCode=T})(ai);var ec={};(function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.ValueScope=e.ValueScopeName=e.Scope=e.varKinds=e.UsedValueState=void 0;const t=ai;class n extends Error{constructor(c){super(`CodeGen: "code" for ${c} not defined`),this.value=c.value}}var r;(function(u){u[u.Started=0]="Started",u[u.Completed=1]="Completed"})(r=e.UsedValueState||(e.UsedValueState={})),e.varKinds={const:new t.Name("const"),let:new t.Name("let"),var:new t.Name("var")};class o{constructor({prefixes:c,parent:p}={}){this._names={},this._prefixes=c,this._parent=p}toName(c){return c instanceof t.Name?c:this.name(c)}name(c){return new t.Name(this._newName(c))}_newName(c){const p=this._names[c]||this._nameGroup(c);return`${c}${p.index++}`}_nameGroup(c){var p,a;if(!((a=(p=this._parent)===null||p===void 0?void 0:p._prefixes)===null||a===void 0)&&a.has(c)||this._prefixes&&!this._prefixes.has(c))throw new Error(`CodeGen: prefix "${c}" is not allowed in this scope`);return this._names[c]={prefix:c,index:0}}}e.Scope=o;class i extends t.Name{constructor(c,p){super(p),this.prefix=c}setValue(c,{property:p,itemIndex:a}){this.value=c,this.scopePath=(0,t._)`.${new t.Name(p)}[${a}]`}}e.ValueScopeName=i;const s=(0,t._)`\n`;class l extends o{constructor(c){super(c),this._values={},this._scope=c.scope,this.opts={...c,_n:c.lines?s:t.nil}}get(){return this._scope}name(c){return new i(c,this._newName(c))}value(c,p){var a;if(p.ref===void 0)throw new Error("CodeGen: ref must be passed in value");const d=this.toName(c),{prefix:h}=d,m=(a=p.key)!==null&&a!==void 0?a:p.ref;let y=this._values[h];if(y){const C=y.get(m);if(C)return C}else y=this._values[h]=new Map;y.set(m,d);const T=this._scope[h]||(this._scope[h]=[]),g=T.length;return T[g]=p.ref,d.setValue(p,{property:h,itemIndex:g}),d}getValue(c,p){const a=this._values[c];if(a)return a.get(p)}scopeRefs(c,p=this._values){return this._reduceValues(p,a=>{if(a.scopePath===void 0)throw new Error(`CodeGen: name "${a}" has no value`);return(0,t._)`${c}${a.scopePath}`})}scopeCode(c=this._values,p,a){return this._reduceValues(c,d=>{if(d.value===void 0)throw new Error(`CodeGen: name "${d}" has no value`);return d.value.code},p,a)}_reduceValues(c,p,a={},d){let h=t.nil;for(const m in c){const y=c[m];if(!y)continue;const T=a[m]=a[m]||new Map;y.forEach(g=>{if(T.has(g))return;T.set(g,r.Started);let C=p(g);if(C){const N=this.opts.es5?e.varKinds.var:e.varKinds.const;h=(0,t._)`${h}${N} ${g} = ${C};${this.opts._n}`}else if(C=d==null?void 0:d(g))h=(0,t._)`${h}${C}${this.opts._n}`;else throw new n(g);T.set(g,r.Completed)})}return h}}e.ValueScope=l})(ec);(function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.or=e.and=e.not=e.CodeGen=e.operators=e.varKinds=e.ValueScopeName=e.ValueScope=e.Scope=e.Name=e.regexpCode=e.stringify=e.getProperty=e.nil=e.strConcat=e.str=e._=void 0;const t=ai,n=ec;var r=ai;Object.defineProperty(e,"_",{enumerable:!0,get:function(){return r._}}),Object.defineProperty(e,"str",{enumerable:!0,get:function(){return r.str}}),Object.defineProperty(e,"strConcat",{enumerable:!0,get:function(){return r.strConcat}}),Object.defineProperty(e,"nil",{enumerable:!0,get:function(){return r.nil}}),Object.defineProperty(e,"getProperty",{enumerable:!0,get:function(){return r.getProperty}}),Object.defineProperty(e,"stringify",{enumerable:!0,get:function(){return r.stringify}}),Object.defineProperty(e,"regexpCode",{enumerable:!0,get:function(){return r.regexpCode}}),Object.defineProperty(e,"Name",{enumerable:!0,get:function(){return r.Name}});var o=ec;Object.defineProperty(e,"Scope",{enumerable:!0,get:function(){return o.Scope}}),Object.defineProperty(e,"ValueScope",{enumerable:!0,get:function(){return o.ValueScope}}),Object.defineProperty(e,"ValueScopeName",{enumerable:!0,get:function(){return o.ValueScopeName}}),Object.defineProperty(e,"varKinds",{enumerable:!0,get:function(){return o.varKinds}}),e.operators={GT:new t._Code(">"),GTE:new t._Code(">="),LT:new t._Code("<"),LTE:new t._Code("<="),EQ:new t._Code("==="),NEQ:new t._Code("!=="),NOT:new t._Code("!"),OR:new t._Code("||"),AND:new t._Code("&&"),ADD:new t._Code("+")};class i{optimizeNodes(){return this}optimizeNames(b,w){return this}}class s extends i{constructor(b,w,I){super(),this.varKind=b,this.name=w,this.rhs=I}render({es5:b,_n:w}){const I=b?n.varKinds.var:this.varKind,G=this.rhs===void 0?"":` = ${this.rhs}`;return`${I} ${this.name}${G};`+w}optimizeNames(b,w){if(b[this.name.str])return this.rhs&&(this.rhs=ae(this.rhs,b,w)),this}get names(){return this.rhs instanceof t._CodeOrName?this.rhs.names:{}}}class l extends i{constructor(b,w,I){super(),this.lhs=b,this.rhs=w,this.sideEffects=I}render({_n:b}){return`${this.lhs} = ${this.rhs};`+b}optimizeNames(b,w){if(!(this.lhs instanceof t.Name&&!b[this.lhs.str]&&!this.sideEffects))return this.rhs=ae(this.rhs,b,w),this}get names(){const b=this.lhs instanceof t.Name?{}:{...this.lhs.names};return Q(b,this.rhs)}}class u extends l{constructor(b,w,I,G){super(b,I,G),this.op=w}render({_n:b}){return`${this.lhs} ${this.op}= ${this.rhs};`+b}}class c extends i{constructor(b){super(),this.label=b,this.names={}}render({_n:b}){return`${this.label}:`+b}}class p extends i{constructor(b){super(),this.label=b,this.names={}}render({_n:b}){return`break${this.label?` ${this.label}`:""};`+b}}class a extends i{constructor(b){super(),this.error=b}render({_n:b}){return`throw ${this.error};`+b}get names(){return this.error.names}}class d extends i{constructor(b){super(),this.code=b}render({_n:b}){return`${this.code};`+b}optimizeNodes(){return`${this.code}`?this:void 0}optimizeNames(b,w){return this.code=ae(this.code,b,w),this}get names(){return this.code instanceof t._CodeOrName?this.code.names:{}}}class h extends i{constructor(b=[]){super(),this.nodes=b}render(b){return this.nodes.reduce((w,I)=>w+I.render(b),"")}optimizeNodes(){const{nodes:b}=this;let w=b.length;for(;w--;){const I=b[w].optimizeNodes();Array.isArray(I)?b.splice(w,1,...I):I?b[w]=I:b.splice(w,1)}return b.length>0?this:void 0}optimizeNames(b,w){const{nodes:I}=this;let G=I.length;for(;G--;){const Z=I[G];Z.optimizeNames(b,w)||(ke(b,Z.names),I.splice(G,1))}return I.length>0?this:void 0}get names(){return this.nodes.reduce((b,w)=>te(b,w.names),{})}}class m extends h{render(b){return"{"+b._n+super.render(b)+"}"+b._n}}class y extends h{}class T extends m{}T.kind="else";class g extends m{constructor(b,w){super(w),this.condition=b}render(b){let w=`if(${this.condition})`+super.render(b);return this.else&&(w+="else "+this.else.render(b)),w}optimizeNodes(){super.optimizeNodes();const b=this.condition;if(b===!0)return this.nodes;let w=this.else;if(w){const I=w.optimizeNodes();w=this.else=Array.isArray(I)?new T(I):I}if(w)return b===!1?w instanceof g?w:w.nodes:this.nodes.length?this:new g(Ee(b),w instanceof g?[w]:w.nodes);if(!(b===!1||!this.nodes.length))return this}optimizeNames(b,w){var I;if(this.else=(I=this.else)===null||I===void 0?void 0:I.optimizeNames(b,w),!!(super.optimizeNames(b,w)||this.else))return this.condition=ae(this.condition,b,w),this}get names(){const b=super.names;return Q(b,this.condition),this.else&&te(b,this.else.names),b}}g.kind="if";class C extends m{}C.kind="for";class N extends C{constructor(b){super(),this.iteration=b}render(b){return`for(${this.iteration})`+super.render(b)}optimizeNames(b,w){if(super.optimizeNames(b,w))return this.iteration=ae(this.iteration,b,w),this}get names(){return te(super.names,this.iteration.names)}}class L extends C{constructor(b,w,I,G){super(),this.varKind=b,this.name=w,this.from=I,this.to=G}render(b){const w=b.es5?n.varKinds.var:this.varKind,{name:I,from:G,to:Z}=this;return`for(${w} ${I}=${G}; ${I}<${Z}; ${I}++)`+super.render(b)}get names(){const b=Q(super.names,this.from);return Q(b,this.to)}}class B extends C{constructor(b,w,I,G){super(),this.loop=b,this.varKind=w,this.name=I,this.iterable=G}render(b){return`for(${this.varKind} ${this.name} ${this.loop} ${this.iterable})`+super.render(b)}optimizeNames(b,w){if(super.optimizeNames(b,w))return this.iterable=ae(this.iterable,b,w),this}get names(){return te(super.names,this.iterable.names)}}class M extends m{constructor(b,w,I){super(),this.name=b,this.args=w,this.async=I}render(b){return`${this.async?"async ":""}function ${this.name}(${this.args})`+super.render(b)}}M.kind="func";class E extends h{render(b){return"return "+super.render(b)}}E.kind="return";class W extends m{render(b){let w="try"+super.render(b);return this.catch&&(w+=this.catch.render(b)),this.finally&&(w+=this.finally.render(b)),w}optimizeNodes(){var b,w;return super.optimizeNodes(),(b=this.catch)===null||b===void 0||b.optimizeNodes(),(w=this.finally)===null||w===void 0||w.optimizeNodes(),this}optimizeNames(b,w){var I,G;return super.optimizeNames(b,w),(I=this.catch)===null||I===void 0||I.optimizeNames(b,w),(G=this.finally)===null||G===void 0||G.optimizeNames(b,w),this}get names(){const b=super.names;return this.catch&&te(b,this.catch.names),this.finally&&te(b,this.finally.names),b}}class q extends m{constructor(b){super(),this.error=b}render(b){return`catch(${this.error})`+super.render(b)}}q.kind="catch";class ue extends m{render(b){return"finally"+super.render(b)}}ue.kind="finally";class ce{constructor(b,w={}){this._values={},this._blockStarts=[],this._constants={},this.opts={...w,_n:w.lines?`
`:""},this._extScope=b,this._scope=new n.Scope({parent:b}),this._nodes=[new y]}toString(){return this._root.render(this.opts)}name(b){return this._scope.name(b)}scopeName(b){return this._extScope.name(b)}scopeValue(b,w){const I=this._extScope.value(b,w);return(this._values[I.prefix]||(this._values[I.prefix]=new Set)).add(I),I}getScopeValue(b,w){return this._extScope.getValue(b,w)}scopeRefs(b){return this._extScope.scopeRefs(b,this._values)}scopeCode(){return this._extScope.scopeCode(this._values)}_def(b,w,I,G){const Z=this._scope.toName(w);return I!==void 0&&G&&(this._constants[Z.str]=I),this._leafNode(new s(b,Z,I)),Z}const(b,w,I){return this._def(n.varKinds.const,b,w,I)}let(b,w,I){return this._def(n.varKinds.let,b,w,I)}var(b,w,I){return this._def(n.varKinds.var,b,w,I)}assign(b,w,I){return this._leafNode(new l(b,w,I))}add(b,w){return this._leafNode(new u(b,e.operators.ADD,w))}code(b){return typeof b=="function"?b():b!==t.nil&&this._leafNode(new d(b)),this}object(...b){const w=["{"];for(const[I,G]of b)w.length>1&&w.push(","),w.push(I),(I!==G||this.opts.es5)&&(w.push(":"),(0,t.addCodeArg)(w,G));return w.push("}"),new t._Code(w)}if(b,w,I){if(this._blockNode(new g(b)),w&&I)this.code(w).else().code(I).endIf();else if(w)this.code(w).endIf();else if(I)throw new Error('CodeGen: "else" body without "then" body');return this}elseIf(b){return this._elseNode(new g(b))}else(){return this._elseNode(new T)}endIf(){return this._endBlockNode(g,T)}_for(b,w){return this._blockNode(b),w&&this.code(w).endFor(),this}for(b,w){return this._for(new N(b),w)}forRange(b,w,I,G,Z=this.opts.es5?n.varKinds.var:n.varKinds.let){const he=this._scope.toName(b);return this._for(new L(Z,he,w,I),()=>G(he))}forOf(b,w,I,G=n.varKinds.const){const Z=this._scope.toName(b);if(this.opts.es5){const he=w instanceof t.Name?w:this.var("_arr",w);return this.forRange("_i",0,(0,t._)`${he}.length`,le=>{this.var(Z,(0,t._)`${he}[${le}]`),I(Z)})}return this._for(new B("of",G,Z,w),()=>I(Z))}forIn(b,w,I,G=this.opts.es5?n.varKinds.var:n.varKinds.const){if(this.opts.ownProperties)return this.forOf(b,(0,t._)`Object.keys(${w})`,I);const Z=this._scope.toName(b);return this._for(new B("in",G,Z,w),()=>I(Z))}endFor(){return this._endBlockNode(C)}label(b){return this._leafNode(new c(b))}break(b){return this._leafNode(new p(b))}return(b){const w=new E;if(this._blockNode(w),this.code(b),w.nodes.length!==1)throw new Error('CodeGen: "return" should have one node');return this._endBlockNode(E)}try(b,w,I){if(!w&&!I)throw new Error('CodeGen: "try" without "catch" and "finally"');const G=new W;if(this._blockNode(G),this.code(b),w){const Z=this.name("e");this._currNode=G.catch=new q(Z),w(Z)}return I&&(this._currNode=G.finally=new ue,this.code(I)),this._endBlockNode(q,ue)}throw(b){return this._leafNode(new a(b))}block(b,w){return this._blockStarts.push(this._nodes.length),b&&this.code(b).endBlock(w),this}endBlock(b){const w=this._blockStarts.pop();if(w===void 0)throw new Error("CodeGen: not in self-balancing block");const I=this._nodes.length-w;if(I<0||b!==void 0&&I!==b)throw new Error(`CodeGen: wrong number of nodes: ${I} vs ${b} expected`);return this._nodes.length=w,this}func(b,w=t.nil,I,G){return this._blockNode(new M(b,w,I)),G&&this.code(G).endFunc(),this}endFunc(){return this._endBlockNode(M)}optimize(b=1){for(;b-- >0;)this._root.optimizeNodes(),this._root.optimizeNames(this._root.names,this._constants)}_leafNode(b){return this._currNode.nodes.push(b),this}_blockNode(b){this._currNode.nodes.push(b),this._nodes.push(b)}_endBlockNode(b,w){const I=this._currNode;if(I instanceof b||w&&I instanceof w)return this._nodes.pop(),this;throw new Error(`CodeGen: not in block "${w?`${b.kind}/${w.kind}`:b.kind}"`)}_elseNode(b){const w=this._currNode;if(!(w instanceof g))throw new Error('CodeGen: "else" without "if"');return this._currNode=w.else=b,this}get _root(){return this._nodes[0]}get _currNode(){const b=this._nodes;return b[b.length-1]}set _currNode(b){const w=this._nodes;w[w.length-1]=b}}e.CodeGen=ce;function te($,b){for(const w in b)$[w]=($[w]||0)+(b[w]||0);return $}function Q($,b){return b instanceof t._CodeOrName?te($,b.names):$}function ae($,b,w){if($ instanceof t.Name)return I($);if(!G($))return $;return new t._Code($._items.reduce((Z,he)=>(he instanceof t.Name&&(he=I(he)),he instanceof t._Code?Z.push(...he._items):Z.push(he),Z),[]));function I(Z){const he=w[Z.str];return he===void 0||b[Z.str]!==1?Z:(delete b[Z.str],he)}function G(Z){return Z instanceof t._Code&&Z._items.some(he=>he instanceof t.Name&&b[he.str]===1&&w[he.str]!==void 0)}}function ke($,b){for(const w in b)$[w]=($[w]||0)-(b[w]||0)}function Ee($){return typeof $=="boolean"||typeof $=="number"||$===null?!$:(0,t._)`!${A($)}`}e.not=Ee;const qe=v(e.operators.AND);function He(...$){return $.reduce(qe)}e.and=He;const pt=v(e.operators.OR);function D(...$){return $.reduce(pt)}e.or=D;function v($){return(b,w)=>b===t.nil?w:w===t.nil?b:(0,t._)`${A(b)} ${$} ${A(w)}`}function A($){return $ instanceof t.Name?$:(0,t._)`(${$})`}})(Je);var at={};(function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.checkStrictMode=e.getErrorPath=e.Type=e.useFunc=e.setEvaluated=e.evaluatedPropsToName=e.mergeEvaluated=e.eachItem=e.unescapeJsonPointer=e.escapeJsonPointer=e.escapeFragment=e.unescapeFragment=e.schemaRefOrVal=e.schemaHasRulesButRef=e.schemaHasRules=e.checkUnknownRules=e.alwaysValidSchema=e.toHash=void 0;const t=Je,n=ai;function r(M){const E={};for(const W of M)E[W]=!0;return E}e.toHash=r;function o(M,E){return typeof E=="boolean"?E:Object.keys(E).length===0?!0:(i(M,E),!s(E,M.self.RULES.all))}e.alwaysValidSchema=o;function i(M,E=M.schema){const{opts:W,self:q}=M;if(!W.strictSchema||typeof E=="boolean")return;const ue=q.RULES.keywords;for(const ce in E)ue[ce]||B(M,`unknown keyword: "${ce}"`)}e.checkUnknownRules=i;function s(M,E){if(typeof M=="boolean")return!M;for(const W in M)if(E[W])return!0;return!1}e.schemaHasRules=s;function l(M,E){if(typeof M=="boolean")return!M;for(const W in M)if(W!=="$ref"&&E.all[W])return!0;return!1}e.schemaHasRulesButRef=l;function u({topSchemaRef:M,schemaPath:E},W,q,ue){if(!ue){if(typeof W=="number"||typeof W=="boolean")return W;if(typeof W=="string")return(0,t._)`${W}`}return(0,t._)`${M}${E}${(0,t.getProperty)(q)}`}e.schemaRefOrVal=u;function c(M){return d(decodeURIComponent(M))}e.unescapeFragment=c;function p(M){return encodeURIComponent(a(M))}e.escapeFragment=p;function a(M){return typeof M=="number"?`${M}`:M.replace(/~/g,"~0").replace(/\//g,"~1")}e.escapeJsonPointer=a;function d(M){return M.replace(/~1/g,"/").replace(/~0/g,"~")}e.unescapeJsonPointer=d;function h(M,E){if(Array.isArray(M))for(const W of M)E(W);else E(M)}e.eachItem=h;function m({mergeNames:M,mergeToName:E,mergeValues:W,resultToName:q}){return(ue,ce,te,Q)=>{const ae=te===void 0?ce:te instanceof t.Name?(ce instanceof t.Name?M(ue,ce,te):E(ue,ce,te),te):ce instanceof t.Name?(E(ue,te,ce),ce):W(ce,te);return Q===t.Name&&!(ae instanceof t.Name)?q(ue,ae):ae}}e.mergeEvaluated={props:m({mergeNames:(M,E,W)=>M.if((0,t._)`${W} !== true && ${E} !== undefined`,()=>{M.if((0,t._)`${E} === true`,()=>M.assign(W,!0),()=>M.assign(W,(0,t._)`${W} || {}`).code((0,t._)`Object.assign(${W}, ${E})`))}),mergeToName:(M,E,W)=>M.if((0,t._)`${W} !== true`,()=>{E===!0?M.assign(W,!0):(M.assign(W,(0,t._)`${W} || {}`),T(M,W,E))}),mergeValues:(M,E)=>M===!0?!0:{...M,...E},resultToName:y}),items:m({mergeNames:(M,E,W)=>M.if((0,t._)`${W} !== true && ${E} !== undefined`,()=>M.assign(W,(0,t._)`${E} === true ? true : ${W} > ${E} ? ${W} : ${E}`)),mergeToName:(M,E,W)=>M.if((0,t._)`${W} !== true`,()=>M.assign(W,E===!0?!0:(0,t._)`${W} > ${E} ? ${W} : ${E}`)),mergeValues:(M,E)=>M===!0?!0:Math.max(M,E),resultToName:(M,E)=>M.var("items",E)})};function y(M,E){if(E===!0)return M.var("props",!0);const W=M.var("props",(0,t._)`{}`);return E!==void 0&&T(M,W,E),W}e.evaluatedPropsToName=y;function T(M,E,W){Object.keys(W).forEach(q=>M.assign((0,t._)`${E}${(0,t.getProperty)(q)}`,!0))}e.setEvaluated=T;const g={};function C(M,E){return M.scopeValue("func",{ref:E,code:g[E.code]||(g[E.code]=new n._Code(E.code))})}e.useFunc=C;var N;(function(M){M[M.Num=0]="Num",M[M.Str=1]="Str"})(N=e.Type||(e.Type={}));function L(M,E,W){if(M instanceof t.Name){const q=E===N.Num;return W?q?(0,t._)`"[" + ${M} + "]"`:(0,t._)`"['" + ${M} + "']"`:q?(0,t._)`"/" + ${M}`:(0,t._)`"/" + ${M}.replace(/~/g, "~0").replace(/\\//g, "~1")`}return W?(0,t.getProperty)(M).toString():"/"+a(M)}e.getErrorPath=L;function B(M,E,W=M.opts.strictSchema){if(W){if(E=`strict mode: ${E}`,W===!0)throw new Error(E);M.self.logger.warn(E)}}e.checkStrictMode=B})(at);var ar={};Object.defineProperty(ar,"__esModule",{value:!0});const Wt=Je,vx={data:new Wt.Name("data"),valCxt:new Wt.Name("valCxt"),instancePath:new Wt.Name("instancePath"),parentData:new Wt.Name("parentData"),parentDataProperty:new Wt.Name("parentDataProperty"),rootData:new Wt.Name("rootData"),dynamicAnchors:new Wt.Name("dynamicAnchors"),vErrors:new Wt.Name("vErrors"),errors:new Wt.Name("errors"),this:new Wt.Name("this"),self:new Wt.Name("self"),scope:new Wt.Name("scope"),json:new Wt.Name("json"),jsonPos:new Wt.Name("jsonPos"),jsonLen:new Wt.Name("jsonLen"),jsonPart:new Wt.Name("jsonPart")};ar.default=vx;(function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.extendErrors=e.resetErrorsCount=e.reportExtraError=e.reportError=e.keyword$DataError=e.keywordError=void 0;const t=Je,n=at,r=ar;e.keywordError={message:({keyword:T})=>(0,t.str)`must pass "${T}" keyword validation`},e.keyword$DataError={message:({keyword:T,schemaType:g})=>g?(0,t.str)`"${T}" keyword must be ${g} ($data)`:(0,t.str)`"${T}" keyword is invalid ($data)`};function o(T,g=e.keywordError,C,N){const{it:L}=T,{gen:B,compositeRule:M,allErrors:E}=L,W=a(T,g,C);N??(M||E)?u(B,W):c(L,(0,t._)`[${W}]`)}e.reportError=o;function i(T,g=e.keywordError,C){const{it:N}=T,{gen:L,compositeRule:B,allErrors:M}=N,E=a(T,g,C);u(L,E),B||M||c(N,r.default.vErrors)}e.reportExtraError=i;function s(T,g){T.assign(r.default.errors,g),T.if((0,t._)`${r.default.vErrors} !== null`,()=>T.if(g,()=>T.assign((0,t._)`${r.default.vErrors}.length`,g),()=>T.assign(r.default.vErrors,null)))}e.resetErrorsCount=s;function l({gen:T,keyword:g,schemaValue:C,data:N,errsCount:L,it:B}){if(L===void 0)throw new Error("ajv implementation error");const M=T.name("err");T.forRange("i",L,r.default.errors,E=>{T.const(M,(0,t._)`${r.default.vErrors}[${E}]`),T.if((0,t._)`${M}.instancePath === undefined`,()=>T.assign((0,t._)`${M}.instancePath`,(0,t.strConcat)(r.default.instancePath,B.errorPath))),T.assign((0,t._)`${M}.schemaPath`,(0,t.str)`${B.errSchemaPath}/${g}`),B.opts.verbose&&(T.assign((0,t._)`${M}.schema`,C),T.assign((0,t._)`${M}.data`,N))})}e.extendErrors=l;function u(T,g){const C=T.const("err",g);T.if((0,t._)`${r.default.vErrors} === null`,()=>T.assign(r.default.vErrors,(0,t._)`[${C}]`),(0,t._)`${r.default.vErrors}.push(${C})`),T.code((0,t._)`${r.default.errors}++`)}function c(T,g){const{gen:C,validateName:N,schemaEnv:L}=T;L.$async?C.throw((0,t._)`new ${T.ValidationError}(${g})`):(C.assign((0,t._)`${N}.errors`,g),C.return(!1))}const p={keyword:new t.Name("keyword"),schemaPath:new t.Name("schemaPath"),params:new t.Name("params"),propertyName:new t.Name("propertyName"),message:new t.Name("message"),schema:new t.Name("schema"),parentSchema:new t.Name("parentSchema")};function a(T,g,C){const{createErrors:N}=T.it;return N===!1?(0,t._)`{}`:d(T,g,C)}function d(T,g,C={}){const{gen:N,it:L}=T,B=[h(L,C),m(T,C)];return y(T,g,B),N.object(...B)}function h({errorPath:T},{instancePath:g}){const C=g?(0,t.str)`${T}${(0,n.getErrorPath)(g,n.Type.Str)}`:T;return[r.default.instancePath,(0,t.strConcat)(r.default.instancePath,C)]}function m({keyword:T,it:{errSchemaPath:g}},{schemaPath:C,parentSchema:N}){let L=N?g:(0,t.str)`${g}/${T}`;return C&&(L=(0,t.str)`${L}${(0,n.getErrorPath)(C,n.Type.Str)}`),[p.schemaPath,L]}function y(T,{params:g,message:C},N){const{keyword:L,data:B,schemaValue:M,it:E}=T,{opts:W,propertyName:q,topSchemaRef:ue,schemaPath:ce}=E;N.push([p.keyword,L],[p.params,typeof g=="function"?g(T):g||(0,t._)`{}`]),W.messages&&N.push([p.message,typeof C=="function"?C(T):C]),W.verbose&&N.push([p.schema,M],[p.parentSchema,(0,t._)`${ue}${ce}`],[r.default.data,B]),q&&N.push([p.propertyName,q])}})(mi);Object.defineProperty(ds,"__esModule",{value:!0});ds.boolOrEmptySchema=ds.topBoolOrEmptySchema=void 0;const bx=mi,_x=Je,Tx=ar,wx={message:"boolean schema is false"};function kx(e){const{gen:t,schema:n,validateName:r}=e;n===!1?vg(e,!1):typeof n=="object"&&n.$async===!0?t.return(Tx.default.data):(t.assign((0,_x._)`${r}.errors`,null),t.return(!0))}ds.topBoolOrEmptySchema=kx;function Sx(e,t){const{gen:n,schema:r}=e;r===!1?(n.var(t,!1),vg(e)):n.var(t,!0)}ds.boolOrEmptySchema=Sx;function vg(e,t){const{gen:n,data:r}=e,o={gen:n,keyword:"false schema",data:r,schema:!1,schemaCode:!1,schemaValue:!1,params:{},it:e};(0,bx.reportError)(o,wx,void 0,t)}var yi={},Io={};Object.defineProperty(Io,"__esModule",{value:!0});Io.getRules=Io.isJSONType=void 0;const Cx=["string","number","integer","boolean","null","object","array"],xx=new Set(Cx);function $x(e){return typeof e=="string"&&xx.has(e)}Io.isJSONType=$x;function Ox(){const e={number:{type:"number",rules:[]},string:{type:"string",rules:[]},array:{type:"array",rules:[]},object:{type:"object",rules:[]}};return{types:{...e,integer:!0,boolean:!0,null:!0},rules:[{rules:[]},e.number,e.string,e.array,e.object],post:{rules:[]},all:{},keywords:{}}}Io.getRules=Ox;var _r={};Object.defineProperty(_r,"__esModule",{value:!0});_r.shouldUseRule=_r.shouldUseGroup=_r.schemaHasRulesForType=void 0;function Ax({schema:e,self:t},n){const r=t.RULES.types[n];return r&&r!==!0&&bg(e,r)}_r.schemaHasRulesForType=Ax;function bg(e,t){return t.rules.some(n=>_g(e,n))}_r.shouldUseGroup=bg;function _g(e,t){var n;return e[t.keyword]!==void 0||((n=t.definition.implements)===null||n===void 0?void 0:n.some(r=>e[r]!==void 0))}_r.shouldUseRule=_g;(function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.reportTypeError=e.checkDataTypes=e.checkDataType=e.coerceAndCheckDataType=e.getJSONTypes=e.getSchemaTypes=e.DataType=void 0;const t=Io,n=_r,r=mi,o=Je,i=at;var s;(function(N){N[N.Correct=0]="Correct",N[N.Wrong=1]="Wrong"})(s=e.DataType||(e.DataType={}));function l(N){const L=u(N.type);if(L.includes("null")){if(N.nullable===!1)throw new Error("type: null contradicts nullable: false")}else{if(!L.length&&N.nullable!==void 0)throw new Error('"nullable" cannot be used without "type"');N.nullable===!0&&L.push("null")}return L}e.getSchemaTypes=l;function u(N){const L=Array.isArray(N)?N:N?[N]:[];if(L.every(t.isJSONType))return L;throw new Error("type must be JSONType or JSONType[]: "+L.join(","))}e.getJSONTypes=u;function c(N,L){const{gen:B,data:M,opts:E}=N,W=a(L,E.coerceTypes),q=L.length>0&&!(W.length===0&&L.length===1&&(0,n.schemaHasRulesForType)(N,L[0]));if(q){const ue=y(L,M,E.strictNumbers,s.Wrong);B.if(ue,()=>{W.length?d(N,L,W):g(N)})}return q}e.coerceAndCheckDataType=c;const p=new Set(["string","number","integer","boolean","null"]);function a(N,L){return L?N.filter(B=>p.has(B)||L==="array"&&B==="array"):[]}function d(N,L,B){const{gen:M,data:E,opts:W}=N,q=M.let("dataType",(0,o._)`typeof ${E}`),ue=M.let("coerced",(0,o._)`undefined`);W.coerceTypes==="array"&&M.if((0,o._)`${q} == 'object' && Array.isArray(${E}) && ${E}.length == 1`,()=>M.assign(E,(0,o._)`${E}[0]`).assign(q,(0,o._)`typeof ${E}`).if(y(L,E,W.strictNumbers),()=>M.assign(ue,E))),M.if((0,o._)`${ue} !== undefined`);for(const te of B)(p.has(te)||te==="array"&&W.coerceTypes==="array")&&ce(te);M.else(),g(N),M.endIf(),M.if((0,o._)`${ue} !== undefined`,()=>{M.assign(E,ue),h(N,ue)});function ce(te){switch(te){case"string":M.elseIf((0,o._)`${q} == "number" || ${q} == "boolean"`).assign(ue,(0,o._)`"" + ${E}`).elseIf((0,o._)`${E} === null`).assign(ue,(0,o._)`""`);return;case"number":M.elseIf((0,o._)`${q} == "boolean" || ${E} === null
              || (${q} == "string" && ${E} && ${E} == +${E})`).assign(ue,(0,o._)`+${E}`);return;case"integer":M.elseIf((0,o._)`${q} === "boolean" || ${E} === null
              || (${q} === "string" && ${E} && ${E} == +${E} && !(${E} % 1))`).assign(ue,(0,o._)`+${E}`);return;case"boolean":M.elseIf((0,o._)`${E} === "false" || ${E} === 0 || ${E} === null`).assign(ue,!1).elseIf((0,o._)`${E} === "true" || ${E} === 1`).assign(ue,!0);return;case"null":M.elseIf((0,o._)`${E} === "" || ${E} === 0 || ${E} === false`),M.assign(ue,null);return;case"array":M.elseIf((0,o._)`${q} === "string" || ${q} === "number"
              || ${q} === "boolean" || ${E} === null`).assign(ue,(0,o._)`[${E}]`)}}}function h({gen:N,parentData:L,parentDataProperty:B},M){N.if((0,o._)`${L} !== undefined`,()=>N.assign((0,o._)`${L}[${B}]`,M))}function m(N,L,B,M=s.Correct){const E=M===s.Correct?o.operators.EQ:o.operators.NEQ;let W;switch(N){case"null":return(0,o._)`${L} ${E} null`;case"array":W=(0,o._)`Array.isArray(${L})`;break;case"object":W=(0,o._)`${L} && typeof ${L} == "object" && !Array.isArray(${L})`;break;case"integer":W=q((0,o._)`!(${L} % 1) && !isNaN(${L})`);break;case"number":W=q();break;default:return(0,o._)`typeof ${L} ${E} ${N}`}return M===s.Correct?W:(0,o.not)(W);function q(ue=o.nil){return(0,o.and)((0,o._)`typeof ${L} == "number"`,ue,B?(0,o._)`isFinite(${L})`:o.nil)}}e.checkDataType=m;function y(N,L,B,M){if(N.length===1)return m(N[0],L,B,M);let E;const W=(0,i.toHash)(N);if(W.array&&W.object){const q=(0,o._)`typeof ${L} != "object"`;E=W.null?q:(0,o._)`!${L} || ${q}`,delete W.null,delete W.array,delete W.object}else E=o.nil;W.number&&delete W.integer;for(const q in W)E=(0,o.and)(E,m(q,L,B,M));return E}e.checkDataTypes=y;const T={message:({schema:N})=>`must be ${N}`,params:({schema:N,schemaValue:L})=>typeof N=="string"?(0,o._)`{type: ${N}}`:(0,o._)`{type: ${L}}`};function g(N){const L=C(N);(0,r.reportError)(L,T)}e.reportTypeError=g;function C(N){const{gen:L,data:B,schema:M}=N,E=(0,i.schemaRefOrVal)(N,M,"type");return{gen:L,keyword:"type",data:B,schema:M.type,schemaCode:E,schemaValue:E,parentSchema:M,params:{},it:N}}})(yi);var za={};Object.defineProperty(za,"__esModule",{value:!0});za.assignDefaults=void 0;const Bo=Je,Ix=at;function Px(e,t){const{properties:n,items:r}=e.schema;if(t==="object"&&n)for(const o in n)Op(e,o,n[o].default);else t==="array"&&Array.isArray(r)&&r.forEach((o,i)=>Op(e,i,o.default))}za.assignDefaults=Px;function Op(e,t,n){const{gen:r,compositeRule:o,data:i,opts:s}=e;if(n===void 0)return;const l=(0,Bo._)`${i}${(0,Bo.getProperty)(t)}`;if(o){(0,Ix.checkStrictMode)(e,`default is ignored for: ${l}`);return}let u=(0,Bo._)`${l} === undefined`;s.useDefaults==="empty"&&(u=(0,Bo._)`${u} || ${l} === null || ${l} === ""`),r.if(u,(0,Bo._)`${l} = ${(0,Bo.stringify)(n)}`)}var er={},Qe={};Object.defineProperty(Qe,"__esModule",{value:!0});Qe.validateUnion=Qe.validateArray=Qe.usePattern=Qe.callValidateCode=Qe.schemaProperties=Qe.allSchemaProperties=Qe.noPropertyInData=Qe.propertyInData=Qe.isOwnProperty=Qe.hasPropFunc=Qe.reportMissingProp=Qe.checkMissingProp=Qe.checkReportMissingProp=void 0;const wt=Je,cu=at,Nr=ar,jx=at;function Ex(e,t){const{gen:n,data:r,it:o}=e;n.if(du(n,r,t,o.opts.ownProperties),()=>{e.setParams({missingProperty:(0,wt._)`${t}`},!0),e.error()})}Qe.checkReportMissingProp=Ex;function Nx({gen:e,data:t,it:{opts:n}},r,o){return(0,wt.or)(...r.map(i=>(0,wt.and)(du(e,t,i,n.ownProperties),(0,wt._)`${o} = ${i}`)))}Qe.checkMissingProp=Nx;function Mx(e,t){e.setParams({missingProperty:t},!0),e.error()}Qe.reportMissingProp=Mx;function Tg(e){return e.scopeValue("func",{ref:Object.prototype.hasOwnProperty,code:(0,wt._)`Object.prototype.hasOwnProperty`})}Qe.hasPropFunc=Tg;function uu(e,t,n){return(0,wt._)`${Tg(e)}.call(${t}, ${n})`}Qe.isOwnProperty=uu;function Lx(e,t,n,r){const o=(0,wt._)`${t}${(0,wt.getProperty)(n)} !== undefined`;return r?(0,wt._)`${o} && ${uu(e,t,n)}`:o}Qe.propertyInData=Lx;function du(e,t,n,r){const o=(0,wt._)`${t}${(0,wt.getProperty)(n)} === undefined`;return r?(0,wt.or)(o,(0,wt.not)(uu(e,t,n))):o}Qe.noPropertyInData=du;function wg(e){return e?Object.keys(e).filter(t=>t!=="__proto__"):[]}Qe.allSchemaProperties=wg;function Dx(e,t){return wg(t).filter(n=>!(0,cu.alwaysValidSchema)(e,t[n]))}Qe.schemaProperties=Dx;function Rx({schemaCode:e,data:t,it:{gen:n,topSchemaRef:r,schemaPath:o,errorPath:i},it:s},l,u,c){const p=c?(0,wt._)`${e}, ${t}, ${r}${o}`:t,a=[[Nr.default.instancePath,(0,wt.strConcat)(Nr.default.instancePath,i)],[Nr.default.parentData,s.parentData],[Nr.default.parentDataProperty,s.parentDataProperty],[Nr.default.rootData,Nr.default.rootData]];s.opts.dynamicRef&&a.push([Nr.default.dynamicAnchors,Nr.default.dynamicAnchors]);const d=(0,wt._)`${p}, ${n.object(...a)}`;return u!==wt.nil?(0,wt._)`${l}.call(${u}, ${d})`:(0,wt._)`${l}(${d})`}Qe.callValidateCode=Rx;const Fx=(0,wt._)`new RegExp`;function Bx({gen:e,it:{opts:t}},n){const r=t.unicodeRegExp?"u":"",{regExp:o}=t.code,i=o(n,r);return e.scopeValue("pattern",{key:i.toString(),ref:i,code:(0,wt._)`${o.code==="new RegExp"?Fx:(0,jx.useFunc)(e,o)}(${n}, ${r})`})}Qe.usePattern=Bx;function Ux(e){const{gen:t,data:n,keyword:r,it:o}=e,i=t.name("valid");if(o.allErrors){const l=t.let("valid",!0);return s(()=>t.assign(l,!1)),l}return t.var(i,!0),s(()=>t.break()),i;function s(l){const u=t.const("len",(0,wt._)`${n}.length`);t.forRange("i",0,u,c=>{e.subschema({keyword:r,dataProp:c,dataPropType:cu.Type.Num},i),t.if((0,wt.not)(i),l)})}}Qe.validateArray=Ux;function qx(e){const{gen:t,schema:n,keyword:r,it:o}=e;if(!Array.isArray(n))throw new Error("ajv implementation error");if(n.some(l=>(0,cu.alwaysValidSchema)(o,l))&&!o.opts.unevaluated)return;const i=t.let("valid",!1),s=t.name("_valid");t.block(()=>n.forEach((l,u)=>{const c=e.subschema({keyword:r,schemaProp:u,compositeRule:!0},s);t.assign(i,(0,wt._)`${i} || ${s}`),e.mergeValidEvaluated(c,s)||t.if((0,wt.not)(i))})),e.result(i,()=>e.reset(),()=>e.error(!0))}Qe.validateUnion=qx;Object.defineProperty(er,"__esModule",{value:!0});er.validateKeywordUsage=er.validSchemaType=er.funcKeywordCode=er.macroKeywordCode=void 0;const on=Je,yo=ar,Vx=Qe,Hx=mi;function Kx(e,t){const{gen:n,keyword:r,schema:o,parentSchema:i,it:s}=e,l=t.macro.call(s.self,o,i,s),u=kg(n,r,l);s.opts.validateSchema!==!1&&s.self.validateSchema(l,!0);const c=n.name("valid");e.subschema({schema:l,schemaPath:on.nil,errSchemaPath:`${s.errSchemaPath}/${r}`,topSchemaRef:u,compositeRule:!0},c),e.pass(c,()=>e.error(!0))}er.macroKeywordCode=Kx;function Gx(e,t){var n;const{gen:r,keyword:o,schema:i,parentSchema:s,$data:l,it:u}=e;zx(u,t);const c=!l&&t.compile?t.compile.call(u.self,i,s,u):t.validate,p=kg(r,o,c),a=r.let("valid");e.block$data(a,d),e.ok((n=t.valid)!==null&&n!==void 0?n:a);function d(){if(t.errors===!1)y(),t.modifying&&Ap(e),T(()=>e.error());else{const g=t.async?h():m();t.modifying&&Ap(e),T(()=>Wx(e,g))}}function h(){const g=r.let("ruleErrs",null);return r.try(()=>y((0,on._)`await `),C=>r.assign(a,!1).if((0,on._)`${C} instanceof ${u.ValidationError}`,()=>r.assign(g,(0,on._)`${C}.errors`),()=>r.throw(C))),g}function m(){const g=(0,on._)`${p}.errors`;return r.assign(g,null),y(on.nil),g}function y(g=t.async?(0,on._)`await `:on.nil){const C=u.opts.passContext?yo.default.this:yo.default.self,N=!("compile"in t&&!l||t.schema===!1);r.assign(a,(0,on._)`${g}${(0,Vx.callValidateCode)(e,p,C,N)}`,t.modifying)}function T(g){var C;r.if((0,on.not)((C=t.valid)!==null&&C!==void 0?C:a),g)}}er.funcKeywordCode=Gx;function Ap(e){const{gen:t,data:n,it:r}=e;t.if(r.parentData,()=>t.assign(n,(0,on._)`${r.parentData}[${r.parentDataProperty}]`))}function Wx(e,t){const{gen:n}=e;n.if((0,on._)`Array.isArray(${t})`,()=>{n.assign(yo.default.vErrors,(0,on._)`${yo.default.vErrors} === null ? ${t} : ${yo.default.vErrors}.concat(${t})`).assign(yo.default.errors,(0,on._)`${yo.default.vErrors}.length`),(0,Hx.extendErrors)(e)},()=>e.error())}function zx({schemaEnv:e},t){if(t.async&&!e.$async)throw new Error("async keyword in sync schema")}function kg(e,t,n){if(n===void 0)throw new Error(`keyword "${t}" failed to compile`);return e.scopeValue("keyword",typeof n=="function"?{ref:n}:{ref:n,code:(0,on.stringify)(n)})}function Qx(e,t,n=!1){return!t.length||t.some(r=>r==="array"?Array.isArray(e):r==="object"?e&&typeof e=="object"&&!Array.isArray(e):typeof e==r||n&&typeof e>"u")}er.validSchemaType=Qx;function Jx({schema:e,opts:t,self:n,errSchemaPath:r},o,i){if(Array.isArray(o.keyword)?!o.keyword.includes(i):o.keyword!==i)throw new Error("ajv implementation error");const s=o.dependencies;if(s!=null&&s.some(l=>!Object.prototype.hasOwnProperty.call(e,l)))throw new Error(`parent schema must have dependencies of ${i}: ${s.join(",")}`);if(o.validateSchema&&!o.validateSchema(e[i])){const l=`keyword "${i}" value is invalid at path "${r}": `+n.errorsText(o.validateSchema.errors);if(t.validateSchema==="log")n.logger.error(l);else throw new Error(l)}}er.validateKeywordUsage=Jx;var Wr={};Object.defineProperty(Wr,"__esModule",{value:!0});Wr.extendSubschemaMode=Wr.extendSubschemaData=Wr.getSubschema=void 0;const Zn=Je,Sg=at;function Yx(e,{keyword:t,schemaProp:n,schema:r,schemaPath:o,errSchemaPath:i,topSchemaRef:s}){if(t!==void 0&&r!==void 0)throw new Error('both "keyword" and "schema" passed, only one allowed');if(t!==void 0){const l=e.schema[t];return n===void 0?{schema:l,schemaPath:(0,Zn._)`${e.schemaPath}${(0,Zn.getProperty)(t)}`,errSchemaPath:`${e.errSchemaPath}/${t}`}:{schema:l[n],schemaPath:(0,Zn._)`${e.schemaPath}${(0,Zn.getProperty)(t)}${(0,Zn.getProperty)(n)}`,errSchemaPath:`${e.errSchemaPath}/${t}/${(0,Sg.escapeFragment)(n)}`}}if(r!==void 0){if(o===void 0||i===void 0||s===void 0)throw new Error('"schemaPath", "errSchemaPath" and "topSchemaRef" are required with "schema"');return{schema:r,schemaPath:o,topSchemaRef:s,errSchemaPath:i}}throw new Error('either "keyword" or "schema" must be passed')}Wr.getSubschema=Yx;function Xx(e,t,{dataProp:n,dataPropType:r,data:o,dataTypes:i,propertyName:s}){if(o!==void 0&&n!==void 0)throw new Error('both "data" and "dataProp" passed, only one allowed');const{gen:l}=t;if(n!==void 0){const{errorPath:c,dataPathArr:p,opts:a}=t,d=l.let("data",(0,Zn._)`${t.data}${(0,Zn.getProperty)(n)}`,!0);u(d),e.errorPath=(0,Zn.str)`${c}${(0,Sg.getErrorPath)(n,r,a.jsPropertySyntax)}`,e.parentDataProperty=(0,Zn._)`${n}`,e.dataPathArr=[...p,e.parentDataProperty]}if(o!==void 0){const c=o instanceof Zn.Name?o:l.let("data",o,!0);u(c),s!==void 0&&(e.propertyName=s)}i&&(e.dataTypes=i);function u(c){e.data=c,e.dataLevel=t.dataLevel+1,e.dataTypes=[],t.definedProperties=new Set,e.parentData=t.data,e.dataNames=[...t.dataNames,c]}}Wr.extendSubschemaData=Xx;function Zx(e,{jtdDiscriminator:t,jtdMetadata:n,compositeRule:r,createErrors:o,allErrors:i}){r!==void 0&&(e.compositeRule=r),o!==void 0&&(e.createErrors=o),i!==void 0&&(e.allErrors=i),e.jtdDiscriminator=t,e.jtdMetadata=n}Wr.extendSubschemaMode=Zx;var Ht={},Cg=function e(t,n){if(t===n)return!0;if(t&&n&&typeof t=="object"&&typeof n=="object"){if(t.constructor!==n.constructor)return!1;var r,o,i;if(Array.isArray(t)){if(r=t.length,r!=n.length)return!1;for(o=r;o--!==0;)if(!e(t[o],n[o]))return!1;return!0}if(t.constructor===RegExp)return t.source===n.source&&t.flags===n.flags;if(t.valueOf!==Object.prototype.valueOf)return t.valueOf()===n.valueOf();if(t.toString!==Object.prototype.toString)return t.toString()===n.toString();if(i=Object.keys(t),r=i.length,r!==Object.keys(n).length)return!1;for(o=r;o--!==0;)if(!Object.prototype.hasOwnProperty.call(n,i[o]))return!1;for(o=r;o--!==0;){var s=i[o];if(!e(t[s],n[s]))return!1}return!0}return t!==t&&n!==n},xg={exports:{}},qr=xg.exports=function(e,t,n){typeof t=="function"&&(n=t,t={}),n=t.cb||n;var r=typeof n=="function"?n:n.pre||function(){},o=n.post||function(){};Hi(t,r,o,e,"",e)};qr.keywords={additionalItems:!0,items:!0,contains:!0,additionalProperties:!0,propertyNames:!0,not:!0,if:!0,then:!0,else:!0};qr.arrayKeywords={items:!0,allOf:!0,anyOf:!0,oneOf:!0};qr.propsKeywords={$defs:!0,definitions:!0,properties:!0,patternProperties:!0,dependencies:!0};qr.skipKeywords={default:!0,enum:!0,const:!0,required:!0,maximum:!0,minimum:!0,exclusiveMaximum:!0,exclusiveMinimum:!0,multipleOf:!0,maxLength:!0,minLength:!0,pattern:!0,format:!0,maxItems:!0,minItems:!0,uniqueItems:!0,maxProperties:!0,minProperties:!0};function Hi(e,t,n,r,o,i,s,l,u,c){if(r&&typeof r=="object"&&!Array.isArray(r)){t(r,o,i,s,l,u,c);for(var p in r){var a=r[p];if(Array.isArray(a)){if(p in qr.arrayKeywords)for(var d=0;d<a.length;d++)Hi(e,t,n,a[d],o+"/"+p+"/"+d,i,o,p,r,d)}else if(p in qr.propsKeywords){if(a&&typeof a=="object")for(var h in a)Hi(e,t,n,a[h],o+"/"+p+"/"+e$(h),i,o,p,r,h)}else(p in qr.keywords||e.allKeys&&!(p in qr.skipKeywords))&&Hi(e,t,n,a,o+"/"+p,i,o,p,r)}n(r,o,i,s,l,u,c)}}function e$(e){return e.replace(/~/g,"~0").replace(/\//g,"~1")}var t$=xg.exports;Object.defineProperty(Ht,"__esModule",{value:!0});Ht.getSchemaRefs=Ht.resolveUrl=Ht.normalizeId=Ht._getFullPath=Ht.getFullPath=Ht.inlineRef=void 0;const n$=at,r$=Cg,o$=t$,s$=new Set(["type","format","pattern","maxLength","minLength","maxProperties","minProperties","maxItems","minItems","maximum","minimum","uniqueItems","multipleOf","required","enum","const"]);function i$(e,t=!0){return typeof e=="boolean"?!0:t===!0?!tc(e):t?$g(e)<=t:!1}Ht.inlineRef=i$;const a$=new Set(["$ref","$recursiveRef","$recursiveAnchor","$dynamicRef","$dynamicAnchor"]);function tc(e){for(const t in e){if(a$.has(t))return!0;const n=e[t];if(Array.isArray(n)&&n.some(tc)||typeof n=="object"&&tc(n))return!0}return!1}function $g(e){let t=0;for(const n in e)if(n==="$ref"||(t++,!s$.has(n)&&(typeof e[n]=="object"&&(0,n$.eachItem)(e[n],r=>t+=$g(r)),t===1/0)))return 1/0;return t}function Og(e,t="",n){n!==!1&&(t=ts(t));const r=e.parse(t);return Ag(e,r)}Ht.getFullPath=Og;function Ag(e,t){return e.serialize(t).split("#")[0]+"#"}Ht._getFullPath=Ag;const l$=/#\/?$/;function ts(e){return e?e.replace(l$,""):""}Ht.normalizeId=ts;function c$(e,t,n){return n=ts(n),e.resolve(t,n)}Ht.resolveUrl=c$;const u$=/^[a-z_][-a-z0-9._]*$/i;function d$(e,t){if(typeof e=="boolean")return{};const{schemaId:n,uriResolver:r}=this.opts,o=ts(e[n]||t),i={"":o},s=Og(r,o,!1),l={},u=new Set;return o$(e,{allKeys:!0},(a,d,h,m)=>{if(m===void 0)return;const y=s+d;let T=i[m];typeof a[n]=="string"&&(T=g.call(this,a[n])),C.call(this,a.$anchor),C.call(this,a.$dynamicAnchor),i[d]=T;function g(N){const L=this.opts.uriResolver.resolve;if(N=ts(T?L(T,N):N),u.has(N))throw p(N);u.add(N);let B=this.refs[N];return typeof B=="string"&&(B=this.refs[B]),typeof B=="object"?c(a,B.schema,N):N!==ts(y)&&(N[0]==="#"?(c(a,l[N],N),l[N]=a):this.refs[N]=y),N}function C(N){if(typeof N=="string"){if(!u$.test(N))throw new Error(`invalid anchor "${N}"`);g.call(this,`#${N}`)}}}),l;function c(a,d,h){if(d!==void 0&&!r$(a,d))throw p(h)}function p(a){return new Error(`reference "${a}" resolves to more than one schema`)}}Ht.getSchemaRefs=d$;Object.defineProperty(Fn,"__esModule",{value:!0});Fn.getData=Fn.KeywordCxt=Fn.validateFunctionCode=void 0;const Ig=ds,Ip=yi,pu=_r,pa=yi,p$=za,qs=er,kl=Wr,Ae=Je,Ve=ar,f$=Ht,Tr=at,xs=mi;function h$(e){if(Eg(e)&&(Ng(e),jg(e))){g$(e);return}Pg(e,()=>(0,Ig.topBoolOrEmptySchema)(e))}Fn.validateFunctionCode=h$;function Pg({gen:e,validateName:t,schema:n,schemaEnv:r,opts:o},i){o.code.es5?e.func(t,(0,Ae._)`${Ve.default.data}, ${Ve.default.valCxt}`,r.$async,()=>{e.code((0,Ae._)`"use strict"; ${Pp(n,o)}`),y$(e,o),e.code(i)}):e.func(t,(0,Ae._)`${Ve.default.data}, ${m$(o)}`,r.$async,()=>e.code(Pp(n,o)).code(i))}function m$(e){return(0,Ae._)`{${Ve.default.instancePath}="", ${Ve.default.parentData}, ${Ve.default.parentDataProperty}, ${Ve.default.rootData}=${Ve.default.data}${e.dynamicRef?(0,Ae._)`, ${Ve.default.dynamicAnchors}={}`:Ae.nil}}={}`}function y$(e,t){e.if(Ve.default.valCxt,()=>{e.var(Ve.default.instancePath,(0,Ae._)`${Ve.default.valCxt}.${Ve.default.instancePath}`),e.var(Ve.default.parentData,(0,Ae._)`${Ve.default.valCxt}.${Ve.default.parentData}`),e.var(Ve.default.parentDataProperty,(0,Ae._)`${Ve.default.valCxt}.${Ve.default.parentDataProperty}`),e.var(Ve.default.rootData,(0,Ae._)`${Ve.default.valCxt}.${Ve.default.rootData}`),t.dynamicRef&&e.var(Ve.default.dynamicAnchors,(0,Ae._)`${Ve.default.valCxt}.${Ve.default.dynamicAnchors}`)},()=>{e.var(Ve.default.instancePath,(0,Ae._)`""`),e.var(Ve.default.parentData,(0,Ae._)`undefined`),e.var(Ve.default.parentDataProperty,(0,Ae._)`undefined`),e.var(Ve.default.rootData,Ve.default.data),t.dynamicRef&&e.var(Ve.default.dynamicAnchors,(0,Ae._)`{}`)})}function g$(e){const{schema:t,opts:n,gen:r}=e;Pg(e,()=>{n.$comment&&t.$comment&&Lg(e),w$(e),r.let(Ve.default.vErrors,null),r.let(Ve.default.errors,0),n.unevaluated&&v$(e),Mg(e),C$(e)})}function v$(e){const{gen:t,validateName:n}=e;e.evaluated=t.const("evaluated",(0,Ae._)`${n}.evaluated`),t.if((0,Ae._)`${e.evaluated}.dynamicProps`,()=>t.assign((0,Ae._)`${e.evaluated}.props`,(0,Ae._)`undefined`)),t.if((0,Ae._)`${e.evaluated}.dynamicItems`,()=>t.assign((0,Ae._)`${e.evaluated}.items`,(0,Ae._)`undefined`))}function Pp(e,t){const n=typeof e=="object"&&e[t.schemaId];return n&&(t.code.source||t.code.process)?(0,Ae._)`/*# sourceURL=${n} */`:Ae.nil}function b$(e,t){if(Eg(e)&&(Ng(e),jg(e))){_$(e,t);return}(0,Ig.boolOrEmptySchema)(e,t)}function jg({schema:e,self:t}){if(typeof e=="boolean")return!e;for(const n in e)if(t.RULES.all[n])return!0;return!1}function Eg(e){return typeof e.schema!="boolean"}function _$(e,t){const{schema:n,gen:r,opts:o}=e;o.$comment&&n.$comment&&Lg(e),k$(e),S$(e);const i=r.const("_errs",Ve.default.errors);Mg(e,i),r.var(t,(0,Ae._)`${i} === ${Ve.default.errors}`)}function Ng(e){(0,Tr.checkUnknownRules)(e),T$(e)}function Mg(e,t){if(e.opts.jtd)return jp(e,[],!1,t);const n=(0,Ip.getSchemaTypes)(e.schema),r=(0,Ip.coerceAndCheckDataType)(e,n);jp(e,n,!r,t)}function T$(e){const{schema:t,errSchemaPath:n,opts:r,self:o}=e;t.$ref&&r.ignoreKeywordsWithRef&&(0,Tr.schemaHasRulesButRef)(t,o.RULES)&&o.logger.warn(`$ref: keywords ignored in schema at path "${n}"`)}function w$(e){const{schema:t,opts:n}=e;t.default!==void 0&&n.useDefaults&&n.strictSchema&&(0,Tr.checkStrictMode)(e,"default is ignored in the schema root")}function k$(e){const t=e.schema[e.opts.schemaId];t&&(e.baseId=(0,f$.resolveUrl)(e.opts.uriResolver,e.baseId,t))}function S$(e){if(e.schema.$async&&!e.schemaEnv.$async)throw new Error("async schema in sync schema")}function Lg({gen:e,schemaEnv:t,schema:n,errSchemaPath:r,opts:o}){const i=n.$comment;if(o.$comment===!0)e.code((0,Ae._)`${Ve.default.self}.logger.log(${i})`);else if(typeof o.$comment=="function"){const s=(0,Ae.str)`${r}/$comment`,l=e.scopeValue("root",{ref:t.root});e.code((0,Ae._)`${Ve.default.self}.opts.$comment(${i}, ${s}, ${l}.schema)`)}}function C$(e){const{gen:t,schemaEnv:n,validateName:r,ValidationError:o,opts:i}=e;n.$async?t.if((0,Ae._)`${Ve.default.errors} === 0`,()=>t.return(Ve.default.data),()=>t.throw((0,Ae._)`new ${o}(${Ve.default.vErrors})`)):(t.assign((0,Ae._)`${r}.errors`,Ve.default.vErrors),i.unevaluated&&x$(e),t.return((0,Ae._)`${Ve.default.errors} === 0`))}function x$({gen:e,evaluated:t,props:n,items:r}){n instanceof Ae.Name&&e.assign((0,Ae._)`${t}.props`,n),r instanceof Ae.Name&&e.assign((0,Ae._)`${t}.items`,r)}function jp(e,t,n,r){const{gen:o,schema:i,data:s,allErrors:l,opts:u,self:c}=e,{RULES:p}=c;if(i.$ref&&(u.ignoreKeywordsWithRef||!(0,Tr.schemaHasRulesButRef)(i,p))){o.block(()=>Fg(e,"$ref",p.all.$ref.definition));return}u.jtd||$$(e,t),o.block(()=>{for(const d of p.rules)a(d);a(p.post)});function a(d){(0,pu.shouldUseGroup)(i,d)&&(d.type?(o.if((0,pa.checkDataType)(d.type,s,u.strictNumbers)),Ep(e,d),t.length===1&&t[0]===d.type&&n&&(o.else(),(0,pa.reportTypeError)(e)),o.endIf()):Ep(e,d),l||o.if((0,Ae._)`${Ve.default.errors} === ${r||0}`))}}function Ep(e,t){const{gen:n,schema:r,opts:{useDefaults:o}}=e;o&&(0,p$.assignDefaults)(e,t.type),n.block(()=>{for(const i of t.rules)(0,pu.shouldUseRule)(r,i)&&Fg(e,i.keyword,i.definition,t.type)})}function $$(e,t){e.schemaEnv.meta||!e.opts.strictTypes||(O$(e,t),e.opts.allowUnionTypes||A$(e,t),I$(e,e.dataTypes))}function O$(e,t){if(t.length){if(!e.dataTypes.length){e.dataTypes=t;return}t.forEach(n=>{Dg(e.dataTypes,n)||fu(e,`type "${n}" not allowed by context "${e.dataTypes.join(",")}"`)}),j$(e,t)}}function A$(e,t){t.length>1&&!(t.length===2&&t.includes("null"))&&fu(e,"use allowUnionTypes to allow union type keyword")}function I$(e,t){const n=e.self.RULES.all;for(const r in n){const o=n[r];if(typeof o=="object"&&(0,pu.shouldUseRule)(e.schema,o)){const{type:i}=o.definition;i.length&&!i.some(s=>P$(t,s))&&fu(e,`missing type "${i.join(",")}" for keyword "${r}"`)}}}function P$(e,t){return e.includes(t)||t==="number"&&e.includes("integer")}function Dg(e,t){return e.includes(t)||t==="integer"&&e.includes("number")}function j$(e,t){const n=[];for(const r of e.dataTypes)Dg(t,r)?n.push(r):t.includes("integer")&&r==="number"&&n.push("integer");e.dataTypes=n}function fu(e,t){const n=e.schemaEnv.baseId+e.errSchemaPath;t+=` at "${n}" (strictTypes)`,(0,Tr.checkStrictMode)(e,t,e.opts.strictTypes)}class Rg{constructor(t,n,r){if((0,qs.validateKeywordUsage)(t,n,r),this.gen=t.gen,this.allErrors=t.allErrors,this.keyword=r,this.data=t.data,this.schema=t.schema[r],this.$data=n.$data&&t.opts.$data&&this.schema&&this.schema.$data,this.schemaValue=(0,Tr.schemaRefOrVal)(t,this.schema,r,this.$data),this.schemaType=n.schemaType,this.parentSchema=t.schema,this.params={},this.it=t,this.def=n,this.$data)this.schemaCode=t.gen.const("vSchema",Bg(this.$data,t));else if(this.schemaCode=this.schemaValue,!(0,qs.validSchemaType)(this.schema,n.schemaType,n.allowUndefined))throw new Error(`${r} value must be ${JSON.stringify(n.schemaType)}`);("code"in n?n.trackErrors:n.errors!==!1)&&(this.errsCount=t.gen.const("_errs",Ve.default.errors))}result(t,n,r){this.failResult((0,Ae.not)(t),n,r)}failResult(t,n,r){this.gen.if(t),r?r():this.error(),n?(this.gen.else(),n(),this.allErrors&&this.gen.endIf()):this.allErrors?this.gen.endIf():this.gen.else()}pass(t,n){this.failResult((0,Ae.not)(t),void 0,n)}fail(t){if(t===void 0){this.error(),this.allErrors||this.gen.if(!1);return}this.gen.if(t),this.error(),this.allErrors?this.gen.endIf():this.gen.else()}fail$data(t){if(!this.$data)return this.fail(t);const{schemaCode:n}=this;this.fail((0,Ae._)`${n} !== undefined && (${(0,Ae.or)(this.invalid$data(),t)})`)}error(t,n,r){if(n){this.setParams(n),this._error(t,r),this.setParams({});return}this._error(t,r)}_error(t,n){(t?xs.reportExtraError:xs.reportError)(this,this.def.error,n)}$dataError(){(0,xs.reportError)(this,this.def.$dataError||xs.keyword$DataError)}reset(){if(this.errsCount===void 0)throw new Error('add "trackErrors" to keyword definition');(0,xs.resetErrorsCount)(this.gen,this.errsCount)}ok(t){this.allErrors||this.gen.if(t)}setParams(t,n){n?Object.assign(this.params,t):this.params=t}block$data(t,n,r=Ae.nil){this.gen.block(()=>{this.check$data(t,r),n()})}check$data(t=Ae.nil,n=Ae.nil){if(!this.$data)return;const{gen:r,schemaCode:o,schemaType:i,def:s}=this;r.if((0,Ae.or)((0,Ae._)`${o} === undefined`,n)),t!==Ae.nil&&r.assign(t,!0),(i.length||s.validateSchema)&&(r.elseIf(this.invalid$data()),this.$dataError(),t!==Ae.nil&&r.assign(t,!1)),r.else()}invalid$data(){const{gen:t,schemaCode:n,schemaType:r,def:o,it:i}=this;return(0,Ae.or)(s(),l());function s(){if(r.length){if(!(n instanceof Ae.Name))throw new Error("ajv implementation error");const u=Array.isArray(r)?r:[r];return(0,Ae._)`${(0,pa.checkDataTypes)(u,n,i.opts.strictNumbers,pa.DataType.Wrong)}`}return Ae.nil}function l(){if(o.validateSchema){const u=t.scopeValue("validate$data",{ref:o.validateSchema});return(0,Ae._)`!${u}(${n})`}return Ae.nil}}subschema(t,n){const r=(0,kl.getSubschema)(this.it,t);(0,kl.extendSubschemaData)(r,this.it,t),(0,kl.extendSubschemaMode)(r,t);const o={...this.it,...r,items:void 0,props:void 0};return b$(o,n),o}mergeEvaluated(t,n){const{it:r,gen:o}=this;r.opts.unevaluated&&(r.props!==!0&&t.props!==void 0&&(r.props=Tr.mergeEvaluated.props(o,t.props,r.props,n)),r.items!==!0&&t.items!==void 0&&(r.items=Tr.mergeEvaluated.items(o,t.items,r.items,n)))}mergeValidEvaluated(t,n){const{it:r,gen:o}=this;if(r.opts.unevaluated&&(r.props!==!0||r.items!==!0))return o.if(n,()=>this.mergeEvaluated(t,Ae.Name)),!0}}Fn.KeywordCxt=Rg;function Fg(e,t,n,r){const o=new Rg(e,n,t);"code"in n?n.code(o,r):o.$data&&n.validate?(0,qs.funcKeywordCode)(o,n):"macro"in n?(0,qs.macroKeywordCode)(o,n):(n.compile||n.validate)&&(0,qs.funcKeywordCode)(o,n)}const E$=/^\/(?:[^~]|~0|~1)*$/,N$=/^([0-9]+)(#|\/(?:[^~]|~0|~1)*)?$/;function Bg(e,{dataLevel:t,dataNames:n,dataPathArr:r}){let o,i;if(e==="")return Ve.default.rootData;if(e[0]==="/"){if(!E$.test(e))throw new Error(`Invalid JSON-pointer: ${e}`);o=e,i=Ve.default.rootData}else{const c=N$.exec(e);if(!c)throw new Error(`Invalid JSON-pointer: ${e}`);const p=+c[1];if(o=c[2],o==="#"){if(p>=t)throw new Error(u("property/index",p));return r[t-p]}if(p>t)throw new Error(u("data",p));if(i=n[t-p],!o)return i}let s=i;const l=o.split("/");for(const c of l)c&&(i=(0,Ae._)`${i}${(0,Ae.getProperty)((0,Tr.unescapeJsonPointer)(c))}`,s=(0,Ae._)`${s} && ${i}`);return s;function u(c,p){return`Cannot access ${c} ${p} levels up, current level is ${t}`}}Fn.getData=Bg;var gi={};Object.defineProperty(gi,"__esModule",{value:!0});class M$ extends Error{constructor(t){super("validation failed"),this.errors=t,this.ajv=this.validation=!0}}gi.default=M$;var vi={};Object.defineProperty(vi,"__esModule",{value:!0});const Sl=Ht;class L$ extends Error{constructor(t,n,r,o){super(o||`can't resolve reference ${r} from id ${n}`),this.missingRef=(0,Sl.resolveUrl)(t,n,r),this.missingSchema=(0,Sl.normalizeId)((0,Sl.getFullPath)(t,this.missingRef))}}vi.default=L$;var fn={};Object.defineProperty(fn,"__esModule",{value:!0});fn.resolveSchema=fn.getCompilingSchema=fn.resolveRef=fn.compileSchema=fn.SchemaEnv=void 0;const En=Je,D$=gi,co=ar,Ln=Ht,Np=at,R$=Fn;class Qa{constructor(t){var n;this.refs={},this.dynamicAnchors={};let r;typeof t.schema=="object"&&(r=t.schema),this.schema=t.schema,this.schemaId=t.schemaId,this.root=t.root||this,this.baseId=(n=t.baseId)!==null&&n!==void 0?n:(0,Ln.normalizeId)(r==null?void 0:r[t.schemaId||"$id"]),this.schemaPath=t.schemaPath,this.localRefs=t.localRefs,this.meta=t.meta,this.$async=r==null?void 0:r.$async,this.refs={}}}fn.SchemaEnv=Qa;function hu(e){const t=Ug.call(this,e);if(t)return t;const n=(0,Ln.getFullPath)(this.opts.uriResolver,e.root.baseId),{es5:r,lines:o}=this.opts.code,{ownProperties:i}=this.opts,s=new En.CodeGen(this.scope,{es5:r,lines:o,ownProperties:i});let l;e.$async&&(l=s.scopeValue("Error",{ref:D$.default,code:(0,En._)`require("ajv/dist/runtime/validation_error").default`}));const u=s.scopeName("validate");e.validateName=u;const c={gen:s,allErrors:this.opts.allErrors,data:co.default.data,parentData:co.default.parentData,parentDataProperty:co.default.parentDataProperty,dataNames:[co.default.data],dataPathArr:[En.nil],dataLevel:0,dataTypes:[],definedProperties:new Set,topSchemaRef:s.scopeValue("schema",this.opts.code.source===!0?{ref:e.schema,code:(0,En.stringify)(e.schema)}:{ref:e.schema}),validateName:u,ValidationError:l,schema:e.schema,schemaEnv:e,rootId:n,baseId:e.baseId||n,schemaPath:En.nil,errSchemaPath:e.schemaPath||(this.opts.jtd?"":"#"),errorPath:(0,En._)`""`,opts:this.opts,self:this};let p;try{this._compilations.add(e),(0,R$.validateFunctionCode)(c),s.optimize(this.opts.code.optimize);const a=s.toString();p=`${s.scopeRefs(co.default.scope)}return ${a}`,this.opts.code.process&&(p=this.opts.code.process(p,e));const d=new Function(`${co.default.self}`,`${co.default.scope}`,p)(this,this.scope.get());if(this.scope.value(u,{ref:d}),d.errors=null,d.schema=e.schema,d.schemaEnv=e,e.$async&&(d.$async=!0),this.opts.code.source===!0&&(d.source={validateName:u,validateCode:a,scopeValues:s._values}),this.opts.unevaluated){const{props:h,items:m}=c;d.evaluated={props:h instanceof En.Name?void 0:h,items:m instanceof En.Name?void 0:m,dynamicProps:h instanceof En.Name,dynamicItems:m instanceof En.Name},d.source&&(d.source.evaluated=(0,En.stringify)(d.evaluated))}return e.validate=d,e}catch(a){throw delete e.validate,delete e.validateName,p&&this.logger.error("Error compiling schema, function code:",p),a}finally{this._compilations.delete(e)}}fn.compileSchema=hu;function F$(e,t,n){var r;n=(0,Ln.resolveUrl)(this.opts.uriResolver,t,n);const o=e.refs[n];if(o)return o;let i=q$.call(this,e,n);if(i===void 0){const s=(r=e.localRefs)===null||r===void 0?void 0:r[n],{schemaId:l}=this.opts;s&&(i=new Qa({schema:s,schemaId:l,root:e,baseId:t}))}if(i!==void 0)return e.refs[n]=B$.call(this,i)}fn.resolveRef=F$;function B$(e){return(0,Ln.inlineRef)(e.schema,this.opts.inlineRefs)?e.schema:e.validate?e:hu.call(this,e)}function Ug(e){for(const t of this._compilations)if(U$(t,e))return t}fn.getCompilingSchema=Ug;function U$(e,t){return e.schema===t.schema&&e.root===t.root&&e.baseId===t.baseId}function q$(e,t){let n;for(;typeof(n=this.refs[t])=="string";)t=n;return n||this.schemas[t]||Ja.call(this,e,t)}function Ja(e,t){const n=this.opts.uriResolver.parse(t),r=(0,Ln._getFullPath)(this.opts.uriResolver,n);let o=(0,Ln.getFullPath)(this.opts.uriResolver,e.baseId,void 0);if(Object.keys(e.schema).length>0&&r===o)return Cl.call(this,n,e);const i=(0,Ln.normalizeId)(r),s=this.refs[i]||this.schemas[i];if(typeof s=="string"){const l=Ja.call(this,e,s);return typeof(l==null?void 0:l.schema)!="object"?void 0:Cl.call(this,n,l)}if(typeof(s==null?void 0:s.schema)=="object"){if(s.validate||hu.call(this,s),i===(0,Ln.normalizeId)(t)){const{schema:l}=s,{schemaId:u}=this.opts,c=l[u];return c&&(o=(0,Ln.resolveUrl)(this.opts.uriResolver,o,c)),new Qa({schema:l,schemaId:u,root:e,baseId:o})}return Cl.call(this,n,s)}}fn.resolveSchema=Ja;const V$=new Set(["properties","patternProperties","enum","dependencies","definitions"]);function Cl(e,{baseId:t,schema:n,root:r}){var o;if(((o=e.fragment)===null||o===void 0?void 0:o[0])!=="/")return;for(const l of e.fragment.slice(1).split("/")){if(typeof n=="boolean")return;const u=n[(0,Np.unescapeFragment)(l)];if(u===void 0)return;n=u;const c=typeof n=="object"&&n[this.opts.schemaId];!V$.has(l)&&c&&(t=(0,Ln.resolveUrl)(this.opts.uriResolver,t,c))}let i;if(typeof n!="boolean"&&n.$ref&&!(0,Np.schemaHasRulesButRef)(n,this.RULES)){const l=(0,Ln.resolveUrl)(this.opts.uriResolver,t,n.$ref);i=Ja.call(this,r,l)}const{schemaId:s}=this.opts;if(i=i||new Qa({schema:n,schemaId:s,root:r,baseId:t}),i.schema!==i.root.schema)return i}const H$="https://raw.githubusercontent.com/ajv-validator/ajv/master/lib/refs/data.json#",K$="Meta-schema for $data reference (JSON AnySchema extension proposal)",G$="object",W$=["$data"],z$={$data:{type:"string",anyOf:[{format:"relative-json-pointer"},{format:"json-pointer"}]}},Q$=!1,J$={$id:H$,description:K$,type:G$,required:W$,properties:z$,additionalProperties:Q$};var mu={},nc={exports:{}};/** @license URI.js v4.4.1 (c) 2011 Gary Court. License: http://github.com/garycourt/uri-js */(function(e,t){(function(n,r){r(t)})(vr,function(n){function r(){for(var x=arguments.length,j=Array(x),F=0;F<x;F++)j[F]=arguments[F];if(j.length>1){j[0]=j[0].slice(0,-1);for(var se=j.length-1,ie=1;ie<se;++ie)j[ie]=j[ie].slice(1,-1);return j[se]=j[se].slice(1),j.join("")}else return j[0]}function o(x){return"(?:"+x+")"}function i(x){return x===void 0?"undefined":x===null?"null":Object.prototype.toString.call(x).split(" ").pop().split("]").shift().toLowerCase()}function s(x){return x.toUpperCase()}function l(x){return x!=null?x instanceof Array?x:typeof x.length!="number"||x.split||x.setInterval||x.call?[x]:Array.prototype.slice.call(x):[]}function u(x,j){var F=x;if(j)for(var se in j)F[se]=j[se];return F}function c(x){var j="[A-Za-z]",F="[0-9]",se=r(F,"[A-Fa-f]"),ie=o(o("%[EFef]"+se+"%"+se+se+"%"+se+se)+"|"+o("%[89A-Fa-f]"+se+"%"+se+se)+"|"+o("%"+se+se)),Ne="[\\:\\/\\?\\#\\[\\]\\@]",Ie="[\\!\\$\\&\\'\\(\\)\\*\\+\\,\\;\\=]",it=r(Ne,Ie),xt=x?"[\\xA0-\\u200D\\u2010-\\u2029\\u202F-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFEF]":"[]",ht=x?"[\\uE000-\\uF8FF]":"[]",$e=r(j,F,"[\\-\\.\\_\\~]",xt);o(j+r(j,F,"[\\+\\-\\.]")+"*"),o(o(ie+"|"+r($e,Ie,"[\\:]"))+"*");var mt=o(o("25[0-5]")+"|"+o("2[0-4]"+F)+"|"+o("1"+F+F)+"|"+o("0?[1-9]"+F)+"|0?0?"+F),S=o(mt+"\\."+mt+"\\."+mt+"\\."+mt),k=o(se+"{1,4}"),Me=o(o(k+"\\:"+k)+"|"+S),Ze=o(o(k+"\\:")+"{6}"+Me),dn=o("\\:\\:"+o(k+"\\:")+"{5}"+Me),Lo=o(o(k)+"?\\:\\:"+o(k+"\\:")+"{4}"+Me),jn=o(o(o(k+"\\:")+"{0,1}"+k)+"?\\:\\:"+o(k+"\\:")+"{3}"+Me),pr=o(o(o(k+"\\:")+"{0,2}"+k)+"?\\:\\:"+o(k+"\\:")+"{2}"+Me),ro=o(o(o(k+"\\:")+"{0,3}"+k)+"?\\:\\:"+k+"\\:"+Me),oo=o(o(o(k+"\\:")+"{0,4}"+k)+"?\\:\\:"+Me),_n=o(o(o(k+"\\:")+"{0,5}"+k)+"?\\:\\:"+k),fr=o(o(o(k+"\\:")+"{0,6}"+k)+"?\\:\\:"),so=o([Ze,dn,Lo,jn,pr,ro,oo,_n,fr].join("|")),Gn=o(o($e+"|"+ie)+"+");o("[vV]"+se+"+\\."+r($e,Ie,"[\\:]")+"+"),o(o(ie+"|"+r($e,Ie))+"*");var wi=o(ie+"|"+r($e,Ie,"[\\:\\@]"));return o(o(ie+"|"+r($e,Ie,"[\\@]"))+"+"),o(o(wi+"|"+r("[\\/\\?]",ht))+"*"),{NOT_SCHEME:new RegExp(r("[^]",j,F,"[\\+\\-\\.]"),"g"),NOT_USERINFO:new RegExp(r("[^\\%\\:]",$e,Ie),"g"),NOT_HOST:new RegExp(r("[^\\%\\[\\]\\:]",$e,Ie),"g"),NOT_PATH:new RegExp(r("[^\\%\\/\\:\\@]",$e,Ie),"g"),NOT_PATH_NOSCHEME:new RegExp(r("[^\\%\\/\\@]",$e,Ie),"g"),NOT_QUERY:new RegExp(r("[^\\%]",$e,Ie,"[\\:\\@\\/\\?]",ht),"g"),NOT_FRAGMENT:new RegExp(r("[^\\%]",$e,Ie,"[\\:\\@\\/\\?]"),"g"),ESCAPE:new RegExp(r("[^]",$e,Ie),"g"),UNRESERVED:new RegExp($e,"g"),OTHER_CHARS:new RegExp(r("[^\\%]",$e,it),"g"),PCT_ENCODED:new RegExp(ie,"g"),IPV4ADDRESS:new RegExp("^("+S+")$"),IPV6ADDRESS:new RegExp("^\\[?("+so+")"+o(o("\\%25|\\%(?!"+se+"{2})")+"("+Gn+")")+"?\\]?$")}}var p=c(!1),a=c(!0),d=function(){function x(j,F){var se=[],ie=!0,Ne=!1,Ie=void 0;try{for(var it=j[Symbol.iterator](),xt;!(ie=(xt=it.next()).done)&&(se.push(xt.value),!(F&&se.length===F));ie=!0);}catch(ht){Ne=!0,Ie=ht}finally{try{!ie&&it.return&&it.return()}finally{if(Ne)throw Ie}}return se}return function(j,F){if(Array.isArray(j))return j;if(Symbol.iterator in Object(j))return x(j,F);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),h=function(x){if(Array.isArray(x)){for(var j=0,F=Array(x.length);j<x.length;j++)F[j]=x[j];return F}else return Array.from(x)},m=2147483647,y=36,T=1,g=26,C=38,N=700,L=72,B=128,M="-",E=/^xn--/,W=/[^\0-\x7E]/,q=/[\x2E\u3002\uFF0E\uFF61]/g,ue={overflow:"Overflow: input needs wider integers to process","not-basic":"Illegal input >= 0x80 (not a basic code point)","invalid-input":"Invalid input"},ce=y-T,te=Math.floor,Q=String.fromCharCode;function ae(x){throw new RangeError(ue[x])}function ke(x,j){for(var F=[],se=x.length;se--;)F[se]=j(x[se]);return F}function Ee(x,j){var F=x.split("@"),se="";F.length>1&&(se=F[0]+"@",x=F[1]),x=x.replace(q,".");var ie=x.split("."),Ne=ke(ie,j).join(".");return se+Ne}function qe(x){for(var j=[],F=0,se=x.length;F<se;){var ie=x.charCodeAt(F++);if(ie>=55296&&ie<=56319&&F<se){var Ne=x.charCodeAt(F++);(Ne&64512)==56320?j.push(((ie&1023)<<10)+(Ne&1023)+65536):(j.push(ie),F--)}else j.push(ie)}return j}var He=function(x){return String.fromCodePoint.apply(String,h(x))},pt=function(x){return x-48<10?x-22:x-65<26?x-65:x-97<26?x-97:y},D=function(x,j){return x+22+75*(x<26)-((j!=0)<<5)},v=function(x,j,F){var se=0;for(x=F?te(x/N):x>>1,x+=te(x/j);x>ce*g>>1;se+=y)x=te(x/ce);return te(se+(ce+1)*x/(x+C))},A=function(x){var j=[],F=x.length,se=0,ie=B,Ne=L,Ie=x.lastIndexOf(M);Ie<0&&(Ie=0);for(var it=0;it<Ie;++it)x.charCodeAt(it)>=128&&ae("not-basic"),j.push(x.charCodeAt(it));for(var xt=Ie>0?Ie+1:0;xt<F;){for(var ht=se,$e=1,mt=y;;mt+=y){xt>=F&&ae("invalid-input");var S=pt(x.charCodeAt(xt++));(S>=y||S>te((m-se)/$e))&&ae("overflow"),se+=S*$e;var k=mt<=Ne?T:mt>=Ne+g?g:mt-Ne;if(S<k)break;var Me=y-k;$e>te(m/Me)&&ae("overflow"),$e*=Me}var Ze=j.length+1;Ne=v(se-ht,Ze,ht==0),te(se/Ze)>m-ie&&ae("overflow"),ie+=te(se/Ze),se%=Ze,j.splice(se++,0,ie)}return String.fromCodePoint.apply(String,j)},$=function(x){var j=[];x=qe(x);var F=x.length,se=B,ie=0,Ne=L,Ie=!0,it=!1,xt=void 0;try{for(var ht=x[Symbol.iterator](),$e;!(Ie=($e=ht.next()).done);Ie=!0){var mt=$e.value;mt<128&&j.push(Q(mt))}}catch(ws){it=!0,xt=ws}finally{try{!Ie&&ht.return&&ht.return()}finally{if(it)throw xt}}var S=j.length,k=S;for(S&&j.push(M);k<F;){var Me=m,Ze=!0,dn=!1,Lo=void 0;try{for(var jn=x[Symbol.iterator](),pr;!(Ze=(pr=jn.next()).done);Ze=!0){var ro=pr.value;ro>=se&&ro<Me&&(Me=ro)}}catch(ws){dn=!0,Lo=ws}finally{try{!Ze&&jn.return&&jn.return()}finally{if(dn)throw Lo}}var oo=k+1;Me-se>te((m-ie)/oo)&&ae("overflow"),ie+=(Me-se)*oo,se=Me;var _n=!0,fr=!1,so=void 0;try{for(var Gn=x[Symbol.iterator](),wi;!(_n=(wi=Gn.next()).done);_n=!0){var id=wi.value;if(id<se&&++ie>m&&ae("overflow"),id==se){for(var ki=ie,Si=y;;Si+=y){var Ci=Si<=Ne?T:Si>=Ne+g?g:Si-Ne;if(ki<Ci)break;var ad=ki-Ci,ld=y-Ci;j.push(Q(D(Ci+ad%ld,0))),ki=te(ad/ld)}j.push(Q(D(ki,0))),Ne=v(ie,oo,k==S),ie=0,++k}}}catch(ws){fr=!0,so=ws}finally{try{!_n&&Gn.return&&Gn.return()}finally{if(fr)throw so}}++ie,++se}return j.join("")},b=function(x){return Ee(x,function(j){return E.test(j)?A(j.slice(4).toLowerCase()):j})},w=function(x){return Ee(x,function(j){return W.test(j)?"xn--"+$(j):j})},I={version:"2.1.0",ucs2:{decode:qe,encode:He},decode:A,encode:$,toASCII:w,toUnicode:b},G={};function Z(x){var j=x.charCodeAt(0),F=void 0;return j<16?F="%0"+j.toString(16).toUpperCase():j<128?F="%"+j.toString(16).toUpperCase():j<2048?F="%"+(j>>6|192).toString(16).toUpperCase()+"%"+(j&63|128).toString(16).toUpperCase():F="%"+(j>>12|224).toString(16).toUpperCase()+"%"+(j>>6&63|128).toString(16).toUpperCase()+"%"+(j&63|128).toString(16).toUpperCase(),F}function he(x){for(var j="",F=0,se=x.length;F<se;){var ie=parseInt(x.substr(F+1,2),16);if(ie<128)j+=String.fromCharCode(ie),F+=3;else if(ie>=194&&ie<224){if(se-F>=6){var Ne=parseInt(x.substr(F+4,2),16);j+=String.fromCharCode((ie&31)<<6|Ne&63)}else j+=x.substr(F,6);F+=6}else if(ie>=224){if(se-F>=9){var Ie=parseInt(x.substr(F+4,2),16),it=parseInt(x.substr(F+7,2),16);j+=String.fromCharCode((ie&15)<<12|(Ie&63)<<6|it&63)}else j+=x.substr(F,9);F+=9}else j+=x.substr(F,3),F+=3}return j}function le(x,j){function F(se){var ie=he(se);return ie.match(j.UNRESERVED)?ie:se}return x.scheme&&(x.scheme=String(x.scheme).replace(j.PCT_ENCODED,F).toLowerCase().replace(j.NOT_SCHEME,"")),x.userinfo!==void 0&&(x.userinfo=String(x.userinfo).replace(j.PCT_ENCODED,F).replace(j.NOT_USERINFO,Z).replace(j.PCT_ENCODED,s)),x.host!==void 0&&(x.host=String(x.host).replace(j.PCT_ENCODED,F).toLowerCase().replace(j.NOT_HOST,Z).replace(j.PCT_ENCODED,s)),x.path!==void 0&&(x.path=String(x.path).replace(j.PCT_ENCODED,F).replace(x.scheme?j.NOT_PATH:j.NOT_PATH_NOSCHEME,Z).replace(j.PCT_ENCODED,s)),x.query!==void 0&&(x.query=String(x.query).replace(j.PCT_ENCODED,F).replace(j.NOT_QUERY,Z).replace(j.PCT_ENCODED,s)),x.fragment!==void 0&&(x.fragment=String(x.fragment).replace(j.PCT_ENCODED,F).replace(j.NOT_FRAGMENT,Z).replace(j.PCT_ENCODED,s)),x}function me(x){return x.replace(/^0*(.*)/,"$1")||"0"}function Fe(x,j){var F=x.match(j.IPV4ADDRESS)||[],se=d(F,2),ie=se[1];return ie?ie.split(".").map(me).join("."):x}function _(x,j){var F=x.match(j.IPV6ADDRESS)||[],se=d(F,3),ie=se[1],Ne=se[2];if(ie){for(var Ie=ie.toLowerCase().split("::").reverse(),it=d(Ie,2),xt=it[0],ht=it[1],$e=ht?ht.split(":").map(me):[],mt=xt.split(":").map(me),S=j.IPV4ADDRESS.test(mt[mt.length-1]),k=S?7:8,Me=mt.length-k,Ze=Array(k),dn=0;dn<k;++dn)Ze[dn]=$e[dn]||mt[Me+dn]||"";S&&(Ze[k-1]=Fe(Ze[k-1],j));var Lo=Ze.reduce(function(_n,fr,so){if(!fr||fr==="0"){var Gn=_n[_n.length-1];Gn&&Gn.index+Gn.length===so?Gn.length++:_n.push({index:so,length:1})}return _n},[]),jn=Lo.sort(function(_n,fr){return fr.length-_n.length})[0],pr=void 0;if(jn&&jn.length>1){var ro=Ze.slice(0,jn.index),oo=Ze.slice(jn.index+jn.length);pr=ro.join(":")+"::"+oo.join(":")}else pr=Ze.join(":");return Ne&&(pr+="%"+Ne),pr}else return x}var O=/^(?:([^:\/?#]+):)?(?:\/\/((?:([^\/?#@]*)@)?(\[[^\/?#\]]+\]|[^\/?#:]*)(?:\:(\d*))?))?([^?#]*)(?:\?([^#]*))?(?:#((?:.|\n|\r)*))?/i,V="".match(/(){0}/)[1]===void 0;function J(x){var j=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},F={},se=j.iri!==!1?a:p;j.reference==="suffix"&&(x=(j.scheme?j.scheme+":":"")+"//"+x);var ie=x.match(O);if(ie){V?(F.scheme=ie[1],F.userinfo=ie[3],F.host=ie[4],F.port=parseInt(ie[5],10),F.path=ie[6]||"",F.query=ie[7],F.fragment=ie[8],isNaN(F.port)&&(F.port=ie[5])):(F.scheme=ie[1]||void 0,F.userinfo=x.indexOf("@")!==-1?ie[3]:void 0,F.host=x.indexOf("//")!==-1?ie[4]:void 0,F.port=parseInt(ie[5],10),F.path=ie[6]||"",F.query=x.indexOf("?")!==-1?ie[7]:void 0,F.fragment=x.indexOf("#")!==-1?ie[8]:void 0,isNaN(F.port)&&(F.port=x.match(/\/\/(?:.|\n)*\:(?:\/|\?|\#|$)/)?ie[4]:void 0)),F.host&&(F.host=_(Fe(F.host,se),se)),F.scheme===void 0&&F.userinfo===void 0&&F.host===void 0&&F.port===void 0&&!F.path&&F.query===void 0?F.reference="same-document":F.scheme===void 0?F.reference="relative":F.fragment===void 0?F.reference="absolute":F.reference="uri",j.reference&&j.reference!=="suffix"&&j.reference!==F.reference&&(F.error=F.error||"URI is not a "+j.reference+" reference.");var Ne=G[(j.scheme||F.scheme||"").toLowerCase()];if(!j.unicodeSupport&&(!Ne||!Ne.unicodeSupport)){if(F.host&&(j.domainHost||Ne&&Ne.domainHost))try{F.host=I.toASCII(F.host.replace(se.PCT_ENCODED,he).toLowerCase())}catch(Ie){F.error=F.error||"Host's domain name can not be converted to ASCII via punycode: "+Ie}le(F,p)}else le(F,se);Ne&&Ne.parse&&Ne.parse(F,j)}else F.error=F.error||"URI can not be parsed.";return F}function X(x,j){var F=j.iri!==!1?a:p,se=[];return x.userinfo!==void 0&&(se.push(x.userinfo),se.push("@")),x.host!==void 0&&se.push(_(Fe(String(x.host),F),F).replace(F.IPV6ADDRESS,function(ie,Ne,Ie){return"["+Ne+(Ie?"%25"+Ie:"")+"]"})),(typeof x.port=="number"||typeof x.port=="string")&&(se.push(":"),se.push(String(x.port))),se.length?se.join(""):void 0}var ne=/^\.\.?\//,de=/^\/\.(\/|$)/,fe=/^\/\.\.(\/|$)/,pe=/^\/?(?:.|\n)*?(?=\/|$)/;function oe(x){for(var j=[];x.length;)if(x.match(ne))x=x.replace(ne,"");else if(x.match(de))x=x.replace(de,"/");else if(x.match(fe))x=x.replace(fe,"/"),j.pop();else if(x==="."||x==="..")x="";else{var F=x.match(pe);if(F){var se=F[0];x=x.slice(se.length),j.push(se)}else throw new Error("Unexpected dot segment condition")}return j.join("")}function U(x){var j=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},F=j.iri?a:p,se=[],ie=G[(j.scheme||x.scheme||"").toLowerCase()];if(ie&&ie.serialize&&ie.serialize(x,j),x.host&&!F.IPV6ADDRESS.test(x.host)&&(j.domainHost||ie&&ie.domainHost))try{x.host=j.iri?I.toUnicode(x.host):I.toASCII(x.host.replace(F.PCT_ENCODED,he).toLowerCase())}catch(it){x.error=x.error||"Host's domain name can not be converted to "+(j.iri?"Unicode":"ASCII")+" via punycode: "+it}le(x,F),j.reference!=="suffix"&&x.scheme&&(se.push(x.scheme),se.push(":"));var Ne=X(x,j);if(Ne!==void 0&&(j.reference!=="suffix"&&se.push("//"),se.push(Ne),x.path&&x.path.charAt(0)!=="/"&&se.push("/")),x.path!==void 0){var Ie=x.path;!j.absolutePath&&(!ie||!ie.absolutePath)&&(Ie=oe(Ie)),Ne===void 0&&(Ie=Ie.replace(/^\/\//,"/%2F")),se.push(Ie)}return x.query!==void 0&&(se.push("?"),se.push(x.query)),x.fragment!==void 0&&(se.push("#"),se.push(x.fragment)),se.join("")}function K(x,j){var F=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},se=arguments[3],ie={};return se||(x=J(U(x,F),F),j=J(U(j,F),F)),F=F||{},!F.tolerant&&j.scheme?(ie.scheme=j.scheme,ie.userinfo=j.userinfo,ie.host=j.host,ie.port=j.port,ie.path=oe(j.path||""),ie.query=j.query):(j.userinfo!==void 0||j.host!==void 0||j.port!==void 0?(ie.userinfo=j.userinfo,ie.host=j.host,ie.port=j.port,ie.path=oe(j.path||""),ie.query=j.query):(j.path?(j.path.charAt(0)==="/"?ie.path=oe(j.path):((x.userinfo!==void 0||x.host!==void 0||x.port!==void 0)&&!x.path?ie.path="/"+j.path:x.path?ie.path=x.path.slice(0,x.path.lastIndexOf("/")+1)+j.path:ie.path=j.path,ie.path=oe(ie.path)),ie.query=j.query):(ie.path=x.path,j.query!==void 0?ie.query=j.query:ie.query=x.query),ie.userinfo=x.userinfo,ie.host=x.host,ie.port=x.port),ie.scheme=x.scheme),ie.fragment=j.fragment,ie}function re(x,j,F){var se=u({scheme:"null"},F);return U(K(J(x,se),J(j,se),se,!0),se)}function ye(x,j){return typeof x=="string"?x=U(J(x,j),j):i(x)==="object"&&(x=J(U(x,j),j)),x}function ge(x,j,F){return typeof x=="string"?x=U(J(x,F),F):i(x)==="object"&&(x=U(x,F)),typeof j=="string"?j=U(J(j,F),F):i(j)==="object"&&(j=U(j,F)),x===j}function Ce(x,j){return x&&x.toString().replace(!j||!j.iri?p.ESCAPE:a.ESCAPE,Z)}function we(x,j){return x&&x.toString().replace(!j||!j.iri?p.PCT_ENCODED:a.PCT_ENCODED,he)}var tt={scheme:"http",domainHost:!0,parse:function(x,j){return x.host||(x.error=x.error||"HTTP URIs must have a host."),x},serialize:function(x,j){var F=String(x.scheme).toLowerCase()==="https";return(x.port===(F?443:80)||x.port==="")&&(x.port=void 0),x.path||(x.path="/"),x}},ct={scheme:"https",domainHost:tt.domainHost,parse:tt.parse,serialize:tt.serialize};function _t(x){return typeof x.secure=="boolean"?x.secure:String(x.scheme).toLowerCase()==="wss"}var Tt={scheme:"ws",domainHost:!0,parse:function(x,j){var F=x;return F.secure=_t(F),F.resourceName=(F.path||"/")+(F.query?"?"+F.query:""),F.path=void 0,F.query=void 0,F},serialize:function(x,j){if((x.port===(_t(x)?443:80)||x.port==="")&&(x.port=void 0),typeof x.secure=="boolean"&&(x.scheme=x.secure?"wss":"ws",x.secure=void 0),x.resourceName){var F=x.resourceName.split("?"),se=d(F,2),ie=se[0],Ne=se[1];x.path=ie&&ie!=="/"?ie:void 0,x.query=Ne,x.resourceName=void 0}return x.fragment=void 0,x}},mn={scheme:"wss",domainHost:Tt.domainHost,parse:Tt.parse,serialize:Tt.serialize},Ir={},At="[A-Za-z0-9\\-\\.\\_\\~\\xA0-\\u200D\\u2010-\\u2029\\u202F-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFEF]",vt="[0-9A-Fa-f]",lr=o(o("%[EFef]"+vt+"%"+vt+vt+"%"+vt+vt)+"|"+o("%[89A-Fa-f]"+vt+"%"+vt+vt)+"|"+o("%"+vt+vt)),cr="[A-Za-z0-9\\!\\$\\%\\'\\*\\+\\-\\^\\_\\`\\{\\|\\}\\~]",Eo="[\\!\\$\\%\\'\\(\\)\\*\\+\\,\\-\\.0-9\\<\\>A-Z\\x5E-\\x7E]",no=r(Eo,'[\\"\\\\]'),It="[\\!\\$\\'\\(\\)\\*\\+\\,\\;\\:\\@]",No=new RegExp(At,"g"),Kn=new RegExp(lr,"g"),ur=new RegExp(r("[^]",cr,"[\\.]",'[\\"]',no),"g"),dr=new RegExp(r("[^]",At,It),"g"),qt=dr;function Pr(x){var j=he(x);return j.match(No)?j:x}var jr={scheme:"mailto",parse:function(x,j){var F=x,se=F.to=F.path?F.path.split(","):[];if(F.path=void 0,F.query){for(var ie=!1,Ne={},Ie=F.query.split("&"),it=0,xt=Ie.length;it<xt;++it){var ht=Ie[it].split("=");switch(ht[0]){case"to":for(var $e=ht[1].split(","),mt=0,S=$e.length;mt<S;++mt)se.push($e[mt]);break;case"subject":F.subject=we(ht[1],j);break;case"body":F.body=we(ht[1],j);break;default:ie=!0,Ne[we(ht[0],j)]=we(ht[1],j);break}}ie&&(F.headers=Ne)}F.query=void 0;for(var k=0,Me=se.length;k<Me;++k){var Ze=se[k].split("@");if(Ze[0]=we(Ze[0]),j.unicodeSupport)Ze[1]=we(Ze[1],j).toLowerCase();else try{Ze[1]=I.toASCII(we(Ze[1],j).toLowerCase())}catch(dn){F.error=F.error||"Email address's domain name can not be converted to ASCII via punycode: "+dn}se[k]=Ze.join("@")}return F},serialize:function(x,j){var F=x,se=l(x.to);if(se){for(var ie=0,Ne=se.length;ie<Ne;++ie){var Ie=String(se[ie]),it=Ie.lastIndexOf("@"),xt=Ie.slice(0,it).replace(Kn,Pr).replace(Kn,s).replace(ur,Z),ht=Ie.slice(it+1);try{ht=j.iri?I.toUnicode(ht):I.toASCII(we(ht,j).toLowerCase())}catch(k){F.error=F.error||"Email address's domain name can not be converted to "+(j.iri?"Unicode":"ASCII")+" via punycode: "+k}se[ie]=xt+"@"+ht}F.path=se.join(",")}var $e=x.headers=x.headers||{};x.subject&&($e.subject=x.subject),x.body&&($e.body=x.body);var mt=[];for(var S in $e)$e[S]!==Ir[S]&&mt.push(S.replace(Kn,Pr).replace(Kn,s).replace(dr,Z)+"="+$e[S].replace(Kn,Pr).replace(Kn,s).replace(qt,Z));return mt.length&&(F.query=mt.join("&")),F}},Ts=/^([^\:]+)\:(.*)/,Mo={scheme:"urn",parse:function(x,j){var F=x.path&&x.path.match(Ts),se=x;if(F){var ie=j.scheme||se.scheme||"urn",Ne=F[1].toLowerCase(),Ie=F[2],it=ie+":"+(j.nid||Ne),xt=G[it];se.nid=Ne,se.nss=Ie,se.path=void 0,xt&&(se=xt.parse(se,j))}else se.error=se.error||"URN can not be parsed.";return se},serialize:function(x,j){var F=j.scheme||x.scheme||"urn",se=x.nid,ie=F+":"+(j.nid||se),Ne=G[ie];Ne&&(x=Ne.serialize(x,j));var Ie=x,it=x.nss;return Ie.path=(se||j.nid)+":"+it,Ie}},Pt=/^[0-9A-Fa-f]{8}(?:\-[0-9A-Fa-f]{4}){3}\-[0-9A-Fa-f]{12}$/,P={scheme:"urn:uuid",parse:function(x,j){var F=x;return F.uuid=F.nss,F.nss=void 0,!j.tolerant&&(!F.uuid||!F.uuid.match(Pt))&&(F.error=F.error||"UUID is not valid."),F},serialize:function(x,j){var F=x;return F.nss=(x.uuid||"").toLowerCase(),F}};G[tt.scheme]=tt,G[ct.scheme]=ct,G[Tt.scheme]=Tt,G[mn.scheme]=mn,G[jr.scheme]=jr,G[Mo.scheme]=Mo,G[P.scheme]=P,n.SCHEMES=G,n.pctEncChar=Z,n.pctDecChars=he,n.parse=J,n.removeDotSegments=oe,n.serialize=U,n.resolveComponents=K,n.resolve=re,n.normalize=ye,n.equal=ge,n.escapeComponent=Ce,n.unescapeComponent=we,Object.defineProperty(n,"__esModule",{value:!0})})})(nc,nc.exports);var Y$=nc.exports;Object.defineProperty(mu,"__esModule",{value:!0});const qg=Y$;qg.code='require("ajv/dist/runtime/uri").default';mu.default=qg;(function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.CodeGen=e.Name=e.nil=e.stringify=e.str=e._=e.KeywordCxt=void 0;var t=Fn;Object.defineProperty(e,"KeywordCxt",{enumerable:!0,get:function(){return t.KeywordCxt}});var n=Je;Object.defineProperty(e,"_",{enumerable:!0,get:function(){return n._}}),Object.defineProperty(e,"str",{enumerable:!0,get:function(){return n.str}}),Object.defineProperty(e,"stringify",{enumerable:!0,get:function(){return n.stringify}}),Object.defineProperty(e,"nil",{enumerable:!0,get:function(){return n.nil}}),Object.defineProperty(e,"Name",{enumerable:!0,get:function(){return n.Name}}),Object.defineProperty(e,"CodeGen",{enumerable:!0,get:function(){return n.CodeGen}});const r=gi,o=vi,i=Io,s=fn,l=Je,u=Ht,c=yi,p=at,a=J$,d=mu,h=(D,v)=>new RegExp(D,v);h.code="new RegExp";const m=["removeAdditional","useDefaults","coerceTypes"],y=new Set(["validate","serialize","parse","wrapper","root","schema","keyword","pattern","formats","validate$data","func","obj","Error"]),T={errorDataPath:"",format:"`validateFormats: false` can be used instead.",nullable:'"nullable" keyword is supported by default.',jsonPointers:"Deprecated jsPropertySyntax can be used instead.",extendRefs:"Deprecated ignoreKeywordsWithRef can be used instead.",missingRefs:"Pass empty schema with $id that should be ignored to ajv.addSchema.",processCode:"Use option `code: {process: (code, schemaEnv: object) => string}`",sourceCode:"Use option `code: {source: true}`",strictDefaults:"It is default now, see option `strict`.",strictKeywords:"It is default now, see option `strict`.",uniqueItems:'"uniqueItems" keyword is always validated.',unknownFormats:"Disable strict mode or pass `true` to `ajv.addFormat` (or `formats` option).",cache:"Map is used as cache, schema object as key.",serialize:"Map is used as cache, schema object as key.",ajvErrors:"It is default now."},g={ignoreKeywordsWithRef:"",jsPropertySyntax:"",unicode:'"minLength"/"maxLength" account for unicode characters by default.'},C=200;function N(D){var v,A,$,b,w,I,G,Z,he,le,me,Fe,_,O,V,J,X,ne,de,fe,pe,oe,U,K,re;const ye=D.strict,ge=(v=D.code)===null||v===void 0?void 0:v.optimize,Ce=ge===!0||ge===void 0?1:ge||0,we=($=(A=D.code)===null||A===void 0?void 0:A.regExp)!==null&&$!==void 0?$:h,tt=(b=D.uriResolver)!==null&&b!==void 0?b:d.default;return{strictSchema:(I=(w=D.strictSchema)!==null&&w!==void 0?w:ye)!==null&&I!==void 0?I:!0,strictNumbers:(Z=(G=D.strictNumbers)!==null&&G!==void 0?G:ye)!==null&&Z!==void 0?Z:!0,strictTypes:(le=(he=D.strictTypes)!==null&&he!==void 0?he:ye)!==null&&le!==void 0?le:"log",strictTuples:(Fe=(me=D.strictTuples)!==null&&me!==void 0?me:ye)!==null&&Fe!==void 0?Fe:"log",strictRequired:(O=(_=D.strictRequired)!==null&&_!==void 0?_:ye)!==null&&O!==void 0?O:!1,code:D.code?{...D.code,optimize:Ce,regExp:we}:{optimize:Ce,regExp:we},loopRequired:(V=D.loopRequired)!==null&&V!==void 0?V:C,loopEnum:(J=D.loopEnum)!==null&&J!==void 0?J:C,meta:(X=D.meta)!==null&&X!==void 0?X:!0,messages:(ne=D.messages)!==null&&ne!==void 0?ne:!0,inlineRefs:(de=D.inlineRefs)!==null&&de!==void 0?de:!0,schemaId:(fe=D.schemaId)!==null&&fe!==void 0?fe:"$id",addUsedSchema:(pe=D.addUsedSchema)!==null&&pe!==void 0?pe:!0,validateSchema:(oe=D.validateSchema)!==null&&oe!==void 0?oe:!0,validateFormats:(U=D.validateFormats)!==null&&U!==void 0?U:!0,unicodeRegExp:(K=D.unicodeRegExp)!==null&&K!==void 0?K:!0,int32range:(re=D.int32range)!==null&&re!==void 0?re:!0,uriResolver:tt}}class L{constructor(v={}){this.schemas={},this.refs={},this.formats={},this._compilations=new Set,this._loading={},this._cache=new Map,v=this.opts={...v,...N(v)};const{es5:A,lines:$}=this.opts.code;this.scope=new l.ValueScope({scope:{},prefixes:y,es5:A,lines:$}),this.logger=te(v.logger);const b=v.validateFormats;v.validateFormats=!1,this.RULES=(0,i.getRules)(),B.call(this,T,v,"NOT SUPPORTED"),B.call(this,g,v,"DEPRECATED","warn"),this._metaOpts=ue.call(this),v.formats&&W.call(this),this._addVocabularies(),this._addDefaultMetaSchema(),v.keywords&&q.call(this,v.keywords),typeof v.meta=="object"&&this.addMetaSchema(v.meta),E.call(this),v.validateFormats=b}_addVocabularies(){this.addKeyword("$async")}_addDefaultMetaSchema(){const{$data:v,meta:A,schemaId:$}=this.opts;let b=a;$==="id"&&(b={...a},b.id=b.$id,delete b.$id),A&&v&&this.addMetaSchema(b,b[$],!1)}defaultMeta(){const{meta:v,schemaId:A}=this.opts;return this.opts.defaultMeta=typeof v=="object"?v[A]||v:void 0}validate(v,A){let $;if(typeof v=="string"){if($=this.getSchema(v),!$)throw new Error(`no schema with key or ref "${v}"`)}else $=this.compile(v);const b=$(A);return"$async"in $||(this.errors=$.errors),b}compile(v,A){const $=this._addSchema(v,A);return $.validate||this._compileSchemaEnv($)}compileAsync(v,A){if(typeof this.opts.loadSchema!="function")throw new Error("options.loadSchema should be a function");const{loadSchema:$}=this.opts;return b.call(this,v,A);async function b(le,me){await w.call(this,le.$schema);const Fe=this._addSchema(le,me);return Fe.validate||I.call(this,Fe)}async function w(le){le&&!this.getSchema(le)&&await b.call(this,{$ref:le},!0)}async function I(le){try{return this._compileSchemaEnv(le)}catch(me){if(!(me instanceof o.default))throw me;return G.call(this,me),await Z.call(this,me.missingSchema),I.call(this,le)}}function G({missingSchema:le,missingRef:me}){if(this.refs[le])throw new Error(`AnySchema ${le} is loaded but ${me} cannot be resolved`)}async function Z(le){const me=await he.call(this,le);this.refs[le]||await w.call(this,me.$schema),this.refs[le]||this.addSchema(me,le,A)}async function he(le){const me=this._loading[le];if(me)return me;try{return await(this._loading[le]=$(le))}finally{delete this._loading[le]}}}addSchema(v,A,$,b=this.opts.validateSchema){if(Array.isArray(v)){for(const I of v)this.addSchema(I,void 0,$,b);return this}let w;if(typeof v=="object"){const{schemaId:I}=this.opts;if(w=v[I],w!==void 0&&typeof w!="string")throw new Error(`schema ${I} must be string`)}return A=(0,u.normalizeId)(A||w),this._checkUnique(A),this.schemas[A]=this._addSchema(v,$,A,b,!0),this}addMetaSchema(v,A,$=this.opts.validateSchema){return this.addSchema(v,A,!0,$),this}validateSchema(v,A){if(typeof v=="boolean")return!0;let $;if($=v.$schema,$!==void 0&&typeof $!="string")throw new Error("$schema must be a string");if($=$||this.opts.defaultMeta||this.defaultMeta(),!$)return this.logger.warn("meta-schema not available"),this.errors=null,!0;const b=this.validate($,v);if(!b&&A){const w="schema is invalid: "+this.errorsText();if(this.opts.validateSchema==="log")this.logger.error(w);else throw new Error(w)}return b}getSchema(v){let A;for(;typeof(A=M.call(this,v))=="string";)v=A;if(A===void 0){const{schemaId:$}=this.opts,b=new s.SchemaEnv({schema:{},schemaId:$});if(A=s.resolveSchema.call(this,b,v),!A)return;this.refs[v]=A}return A.validate||this._compileSchemaEnv(A)}removeSchema(v){if(v instanceof RegExp)return this._removeAllSchemas(this.schemas,v),this._removeAllSchemas(this.refs,v),this;switch(typeof v){case"undefined":return this._removeAllSchemas(this.schemas),this._removeAllSchemas(this.refs),this._cache.clear(),this;case"string":{const A=M.call(this,v);return typeof A=="object"&&this._cache.delete(A.schema),delete this.schemas[v],delete this.refs[v],this}case"object":{const A=v;this._cache.delete(A);let $=v[this.opts.schemaId];return $&&($=(0,u.normalizeId)($),delete this.schemas[$],delete this.refs[$]),this}default:throw new Error("ajv.removeSchema: invalid parameter")}}addVocabulary(v){for(const A of v)this.addKeyword(A);return this}addKeyword(v,A){let $;if(typeof v=="string")$=v,typeof A=="object"&&(this.logger.warn("these parameters are deprecated, see docs for addKeyword"),A.keyword=$);else if(typeof v=="object"&&A===void 0){if(A=v,$=A.keyword,Array.isArray($)&&!$.length)throw new Error("addKeywords: keyword must be string or non-empty array")}else throw new Error("invalid addKeywords parameters");if(ae.call(this,$,A),!A)return(0,p.eachItem)($,w=>ke.call(this,w)),this;qe.call(this,A);const b={...A,type:(0,c.getJSONTypes)(A.type),schemaType:(0,c.getJSONTypes)(A.schemaType)};return(0,p.eachItem)($,b.type.length===0?w=>ke.call(this,w,b):w=>b.type.forEach(I=>ke.call(this,w,b,I))),this}getKeyword(v){const A=this.RULES.all[v];return typeof A=="object"?A.definition:!!A}removeKeyword(v){const{RULES:A}=this;delete A.keywords[v],delete A.all[v];for(const $ of A.rules){const b=$.rules.findIndex(w=>w.keyword===v);b>=0&&$.rules.splice(b,1)}return this}addFormat(v,A){return typeof A=="string"&&(A=new RegExp(A)),this.formats[v]=A,this}errorsText(v=this.errors,{separator:A=", ",dataVar:$="data"}={}){return!v||v.length===0?"No errors":v.map(b=>`${$}${b.instancePath} ${b.message}`).reduce((b,w)=>b+A+w)}$dataMetaSchema(v,A){const $=this.RULES.all;v=JSON.parse(JSON.stringify(v));for(const b of A){const w=b.split("/").slice(1);let I=v;for(const G of w)I=I[G];for(const G in $){const Z=$[G];if(typeof Z!="object")continue;const{$data:he}=Z.definition,le=I[G];he&&le&&(I[G]=pt(le))}}return v}_removeAllSchemas(v,A){for(const $ in v){const b=v[$];(!A||A.test($))&&(typeof b=="string"?delete v[$]:b&&!b.meta&&(this._cache.delete(b.schema),delete v[$]))}}_addSchema(v,A,$,b=this.opts.validateSchema,w=this.opts.addUsedSchema){let I;const{schemaId:G}=this.opts;if(typeof v=="object")I=v[G];else{if(this.opts.jtd)throw new Error("schema must be object");if(typeof v!="boolean")throw new Error("schema must be object or boolean")}let Z=this._cache.get(v);if(Z!==void 0)return Z;$=(0,u.normalizeId)(I||$);const he=u.getSchemaRefs.call(this,v,$);return Z=new s.SchemaEnv({schema:v,schemaId:G,meta:A,baseId:$,localRefs:he}),this._cache.set(Z.schema,Z),w&&!$.startsWith("#")&&($&&this._checkUnique($),this.refs[$]=Z),b&&this.validateSchema(v,!0),Z}_checkUnique(v){if(this.schemas[v]||this.refs[v])throw new Error(`schema with key or id "${v}" already exists`)}_compileSchemaEnv(v){if(v.meta?this._compileMetaSchema(v):s.compileSchema.call(this,v),!v.validate)throw new Error("ajv implementation error");return v.validate}_compileMetaSchema(v){const A=this.opts;this.opts=this._metaOpts;try{s.compileSchema.call(this,v)}finally{this.opts=A}}}e.default=L,L.ValidationError=r.default,L.MissingRefError=o.default;function B(D,v,A,$="error"){for(const b in D){const w=b;w in v&&this.logger[$](`${A}: option ${b}. ${D[w]}`)}}function M(D){return D=(0,u.normalizeId)(D),this.schemas[D]||this.refs[D]}function E(){const D=this.opts.schemas;if(D)if(Array.isArray(D))this.addSchema(D);else for(const v in D)this.addSchema(D[v],v)}function W(){for(const D in this.opts.formats){const v=this.opts.formats[D];v&&this.addFormat(D,v)}}function q(D){if(Array.isArray(D)){this.addVocabulary(D);return}this.logger.warn("keywords option as map is deprecated, pass array");for(const v in D){const A=D[v];A.keyword||(A.keyword=v),this.addKeyword(A)}}function ue(){const D={...this.opts};for(const v of m)delete D[v];return D}const ce={log(){},warn(){},error(){}};function te(D){if(D===!1)return ce;if(D===void 0)return console;if(D.log&&D.warn&&D.error)return D;throw new Error("logger must implement log, warn and error methods")}const Q=/^[a-z_$][a-z0-9_$:-]*$/i;function ae(D,v){const{RULES:A}=this;if((0,p.eachItem)(D,$=>{if(A.keywords[$])throw new Error(`Keyword ${$} is already defined`);if(!Q.test($))throw new Error(`Keyword ${$} has invalid name`)}),!!v&&v.$data&&!("code"in v||"validate"in v))throw new Error('$data keyword must have "code" or "validate" function')}function ke(D,v,A){var $;const b=v==null?void 0:v.post;if(A&&b)throw new Error('keyword with "post" flag cannot have "type"');const{RULES:w}=this;let I=b?w.post:w.rules.find(({type:Z})=>Z===A);if(I||(I={type:A,rules:[]},w.rules.push(I)),w.keywords[D]=!0,!v)return;const G={keyword:D,definition:{...v,type:(0,c.getJSONTypes)(v.type),schemaType:(0,c.getJSONTypes)(v.schemaType)}};v.before?Ee.call(this,I,G,v.before):I.rules.push(G),w.all[D]=G,($=v.implements)===null||$===void 0||$.forEach(Z=>this.addKeyword(Z))}function Ee(D,v,A){const $=D.rules.findIndex(b=>b.keyword===A);$>=0?D.rules.splice($,0,v):(D.rules.push(v),this.logger.warn(`rule ${A} is not defined`))}function qe(D){let{metaSchema:v}=D;v!==void 0&&(D.$data&&this.opts.$data&&(v=pt(v)),D.validateSchema=this.compile(v,!0))}const He={$ref:"https://raw.githubusercontent.com/ajv-validator/ajv/master/lib/refs/data.json#"};function pt(D){return{anyOf:[D,He]}}})(gg);var yu={},gu={},vu={};Object.defineProperty(vu,"__esModule",{value:!0});const X$={keyword:"id",code(){throw new Error('NOT SUPPORTED: keyword "id", use "$id" for schema ID')}};vu.default=X$;var Po={};Object.defineProperty(Po,"__esModule",{value:!0});Po.callRef=Po.getValidate=void 0;const Z$=vi,Mp=Qe,pn=Je,Uo=ar,Lp=fn,Pi=at,eO={keyword:"$ref",schemaType:"string",code(e){const{gen:t,schema:n,it:r}=e,{baseId:o,schemaEnv:i,validateName:s,opts:l,self:u}=r,{root:c}=i;if((n==="#"||n==="#/")&&o===c.baseId)return a();const p=Lp.resolveRef.call(u,c,o,n);if(p===void 0)throw new Z$.default(r.opts.uriResolver,o,n);if(p instanceof Lp.SchemaEnv)return d(p);return h(p);function a(){if(i===c)return Ki(e,s,i,i.$async);const m=t.scopeValue("root",{ref:c});return Ki(e,(0,pn._)`${m}.validate`,c,c.$async)}function d(m){const y=Vg(e,m);Ki(e,y,m,m.$async)}function h(m){const y=t.scopeValue("schema",l.code.source===!0?{ref:m,code:(0,pn.stringify)(m)}:{ref:m}),T=t.name("valid"),g=e.subschema({schema:m,dataTypes:[],schemaPath:pn.nil,topSchemaRef:y,errSchemaPath:n},T);e.mergeEvaluated(g),e.ok(T)}}};function Vg(e,t){const{gen:n}=e;return t.validate?n.scopeValue("validate",{ref:t.validate}):(0,pn._)`${n.scopeValue("wrapper",{ref:t})}.validate`}Po.getValidate=Vg;function Ki(e,t,n,r){const{gen:o,it:i}=e,{allErrors:s,schemaEnv:l,opts:u}=i,c=u.passContext?Uo.default.this:pn.nil;r?p():a();function p(){if(!l.$async)throw new Error("async schema referenced by sync schema");const m=o.let("valid");o.try(()=>{o.code((0,pn._)`await ${(0,Mp.callValidateCode)(e,t,c)}`),h(t),s||o.assign(m,!0)},y=>{o.if((0,pn._)`!(${y} instanceof ${i.ValidationError})`,()=>o.throw(y)),d(y),s||o.assign(m,!1)}),e.ok(m)}function a(){e.result((0,Mp.callValidateCode)(e,t,c),()=>h(t),()=>d(t))}function d(m){const y=(0,pn._)`${m}.errors`;o.assign(Uo.default.vErrors,(0,pn._)`${Uo.default.vErrors} === null ? ${y} : ${Uo.default.vErrors}.concat(${y})`),o.assign(Uo.default.errors,(0,pn._)`${Uo.default.vErrors}.length`)}function h(m){var y;if(!i.opts.unevaluated)return;const T=(y=n==null?void 0:n.validate)===null||y===void 0?void 0:y.evaluated;if(i.props!==!0)if(T&&!T.dynamicProps)T.props!==void 0&&(i.props=Pi.mergeEvaluated.props(o,T.props,i.props));else{const g=o.var("props",(0,pn._)`${m}.evaluated.props`);i.props=Pi.mergeEvaluated.props(o,g,i.props,pn.Name)}if(i.items!==!0)if(T&&!T.dynamicItems)T.items!==void 0&&(i.items=Pi.mergeEvaluated.items(o,T.items,i.items));else{const g=o.var("items",(0,pn._)`${m}.evaluated.items`);i.items=Pi.mergeEvaluated.items(o,g,i.items,pn.Name)}}}Po.callRef=Ki;Po.default=eO;Object.defineProperty(gu,"__esModule",{value:!0});const tO=vu,nO=Po,rO=["$schema","$id","$defs","$vocabulary",{keyword:"$comment"},"definitions",tO.default,nO.default];gu.default=rO;var bu={},_u={};Object.defineProperty(_u,"__esModule",{value:!0});const fa=Je,Mr=fa.operators,ha={maximum:{okStr:"<=",ok:Mr.LTE,fail:Mr.GT},minimum:{okStr:">=",ok:Mr.GTE,fail:Mr.LT},exclusiveMaximum:{okStr:"<",ok:Mr.LT,fail:Mr.GTE},exclusiveMinimum:{okStr:">",ok:Mr.GT,fail:Mr.LTE}},oO={message:({keyword:e,schemaCode:t})=>(0,fa.str)`must be ${ha[e].okStr} ${t}`,params:({keyword:e,schemaCode:t})=>(0,fa._)`{comparison: ${ha[e].okStr}, limit: ${t}}`},sO={keyword:Object.keys(ha),type:"number",schemaType:"number",$data:!0,error:oO,code(e){const{keyword:t,data:n,schemaCode:r}=e;e.fail$data((0,fa._)`${n} ${ha[t].fail} ${r} || isNaN(${n})`)}};_u.default=sO;var Tu={};Object.defineProperty(Tu,"__esModule",{value:!0});const Vs=Je,iO={message:({schemaCode:e})=>(0,Vs.str)`must be multiple of ${e}`,params:({schemaCode:e})=>(0,Vs._)`{multipleOf: ${e}}`},aO={keyword:"multipleOf",type:"number",schemaType:"number",$data:!0,error:iO,code(e){const{gen:t,data:n,schemaCode:r,it:o}=e,i=o.opts.multipleOfPrecision,s=t.let("res"),l=i?(0,Vs._)`Math.abs(Math.round(${s}) - ${s}) > 1e-${i}`:(0,Vs._)`${s} !== parseInt(${s})`;e.fail$data((0,Vs._)`(${r} === 0 || (${s} = ${n}/${r}, ${l}))`)}};Tu.default=aO;var wu={},ku={};Object.defineProperty(ku,"__esModule",{value:!0});function Hg(e){const t=e.length;let n=0,r=0,o;for(;r<t;)n++,o=e.charCodeAt(r++),o>=55296&&o<=56319&&r<t&&(o=e.charCodeAt(r),(o&64512)===56320&&r++);return n}ku.default=Hg;Hg.code='require("ajv/dist/runtime/ucs2length").default';Object.defineProperty(wu,"__esModule",{value:!0});const go=Je,lO=at,cO=ku,uO={message({keyword:e,schemaCode:t}){const n=e==="maxLength"?"more":"fewer";return(0,go.str)`must NOT have ${n} than ${t} characters`},params:({schemaCode:e})=>(0,go._)`{limit: ${e}}`},dO={keyword:["maxLength","minLength"],type:"string",schemaType:"number",$data:!0,error:uO,code(e){const{keyword:t,data:n,schemaCode:r,it:o}=e,i=t==="maxLength"?go.operators.GT:go.operators.LT,s=o.opts.unicode===!1?(0,go._)`${n}.length`:(0,go._)`${(0,lO.useFunc)(e.gen,cO.default)}(${n})`;e.fail$data((0,go._)`${s} ${i} ${r}`)}};wu.default=dO;var Su={};Object.defineProperty(Su,"__esModule",{value:!0});const pO=Qe,ma=Je,fO={message:({schemaCode:e})=>(0,ma.str)`must match pattern "${e}"`,params:({schemaCode:e})=>(0,ma._)`{pattern: ${e}}`},hO={keyword:"pattern",type:"string",schemaType:"string",$data:!0,error:fO,code(e){const{data:t,$data:n,schema:r,schemaCode:o,it:i}=e,s=i.opts.unicodeRegExp?"u":"",l=n?(0,ma._)`(new RegExp(${o}, ${s}))`:(0,pO.usePattern)(e,r);e.fail$data((0,ma._)`!${l}.test(${t})`)}};Su.default=hO;var Cu={};Object.defineProperty(Cu,"__esModule",{value:!0});const Hs=Je,mO={message({keyword:e,schemaCode:t}){const n=e==="maxProperties"?"more":"fewer";return(0,Hs.str)`must NOT have ${n} than ${t} properties`},params:({schemaCode:e})=>(0,Hs._)`{limit: ${e}}`},yO={keyword:["maxProperties","minProperties"],type:"object",schemaType:"number",$data:!0,error:mO,code(e){const{keyword:t,data:n,schemaCode:r}=e,o=t==="maxProperties"?Hs.operators.GT:Hs.operators.LT;e.fail$data((0,Hs._)`Object.keys(${n}).length ${o} ${r}`)}};Cu.default=yO;var xu={};Object.defineProperty(xu,"__esModule",{value:!0});const $s=Qe,Ks=Je,gO=at,vO={message:({params:{missingProperty:e}})=>(0,Ks.str)`must have required property '${e}'`,params:({params:{missingProperty:e}})=>(0,Ks._)`{missingProperty: ${e}}`},bO={keyword:"required",type:"object",schemaType:"array",$data:!0,error:vO,code(e){const{gen:t,schema:n,schemaCode:r,data:o,$data:i,it:s}=e,{opts:l}=s;if(!i&&n.length===0)return;const u=n.length>=l.loopRequired;if(s.allErrors?c():p(),l.strictRequired){const h=e.parentSchema.properties,{definedProperties:m}=e.it;for(const y of n)if((h==null?void 0:h[y])===void 0&&!m.has(y)){const T=s.schemaEnv.baseId+s.errSchemaPath,g=`required property "${y}" is not defined at "${T}" (strictRequired)`;(0,gO.checkStrictMode)(s,g,s.opts.strictRequired)}}function c(){if(u||i)e.block$data(Ks.nil,a);else for(const h of n)(0,$s.checkReportMissingProp)(e,h)}function p(){const h=t.let("missing");if(u||i){const m=t.let("valid",!0);e.block$data(m,()=>d(h,m)),e.ok(m)}else t.if((0,$s.checkMissingProp)(e,n,h)),(0,$s.reportMissingProp)(e,h),t.else()}function a(){t.forOf("prop",r,h=>{e.setParams({missingProperty:h}),t.if((0,$s.noPropertyInData)(t,o,h,l.ownProperties),()=>e.error())})}function d(h,m){e.setParams({missingProperty:h}),t.forOf(h,r,()=>{t.assign(m,(0,$s.propertyInData)(t,o,h,l.ownProperties)),t.if((0,Ks.not)(m),()=>{e.error(),t.break()})},Ks.nil)}}};xu.default=bO;var $u={};Object.defineProperty($u,"__esModule",{value:!0});const Gs=Je,_O={message({keyword:e,schemaCode:t}){const n=e==="maxItems"?"more":"fewer";return(0,Gs.str)`must NOT have ${n} than ${t} items`},params:({schemaCode:e})=>(0,Gs._)`{limit: ${e}}`},TO={keyword:["maxItems","minItems"],type:"array",schemaType:"number",$data:!0,error:_O,code(e){const{keyword:t,data:n,schemaCode:r}=e,o=t==="maxItems"?Gs.operators.GT:Gs.operators.LT;e.fail$data((0,Gs._)`${n}.length ${o} ${r}`)}};$u.default=TO;var Ou={},bi={};Object.defineProperty(bi,"__esModule",{value:!0});const Kg=Cg;Kg.code='require("ajv/dist/runtime/equal").default';bi.default=Kg;Object.defineProperty(Ou,"__esModule",{value:!0});const xl=yi,Vt=Je,wO=at,kO=bi,SO={message:({params:{i:e,j:t}})=>(0,Vt.str)`must NOT have duplicate items (items ## ${t} and ${e} are identical)`,params:({params:{i:e,j:t}})=>(0,Vt._)`{i: ${e}, j: ${t}}`},CO={keyword:"uniqueItems",type:"array",schemaType:"boolean",$data:!0,error:SO,code(e){const{gen:t,data:n,$data:r,schema:o,parentSchema:i,schemaCode:s,it:l}=e;if(!r&&!o)return;const u=t.let("valid"),c=i.items?(0,xl.getSchemaTypes)(i.items):[];e.block$data(u,p,(0,Vt._)`${s} === false`),e.ok(u);function p(){const m=t.let("i",(0,Vt._)`${n}.length`),y=t.let("j");e.setParams({i:m,j:y}),t.assign(u,!0),t.if((0,Vt._)`${m} > 1`,()=>(a()?d:h)(m,y))}function a(){return c.length>0&&!c.some(m=>m==="object"||m==="array")}function d(m,y){const T=t.name("item"),g=(0,xl.checkDataTypes)(c,T,l.opts.strictNumbers,xl.DataType.Wrong),C=t.const("indices",(0,Vt._)`{}`);t.for((0,Vt._)`;${m}--;`,()=>{t.let(T,(0,Vt._)`${n}[${m}]`),t.if(g,(0,Vt._)`continue`),c.length>1&&t.if((0,Vt._)`typeof ${T} == "string"`,(0,Vt._)`${T} += "_"`),t.if((0,Vt._)`typeof ${C}[${T}] == "number"`,()=>{t.assign(y,(0,Vt._)`${C}[${T}]`),e.error(),t.assign(u,!1).break()}).code((0,Vt._)`${C}[${T}] = ${m}`)})}function h(m,y){const T=(0,wO.useFunc)(t,kO.default),g=t.name("outer");t.label(g).for((0,Vt._)`;${m}--;`,()=>t.for((0,Vt._)`${y} = ${m}; ${y}--;`,()=>t.if((0,Vt._)`${T}(${n}[${m}], ${n}[${y}])`,()=>{e.error(),t.assign(u,!1).break(g)})))}}};Ou.default=CO;var Au={};Object.defineProperty(Au,"__esModule",{value:!0});const rc=Je,xO=at,$O=bi,OO={message:"must be equal to constant",params:({schemaCode:e})=>(0,rc._)`{allowedValue: ${e}}`},AO={keyword:"const",$data:!0,error:OO,code(e){const{gen:t,data:n,$data:r,schemaCode:o,schema:i}=e;r||i&&typeof i=="object"?e.fail$data((0,rc._)`!${(0,xO.useFunc)(t,$O.default)}(${n}, ${o})`):e.fail((0,rc._)`${i} !== ${n}`)}};Au.default=AO;var Iu={};Object.defineProperty(Iu,"__esModule",{value:!0});const Is=Je,IO=at,PO=bi,jO={message:"must be equal to one of the allowed values",params:({schemaCode:e})=>(0,Is._)`{allowedValues: ${e}}`},EO={keyword:"enum",schemaType:"array",$data:!0,error:jO,code(e){const{gen:t,data:n,$data:r,schema:o,schemaCode:i,it:s}=e;if(!r&&o.length===0)throw new Error("enum must have non-empty array");const l=o.length>=s.opts.loopEnum;let u;const c=()=>u??(u=(0,IO.useFunc)(t,PO.default));let p;if(l||r)p=t.let("valid"),e.block$data(p,a);else{if(!Array.isArray(o))throw new Error("ajv implementation error");const h=t.const("vSchema",i);p=(0,Is.or)(...o.map((m,y)=>d(h,y)))}e.pass(p);function a(){t.assign(p,!1),t.forOf("v",i,h=>t.if((0,Is._)`${c()}(${n}, ${h})`,()=>t.assign(p,!0).break()))}function d(h,m){const y=o[m];return typeof y=="object"&&y!==null?(0,Is._)`${c()}(${n}, ${h}[${m}])`:(0,Is._)`${n} === ${y}`}}};Iu.default=EO;Object.defineProperty(bu,"__esModule",{value:!0});const NO=_u,MO=Tu,LO=wu,DO=Su,RO=Cu,FO=xu,BO=$u,UO=Ou,qO=Au,VO=Iu,HO=[NO.default,MO.default,LO.default,DO.default,RO.default,FO.default,BO.default,UO.default,{keyword:"type",schemaType:["string","array"]},{keyword:"nullable",schemaType:"boolean"},qO.default,VO.default];bu.default=HO;var Pu={},gs={};Object.defineProperty(gs,"__esModule",{value:!0});gs.validateAdditionalItems=void 0;const vo=Je,oc=at,KO={message:({params:{len:e}})=>(0,vo.str)`must NOT have more than ${e} items`,params:({params:{len:e}})=>(0,vo._)`{limit: ${e}}`},GO={keyword:"additionalItems",type:"array",schemaType:["boolean","object"],before:"uniqueItems",error:KO,code(e){const{parentSchema:t,it:n}=e,{items:r}=t;if(!Array.isArray(r)){(0,oc.checkStrictMode)(n,'"additionalItems" is ignored when "items" is not an array of schemas');return}Gg(e,r)}};function Gg(e,t){const{gen:n,schema:r,data:o,keyword:i,it:s}=e;s.items=!0;const l=n.const("len",(0,vo._)`${o}.length`);if(r===!1)e.setParams({len:t.length}),e.pass((0,vo._)`${l} <= ${t.length}`);else if(typeof r=="object"&&!(0,oc.alwaysValidSchema)(s,r)){const c=n.var("valid",(0,vo._)`${l} <= ${t.length}`);n.if((0,vo.not)(c),()=>u(c)),e.ok(c)}function u(c){n.forRange("i",t.length,l,p=>{e.subschema({keyword:i,dataProp:p,dataPropType:oc.Type.Num},c),s.allErrors||n.if((0,vo.not)(c),()=>n.break())})}}gs.validateAdditionalItems=Gg;gs.default=GO;var ju={},vs={};Object.defineProperty(vs,"__esModule",{value:!0});vs.validateTuple=void 0;const Dp=Je,Gi=at,WO=Qe,zO={keyword:"items",type:"array",schemaType:["object","array","boolean"],before:"uniqueItems",code(e){const{schema:t,it:n}=e;if(Array.isArray(t))return Wg(e,"additionalItems",t);n.items=!0,!(0,Gi.alwaysValidSchema)(n,t)&&e.ok((0,WO.validateArray)(e))}};function Wg(e,t,n=e.schema){const{gen:r,parentSchema:o,data:i,keyword:s,it:l}=e;p(o),l.opts.unevaluated&&n.length&&l.items!==!0&&(l.items=Gi.mergeEvaluated.items(r,n.length,l.items));const u=r.name("valid"),c=r.const("len",(0,Dp._)`${i}.length`);n.forEach((a,d)=>{(0,Gi.alwaysValidSchema)(l,a)||(r.if((0,Dp._)`${c} > ${d}`,()=>e.subschema({keyword:s,schemaProp:d,dataProp:d},u)),e.ok(u))});function p(a){const{opts:d,errSchemaPath:h}=l,m=n.length,y=m===a.minItems&&(m===a.maxItems||a[t]===!1);if(d.strictTuples&&!y){const T=`"${s}" is ${m}-tuple, but minItems or maxItems/${t} are not specified or different at path "${h}"`;(0,Gi.checkStrictMode)(l,T,d.strictTuples)}}}vs.validateTuple=Wg;vs.default=zO;Object.defineProperty(ju,"__esModule",{value:!0});const QO=vs,JO={keyword:"prefixItems",type:"array",schemaType:["array"],before:"uniqueItems",code:e=>(0,QO.validateTuple)(e,"items")};ju.default=JO;var Eu={};Object.defineProperty(Eu,"__esModule",{value:!0});const Rp=Je,YO=at,XO=Qe,ZO=gs,eA={message:({params:{len:e}})=>(0,Rp.str)`must NOT have more than ${e} items`,params:({params:{len:e}})=>(0,Rp._)`{limit: ${e}}`},tA={keyword:"items",type:"array",schemaType:["object","boolean"],before:"uniqueItems",error:eA,code(e){const{schema:t,parentSchema:n,it:r}=e,{prefixItems:o}=n;r.items=!0,!(0,YO.alwaysValidSchema)(r,t)&&(o?(0,ZO.validateAdditionalItems)(e,o):e.ok((0,XO.validateArray)(e)))}};Eu.default=tA;var Nu={};Object.defineProperty(Nu,"__esModule",{value:!0});const kn=Je,ji=at,nA={message:({params:{min:e,max:t}})=>t===void 0?(0,kn.str)`must contain at least ${e} valid item(s)`:(0,kn.str)`must contain at least ${e} and no more than ${t} valid item(s)`,params:({params:{min:e,max:t}})=>t===void 0?(0,kn._)`{minContains: ${e}}`:(0,kn._)`{minContains: ${e}, maxContains: ${t}}`},rA={keyword:"contains",type:"array",schemaType:["object","boolean"],before:"uniqueItems",trackErrors:!0,error:nA,code(e){const{gen:t,schema:n,parentSchema:r,data:o,it:i}=e;let s,l;const{minContains:u,maxContains:c}=r;i.opts.next?(s=u===void 0?1:u,l=c):s=1;const p=t.const("len",(0,kn._)`${o}.length`);if(e.setParams({min:s,max:l}),l===void 0&&s===0){(0,ji.checkStrictMode)(i,'"minContains" == 0 without "maxContains": "contains" keyword ignored');return}if(l!==void 0&&s>l){(0,ji.checkStrictMode)(i,'"minContains" > "maxContains" is always invalid'),e.fail();return}if((0,ji.alwaysValidSchema)(i,n)){let y=(0,kn._)`${p} >= ${s}`;l!==void 0&&(y=(0,kn._)`${y} && ${p} <= ${l}`),e.pass(y);return}i.items=!0;const a=t.name("valid");l===void 0&&s===1?h(a,()=>t.if(a,()=>t.break())):s===0?(t.let(a,!0),l!==void 0&&t.if((0,kn._)`${o}.length > 0`,d)):(t.let(a,!1),d()),e.result(a,()=>e.reset());function d(){const y=t.name("_valid"),T=t.let("count",0);h(y,()=>t.if(y,()=>m(T)))}function h(y,T){t.forRange("i",0,p,g=>{e.subschema({keyword:"contains",dataProp:g,dataPropType:ji.Type.Num,compositeRule:!0},y),T()})}function m(y){t.code((0,kn._)`${y}++`),l===void 0?t.if((0,kn._)`${y} >= ${s}`,()=>t.assign(a,!0).break()):(t.if((0,kn._)`${y} > ${l}`,()=>t.assign(a,!1).break()),s===1?t.assign(a,!0):t.if((0,kn._)`${y} >= ${s}`,()=>t.assign(a,!0)))}}};Nu.default=rA;var zg={};(function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.validateSchemaDeps=e.validatePropertyDeps=e.error=void 0;const t=Je,n=at,r=Qe;e.error={message:({params:{property:u,depsCount:c,deps:p}})=>{const a=c===1?"property":"properties";return(0,t.str)`must have ${a} ${p} when property ${u} is present`},params:({params:{property:u,depsCount:c,deps:p,missingProperty:a}})=>(0,t._)`{property: ${u},
    missingProperty: ${a},
    depsCount: ${c},
    deps: ${p}}`};const o={keyword:"dependencies",type:"object",schemaType:"object",error:e.error,code(u){const[c,p]=i(u);s(u,c),l(u,p)}};function i({schema:u}){const c={},p={};for(const a in u){if(a==="__proto__")continue;const d=Array.isArray(u[a])?c:p;d[a]=u[a]}return[c,p]}function s(u,c=u.schema){const{gen:p,data:a,it:d}=u;if(Object.keys(c).length===0)return;const h=p.let("missing");for(const m in c){const y=c[m];if(y.length===0)continue;const T=(0,r.propertyInData)(p,a,m,d.opts.ownProperties);u.setParams({property:m,depsCount:y.length,deps:y.join(", ")}),d.allErrors?p.if(T,()=>{for(const g of y)(0,r.checkReportMissingProp)(u,g)}):(p.if((0,t._)`${T} && (${(0,r.checkMissingProp)(u,y,h)})`),(0,r.reportMissingProp)(u,h),p.else())}}e.validatePropertyDeps=s;function l(u,c=u.schema){const{gen:p,data:a,keyword:d,it:h}=u,m=p.name("valid");for(const y in c)(0,n.alwaysValidSchema)(h,c[y])||(p.if((0,r.propertyInData)(p,a,y,h.opts.ownProperties),()=>{const T=u.subschema({keyword:d,schemaProp:y},m);u.mergeValidEvaluated(T,m)},()=>p.var(m,!0)),u.ok(m))}e.validateSchemaDeps=l,e.default=o})(zg);var Mu={};Object.defineProperty(Mu,"__esModule",{value:!0});const Qg=Je,oA=at,sA={message:"property name must be valid",params:({params:e})=>(0,Qg._)`{propertyName: ${e.propertyName}}`},iA={keyword:"propertyNames",type:"object",schemaType:["object","boolean"],error:sA,code(e){const{gen:t,schema:n,data:r,it:o}=e;if((0,oA.alwaysValidSchema)(o,n))return;const i=t.name("valid");t.forIn("key",r,s=>{e.setParams({propertyName:s}),e.subschema({keyword:"propertyNames",data:s,dataTypes:["string"],propertyName:s,compositeRule:!0},i),t.if((0,Qg.not)(i),()=>{e.error(!0),o.allErrors||t.break()})}),e.ok(i)}};Mu.default=iA;var Ya={};Object.defineProperty(Ya,"__esModule",{value:!0});const Ei=Qe,Nn=Je,aA=ar,Ni=at,lA={message:"must NOT have additional properties",params:({params:e})=>(0,Nn._)`{additionalProperty: ${e.additionalProperty}}`},cA={keyword:"additionalProperties",type:["object"],schemaType:["boolean","object"],allowUndefined:!0,trackErrors:!0,error:lA,code(e){const{gen:t,schema:n,parentSchema:r,data:o,errsCount:i,it:s}=e;if(!i)throw new Error("ajv implementation error");const{allErrors:l,opts:u}=s;if(s.props=!0,u.removeAdditional!=="all"&&(0,Ni.alwaysValidSchema)(s,n))return;const c=(0,Ei.allSchemaProperties)(r.properties),p=(0,Ei.allSchemaProperties)(r.patternProperties);a(),e.ok((0,Nn._)`${i} === ${aA.default.errors}`);function a(){t.forIn("key",o,T=>{!c.length&&!p.length?m(T):t.if(d(T),()=>m(T))})}function d(T){let g;if(c.length>8){const C=(0,Ni.schemaRefOrVal)(s,r.properties,"properties");g=(0,Ei.isOwnProperty)(t,C,T)}else c.length?g=(0,Nn.or)(...c.map(C=>(0,Nn._)`${T} === ${C}`)):g=Nn.nil;return p.length&&(g=(0,Nn.or)(g,...p.map(C=>(0,Nn._)`${(0,Ei.usePattern)(e,C)}.test(${T})`))),(0,Nn.not)(g)}function h(T){t.code((0,Nn._)`delete ${o}[${T}]`)}function m(T){if(u.removeAdditional==="all"||u.removeAdditional&&n===!1){h(T);return}if(n===!1){e.setParams({additionalProperty:T}),e.error(),l||t.break();return}if(typeof n=="object"&&!(0,Ni.alwaysValidSchema)(s,n)){const g=t.name("valid");u.removeAdditional==="failing"?(y(T,g,!1),t.if((0,Nn.not)(g),()=>{e.reset(),h(T)})):(y(T,g),l||t.if((0,Nn.not)(g),()=>t.break()))}}function y(T,g,C){const N={keyword:"additionalProperties",dataProp:T,dataPropType:Ni.Type.Str};C===!1&&Object.assign(N,{compositeRule:!0,createErrors:!1,allErrors:!1}),e.subschema(N,g)}}};Ya.default=cA;var Lu={};Object.defineProperty(Lu,"__esModule",{value:!0});const uA=Fn,Fp=Qe,$l=at,Bp=Ya,dA={keyword:"properties",type:"object",schemaType:"object",code(e){const{gen:t,schema:n,parentSchema:r,data:o,it:i}=e;i.opts.removeAdditional==="all"&&r.additionalProperties===void 0&&Bp.default.code(new uA.KeywordCxt(i,Bp.default,"additionalProperties"));const s=(0,Fp.allSchemaProperties)(n);for(const a of s)i.definedProperties.add(a);i.opts.unevaluated&&s.length&&i.props!==!0&&(i.props=$l.mergeEvaluated.props(t,(0,$l.toHash)(s),i.props));const l=s.filter(a=>!(0,$l.alwaysValidSchema)(i,n[a]));if(l.length===0)return;const u=t.name("valid");for(const a of l)c(a)?p(a):(t.if((0,Fp.propertyInData)(t,o,a,i.opts.ownProperties)),p(a),i.allErrors||t.else().var(u,!0),t.endIf()),e.it.definedProperties.add(a),e.ok(u);function c(a){return i.opts.useDefaults&&!i.compositeRule&&n[a].default!==void 0}function p(a){e.subschema({keyword:"properties",schemaProp:a,dataProp:a},u)}}};Lu.default=dA;var Du={};Object.defineProperty(Du,"__esModule",{value:!0});const Up=Qe,Mi=Je,qp=at,Vp=at,pA={keyword:"patternProperties",type:"object",schemaType:"object",code(e){const{gen:t,schema:n,data:r,parentSchema:o,it:i}=e,{opts:s}=i,l=(0,Up.allSchemaProperties)(n),u=l.filter(y=>(0,qp.alwaysValidSchema)(i,n[y]));if(l.length===0||u.length===l.length&&(!i.opts.unevaluated||i.props===!0))return;const c=s.strictSchema&&!s.allowMatchingProperties&&o.properties,p=t.name("valid");i.props!==!0&&!(i.props instanceof Mi.Name)&&(i.props=(0,Vp.evaluatedPropsToName)(t,i.props));const{props:a}=i;d();function d(){for(const y of l)c&&h(y),i.allErrors?m(y):(t.var(p,!0),m(y),t.if(p))}function h(y){for(const T in c)new RegExp(y).test(T)&&(0,qp.checkStrictMode)(i,`property ${T} matches pattern ${y} (use allowMatchingProperties)`)}function m(y){t.forIn("key",r,T=>{t.if((0,Mi._)`${(0,Up.usePattern)(e,y)}.test(${T})`,()=>{const g=u.includes(y);g||e.subschema({keyword:"patternProperties",schemaProp:y,dataProp:T,dataPropType:Vp.Type.Str},p),i.opts.unevaluated&&a!==!0?t.assign((0,Mi._)`${a}[${T}]`,!0):!g&&!i.allErrors&&t.if((0,Mi.not)(p),()=>t.break())})})}}};Du.default=pA;var Ru={};Object.defineProperty(Ru,"__esModule",{value:!0});const fA=at,hA={keyword:"not",schemaType:["object","boolean"],trackErrors:!0,code(e){const{gen:t,schema:n,it:r}=e;if((0,fA.alwaysValidSchema)(r,n)){e.fail();return}const o=t.name("valid");e.subschema({keyword:"not",compositeRule:!0,createErrors:!1,allErrors:!1},o),e.failResult(o,()=>e.reset(),()=>e.error())},error:{message:"must NOT be valid"}};Ru.default=hA;var Fu={};Object.defineProperty(Fu,"__esModule",{value:!0});const mA=Qe,yA={keyword:"anyOf",schemaType:"array",trackErrors:!0,code:mA.validateUnion,error:{message:"must match a schema in anyOf"}};Fu.default=yA;var Bu={};Object.defineProperty(Bu,"__esModule",{value:!0});const Wi=Je,gA=at,vA={message:"must match exactly one schema in oneOf",params:({params:e})=>(0,Wi._)`{passingSchemas: ${e.passing}}`},bA={keyword:"oneOf",schemaType:"array",trackErrors:!0,error:vA,code(e){const{gen:t,schema:n,parentSchema:r,it:o}=e;if(!Array.isArray(n))throw new Error("ajv implementation error");if(o.opts.discriminator&&r.discriminator)return;const i=n,s=t.let("valid",!1),l=t.let("passing",null),u=t.name("_valid");e.setParams({passing:l}),t.block(c),e.result(s,()=>e.reset(),()=>e.error(!0));function c(){i.forEach((p,a)=>{let d;(0,gA.alwaysValidSchema)(o,p)?t.var(u,!0):d=e.subschema({keyword:"oneOf",schemaProp:a,compositeRule:!0},u),a>0&&t.if((0,Wi._)`${u} && ${s}`).assign(s,!1).assign(l,(0,Wi._)`[${l}, ${a}]`).else(),t.if(u,()=>{t.assign(s,!0),t.assign(l,a),d&&e.mergeEvaluated(d,Wi.Name)})})}}};Bu.default=bA;var Uu={};Object.defineProperty(Uu,"__esModule",{value:!0});const _A=at,TA={keyword:"allOf",schemaType:"array",code(e){const{gen:t,schema:n,it:r}=e;if(!Array.isArray(n))throw new Error("ajv implementation error");const o=t.name("valid");n.forEach((i,s)=>{if((0,_A.alwaysValidSchema)(r,i))return;const l=e.subschema({keyword:"allOf",schemaProp:s},o);e.ok(o),e.mergeEvaluated(l)})}};Uu.default=TA;var qu={};Object.defineProperty(qu,"__esModule",{value:!0});const ya=Je,Jg=at,wA={message:({params:e})=>(0,ya.str)`must match "${e.ifClause}" schema`,params:({params:e})=>(0,ya._)`{failingKeyword: ${e.ifClause}}`},kA={keyword:"if",schemaType:["object","boolean"],trackErrors:!0,error:wA,code(e){const{gen:t,parentSchema:n,it:r}=e;n.then===void 0&&n.else===void 0&&(0,Jg.checkStrictMode)(r,'"if" without "then" and "else" is ignored');const o=Hp(r,"then"),i=Hp(r,"else");if(!o&&!i)return;const s=t.let("valid",!0),l=t.name("_valid");if(u(),e.reset(),o&&i){const p=t.let("ifClause");e.setParams({ifClause:p}),t.if(l,c("then",p),c("else",p))}else o?t.if(l,c("then")):t.if((0,ya.not)(l),c("else"));e.pass(s,()=>e.error(!0));function u(){const p=e.subschema({keyword:"if",compositeRule:!0,createErrors:!1,allErrors:!1},l);e.mergeEvaluated(p)}function c(p,a){return()=>{const d=e.subschema({keyword:p},l);t.assign(s,l),e.mergeValidEvaluated(d,s),a?t.assign(a,(0,ya._)`${p}`):e.setParams({ifClause:p})}}}};function Hp(e,t){const n=e.schema[t];return n!==void 0&&!(0,Jg.alwaysValidSchema)(e,n)}qu.default=kA;var Vu={};Object.defineProperty(Vu,"__esModule",{value:!0});const SA=at,CA={keyword:["then","else"],schemaType:["object","boolean"],code({keyword:e,parentSchema:t,it:n}){t.if===void 0&&(0,SA.checkStrictMode)(n,`"${e}" without "if" is ignored`)}};Vu.default=CA;Object.defineProperty(Pu,"__esModule",{value:!0});const xA=gs,$A=ju,OA=vs,AA=Eu,IA=Nu,PA=zg,jA=Mu,EA=Ya,NA=Lu,MA=Du,LA=Ru,DA=Fu,RA=Bu,FA=Uu,BA=qu,UA=Vu;function qA(e=!1){const t=[LA.default,DA.default,RA.default,FA.default,BA.default,UA.default,jA.default,EA.default,PA.default,NA.default,MA.default];return e?t.push($A.default,AA.default):t.push(xA.default,OA.default),t.push(IA.default),t}Pu.default=qA;var Hu={},Ku={};Object.defineProperty(Ku,"__esModule",{value:!0});const jt=Je,VA={message:({schemaCode:e})=>(0,jt.str)`must match format "${e}"`,params:({schemaCode:e})=>(0,jt._)`{format: ${e}}`},HA={keyword:"format",type:["number","string"],schemaType:"string",$data:!0,error:VA,code(e,t){const{gen:n,data:r,$data:o,schema:i,schemaCode:s,it:l}=e,{opts:u,errSchemaPath:c,schemaEnv:p,self:a}=l;if(!u.validateFormats)return;o?d():h();function d(){const m=n.scopeValue("formats",{ref:a.formats,code:u.code.formats}),y=n.const("fDef",(0,jt._)`${m}[${s}]`),T=n.let("fType"),g=n.let("format");n.if((0,jt._)`typeof ${y} == "object" && !(${y} instanceof RegExp)`,()=>n.assign(T,(0,jt._)`${y}.type || "string"`).assign(g,(0,jt._)`${y}.validate`),()=>n.assign(T,(0,jt._)`"string"`).assign(g,y)),e.fail$data((0,jt.or)(C(),N()));function C(){return u.strictSchema===!1?jt.nil:(0,jt._)`${s} && !${g}`}function N(){const L=p.$async?(0,jt._)`(${y}.async ? await ${g}(${r}) : ${g}(${r}))`:(0,jt._)`${g}(${r})`,B=(0,jt._)`(typeof ${g} == "function" ? ${L} : ${g}.test(${r}))`;return(0,jt._)`${g} && ${g} !== true && ${T} === ${t} && !${B}`}}function h(){const m=a.formats[i];if(!m){C();return}if(m===!0)return;const[y,T,g]=N(m);y===t&&e.pass(L());function C(){if(u.strictSchema===!1){a.logger.warn(B());return}throw new Error(B());function B(){return`unknown format "${i}" ignored in schema at path "${c}"`}}function N(B){const M=B instanceof RegExp?(0,jt.regexpCode)(B):u.code.formats?(0,jt._)`${u.code.formats}${(0,jt.getProperty)(i)}`:void 0,E=n.scopeValue("formats",{key:i,ref:B,code:M});return typeof B=="object"&&!(B instanceof RegExp)?[B.type||"string",B.validate,(0,jt._)`${E}.validate`]:["string",B,E]}function L(){if(typeof m=="object"&&!(m instanceof RegExp)&&m.async){if(!p.$async)throw new Error("async format in sync schema");return(0,jt._)`await ${g}(${r})`}return typeof T=="function"?(0,jt._)`${g}(${r})`:(0,jt._)`${g}.test(${r})`}}}};Ku.default=HA;Object.defineProperty(Hu,"__esModule",{value:!0});const KA=Ku,GA=[KA.default];Hu.default=GA;var ps={};Object.defineProperty(ps,"__esModule",{value:!0});ps.contentVocabulary=ps.metadataVocabulary=void 0;ps.metadataVocabulary=["title","description","default","deprecated","readOnly","writeOnly","examples"];ps.contentVocabulary=["contentMediaType","contentEncoding","contentSchema"];Object.defineProperty(yu,"__esModule",{value:!0});const WA=gu,zA=bu,QA=Pu,JA=Hu,Kp=ps,YA=[WA.default,zA.default,(0,QA.default)(),JA.default,Kp.metadataVocabulary,Kp.contentVocabulary];yu.default=YA;var Gu={},Yg={};(function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.DiscrError=void 0,function(t){t.Tag="tag",t.Mapping="mapping"}(e.DiscrError||(e.DiscrError={}))})(Yg);Object.defineProperty(Gu,"__esModule",{value:!0});const Ho=Je,sc=Yg,Gp=fn,XA=at,ZA={message:({params:{discrError:e,tagName:t}})=>e===sc.DiscrError.Tag?`tag "${t}" must be string`:`value of tag "${t}" must be in oneOf`,params:({params:{discrError:e,tag:t,tagName:n}})=>(0,Ho._)`{error: ${e}, tag: ${n}, tagValue: ${t}}`},eI={keyword:"discriminator",type:"object",schemaType:"object",error:ZA,code(e){const{gen:t,data:n,schema:r,parentSchema:o,it:i}=e,{oneOf:s}=o;if(!i.opts.discriminator)throw new Error("discriminator: requires discriminator option");const l=r.propertyName;if(typeof l!="string")throw new Error("discriminator: requires propertyName");if(r.mapping)throw new Error("discriminator: mapping is not supported");if(!s)throw new Error("discriminator: requires oneOf keyword");const u=t.let("valid",!1),c=t.const("tag",(0,Ho._)`${n}${(0,Ho.getProperty)(l)}`);t.if((0,Ho._)`typeof ${c} == "string"`,()=>p(),()=>e.error(!1,{discrError:sc.DiscrError.Tag,tag:c,tagName:l})),e.ok(u);function p(){const h=d();t.if(!1);for(const m in h)t.elseIf((0,Ho._)`${c} === ${m}`),t.assign(u,a(h[m]));t.else(),e.error(!1,{discrError:sc.DiscrError.Mapping,tag:c,tagName:l}),t.endIf()}function a(h){const m=t.name("valid"),y=e.subschema({keyword:"oneOf",schemaProp:h},m);return e.mergeEvaluated(y,Ho.Name),m}function d(){var h;const m={},y=g(o);let T=!0;for(let L=0;L<s.length;L++){let B=s[L];B!=null&&B.$ref&&!(0,XA.schemaHasRulesButRef)(B,i.self.RULES)&&(B=Gp.resolveRef.call(i.self,i.schemaEnv.root,i.baseId,B==null?void 0:B.$ref),B instanceof Gp.SchemaEnv&&(B=B.schema));const M=(h=B==null?void 0:B.properties)===null||h===void 0?void 0:h[l];if(typeof M!="object")throw new Error(`discriminator: oneOf subschemas (or referenced schemas) must have "properties/${l}"`);T=T&&(y||g(B)),C(M,L)}if(!T)throw new Error(`discriminator: "${l}" must be required`);return m;function g({required:L}){return Array.isArray(L)&&L.includes(l)}function C(L,B){if(L.const)N(L.const,B);else if(L.enum)for(const M of L.enum)N(M,B);else throw new Error(`discriminator: "properties/${l}" must have "const" or "enum"`)}function N(L,B){if(typeof L!="string"||L in m)throw new Error(`discriminator: "${l}" values must be unique strings`);m[L]=B}}}};Gu.default=eI;const tI="http://json-schema.org/draft-07/schema#",nI="http://json-schema.org/draft-07/schema#",rI="Core schema meta-schema",oI={schemaArray:{type:"array",minItems:1,items:{$ref:"#"}},nonNegativeInteger:{type:"integer",minimum:0},nonNegativeIntegerDefault0:{allOf:[{$ref:"#/definitions/nonNegativeInteger"},{default:0}]},simpleTypes:{enum:["array","boolean","integer","null","number","object","string"]},stringArray:{type:"array",items:{type:"string"},uniqueItems:!0,default:[]}},sI=["object","boolean"],iI={$id:{type:"string",format:"uri-reference"},$schema:{type:"string",format:"uri"},$ref:{type:"string",format:"uri-reference"},$comment:{type:"string"},title:{type:"string"},description:{type:"string"},default:!0,readOnly:{type:"boolean",default:!1},examples:{type:"array",items:!0},multipleOf:{type:"number",exclusiveMinimum:0},maximum:{type:"number"},exclusiveMaximum:{type:"number"},minimum:{type:"number"},exclusiveMinimum:{type:"number"},maxLength:{$ref:"#/definitions/nonNegativeInteger"},minLength:{$ref:"#/definitions/nonNegativeIntegerDefault0"},pattern:{type:"string",format:"regex"},additionalItems:{$ref:"#"},items:{anyOf:[{$ref:"#"},{$ref:"#/definitions/schemaArray"}],default:!0},maxItems:{$ref:"#/definitions/nonNegativeInteger"},minItems:{$ref:"#/definitions/nonNegativeIntegerDefault0"},uniqueItems:{type:"boolean",default:!1},contains:{$ref:"#"},maxProperties:{$ref:"#/definitions/nonNegativeInteger"},minProperties:{$ref:"#/definitions/nonNegativeIntegerDefault0"},required:{$ref:"#/definitions/stringArray"},additionalProperties:{$ref:"#"},definitions:{type:"object",additionalProperties:{$ref:"#"},default:{}},properties:{type:"object",additionalProperties:{$ref:"#"},default:{}},patternProperties:{type:"object",additionalProperties:{$ref:"#"},propertyNames:{format:"regex"},default:{}},dependencies:{type:"object",additionalProperties:{anyOf:[{$ref:"#"},{$ref:"#/definitions/stringArray"}]}},propertyNames:{$ref:"#"},const:!0,enum:{type:"array",items:!0,minItems:1,uniqueItems:!0},type:{anyOf:[{$ref:"#/definitions/simpleTypes"},{type:"array",items:{$ref:"#/definitions/simpleTypes"},minItems:1,uniqueItems:!0}]},format:{type:"string"},contentMediaType:{type:"string"},contentEncoding:{type:"string"},if:{$ref:"#"},then:{$ref:"#"},else:{$ref:"#"},allOf:{$ref:"#/definitions/schemaArray"},anyOf:{$ref:"#/definitions/schemaArray"},oneOf:{$ref:"#/definitions/schemaArray"},not:{$ref:"#"}},aI={$schema:tI,$id:nI,title:rI,definitions:oI,type:sI,properties:iI,default:!0};(function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.MissingRefError=t.ValidationError=t.CodeGen=t.Name=t.nil=t.stringify=t.str=t._=t.KeywordCxt=void 0;const n=gg,r=yu,o=Gu,i=aI,s=["/properties"],l="http://json-schema.org/draft-07/schema";class u extends n.default{_addVocabularies(){super._addVocabularies(),r.default.forEach(m=>this.addVocabulary(m)),this.opts.discriminator&&this.addKeyword(o.default)}_addDefaultMetaSchema(){if(super._addDefaultMetaSchema(),!this.opts.meta)return;const m=this.opts.$data?this.$dataMetaSchema(i,s):i;this.addMetaSchema(m,l,!1),this.refs["http://json-schema.org/schema"]=l}defaultMeta(){return this.opts.defaultMeta=super.defaultMeta()||(this.getSchema(l)?l:void 0)}}e.exports=t=u,Object.defineProperty(t,"__esModule",{value:!0}),t.default=u;var c=Fn;Object.defineProperty(t,"KeywordCxt",{enumerable:!0,get:function(){return c.KeywordCxt}});var p=Je;Object.defineProperty(t,"_",{enumerable:!0,get:function(){return p._}}),Object.defineProperty(t,"str",{enumerable:!0,get:function(){return p.str}}),Object.defineProperty(t,"stringify",{enumerable:!0,get:function(){return p.stringify}}),Object.defineProperty(t,"nil",{enumerable:!0,get:function(){return p.nil}}),Object.defineProperty(t,"Name",{enumerable:!0,get:function(){return p.Name}}),Object.defineProperty(t,"CodeGen",{enumerable:!0,get:function(){return p.CodeGen}});var a=gi;Object.defineProperty(t,"ValidationError",{enumerable:!0,get:function(){return a.default}});var d=vi;Object.defineProperty(t,"MissingRefError",{enumerable:!0,get:function(){return d.default}})})(Zl,Zl.exports);var lI=Zl.exports;const cI=Ch(lI);function uI(e,t){for(const n in t.screens){const r=t.screens[n];if(r.buttons)for(const[o,i]of r.buttons.entries())typeof i=="object"&&(e.buttons.buttons[i.id]=i,r.buttons[o]=i.id)}return t}function dI(e,t){if(t.transitions)for(const n in t.transitions)Vi[n]?Object.assign(Vi[n],t.transitions[n]):Vi[n]=t.transitions[n];return t}function pI(e,t,n){switch(e){case"screens":return uI(t,n);case"common":return dI(t,n);default:return n}}function Xg(e,t,n){const r=e[t],o=(i,s,l)=>s;if(n){let i=Ao(r,n,{arrayMerge:o});return i=pI(t,e,i),i}}function Zg(e){return!(!e||!e.default)}function ev(e){if(Le().clearErrors(),!Zg(e))return;console.log("Received HMR update for ",e.default.id);const t=e.default;if(tv(t))un().addNotification(`Reloaded ${t.fileName}`,"You can continue playing with the changes."),Ge.addNarratScript(t);else if(Wu(t)){const n=Bt().findConfigModuleKey(t);if(n){const r=Xg(Bt().config,n,t.code);Bt().reloadConfigModule(n,r);const o=Object.values(QC()).find(i=>i.config===n);o&&o.store().updateConfig&&o.store().updateConfig(r)}console.log(`Yaml update ${t.fileName}}`)}else console.error("Unknown module type",t)}function tv(e){return typeof e=="object"&&e!==null&&typeof e.code=="string"&&typeof e.fileName=="string"&&typeof e.id=="string"&&e.type==="script"}function Wu(e){return typeof e=="object"&&e!==null&&typeof e.code=="object"&&typeof e.fileName=="string"&&typeof e.id=="string"&&e.type==="yaml"}window.narratHMRHandler=e=>{const t=window.narrat;t&&t.handleHMR(e);const n=new CustomEvent("narrat-hmr",{detail:{newModule:e}});document.body.dispatchEvent(n)};class Y{constructor(t,n,r,o){ot(this,"keyword"),ot(this,"runner"),ot(this,"argTypes"),ot(this,"parser"),ot(this,"onPlayerAnswered"),ot(this,"returnAfterPlayerAnswer"),this.keyword=t,this.runner=r,this.argTypes=n,o?this.parser=o:this.parser=_i(this.keyword,this.argTypes),this.returnAfterPlayerAnswer=!1}async run(t,n){let r=await this.runner(t,n);return this.returnAfterPlayerAnswer&&(r=await new Promise((o,i)=>{Ue().waitForPlayerAnswer(t),t.finishCommand=o})),r}async processPlayerAnswer(t,n){let r=n;return this.onPlayerAnswered&&(r=await this.onPlayerAnswered(t,n)),this.returnAfterPlayerAnswer&&t.finishCommand&&t.finishCommand(r),r}static FromOptions(t){const n=new Y(t.keyword,t.argTypes,t.runner,t.parser);return n.onPlayerAnswered=t.onPlayerAnswered,n.returnAfterPlayerAnswer=t.returnAfterPlayerAnswer??!1,n}}function _i(e,t){let n=[];if(t!=="any"){n=[];let r=!1;const o=t.reduce((i,s)=>(s.type==="rest"&&(r=!0),s.optional&&i++,i),0);o>=1?n.push(t.length-o):n.push(t.length),n.push(t.length),r&&(n[1]=1/0)}return(r,o)=>{const i={newLine:r.currentLine+1},s=o.command.args;if(t!=="any"&&(s.length<n[0]||s.length>n[1]))return console.log("Error details"),console.log(o.command),console.log(s),r.parserContext.error(r.line.line,`Command ${e}: Expected ${n.join(" to ")} arguments but got ${s.length}`),i;if(o.command.commandType=e,t!=="any"){let l=!1;o.command.args.forEach((u,c)=>{if(l)return;const p=t[c];if(p.type==="rest"){l=!0;return}!zc(u)&&!Qc(u)&&(p.type==="any"||typeof u===p.type||r.parserContext.error(r.line.line,`Command ${e}: Argument #${c+1} (${p.name}) should be a ${p.type}, but got type ${typeof u}: ${JSON.stringify(u)}`))})}return{newLine:r.currentLine+1}}}function _e(e,t){console.error("Runtime error ========================="),console.error(`Command: ${e.commandType}`),console.error("Args: ",e.args),console.error("Options: ",e.options),Te(`Runtime error at ${e.fileName}:${e.line+1} (${e.commandType}) ${e.code}. - 
  <br />
  Error: ${t}`),console.error("============================")}function fI(e,...t){console.log(`[${e.fileName}:${e.line+1}] log: `,...t)}function nv(e,t,n){const r=Y.FromOptions({keyword:e,argTypes:t,runner:async o=>await Ue().runLabelFunction(n,...o.args)});Ge.addCommand(r)}const hI=Y.FromOptions({keyword:"create_macro",argTypes:"any",runner:async e=>{e.args.length<2&&_e(e,"create_macro command needs at least a name and a label");const t=e.args[0],n=e.args[1],r=e.args.slice(2).map(o=>({name:o,type:"any"}));nv(t,r,n)}}),mI=[["items",cm,um],["achievements",Am,Im],["screens",gm,vm],["skills",Tm,wm],["skillChecks",Pm,jm],["buttons",hm,mm],["scripts",om,$T],["audio",Hh,Kh],["quests",dm,pm],["tooltips",Cm,xm],["characters",km,Sm],["choices",Nm,Mm],["animations",Dm,Rm],["macros",Fm,Bm],["preload",Um,qm],["fonts",Vm,Hm]],yI=[["common",im,Gc]],wr=new cI({allErrors:!0}),gI=["baseAssetsPath","baseDataPath","gameTitle","saveFileName","images","layout","settings","gameFlow","dialogPanel","splashScreens","notifications","hudStats","interactionTags","transitions","menuButtons","debugging","saves","input","graphics"];async function vI(e,t){for(const[n,r,o]of yI){const i=t[n];let s=Wp(o);try{if(!wr.validate(r,i))throw console.error(wr.errors),new Error(`${wr.errorsText()}`)}catch(l){console.error(l),Te(`${n} config error: ${l}`)}typeof i<"u"&&(s=Wp(i,s)),e[n]=s}}function Wp(e,t){return typeof e=="object"?Array.isArray(e)?[...e]:{...t,...e}:typeof e<"u"?e:t}async function bI(e,t){for(const n of gI){const r=t[n];r&&(typeof r=="object"&&!Array.isArray(r)?e.common[n]={...e.common[n],...r}:e.common[n]=r)}}async function _I(e){const t={...ls};lu(e)?await vI(t,e):bI(t,e);for(const n of mI){const r=n[0],o=n[1],i=n[2];let s=e[r];if(s&&typeof s=="string")try{if(s=await qa(av(t.common.baseDataPath,s)),!wr.validate(o,s))throw console.error(wr.errors),new Error(`${wr.errorsText()}`)}catch(l){console.error(l),Te(`${r} config error: ${l}`),s={...i}}s&&(Array.isArray(s)?t[r]=s:typeof s=="object"?t[r]={...i,...s}:t[r]=s)}for(const n in t)Xg(t,n,t[n]);for(const n of t.macros.macros){const r=n.options??[];nv(n.keyword,r,n.label)}return t}async function TI(e){let t;if(e.config){const r=e.config;t={};for(const o in r){const i=r[o];Wu(i)?(Bt().addConfigModule(o,{id:i.id,configKey:o,code:i.code}),t[o]=i.code):t[o]=i}}else if(e.configPath)t=await qa(e.configPath);else throw Te("No config file or config object provided"),new Error("No config file or config object provided");let n=t;return lu(t)&&(n=t.common),n.baseAssetsPath=e.baseAssetsPath??n.baseAssetsPath??"",n.baseDataPath=e.baseDataPath??n.baseDataPath??"",wr.validate(yg,t)||(Te("Config file validation failed."),console.log(wr.errors),Te(wr.errorsText())),_I(t)}function ft(){return Bt().config}function ve(){return ft().common}function _o(e){const t=ve().hudStats[e];return t||Te(`Hud stat ${e} doesn't exist`),t}function xn(){return ft().audio}function rv(e){const t=xn().files[e];if(!t){ys(`Audio file ${e} doesn't exist`);return}return t}function ga(e){const t=rv(e),n=((t==null?void 0:t.fadeInDelay)??xn().options.musicFadeInDelay)*1e3,r=((t==null?void 0:t.fadeInTime)??xn().options.musicFadeInTime)*1e3,o=((t==null?void 0:t.fadeOutTime)??xn().options.musicFadeOutTime)*1e3;return{fadeInDelay:n,fadeInTime:r,fadeOutTime:o}}function kr(){return ft().skills}function li(){return ft().skillChecks}function zu(){return ft().items}function Xa(){return ft().quests}function ic(){return ft().screens}function Qu(){return ft().buttons}function Co(){return ft().tooltips}function Ju(){return ft().characters}function ac(){return ft().choices}function ov(){return ft().animations}function zp(e){return ac().choicePrompts[e]}function lc(){return ft().fonts}function Ti(e){return e===Fa?rp:ic().screens[e]?ic().screens[e]:(Te(`Screen config for screen ${e} doesn't exist`),rp)}function va(e){return Co().tooltips.find(n=>n.keywords.includes(e))||(Te(`Tooltip config for keyword ${e} not found`),null)}function Yu(e){const t=ft().skills.skills[e];return t||Te(`Skill config for skill ${e} doesn't exist`),t}function sv(e){const t=ft().skillChecks.skillChecks[e];return t||Te(`Skill check config for skill check ${e} doesn't exist`),t}function iv(e){return!!ft().skillChecks.skillChecks[e]}function Jr(e){return e.startsWith("http")?e:Zt(e)}function Zt(e){var t,n,r,o;if(e.startsWith("http"))return e;let i=e;return ve().images[e]?i=ve().images[e]:(t=ft().preload.images)!=null&&t.assets[e]?i=(n=ft().preload.images)==null?void 0:n.assets[e]:(r=ft().preload.video)!=null&&r.assets[e]&&(i=(o=ft().preload.video)==null?void 0:o.assets[e]),ve().baseAssetsPath?`${ve().baseAssetsPath}${i}`:i}function av(e,t){return`${e}${t}`}function Xu(e){return ve().baseDataPath?`${ve().baseDataPath}${e}`:e}function xo(e){const t=Qu().buttons[e];return t||Te(`Button config for button ${e} doesn't exist`),t}function tr(e){const t=zu().items[e];return t||Te(`Item config for skill ${e} doesn't exist`),t}function ci(){return ft().achievements}function Zu(e){const t=ci().achievements[e];return t||Te(`Achievement config for achievement ${e} doesn't exist`),t}function Yr(e){return Xa().quests[e]}function lv(e,t){const n=Yr(e).endings;return n||Te(`Quest ${e} doesn't have any endings`),n[t]||Te(`Quest ${e} has no ending called ${t}`),n[t]}function ba(e,t){return Yr(e).objectives[t]}function _a(){return ve().dialogPanel.width??wT}const Gt=Ot("quests",{state:()=>({quests:{}}),actions:{getQuest(e){const t=this.quests[e];if(t)return t;{const n=`Quest ${e} doesn't exist!`;throw Te(n),new Error(n)}},getObjective(e,t){const n=this.getQuest(e);if(!n){const i=`Quest ${e} doesn't exist!`;throw Te(i),new Error(i)}const r=n.objectives[t];if(r)return r;const o=`Objective ${t} doesn't exist in quest ${e}!`;throw Te(o),new Error(o)},updateConfig(e){const t=e.quests;for(const n of Object.keys(t)){const r=t[n];this.quests[n]||(this.quests[n]={id:n,state:"hidden",objectives:{},extraData:{}});for(const o of Object.keys(r.objectives)){const i=r.objectives[o];this.quests[n].objectives[o]||(this.quests[n].objectives[o]={extraData:{},id:o,state:i.hidden?"hidden":"unlocked"})}}},reset(e){this.$reset(),this.updateConfig(e)},startQuest(e){const t=this.getQuest(e);t?(t.state="unlocked",un().addNotification(`Started quest: ${Yr(e).title}`)):Te(`Quest ${e} doesn't exist!`)},startObjective(e,t){const n=this.getObjective(e,t);n?(n.state="unlocked",un().addNotification(`New quest objective: ${ba(e,t).description}`)):Te(`Objective ${t} doesn't exist in quest ${e}!`)},completeObjective(e,t){const n=this.getObjective(e,t);n?(n.state="completed",un().addNotification(`Completed quest objective: ${ba(e,t).description}`)):Te(`Objective ${t} doesn't exist in quest ${e}!`)},completeQuest(e,t){const n=this.getQuest(e);if(n){if(n.state="completed",typeof t=="string"){n.ending=t;const r=lv(e,t);n.succeeded=r.success}else typeof t=="boolean"?n.succeeded=t:n.succeeded=!0;un().addNotification(`Completed quest: ${Yr(e).title}`)}else Te(`Quest ${e} doesn't exist!`)},isQuestCompleted(e){const t=this.getQuest(e);return t?t.state==="completed":!1},isQuestSucceeded(e){const t=this.getQuest(e);return t?t.state==="completed"&&t.succeeded:!1},isQuestFailed(e){const t=this.getQuest(e);return t?t.state==="completed"&&!t.succeeded:!1},getQuestEnding(e){const t=this.getQuest(e);return t?t.ending:!1},questHasEnding(e,t){return this.getQuestEnding(e)===t},isObjectiveCompleted(e,t){const n=this.getObjective(e,t);return n?n.state==="completed":!1},isQuestStarted(e){const t=this.getQuest(e);return t&&t.state==="unlocked"},isObjectiveStarted(e,t){return this.getObjective(e,t).state==="unlocked"},removeQuest(e){delete this.quests[e]},generateSaveData(){return{quests:ze(this.quests)}},loadSaveData(e){this.quests=ze(e.quests)}}});function ed(e,t,n,r="$"){if(!n.startsWith(r))return isNaN(Number(n))?[null,n]:[null,Number(n)];n=n.substring(r.length);const o=/\[/,i=/\]/;let s=n.search(o);n.search(i);let l=n,u=t,c=0;for(;c<n.length;){if(s>c||s===-1){const p=s>c?s:n.length;let a=n.substring(c,p);isNaN(Number(a))||(a=Number(a)),c>0&&(u=u[l]),[u,l]=kI(u,a)}if(s!==-1){c=s;const p=n.substring(s+1),a=wI(p)+s,d=n.substring(s+1,a),[h,m]=ed(e,e,d);let y=m;h&&(y=h[m]),typeof y=="number"||!isNaN(Number(y))?y=Number(y):typeof y!="string"&&console.error(`invalid array index (${y}) key type when compiling: ${n}`),u=u[l],l=y,c=a+1;const T=n.substring(c);s=T.search(o),s!==-1&&(s+=c),T.search(i)}else c=n.length}return[u,l]}function wI(e){let t=!1,n=0,r,o=1;for(;!t;){r=e.substring(n);const i=r.search(/\[/),s=r.search(/\]/);i!==-1&&i<s?(n+=i+1,o++):(n+=s+1,o--),o===0&&(t=!0),i===-1&&s===-1&&!t&&Te(`Could not find closing bracket in ${e}`)}return n}function kI(e,t){if(typeof t=="number")return[e,t];t.startsWith(".")&&(t=t.substring(1));const n=t.split(".");let r=e;const o=n.length-1;let i=n[0],s=0;for(s=0;s<o;s++)i=n[s],typeof r[i]>"u"&&(r[i]={}),r=r[i];return i=n[s],[r,i]}function Za(e,t,n="$"){return ed(e,e,t)}function SI(e,t){return Za(e,t)}function cv(e,t,n){const[r,o]=Za(e,t);r[o]=n}function uv(e,t,n){const[r,o]=Za(e,t),i=r[o]||0;r[o]=n+i}function fs(){const e=Ue(),t=Lt(),n=Vn(),r=Xt(),o=Ue().scope,i={data:e.data,global:e.globalData,skills:t.skills,skillChecks:t.skillChecks,buttons:n.buttons,items:r.items,quests:Gt().quests,stats:bn().hudStats,scope:o,config:ve(),gameOptions:Le().options,baseSettings:sr().baseSettings,customSettings:sr().customSettings};return new Proxy(i,{get:(s,l,u)=>{const c=Ue().scope,p=Ue().data;return typeof c[l]<"u"?c[l]:typeof p[l]<"u"?p[l]:Reflect.get(s,l,u)},set:(s,l,u,c)=>{const p=Ue().scope,a=Ue().data;if(typeof p[l]<"u")p[l]=u;else{if(typeof s[l]<"u")return Reflect.set(s,l,u,c);typeof u=="object"?a[l]={}:a[l]=u}return!0}})}function ze(e){if(e===null)return null;if(typeof e=="object")if(Array.isArray(e)){const t=[];for(const n in e)t[n]=ze(e[n]);return t}else{const t={};for(const n in e)t[n]=ze(e[n]);return t}else return e}function cc(e,t){if(typeof e=="object"){const n=t(e);if(n)return n;if(Array.isArray(e)){const r=[];for(const o in e)r[o]=cc(e[o],t);return r}else{const r={};for(const o in e)r[o]=cc(e[o],t);return r}}else return e}const Lt=Ot("skills",{state:()=>({skillChecks:{},skills:{}}),actions:{setupSkillCheck(e,t){this.skillChecks[t]=e},passSkillCheck(e,t){this.skillChecks[e].happened=!0,this.skillChecks[e].succeeded=!0,t&&(this.skillChecks[e].hidden=!0)},failSkillCheck(e,t){this.skillChecks[e].happened=!0,this.skillChecks[e].succeeded=!1,t&&(this.skillChecks[e].hidden=!0)},resetSkillCheck(e){this.skillChecks[e].happened=!1,this.skillChecks[e].succeeded=!1,this.skillChecks[e].hidden=!1},generateSaveData(){return{skillChecks:ze(this.skillChecks),skills:ze(this.skills)}},getSkillCheck(e){return this.skillChecks[e]||this.setupSkillCheck(this.createSkillCheckState(),e),this.skillChecks[e]},createSkillCheckState(){return{happened:!1,succeeded:!1,hidden:!1}},loadSaveData(e){this.skillChecks=Ao(this.skillChecks,e.skillChecks),this.skills=Ao(this.skills,e.skills)},updateConfig(e){const t=e.skills;for(const n in t)this.skills[n]||(this.skills[n]={id:n,level:t[n].startingLevel||0,xp:0})},reset(e){this.$reset(),this.updateConfig(e)},getSkill(e){return this.skills[e]},getSkillLevel(e){return this.getSkill(e).level},getSkillXp(e){return this.getSkill(e).xp},addXp(e,t){const n=this.getSkill(e);n||Te(`Skill ${e} doesn't exist`),n.xp+=t,n.xp>=kr().skillOptions.xpPerLevel&&(n.xp=0,n.level++,this.levelledUp(e))},setSkillLevel(e,t){const n=this.getSkill(e);n||Te(`Skill ${e} doesn't exist`),n.level=t,this.levelledUp(e)},incrementSkill(e,t){this.getSkill(e).level+=t,this.levelledUp(e)},levelledUp(e){const t=kr().skills[e].name,n=this.skills[e].level;kr().skillOptions.notifyLevelUp&&un().addNotification(`Your skill in ${t} is now level ${n}`)}}});function $r(e){return Array.isArray?Array.isArray(e):fv(e)==="[object Array]"}const CI=1/0;function xI(e){if(typeof e=="string")return e;let t=e+"";return t=="0"&&1/e==-CI?"-0":t}function $I(e){return e==null?"":xI(e)}function nr(e){return typeof e=="string"}function dv(e){return typeof e=="number"}function OI(e){return e===!0||e===!1||AI(e)&&fv(e)=="[object Boolean]"}function pv(e){return typeof e=="object"}function AI(e){return pv(e)&&e!==null}function yn(e){return e!=null}function Ol(e){return!e.trim().length}function fv(e){return e==null?e===void 0?"[object Undefined]":"[object Null]":Object.prototype.toString.call(e)}const II="Incorrect 'index' type",PI=e=>`Invalid value for key ${e}`,jI=e=>`Pattern length exceeds max of ${e}.`,EI=e=>`Missing ${e} property in key`,NI=e=>`Property 'weight' in key '${e}' must be a positive integer`,Qp=Object.prototype.hasOwnProperty;class MI{constructor(t){this._keys=[],this._keyMap={};let n=0;t.forEach(r=>{let o=hv(r);n+=o.weight,this._keys.push(o),this._keyMap[o.id]=o,n+=o.weight}),this._keys.forEach(r=>{r.weight/=n})}get(t){return this._keyMap[t]}keys(){return this._keys}toJSON(){return JSON.stringify(this._keys)}}function hv(e){let t=null,n=null,r=null,o=1,i=null;if(nr(e)||$r(e))r=e,t=Jp(e),n=uc(e);else{if(!Qp.call(e,"name"))throw new Error(EI("name"));const s=e.name;if(r=s,Qp.call(e,"weight")&&(o=e.weight,o<=0))throw new Error(NI(s));t=Jp(s),n=uc(s),i=e.getFn}return{path:t,id:n,weight:o,src:r,getFn:i}}function Jp(e){return $r(e)?e:e.split(".")}function uc(e){return $r(e)?e.join("."):e}function LI(e,t){let n=[],r=!1;const o=(i,s,l)=>{if(yn(i))if(!s[l])n.push(i);else{let u=s[l];const c=i[u];if(!yn(c))return;if(l===s.length-1&&(nr(c)||dv(c)||OI(c)))n.push($I(c));else if($r(c)){r=!0;for(let p=0,a=c.length;p<a;p+=1)o(c[p],s,l+1)}else s.length&&o(c,s,l+1)}};return o(e,nr(t)?t.split("."):t,0),r?n:n[0]}const DI={includeMatches:!1,findAllMatches:!1,minMatchCharLength:1},RI={isCaseSensitive:!1,includeScore:!1,keys:[],shouldSort:!0,sortFn:(e,t)=>e.score===t.score?e.idx<t.idx?-1:1:e.score<t.score?-1:1},FI={location:0,threshold:.6,distance:100},BI={useExtendedSearch:!1,getFn:LI,ignoreLocation:!1,ignoreFieldNorm:!1,fieldNormWeight:1};var Ke={...RI,...DI,...FI,...BI};const UI=/[^ ]+/g;function qI(e=1,t=3){const n=new Map,r=Math.pow(10,t);return{get(o){const i=o.match(UI).length;if(n.has(i))return n.get(i);const s=1/Math.pow(i,.5*e),l=parseFloat(Math.round(s*r)/r);return n.set(i,l),l},clear(){n.clear()}}}class td{constructor({getFn:t=Ke.getFn,fieldNormWeight:n=Ke.fieldNormWeight}={}){this.norm=qI(n,3),this.getFn=t,this.isCreated=!1,this.setIndexRecords()}setSources(t=[]){this.docs=t}setIndexRecords(t=[]){this.records=t}setKeys(t=[]){this.keys=t,this._keysMap={},t.forEach((n,r)=>{this._keysMap[n.id]=r})}create(){this.isCreated||!this.docs.length||(this.isCreated=!0,nr(this.docs[0])?this.docs.forEach((t,n)=>{this._addString(t,n)}):this.docs.forEach((t,n)=>{this._addObject(t,n)}),this.norm.clear())}add(t){const n=this.size();nr(t)?this._addString(t,n):this._addObject(t,n)}removeAt(t){this.records.splice(t,1);for(let n=t,r=this.size();n<r;n+=1)this.records[n].i-=1}getValueForItemAtKeyId(t,n){return t[this._keysMap[n]]}size(){return this.records.length}_addString(t,n){if(!yn(t)||Ol(t))return;let r={v:t,i:n,n:this.norm.get(t)};this.records.push(r)}_addObject(t,n){let r={i:n,$:{}};this.keys.forEach((o,i)=>{let s=o.getFn?o.getFn(t):this.getFn(t,o.path);if(yn(s)){if($r(s)){let l=[];const u=[{nestedArrIndex:-1,value:s}];for(;u.length;){const{nestedArrIndex:c,value:p}=u.pop();if(yn(p))if(nr(p)&&!Ol(p)){let a={v:p,i:c,n:this.norm.get(p)};l.push(a)}else $r(p)&&p.forEach((a,d)=>{u.push({nestedArrIndex:d,value:a})})}r.$[i]=l}else if(nr(s)&&!Ol(s)){let l={v:s,n:this.norm.get(s)};r.$[i]=l}}}),this.records.push(r)}toJSON(){return{keys:this.keys,records:this.records}}}function mv(e,t,{getFn:n=Ke.getFn,fieldNormWeight:r=Ke.fieldNormWeight}={}){const o=new td({getFn:n,fieldNormWeight:r});return o.setKeys(e.map(hv)),o.setSources(t),o.create(),o}function VI(e,{getFn:t=Ke.getFn,fieldNormWeight:n=Ke.fieldNormWeight}={}){const{keys:r,records:o}=e,i=new td({getFn:t,fieldNormWeight:n});return i.setKeys(r),i.setIndexRecords(o),i}function Li(e,{errors:t=0,currentLocation:n=0,expectedLocation:r=0,distance:o=Ke.distance,ignoreLocation:i=Ke.ignoreLocation}={}){const s=t/e.length;if(i)return s;const l=Math.abs(r-n);return o?s+l/o:l?1:s}function HI(e=[],t=Ke.minMatchCharLength){let n=[],r=-1,o=-1,i=0;for(let s=e.length;i<s;i+=1){let l=e[i];l&&r===-1?r=i:!l&&r!==-1&&(o=i-1,o-r+1>=t&&n.push([r,o]),r=-1)}return e[i-1]&&i-r>=t&&n.push([r,i-1]),n}const bo=32;function KI(e,t,n,{location:r=Ke.location,distance:o=Ke.distance,threshold:i=Ke.threshold,findAllMatches:s=Ke.findAllMatches,minMatchCharLength:l=Ke.minMatchCharLength,includeMatches:u=Ke.includeMatches,ignoreLocation:c=Ke.ignoreLocation}={}){if(t.length>bo)throw new Error(jI(bo));const p=t.length,a=e.length,d=Math.max(0,Math.min(r,a));let h=i,m=d;const y=l>1||u,T=y?Array(a):[];let g;for(;(g=e.indexOf(t,m))>-1;){let E=Li(t,{currentLocation:g,expectedLocation:d,distance:o,ignoreLocation:c});if(h=Math.min(E,h),m=g+p,y){let W=0;for(;W<p;)T[g+W]=1,W+=1}}m=-1;let C=[],N=1,L=p+a;const B=1<<p-1;for(let E=0;E<p;E+=1){let W=0,q=L;for(;W<q;)Li(t,{errors:E,currentLocation:d+q,expectedLocation:d,distance:o,ignoreLocation:c})<=h?W=q:L=q,q=Math.floor((L-W)/2+W);L=q;let ue=Math.max(1,d-q+1),ce=s?a:Math.min(d+q,a)+p,te=Array(ce+2);te[ce+1]=(1<<E)-1;for(let Q=ce;Q>=ue;Q-=1){let ae=Q-1,ke=n[e.charAt(ae)];if(y&&(T[ae]=+!!ke),te[Q]=(te[Q+1]<<1|1)&ke,E&&(te[Q]|=(C[Q+1]|C[Q])<<1|1|C[Q+1]),te[Q]&B&&(N=Li(t,{errors:E,currentLocation:ae,expectedLocation:d,distance:o,ignoreLocation:c}),N<=h)){if(h=N,m=ae,m<=d)break;ue=Math.max(1,2*d-m)}}if(Li(t,{errors:E+1,currentLocation:d,expectedLocation:d,distance:o,ignoreLocation:c})>h)break;C=te}const M={isMatch:m>=0,score:Math.max(.001,N)};if(y){const E=HI(T,l);E.length?u&&(M.indices=E):M.isMatch=!1}return M}function GI(e){let t={};for(let n=0,r=e.length;n<r;n+=1){const o=e.charAt(n);t[o]=(t[o]||0)|1<<r-n-1}return t}class yv{constructor(t,{location:n=Ke.location,threshold:r=Ke.threshold,distance:o=Ke.distance,includeMatches:i=Ke.includeMatches,findAllMatches:s=Ke.findAllMatches,minMatchCharLength:l=Ke.minMatchCharLength,isCaseSensitive:u=Ke.isCaseSensitive,ignoreLocation:c=Ke.ignoreLocation}={}){if(this.options={location:n,threshold:r,distance:o,includeMatches:i,findAllMatches:s,minMatchCharLength:l,isCaseSensitive:u,ignoreLocation:c},this.pattern=u?t:t.toLowerCase(),this.chunks=[],!this.pattern.length)return;const p=(d,h)=>{this.chunks.push({pattern:d,alphabet:GI(d),startIndex:h})},a=this.pattern.length;if(a>bo){let d=0;const h=a%bo,m=a-h;for(;d<m;)p(this.pattern.substr(d,bo),d),d+=bo;if(h){const y=a-bo;p(this.pattern.substr(y),y)}}else p(this.pattern,0)}searchIn(t){const{isCaseSensitive:n,includeMatches:r}=this.options;if(n||(t=t.toLowerCase()),this.pattern===t){let m={isMatch:!0,score:0};return r&&(m.indices=[[0,t.length-1]]),m}const{location:o,distance:i,threshold:s,findAllMatches:l,minMatchCharLength:u,ignoreLocation:c}=this.options;let p=[],a=0,d=!1;this.chunks.forEach(({pattern:m,alphabet:y,startIndex:T})=>{const{isMatch:g,score:C,indices:N}=KI(t,m,y,{location:o+T,distance:i,threshold:s,findAllMatches:l,minMatchCharLength:u,includeMatches:r,ignoreLocation:c});g&&(d=!0),a+=C,g&&N&&(p=[...p,...N])});let h={isMatch:d,score:d?a/this.chunks.length:1};return d&&r&&(h.indices=p),h}}class to{constructor(t){this.pattern=t}static isMultiMatch(t){return Yp(t,this.multiRegex)}static isSingleMatch(t){return Yp(t,this.singleRegex)}search(){}}function Yp(e,t){const n=e.match(t);return n?n[1]:null}class WI extends to{constructor(t){super(t)}static get type(){return"exact"}static get multiRegex(){return/^="(.*)"$/}static get singleRegex(){return/^=(.*)$/}search(t){const n=t===this.pattern;return{isMatch:n,score:n?0:1,indices:[0,this.pattern.length-1]}}}class zI extends to{constructor(t){super(t)}static get type(){return"inverse-exact"}static get multiRegex(){return/^!"(.*)"$/}static get singleRegex(){return/^!(.*)$/}search(t){const n=t.indexOf(this.pattern)===-1;return{isMatch:n,score:n?0:1,indices:[0,t.length-1]}}}class QI extends to{constructor(t){super(t)}static get type(){return"prefix-exact"}static get multiRegex(){return/^\^"(.*)"$/}static get singleRegex(){return/^\^(.*)$/}search(t){const n=t.startsWith(this.pattern);return{isMatch:n,score:n?0:1,indices:[0,this.pattern.length-1]}}}class JI extends to{constructor(t){super(t)}static get type(){return"inverse-prefix-exact"}static get multiRegex(){return/^!\^"(.*)"$/}static get singleRegex(){return/^!\^(.*)$/}search(t){const n=!t.startsWith(this.pattern);return{isMatch:n,score:n?0:1,indices:[0,t.length-1]}}}class YI extends to{constructor(t){super(t)}static get type(){return"suffix-exact"}static get multiRegex(){return/^"(.*)"\$$/}static get singleRegex(){return/^(.*)\$$/}search(t){const n=t.endsWith(this.pattern);return{isMatch:n,score:n?0:1,indices:[t.length-this.pattern.length,t.length-1]}}}class XI extends to{constructor(t){super(t)}static get type(){return"inverse-suffix-exact"}static get multiRegex(){return/^!"(.*)"\$$/}static get singleRegex(){return/^!(.*)\$$/}search(t){const n=!t.endsWith(this.pattern);return{isMatch:n,score:n?0:1,indices:[0,t.length-1]}}}class gv extends to{constructor(t,{location:n=Ke.location,threshold:r=Ke.threshold,distance:o=Ke.distance,includeMatches:i=Ke.includeMatches,findAllMatches:s=Ke.findAllMatches,minMatchCharLength:l=Ke.minMatchCharLength,isCaseSensitive:u=Ke.isCaseSensitive,ignoreLocation:c=Ke.ignoreLocation}={}){super(t),this._bitapSearch=new yv(t,{location:n,threshold:r,distance:o,includeMatches:i,findAllMatches:s,minMatchCharLength:l,isCaseSensitive:u,ignoreLocation:c})}static get type(){return"fuzzy"}static get multiRegex(){return/^"(.*)"$/}static get singleRegex(){return/^(.*)$/}search(t){return this._bitapSearch.searchIn(t)}}class vv extends to{constructor(t){super(t)}static get type(){return"include"}static get multiRegex(){return/^'"(.*)"$/}static get singleRegex(){return/^'(.*)$/}search(t){let n=0,r;const o=[],i=this.pattern.length;for(;(r=t.indexOf(this.pattern,n))>-1;)n=r+i,o.push([r,n-1]);const s=!!o.length;return{isMatch:s,score:s?0:1,indices:o}}}const dc=[WI,vv,QI,JI,XI,YI,zI,gv],Xp=dc.length,ZI=/ +(?=(?:[^\"]*\"[^\"]*\")*[^\"]*$)/,eP="|";function tP(e,t={}){return e.split(eP).map(n=>{let r=n.trim().split(ZI).filter(i=>i&&!!i.trim()),o=[];for(let i=0,s=r.length;i<s;i+=1){const l=r[i];let u=!1,c=-1;for(;!u&&++c<Xp;){const p=dc[c];let a=p.isMultiMatch(l);a&&(o.push(new p(a,t)),u=!0)}if(!u)for(c=-1;++c<Xp;){const p=dc[c];let a=p.isSingleMatch(l);if(a){o.push(new p(a,t));break}}}return o})}const nP=new Set([gv.type,vv.type]);class rP{constructor(t,{isCaseSensitive:n=Ke.isCaseSensitive,includeMatches:r=Ke.includeMatches,minMatchCharLength:o=Ke.minMatchCharLength,ignoreLocation:i=Ke.ignoreLocation,findAllMatches:s=Ke.findAllMatches,location:l=Ke.location,threshold:u=Ke.threshold,distance:c=Ke.distance}={}){this.query=null,this.options={isCaseSensitive:n,includeMatches:r,minMatchCharLength:o,findAllMatches:s,ignoreLocation:i,location:l,threshold:u,distance:c},this.pattern=n?t:t.toLowerCase(),this.query=tP(this.pattern,this.options)}static condition(t,n){return n.useExtendedSearch}searchIn(t){const n=this.query;if(!n)return{isMatch:!1,score:1};const{includeMatches:r,isCaseSensitive:o}=this.options;t=o?t:t.toLowerCase();let i=0,s=[],l=0;for(let u=0,c=n.length;u<c;u+=1){const p=n[u];s.length=0,i=0;for(let a=0,d=p.length;a<d;a+=1){const h=p[a],{isMatch:m,indices:y,score:T}=h.search(t);if(m){if(i+=1,l+=T,r){const g=h.constructor.type;nP.has(g)?s=[...s,...y]:s.push(y)}}else{l=0,i=0,s.length=0;break}}if(i){let a={isMatch:!0,score:l/i};return r&&(a.indices=s),a}}return{isMatch:!1,score:1}}}const pc=[];function oP(...e){pc.push(...e)}function fc(e,t){for(let n=0,r=pc.length;n<r;n+=1){let o=pc[n];if(o.condition(e,t))return new o(e,t)}return new yv(e,t)}const Ta={AND:"$and",OR:"$or"},hc={PATH:"$path",PATTERN:"$val"},mc=e=>!!(e[Ta.AND]||e[Ta.OR]),sP=e=>!!e[hc.PATH],iP=e=>!$r(e)&&pv(e)&&!mc(e),Zp=e=>({[Ta.AND]:Object.keys(e).map(t=>({[t]:e[t]}))});function bv(e,t,{auto:n=!0}={}){const r=o=>{let i=Object.keys(o);const s=sP(o);if(!s&&i.length>1&&!mc(o))return r(Zp(o));if(iP(o)){const u=s?o[hc.PATH]:i[0],c=s?o[hc.PATTERN]:o[u];if(!nr(c))throw new Error(PI(u));const p={keyId:uc(u),pattern:c};return n&&(p.searcher=fc(c,t)),p}let l={children:[],operator:i[0]};return i.forEach(u=>{const c=o[u];$r(c)&&c.forEach(p=>{l.children.push(r(p))})}),l};return mc(e)||(e=Zp(e)),r(e)}function aP(e,{ignoreFieldNorm:t=Ke.ignoreFieldNorm}){e.forEach(n=>{let r=1;n.matches.forEach(({key:o,norm:i,score:s})=>{const l=o?o.weight:null;r*=Math.pow(s===0&&l?Number.EPSILON:s,(l||1)*(t?1:i))}),n.score=r})}function lP(e,t){const n=e.matches;t.matches=[],yn(n)&&n.forEach(r=>{if(!yn(r.indices)||!r.indices.length)return;const{indices:o,value:i}=r;let s={indices:o,value:i};r.key&&(s.key=r.key.src),r.idx>-1&&(s.refIndex=r.idx),t.matches.push(s)})}function cP(e,t){t.score=e.score}function uP(e,t,{includeMatches:n=Ke.includeMatches,includeScore:r=Ke.includeScore}={}){const o=[];return n&&o.push(lP),r&&o.push(cP),e.map(i=>{const{idx:s}=i,l={item:t[s],refIndex:s};return o.length&&o.forEach(u=>{u(i,l)}),l})}class bs{constructor(t,n={},r){this.options={...Ke,...n},this.options.useExtendedSearch,this._keyStore=new MI(this.options.keys),this.setCollection(t,r)}setCollection(t,n){if(this._docs=t,n&&!(n instanceof td))throw new Error(II);this._myIndex=n||mv(this.options.keys,this._docs,{getFn:this.options.getFn,fieldNormWeight:this.options.fieldNormWeight})}add(t){yn(t)&&(this._docs.push(t),this._myIndex.add(t))}remove(t=()=>!1){const n=[];for(let r=0,o=this._docs.length;r<o;r+=1){const i=this._docs[r];t(i,r)&&(this.removeAt(r),r-=1,o-=1,n.push(i))}return n}removeAt(t){this._docs.splice(t,1),this._myIndex.removeAt(t)}getIndex(){return this._myIndex}search(t,{limit:n=-1}={}){const{includeMatches:r,includeScore:o,shouldSort:i,sortFn:s,ignoreFieldNorm:l}=this.options;let u=nr(t)?nr(this._docs[0])?this._searchStringList(t):this._searchObjectList(t):this._searchLogical(t);return aP(u,{ignoreFieldNorm:l}),i&&u.sort(s),dv(n)&&n>-1&&(u=u.slice(0,n)),uP(u,this._docs,{includeMatches:r,includeScore:o})}_searchStringList(t){const n=fc(t,this.options),{records:r}=this._myIndex,o=[];return r.forEach(({v:i,i:s,n:l})=>{if(!yn(i))return;const{isMatch:u,score:c,indices:p}=n.searchIn(i);u&&o.push({item:i,idx:s,matches:[{score:c,value:i,norm:l,indices:p}]})}),o}_searchLogical(t){const n=bv(t,this.options),r=(l,u,c)=>{if(!l.children){const{keyId:a,searcher:d}=l,h=this._findMatches({key:this._keyStore.get(a),value:this._myIndex.getValueForItemAtKeyId(u,a),searcher:d});return h&&h.length?[{idx:c,item:u,matches:h}]:[]}const p=[];for(let a=0,d=l.children.length;a<d;a+=1){const h=l.children[a],m=r(h,u,c);if(m.length)p.push(...m);else if(l.operator===Ta.AND)return[]}return p},o=this._myIndex.records,i={},s=[];return o.forEach(({$:l,i:u})=>{if(yn(l)){let c=r(n,l,u);c.length&&(i[u]||(i[u]={idx:u,item:l,matches:[]},s.push(i[u])),c.forEach(({matches:p})=>{i[u].matches.push(...p)}))}}),s}_searchObjectList(t){const n=fc(t,this.options),{keys:r,records:o}=this._myIndex,i=[];return o.forEach(({$:s,i:l})=>{if(!yn(s))return;let u=[];r.forEach((c,p)=>{u.push(...this._findMatches({key:c,value:s[p],searcher:n}))}),u.length&&i.push({idx:l,item:s,matches:u})}),i}_findMatches({key:t,value:n,searcher:r}){if(!yn(n))return[];let o=[];if($r(n))n.forEach(({v:i,i:s,n:l})=>{if(!yn(i))return;const{isMatch:u,score:c,indices:p}=r.searchIn(i);u&&o.push({score:c,key:t,value:i,idx:s,norm:l,indices:p})});else{const{v:i,n:s}=n,{isMatch:l,score:u,indices:c}=r.searchIn(i);l&&o.push({score:u,key:t,value:i,norm:s,indices:c})}return o}}bs.version="6.6.2";bs.createIndex=mv;bs.parseIndex=VI;bs.config=Ke;bs.parseQuery=bv;oP(rP);const dP=H("h3",{class:"title"},"Jump to label",-1),pP={key:0,class:"search-results"},fP={key:1},hP=H("h3",null,"No matches found",-1),mP=[hP],yP=je({__name:"debug-jumping",emits:["close","jump"],setup(e,{emit:t}){const n=t;let r;const o=be(null),i=be(""),s=be([]),l=be(0),u=be(null);function c(){const d=i.value,h=r.search(d);s.value=h.map(m=>m.item),s.value.length>0&&l.value>s.value.length-1&&(l.value=s.value.length-1)}function p(d){if(d===l.value)return{background:"var(--light-background)"}}const a=z(()=>Object.keys(Ge.script).sort());return St(()=>{Le().debugMode=!0,r=new bs(a.value,{includeScore:!0}),s.value=a.value,l.value=0,setTimeout(()=>{pi(()=>{u.value&&u.value.focus()})},10),o.value=ut().registerInputListener("debug-jumping",{up:{press:()=>{l.value>0?l.value--:l.value=s.value.length-1}},down:{press:()=>{s.value.length>l.value+1?l.value++:l.value=0}},confirm:{press:()=>{if(s.value.length>0&&l.value<s.value.length){const d=s.value[l.value];Ue().jumpToLabel(d),n("close")}}},escape:{press:()=>{n("close")}}})}),Ct(()=>{o.value&&ut().unregisterInputListener(o.value),Le().debugMode=!1}),(d,h)=>(R(),Oe(eo,{onClose:h[1]||(h[1]=m=>d.$emit("close")),containerCssClass:"jump-menu-container"},{header:et(()=>[dP]),body:et(()=>[Kr(H("input",{type:"text",class:"label-input nrt-input",ref_key:"search",ref:u,"onUpdate:modelValue":h[0]||(h[0]=m=>i.value=m),onInput:c},null,544),[[is,i.value]]),s.value.length>0?(R(),ee("div",pP,[(R(!0),ee(Be,null,lt(s.value,(m,y)=>(R(),ee("div",{class:"search-result",style:Ye(p(y)),key:y},Se(m),5))),128))])):(R(),ee("div",fP,mP))]),_:1}))}}),_s=Ot("achievements",{state:()=>({achievements:{}}),actions:{generateGlobalSaveData(){return{achievements:ze(this.achievements)}},loadGlobalSaveData(e){this.achievements={...this.achievements,...ze(e.achievements)}},updateConfig(e){Object.keys(e.achievements).forEach(t=>{this.achievements[t]||(this.achievements[t]={id:t,unlocked:!1})})},reset(e){this.$reset(),this.updateConfig(e)},hasAchievement(e){var t;return((t=this.achievements[e])==null?void 0:t.unlocked)??!1},getExistingAchievement(e){return this.achievements[e]},unlock(e){const t=this.getExistingAchievement(e);if(!t){Te(`Tried to unlock achievement ${e} but it doesn't exist`);return}if(!t.unlocked){const n=new Date().toISOString();if(t.unlocked=!0,t.unlockTime=n,ci().notifyNewAchievements){const r=Zu(e);un().addNotification(`New Achievement: ${r.name}`,r.description,r.icon)}ex()}}}}),nd=Ot("choices-tracking-store",{state:()=>({choices:{}}),getters:{},actions:{trackChoice(e,t){this.choices[e]||(this.choices[e]={}),this.choices[e][t]=!0},hasSeenChoice(e,t){var n;return((n=this.choices[e])==null?void 0:n[t])??!1},generateSaveData(){return{choices:ze(this.choices)}},loadSaveData(e){this.choices=ze(e.choices)},reset(){this.$reset()}}}),rd=Ot("fonts-store",{state:()=>({currentFont:null,loadedFonts:{}}),getters:{},actions:{updateConfig(e){if(e.fontSets){for(const t in e.fontSets)this.loadFontSet(t);this.setFontSet(this.currentFont)}},generateSaveData(){return{currentFont:this.currentFont}},loadSaveData(e){this.currentFont=e.currentFont},reset(e){this.$reset(),this.updateConfig(e)},async loadFontFile(e,t){let n;this.isFontConfigObject(t)?n=new FontFace(e,`url(${Zt(t.file)})`,t.options):n=new FontFace(e,`url(${Zt(t)})`),document.fonts.add(n);try{return await n.load(),!0}catch(r){return Te(`Failed to load font ${t} (${e})`,r),!1}},isFontConfigObject(e){return typeof e=="object"},async loadNewFont(e,t){for(const n in t.files)await this.loadFontFile(t.name,t.files[n]);this.loadedFonts[t.name]=!0},getFontSets(){return lc().fontSets||(Te("No fonts found in config"),{})},async loadIfNeeded(e,t){if(!this.loadedFonts[t.name])return await this.loadNewFont(e,t)},async loadFontSet(e){const t=this.getFontSets()[e];if(!t){Te(`Font set ${e} not found`);return}for(const n in t)await this.loadIfNeeded(n,t[n])},async setFontSet(e){let t="default";if(!e)if(this.getFontSets().default)e="default";else return;e&&(t=e);const n=this.getFontSets()[t];await this.loadFontSet(t),this.currentFont=t,this.setFontVariables(n)},setFontVariables(e){const t=document.querySelector("#narrat");if(!t){Te("Narrat element not found");return}for(const n in e){const r=e[n];t.style.setProperty(`--font-${n}`,r.fontFamily)}}}}),yc={main:{store:Le,save:"main"},achievements:{store:_s,config:"achievements",globalSave:"achievements"},audio:{store:Yt,config:"audio",save:"audio"},choicesTracking:{store:nd,config:"choices",save:"choices"},config:{store:Bt,save:"config"},dialog:{store:rt,save:"dialog"},hud:{store:bn,config:"common",save:"hud"},inputs:{store:ut},inventory:{store:Xt,config:"items",save:"inventory"},menu:{store:Jt},notifications:{store:un,config:"common"},quests:{store:Gt,config:"quests",save:"quests"},rendering:{store:Et,save:"rendering"},screens:{store:Vn,config:"screens",save:"screens"},sprites:{store:An,save:"screenObjects"},settings:{store:sr,save:"settings",config:"common"},skills:{store:Lt,config:"skills",save:"skills"},startMenu:{store:ou},tooltips:{store:hi,config:"tooltips"},vm:{store:Ue,save:"vm",globalSave:"data"},scenes:{store:vn,save:"scenes",avoidReset:!0},fonts:{store:rd,save:"fonts",config:"fonts",avoidReset:!1}};function _v(){const e={};for(const t in yc){const n=yc[t].store();e[t]=n}return e}function gP(e){const t=_v();for(const n in e){const r=e[n];Object.assign(t[n],r)}}WC(yc);const vP=e=>(Ef("data-v-6a3ddcf8"),e=e(),Nf(),e),bP={class:"debug-menu-section"},_P=["id"],TP=vP(()=>H("a",{href:"#table-of-contents",class:"debug-menu-link"},[H("button",{class:"debug-link-button"},"Back")],-1)),wP=je({__name:"DebugMenuSection",props:{title:{},link:{}},setup(e){return(t,n)=>(R(),ee("div",bP,[H("h2",{class:"debug-section-title",id:t.link},Se(t.title),9,_P),TP,Yo(t.$slots,"default",{},void 0,!0)]))}}),kP=Pn(wP,[["__scopeId","data-v-6a3ddcf8"]]);let ns;async function SP(){ns||(ns=(await Pv(()=>import("./index-4-06qCrV-cc3d4c38.js"),[],import.meta.url)).JSONEditor,console.log(ns))}const CP=je({components:{ModalWindow:eo,DebugJumping:yP,DebugMenuSection:kP},setup(){const e=Lt(),t=z(()=>e.skills),n=z(()=>e.skillChecks);return{skills:t,skillChecks:n}},data(){return{showDebug:!1,jumping:!1,inputListener:null}},mounted(){const e=Et(),t=ve().hotkeys.debugMenu??"d",n=ve().hotkeys.jumpMenu??"j";e.inputsContainer.addEventListener("keydown",r=>{ut().isTyping||(this.jumping||(r.key===t&&this.toggle(),r.key===n&&this.jump()),r.key==="Escape"&&(this.closeJumping(),this.close()))})},methods:{closeJumping(){this.jumping=!1},labelSelected(e){const t=e.target.value;Ue().jumpToLabel(t),this.close()},close(){this.showDebug=!1,this.endDebug()},closeErrors(){Le().clearErrors()},async setupJsonEditor(){if(Le().options.debug){await SP();const e=Ue(),t=Gt(),n=Xt(),r=Lt();this.$nextTick(()=>{new ns({target:this.$refs.variablesViewer,props:{content:{text:void 0,json:{data:this.variables,quests:t.quests,items:n.items,skills:r.skills,skillChecks:r.skillChecks}},onChange:o=>{e.overrideData(o.json.data),t.quests=o.json.quests,n.items=o.json.items,r.skills=o.json.skills,r.skillChecks=o.json.skillChecks}}}),new ns({target:this.$refs.stateViewer,props:{content:{text:void 0,json:_v()},onChange:o=>{gP(o.json)}}}),new ns({target:this.$refs.saveViewer,props:{content:{text:void 0,json:ir()}}})})}},open(){this.showDebug=!0,this.startDebug(),this.setupJsonEditor()},toggle(){this.showDebug?this.close():this.open()},startDebug(){Le().debugMode=!0},endDebug(){Le().debugMode=!1},jump(){this.jumping=!0,this.startDebug()},save(){su({})},resetSave(){T_()},resetGlobalSave(){sg()},wordCount(){const e=Object.values(this.script).reduce((t,n)=>(qn.log(t),t+this.countWordsInScriptBranch(n.branch)),0);alert(`You have ${e} words`)},countWordsInScriptLine(e){if(e.command.commandType==="talk"&&typeof e.command.args[2]=="string")return this.countWordsInString(e.command.args[2]);if(e.command.commandType==="text")return this.countWordsInString(e.code);if(e.command.commandType==="choice"){const t=e.command.staticOptions;let n=this.countWordsInScriptLine(t.prompt);return n+=t.choices.reduce((r,o)=>r+this.countWordsInString(o.prompt.code),0),t.choices.reduce((r,o)=>o.branch?r+this.countWordsInScriptBranch(o.branch):r,n)}if(e.command.commandType==="if"){const t=e.command.staticOptions;return[t.success,t.failure].reduce((n,r)=>r?n+this.countWordsInScriptBranch(r):n,0)}return 0},countWordsInString(e){return e.split(" ").length},countWordsInScriptBranch(e){return e.reduce((t,n)=>n?t+this.countWordsInScriptLine(n):t,0)},getPlayTimeString(){const e=Zo(this.playTime.start,this.playTime.previousPlaytime);return qc(e/1e3)}},computed:{...Us(Ue,["data"]),...Us(Le,["playTime","errors","playing"]),...Us(vn,["activeScene"]),labels(){const e=this.script;return Object.keys(e).sort()},script(){return Ge.script},variables(){return this.data}}}),xP={class:"debug-menu"},$P={key:0,class:"debug-info"},OP=bb("<h3>Debug mode is ON</h3><ul><li><b>j</b>: Quick Label Jump</li><li><b>d</b>: Debug Menu</li><li><b>a</b>: Auto Play</li><li><b>s</b>: Skip</li><li><b>Space</b>: New Game</li><li><b>c</b>: Continue</li><li><b>Escape</b>: Toggle Menu</li></ul>",2),AP=[OP],IP=H("h3",{class:"title"},"Error(s)",-1),PP=["innerHTML"],jP=H("h1",{class:"text-center title"},"Debug Menu",-1),EP={class:"debug-body"},NP={class:"container items-center"},MP=H("h2",{class:"debug-section text-center",id:"table-of-contents"}," Table of contents ",-1),LP=H("ul",null,[H("li",null,[H("a",{href:"#utilities"},"Utilities")]),H("li",null,[H("a",{href:"#variables-editor"},"Variables Editor")]),H("li",null,[H("a",{href:"#skillchecks"},"Skillchecks state")]),H("li",null,[H("a",{href:"#state-editor"},"App State editor")]),H("li",null,[H("a",{href:"#save-editor"},"Save data editor")])],-1),DP=H("option",{class:"nrt-option",selected:"",disabled:""}," Jump to a label ",-1),RP=["value"],FP={class:"grid grid-cols-5 gap-4"},BP={class:"text-center"},UP={ref:"variablesViewer"},qP={key:0},VP={key:1,class:"table-auto"},HP=H("thead",null,[H("tr",null,[H("th",null,"Skill Check"),H("th",null,"Happened"),H("th",null,"Succeeded")])],-1),KP=H("h3",{style:{color:"pink"}}," Use for debugging, editing some of those things can cause issues ",-1),GP={ref:"stateViewer"},WP=H("h3",{style:{color:"pink"}},"Use to debug and view save data",-1),zP=H("h3",{style:{color:"pink"}},[On(" NOTE: Editing save data here will override it locally temporarily but "),H("i",null,"not"),On(" save changes. ")],-1),QP={ref:"saveViewer"};function JP(e,t,n,r,o,i){const s=wo("DebugJumping"),l=wo("ModalWindow"),u=wo("DebugMenuSection");return R(),ee("div",xP,[H("button",{onClick:t[0]||(t[0]=(...c)=>e.open&&e.open(...c)),class:"nrt-button debug-menu-toggle"}," Debug Menu "),!e.playing&&e.activeScene==="menu"?(R(),ee("div",$P,AP)):xe("",!0),e.jumping?(R(),Oe(s,{key:1,onClose:e.closeJumping},null,8,["onClose"])):xe("",!0),(R(),Oe(Js,{to:"#modals"},[e.errors.length>0?(R(),Oe(l,{key:0,onClose:e.closeErrors,containerCssClass:"debug-menu-container"},{header:et(()=>[IP]),body:et(()=>[On(" There are errors in your dialogue scripts. Open the developer console for more details. "),H("ul",null,[(R(!0),ee(Be,null,lt(e.errors,(c,p)=>(R(),ee("li",{key:p,class:Xe(["error-message list-disc",c.type==="error"?"error":"warning"]),innerHTML:c.text},null,10,PP))),128))])]),_:1},8,["onClose"])):xe("",!0)])),(R(),Oe(Js,{to:"#modals"},[e.showDebug?(R(),Oe(l,{key:0,onClose:e.close,containerCssClass:"debug-menu-container"},{header:et(()=>[jP]),body:et(()=>[H("div",EP,[H("div",NP,[MP,On(" Jump to debug menu elements by clicking links "),LP,Re(u,{title:"Utilities",link:"utilities"},{default:et(()=>[H("select",{class:"nrt-select",name:"label-selector",onChange:t[1]||(t[1]=c=>e.labelSelected(c))},[DP,(R(!0),ee(Be,null,lt(e.labels,c=>(R(),ee("option",{class:"nrt-option",value:c,key:c},Se(c),9,RP))),128))],32),H("div",FP,[H("button",{onClick:t[2]||(t[2]=(...c)=>e.wordCount&&e.wordCount(...c)),class:"nrt-button debug-button"}," Word Count "),H("button",{onClick:t[3]||(t[3]=(...c)=>e.save&&e.save(...c)),class:"nrt-button debug-button"}," Save Game "),H("button",{onClick:t[4]||(t[4]=(...c)=>e.resetSave&&e.resetSave(...c)),class:"nrt-button debug-button"}," Reset Save "),H("button",{onClick:t[5]||(t[5]=(...c)=>e.resetGlobalSave&&e.resetGlobalSave(...c)),class:"nrt-button debug-button"}," Reset GLOBAL Save ")]),H("h4",BP," Play time: "+Se(e.getPlayTimeString()),1)]),_:1}),Re(u,{title:"Variables Editor",link:"variables-editor"},{default:et(()=>[H("div",UP,null,512)]),_:1}),Re(u,{title:"Skill Checks",link:"skillchecks"},{default:et(()=>[Object.keys(e.skillChecks).length<1?(R(),ee("h3",qP," No skill checks have been made yet ")):(R(),ee("table",VP,[HP,H("tbody",null,[(R(!0),ee(Be,null,lt(e.skillChecks,(c,p)=>(R(),ee("tr",{key:p},[H("td",null,Se(p),1),H("td",null,Se(c.happened?"✅":"❌"),1),H("td",null,Se(c.happened?c.succeeded?"✅":"❌":"NA"),1)]))),128))])]))]),_:1}),Re(u,{title:"App State editor",link:"state-editor"},{default:et(()=>[KP,H("div",GP,null,512)]),_:1}),Re(u,{title:"Save data editor",link:"save-editor"},{default:et(()=>[WP,zP,H("div",QP,null,512)]),_:1})])])]),_:1},8,["onClose"])):xe("",!0)]))])}const YP=Pn(CP,[["render",JP]]),XP=["src"],ZP=["innerHTML"],ej=["innerHTML"],tj=je({__name:"notification-toast",setup(e){const t=un(),n=z(()=>t.notifications),r=o=>{if(o.description)return{marginTop:"10px"}};return(o,i)=>(R(),Oe(Rs,{name:"notification",tag:"div",class:"notifications-holder"},{default:et(()=>[(R(!0),ee(Be,null,lt(n.value,(s,l)=>(R(),ee("div",{class:"notification nrt-tile",key:l},[s.icon?(R(),ee("img",{key:0,src:st(Zt)(s.icon),class:"notification-icon",style:Ye(r(s))},null,12,XP)):xe("",!0),H("span",{innerHTML:s.text,class:"notification-text"},null,8,ZP),s.description?(R(),ee("p",{key:1,innerHTML:s.description,class:"notification-description"},null,8,ej)):xe("",!0)]))),128))]),_:1}))}}),nj={class:"title"},rj=je({__name:"alert-modal",props:{title:{type:String,required:!1},text:{type:String,required:!1}},emits:["close"],setup(e,{emit:t}){const n=t;function r(){n("close")}const o=be(ut().registerInputListener("yes-no",{cancel:{press:()=>{r()}},confirm:{press:()=>{r()}},system:{press:()=>{r()}}}));return Ct(()=>{o.value&&ut().unregisterInputListener(o.value)}),(i,s)=>(R(),Oe(eo,{onClose:r,containerCssClass:"yes-no-modal"},{header:et(()=>[H("h3",nj,Se(e.title??"Alert"),1)]),body:et(()=>[H("h3",null,Se(e.text),1)]),_:1}))}}),oj=H("hr",null,null,-1),sj=je({__name:"floating-tooltip",props:{title:{},text:{},width:{},x:{},y:{},screenWidth:{},screenHeight:{},screenMargin:{},cssClass:{},textCssClass:{},titleCssClass:{}},setup(e){const t=be(150),n=be(null),r=e,o=z(()=>r.screenWidth??window.innerWidth),i=z(()=>r.screenHeight??window.innerHeight),s=z(()=>{const l=r.screenMargin??5,u={};let c=r.x-r.width/2;c=Math.min(c,o.value-r.width-l),c=Math.max(l,c),u.left=`${c}px`;let p=i.value-r.y;return p=Math.max(p,l),p=Math.min(p,i.value-t.value-l),u.bottom=`${p}px`,u.width=`${r.width}px`,u});return St(()=>{n.value&&(t.value=n.value.clientHeight)}),(l,u)=>(R(),Oe(ss,{name:"fade"},{default:et(()=>[H("div",{class:Xe(["floating-tooltip",l.cssClass]),style:Ye(s.value),ref_key:"element",ref:n},[l.title?(R(),ee("div",{key:0,class:Xe(["floating-tooltip-title",l.titleCssClass])},[On(Se(r.title)+" ",1),oj],2)):xe("",!0),H("div",{class:Xe(["floating-tooltip-text",l.textCssClass])},Se(r.text),3)],6)]),_:1}))}}),ij={class:"tooltips-ui"},aj=je({__name:"tooltips-ui",setup(e){const t=hi(),n=Et(),r=z(()=>t.tooltip),o=z(()=>n.screenWidth),i=z(()=>n.screenHeight),s=z(()=>{if(r.value)return{...r.value,screenMargin:Co().options.screenEdgesMinimumMargin??5,screenWidth:o.value,screenHeight:i.value,...l(r.value)}});function l(u){var c,p;let a={};return Co().options.styling&&(a={...a,...Co().options.styling}),(c=va(u.keyword))!=null&&c.styling&&(a={...a,...(p=va(u.keyword))==null?void 0:p.styling}),a}return(u,c)=>(R(),ee("div",ij,[r.value?(R(),Oe(sj,qv(Rc({key:0},s.value)),null,16)):xe("",!0)]))}}),Al={};async function lj(e){qn.log("Loading videos");const t=[],n=async(o,i)=>await cj(o,i),r=(o,i)=>{t.push(n(o,i))};if(e.preload.video)for(const o in e.preload.video.assets){const i=e.preload.video.assets[o];r(o,i)}return Promise.all(t)}async function cj(e,t){if(Al[e])return Al[e];const n=new Promise((r,o)=>{const i=document.createElement("video");i.onloadeddata=()=>{r(i)},i.onerror=s=>{Te(`Could not load video ${t}`,s),o(s)},i.src=Zt(t)});return Al[e]=n,n}async function uj(){const e=ft().scripts;Yt().setMasterVolume(xn().options.volume??1),await Ue().loadScripts(e),Jt().setup();for(const[,t]of Ge.customStores())if(t.setup){const n=t.setup();Bh(n)&&await n}Ge.addCustomSettings(),ng()}async function dj(){const e=Le(),t=Rk(ft()),n=lj(ft()),r=H_(xn());if(Ge.plugins){const o=[];for(const i of Ge.plugins)i.loadingPromises&&o.push(Promise.all(i.loadingPromises));o.length>0&&(e.setLoadingStep("Plugins",0),await Promise.all(o))}e.setLoadingStep("Assets",.3),await Promise.all([t,n,r]),Ge.callHook("onAssetsLoaded"),e.setLoadingStep("Starting",.9),await uj(),Ge.callHook("onGameSetup"),e.gameLoaded()}const pj=["id"],fj=je({__name:"GameScene",props:{sceneId:{},options:{}},setup(e){const t=e,n=vn(),r=z(()=>n.getSceneConfig(t.sceneId));function o(){n.finishedScene(t.sceneId)}return(i,s)=>(R(),ee("div",{class:"game-scene",id:`scene-${i.sceneId}`},[(R(),Oe(Ea(r.value.component),{onFinished:o,options:i.options},null,40,["options"]))],8,pj))}}),hj={key:0,class:"inputs-legend"},mj=je({__name:"inputs-legend",props:{extraInputs:{}},setup(e){const t=ut(),n=e,r=z(()=>[...n.extraInputs??[],...t.inputLegend]);return(o,i)=>st(t).showPrompts&&st(ve)().input.showBottomLegend!==!1?(R(),ee("div",hj,[(R(!0),ee(Be,null,lt(r.value,s=>(R(),Oe(ii,{key:s,input:s,showLabel:!0,class:"legend-prompt"},null,8,["input"]))),128))])):xe("",!0)}}),yj={id:"narrat"},gj=H("div",{id:"modals"},null,-1),vj=je({__name:"app",props:{options:{}},setup(e){const t=e,n=Le(),r=vn(),o=z(()=>r.activeScene),i=z(()=>n.alerts),s=Et(),l=be(!1),u=z(()=>({transform:`scale(${s.gameScaleRatio}, ${s.gameScaleRatio})`,width:`${s.gameWidth}px`,height:`${s.actualGameHeight}px`})),c=z(()=>Jt().activeMenu?"app-blurred-by-modal":{});function p(d){Le().closeAlert(d)}function a(){Et().refreshScreenSize()}return St(async()=>{Ge.callHook("onAppMounted"),await dj(),s.inputsContainer.addEventListener("resize",Ka(()=>{a()},100,{maxWait:200})),Hn.setup(t.options.debug),l.value=!0,setTimeout(()=>{a()},50)}),(d,h)=>(R(),ee("div",yj,[H("div",{id:"narrat-app-container",style:Ye(u.value)},[H("div",{id:"narrat-app",class:Xe(c.value),tabindex:"0"},[Re(ss,{name:"screens-fade"},{default:et(()=>[(R(),Oe(fj,{key:o.value,sceneId:o.value,options:st(r).currentOptions},null,8,["sceneId","options"]))]),_:1}),d.options.debug&&l.value?(R(),Oe(YP,{key:0})):xe("",!0),Re(tj),(R(!0),ee(Be,null,lt(i.value,m=>(R(),Oe(rj,{key:m.id,title:m.title,text:m.text,onClose:()=>p(m.id)},null,8,["title","text","onClose"]))),128))],2)],4),Re(aj),Re(mj,{extraInputs:["movement"]}),gj]))}}),bj=new Y("add_level",[{name:"skillKey",type:"string"},{name:"amount",type:"number"}],async e=>{let{skillKey:t,amount:n}=e.options;if((!t||!n)&&_e(e,"add_level command needs a skill id and a value as parameters"),!Number.isInteger(n)){const r=n;n=Math.round(n),console.warn(`add_level expects a level to be an integer. Auto Rounding ${r} to ${n}`)}Lt().incrementSkill(t,n)}),_j=Y.FromOptions({keyword:"set_level",argTypes:[{name:"skill",type:"string"},{name:"level",type:"number"}],runner:async e=>{let{skill:t,level:n}=e.options;if((!t||!n)&&_e(e,"set_level command needs a skill id and a value as parameters"),!Number.isInteger(n)){const r=n;n=Math.round(n),console.warn(`set_level expects a level to be an integer. Auto Rounding ${r} to ${n}`)}Lt().setSkillLevel(t,n)}}),Tj=new Y("add_xp",[{name:"xpKey",type:"string"},{name:"xpToAdd",type:"number"}],async e=>{const{xpKey:t,xpToAdd:n}=e.options;(!t||!n)&&_e(e,"add_xp command needs a skill id and a value as parameters"),Lt().addXp(t,n)}),wj=new Y("get_level",[{name:"skillKey",type:"string"}],async e=>{const{skillKey:t}=e.options;t||_e(e,"get_level command needs a skill id as parameter");const n=Lt().getSkill(t);return n||_e(e,`Skill ${t} not found`),n.level}),kj=new Y("get_xp",[{name:"xpKey",type:"string"}],async e=>{const{xpKey:t}=e.options;t||_e(e,"get_xp command needs a skill id as parameter");const n=Lt().getSkillXp(t);return n||_e(e,`XP ${t} not found`),n}),Sj=new Y("roll",[{name:"id",type:"string"},{name:"skill",type:"string",optional:!0},{name:"difficulty",type:"number",optional:!0},{name:"mode",type:"string",optional:!0}],async e=>{const{id:t}=e.options;let n={id:t};if(e.args.length===1&&iv(t))n={...sv(t),id:t};else{const{skill:r,difficulty:o,mode:i}=e.options;if(!r||!o){_e(e,"roll command needs a skill and a difficulty as parameters, or the skill check id to be configured in skillChecks.yaml");return}n={skill:r,difficulty:o,id:t},i==="hideAfterRoll"&&(n.hideAfterRoll=!0),i==="repeatable"&&(n.repeatable=!0)}return Gm(n).succeeded}),Cj=new Y("get_skill_check",[{name:"skillCheckId",type:"string"}],async e=>Lt().getSkillCheck(e.options.skillCheckId)),xj=new Y("skill_check_result",[{name:"skillCheckId",type:"string"}],async e=>Lt().getSkillCheck(e.options.skillCheckId).succeeded),$j=new Y("reset_roll",[{name:"id",type:"string"}],async e=>Lt().resetSkillCheck(e.options.id)),Oj=new Y("add_stat",[{name:"statKey",type:"string"},{name:"amountToAdd",type:"number"}],async e=>{const{statKey:t,amountToAdd:n}=e.options;(!t||typeof n!="number")&&_e(e,"add_stat command needs a stat id and a value as parameters"),bn().addStat(t,n)}),Aj=new Y("set_stat",[{name:"statKey",type:"string"},{name:"value",type:"number"}],async e=>{const{statKey:t,value:n}=e.options;(!t||typeof n!="number")&&_e(e,"set_stat command needs a stat id and a value as parameters"),bn().setStat(t,n)}),Ij=new Y("get_stat_value",[{name:"statKey",type:"string"}],async e=>{const{statKey:t}=e.options;return t||_e(e,"get_stat_value command needs a stat id as parameter"),bn().getStatValue(t)}),Pj=new Y("show_hud",[],async e=>{bn().setVisibility(!0)}),jj=new Y("hide_hud",[],async e=>{bn().setVisibility(!1)}),Ej=Y.FromOptions({keyword:"jump",argTypes:"any",runner:async e=>{(e.args.length<1||typeof e.args[0]!="string")&&_e(e,"requires a label argument");const t=e.args[0],n=Ue(),r={branchData:Ge.script[t],label:t,args:e.args.splice(1),currentIndex:0};if(!Ge.script[t]){Te(`Trying to jump but label ${t} not found`);return}return n.jumpTarget=r,ra}}),Nj=Y.FromOptions({keyword:"run",argTypes:"any",runner:async e=>{(e.args.length<1||typeof e.args[0]!="string")&&_e(e,"run command needs a label to argument run");const t=e.args[0];return await Ue().runLabelFunction(t,...e.args.slice(1))}}),Mj=Y.FromOptions({keyword:"var",argTypes:[{name:"name",type:"string"},{name:"value",type:"any"}],runner:async e=>{const{name:t,value:n}=e.options;Ue().addScopedVariable(t,n)}}),Lj=Y.FromOptions({keyword:"return",argTypes:[{name:"value",type:"any"}],runner:async e=>{const{value:t}=e.options;return Ue().setReturnValue(t),Kc}}),Dj=Y.FromOptions({keyword:"log",argTypes:"any",runner:async e=>{fI(e,...e.args)}}),Rj=Y.FromOptions({keyword:"menu_return",argTypes:[],runner:async e=>(Hy(),oa)}),Fj=Y.FromOptions({keyword:"save",argTypes:[{name:"name",type:"string",optional:!0}],runner:async e=>{await iu({saveName:e.options.name})}}),Bj=Y.FromOptions({keyword:"save_prompt",argTypes:[{name:"name",type:"string",optional:!0}],runner:async e=>{await iu({saveName:e.options.name,withPrompt:!0})}}),Uj=Y.FromOptions({keyword:"reset_global_save",argTypes:[],runner:async e=>{await sg()}}),qj=Y.FromOptions({keyword:"new",argTypes:[{name:"name",type:"string"},{name:"rest",type:"rest",optional:!0}],runner:async e=>{const t=e.options.name;if(t==="Array")return[...e.args.slice(1)];if(t==="Object")return{}}}),Vj=[{name:"mode",type:"string"},{name:"audio",type:"string"},{name:"channel",type:"number",optional:!0}],Hj=new Y("play",Vj,async e=>{const t=Yt(),{mode:n,audio:r,channel:o}=e.options,i=el(e,n);i&&t.playChannel(i,r,o??0)}),Kj=new Y("resume",[{name:"mode",type:"string"},{name:"channel",type:"number",optional:!0}],async e=>{const t=Yt(),{mode:n,channel:r}=e.options,o=el(e,n);o&&t.resumeChannel(o,r??0)}),Gj=new Y("pause",[{name:"mode",type:"string"},{name:"channel",type:"number",optional:!0}],async e=>{const t=Yt(),{mode:n,channel:r}=e.options,o=el(e,n);o&&t.pauseChannel(o,r??0)}),Wj=new Y("stop",[{name:"mode",type:"string"},{name:"channel",type:"number",optional:!0}],async e=>{const t=Yt(),{mode:n,channel:r}=e.options,o=el(e,n);o&&t.stopChannel(o,r??0)});function el(e,t){return zj(t)?t:(_e(e,`${t} is not a valid audio mode.`),!1)}function zj(e){return!!Uh.includes(e)}const Qj=new Y("set",[{name:"key",type:"string"},{name:"value",type:"any"}],async e=>{const t=fs();cv(t,`$${e.options.key}`,e.options.value)}),Jj=new Y("add",[{name:"key",type:"string"},{name:"value",type:"any"}],async e=>{const t=fs();uv(t,`$${e.options.key}`,e.options.value)}),Yj=new Y("set_screen",[{name:"screen",type:"string"},{name:"layer",type:"number",optional:!0},{name:"transitionName",type:"string",optional:!0},{name:"transitionDuration",type:"number",optional:!0},{name:"transitionDelay",type:"number",optional:!0}],async e=>{const t=Vn();if(!Ti(e.options.screen)){_e(e,`Screen ${e.options.screen} doesn't exist in the config`);return}return e.options.transitionName?t.transitionScreen(e.options.screen,{transition:e.options.transitionName,duration:e.options.transitionDuration,delay:e.options.transitionDelay},e.options.layer):t.setScreen(e.options.screen,e.options.layer??0)}),Xj=new Y("empty_layer",[{name:"layer",type:"number"},{name:"transitionName",type:"string",optional:!0},{name:"transitionDuration",type:"number",optional:!0},{name:"transitionDelay",type:"number",optional:!0}],async e=>{const t=Vn();return e.options.transitionName?t.emptyLayer(e.options.layer,{transition:e.options.transitionName,duration:e.options.transitionDuration,delay:e.options.transitionDelay}):t.emptyLayer(e.options.layer)}),Zj=new Y("set_button",[{name:"buttonId",type:"string"},{name:"state",type:"any"}],async e=>{const{buttonId:t,state:n}=e.options,r=Vn();if(!xo(t)){_e(e,`Button ${t} doesn't exist in the config`);return}r.changeButton(t,n)});class Sr extends Y{static async ManageAutoAdvance(t){await Ue().waitForEndTextAnimation(),await cn(t.options.delay||0),t.options.autoAdvance?fg(0):rt().makeLastDialogInteractive()}static ShouldBeInteractive(t){return!t.options.delay&&!t.options.autoAdvance}}const od=[{name:"speaker",type:"string"},{name:"pose",type:"string"},{name:"text",type:"string"},{name:"delay",type:"number",optional:!0},{name:"autoAdvance",type:"boolean",optional:!0}],eE=Sr.FromOptions({keyword:"talk",argTypes:od,runner:async(e,t)=>{const n=Sr.ShouldBeInteractive(e);await Ba({speaker:e.options.speaker,pose:e.options.pose,cssClass:"talk-command",text:`"${e.options.text}"`,choices:t,interactive:n}),n||Sr.ManageAutoAdvance(e)},returnAfterPlayerAnswer:!0}),tE=Sr.FromOptions({keyword:"think",argTypes:od,runner:async(e,t)=>{const n=Sr.ShouldBeInteractive(e);await Ba({speaker:e.options.speaker,pose:e.options.pose,cssClass:"think-command",text:`${e.options.text}`,choices:t,interactive:n}),n||Sr.ManageAutoAdvance(e)},returnAfterPlayerAnswer:!0}),nE=Sr.FromOptions({keyword:"narrate",argTypes:od.slice(2,5),runner:async(e,t)=>{const n=Sr.ShouldBeInteractive(e);await Ba({speaker:Bt().gameCharacter,cssClass:"text-command",text:`${e.options.text}`,choices:t,interactive:n}),n||Sr.ManageAutoAdvance(e)},returnAfterPlayerAnswer:!0}),rE=()=>{const e=_i("text",[]);return(t,n)=>{const r=e(t,n);return n.command.staticOptions={text:n.code.substring(1,n.code.length-1)},r}},oE=Y.FromOptions({keyword:"text",argTypes:[],runner:async(e,t)=>{await Ba({speaker:Bt().gameCharacter,cssClass:"text-command",text:e.staticOptions.text,choices:t,interactive:!0})},parser:rE(),returnAfterPlayerAnswer:!0}),sE=new Y("add_item",[{name:"id",type:"string"},{name:"amount",type:"number"}],async e=>{const{id:t,amount:n}=e.options;Xt().add({id:t,amount:n})}),iE=new Y("remove_item",[{name:"id",type:"string"},{name:"amount",type:"number"}],async e=>{const{id:t,amount:n}=e.options;Xt().remove({id:t,amount:n})}),aE=new Y("has_item?",[{name:"id",type:"string"},{name:"amount",type:"number",optional:!0}],async e=>{const{id:t,amount:n}=e.options;return Xt().hasItem(t,n)}),lE=new Y("item_amount?",[{name:"id",type:"string"}],async e=>{const{id:t}=e.options;return Xt().getItemAmount(t)}),cE=new Y("enable_interaction",[{name:"tag",type:"string"}],async e=>{const t=e.options.tag;Xt().enableInteraction(t)}),uE=new Y("disable_interaction",[{name:"tag",type:"string"}],async e=>{const t=e.options.tag;Xt().disableInteraction(t)}),dE=new Y("start_quest",[{name:"questId",type:"string"}],async e=>{const t=e.options.questId;Gt().startQuest(t)}),pE=new Y("start_objective",[{name:"questId",type:"string"},{name:"objectiveId",type:"string"}],async e=>{const{questId:t,objectiveId:n}=e.options;Gt().startObjective(t,n)}),fE=new Y("complete_objective",[{name:"questId",type:"string"},{name:"objectiveId",type:"string"}],async e=>{const{questId:t,objectiveId:n}=e.options;Gt().completeObjective(t,n)}),hE=new Y("complete_quest",[{name:"questId",type:"string"},{name:"ending",type:"any",optional:!0}],async e=>{const{questId:t,ending:n}=e.options;Gt().completeQuest(t,n)}),mE=new Y("quest_completed?",[{name:"questId",type:"string"}],async e=>{const{questId:t}=e.options;return Gt().isQuestCompleted(t)}),yE=new Y("quest_succeeded?",[{name:"questId",type:"string"}],async e=>{const{questId:t}=e.options;return Gt().isQuestSucceeded(t)}),gE=new Y("quest_failed?",[{name:"questId",type:"string"}],async e=>{const{questId:t}=e.options;return Gt().isQuestFailed(t)}),vE=new Y("quest_ending?",[{name:"questId",type:"string"}],async e=>{const{questId:t}=e.options;return Gt().getQuestEnding(t)}),bE=new Y("quest_has_ending?",[{name:"questId",type:"string"},{name:"ending",type:"string"}],async e=>{const{questId:t,ending:n}=e.options;return Gt().questHasEnding(t,n)}),_E=new Y("objective_completed?",[{name:"questId",type:"string"},{name:"objectiveId",type:"string"}],async e=>{const{questId:t,objectiveId:n}=e.options;return Gt().isObjectiveCompleted(t,n)}),TE=new Y("quest_started?",[{name:"questId",type:"string"}],async e=>{const{questId:t}=e.options;return Gt().isQuestStarted(t)}),wE=new Y("objective_started?",[{name:"questId",type:"string"},{name:"objectiveId",type:"string"}],async e=>{const{questId:t,objectiveId:n}=e.options;return Gt().isObjectiveStarted(t,n)}),kE=Y.FromOptions({keyword:"wait",argTypes:[{name:"duration",type:"number"}],runner:async e=>{await cn(e.options.duration)}}),SE=new Y("notify",[{name:"text",type:"string"},{name:"description",type:"string",optional:!0},{name:"icon",type:"string",optional:!0}],async e=>{const{text:t,icon:n,description:r}=e.options;un().addNotification(t,r,n)}),CE=new Y("disable_notifications",[],async e=>{un().disableNotifications()}),xE=new Y("enable_notifications",[],async e=>{un().enableNotifications()}),$E=new Y("clear_dialog",[],async e=>{rt().clearDialog()}),OE=new Y("if",[{name:"condition",type:"boolean"}],async e=>{const t=[];for(const o of e.staticOptions.elseifs){const i=o.condition;let s;zc(i)?s=await Wa(i):Qc(i)?s=pg(i):s=i,t.push(s)}const n=hw(e,t),r=Ue();if(n){const o={branchData:{branch:n},currentIndex:0};return r.addAndRunBlock(o)}},(e,t)=>{let n=e.currentLine;_i("if",[{name:"condition",type:"string"}])(e,t);const{lines:r,currentLine:o,line:i}=e,s=t.command;let l,u=o,c=!1;const p=[];for(;!c;){u++;const a=mw(r,u);if(a&&a.code.startsWith("elseif")){const d=a.expression;if(!Array.isArray(d)){e.parserContext.error(a.line,"Expected an expression after elseif"),c=!0;break}if(d.length>2){e.parserContext.error(a.line,"Expected only one argument after elseif"),c=!0;break}p.push({branch:e.processCommandsFunction(e.parserContext,a.branch,i),condition:lg(e.parserContext,a,d[1])})}else a&&a.code==="else:"?l=e.processCommandsFunction(e.parserContext,a.branch,i):(c=!0,u--)}return s.staticOptions={success:e.processCommandsFunction(e.parserContext,i.branch,i),elseifs:p,failure:l},u++,n=u,{newLine:n}}),AE=new Y("==","any",async e=>{e.args.length<1&&_e(e,"requires at least 1 arguments");let t=e.args[0],n=!0;for(const r of e.args)if(r!=t){n=!1;break}else t=r;return n}),IE=new Y(">",[{name:"a",type:"any"},{name:"b",type:"any"}],async e=>{const{a:t,b:n}=e.options;return t>n}),PE=new Y("<",[{name:"a",type:"any"},{name:"b",type:"any"}],async e=>{const{a:t,b:n}=e.options;return t<n}),jE=new Y(">=",[{name:"a",type:"any"},{name:"b",type:"any"}],async e=>{const{a:t,b:n}=e.options;return t>=n}),EE=new Y("<=",[{name:"a",type:"any"},{name:"b",type:"any"}],async e=>{const{a:t,b:n}=e.options;return t<=n}),NE=new Y("!=",[{name:"a",type:"any"},{name:"b",type:"any"}],async e=>{const{a:t,b:n}=e.options;return t!=n}),ME=new Y("!",[{name:"a",type:"any"}],async e=>{const{a:t}=e.options;return!t}),LE=new Y("&&","any",async e=>{const t=e.args;return e.args.length<2&&_e(e,"requires at least two arguments"),t.reduce((n,r)=>n&&r,!0)}),DE=new Y("||","any",async e=>(e.args.length<2&&_e(e,"requires at least two arguments"),e.args.reduce((t,n)=>t||n,!1))),RE=new Y("?",[{name:"a",type:"any"},{name:"b",type:"any"},{name:"c",type:"any"}],async e=>{const{a:t,b:n,c:r}=e.options;return t?n:r}),FE=new Y("+","any",async e=>(e.args.length<2&&_e(e,"requires at least two arguments"),e.args.reduce((t,n)=>typeof n=="number"?t+n:(_e(e,"requires all arguments to be numbers"),t),0))),BE=new Y("-","any",async e=>(e.args.length<2&&_e(e,"requires at least two arguments"),e.args.slice(1).reduce((t,n)=>typeof n=="number"?t-n:(_e(e,"requires all arguments to be numbers"),t),e.args[0]))),UE=new Y("neg",[{name:"a",type:"number"}],async e=>(e.args.length!==1&&_e(e,"requires one argument"),-e.options.a)),qE=new Y("abs",[{name:"a",type:"number"}],async e=>(e.args.length!==1&&_e(e,"requires one argument"),Math.abs(e.options.a))),VE=new Y("*","any",async e=>(e.args.length<2&&_e(e,"requires at least two arguments"),e.args.reduce((t,n)=>typeof n=="number"?t*n:(_e(e,"requires all arguments to be numbers"),t),1))),HE=new Y("/","any",async e=>{e.args.length<2&&_e(e,"requires at least two arguments");const t=e.args[0]/e.args[1];return e.args.slice(2).reduce((n,r)=>typeof r=="number"?n/r:(_e(e,"requires all arguments to be numbers"),n),t)}),KE=async e=>{const{prompt:t,choices:n}=e.staticOptions,r=[];for(const[,s]of n.entries()){const l=await Wa(s.prompt);r.push(l)}e.options.choiceResults=r;const o=r.map((s,l)=>{var u;let c=!0;s.skillCheck&&(c=((u=s.skillCheck)==null?void 0:u.allowed)??!1);const p=nd().hasSeenChoice(t.code,n[l].prompt.code);return{flag:s.flag,seenBefore:p,choice:s.text,originalIndex:l,allowed:c}}).filter(s=>s.choice),i=await dg(t,o);return await QE(e,i)};function GE(e,t){t.branch||e.parserContext.error(t.line,`Choice option doesn't have any branch to go to (${t.code} - ${t.line})`);let n,r;const o=t.branch;return t.expression[1]==="roll"||t.expression[2]==="roll"?((!o[0].branch||!o[1].branch)&&e.parserContext.error(t.line,`Choice option with a skill roll needs success and failure branches (${t.code} - ${t.line})`),n={success:e.processCommandsFunction(e.parserContext,o[0].branch,t),failure:e.processCommandsFunction(e.parserContext,o[1].branch,t)}):r=e.processCommandsFunction(e.parserContext,o,t),{prompt:e.processCommandsFunction(e.parserContext,[t],t)[0],branch:r,skillBranches:n}}const WE=(e,t)=>{let n=e.currentLine;_i("choice",[]);const{line:r}=e,o=t.command;(!r.branch||r.branch.length<2)&&e.parserContext.error(r.line,"Choice menu needs to have at least one option");const i=r.branch[0];i||e.parserContext.error(e.line.line,"Choice prompt is missing ");const s=r.branch.slice(1).map((l,u)=>(l.branch||e.parserContext.error(l.line,`Choice option doesn't have any branch to go to (${l.code})`),l=JE(e.parserContext,l),GE(e,l)));return o.staticOptions={prompt:e.processCommandsFunction(e.parserContext,[i],r)[0],choices:s},n++,{newLine:n}},zE=Y.FromOptions({keyword:"choice",argTypes:[],runner:KE,parser:WE}),QE=async(e,t)=>{const n=t,r=Ue(),{choices:o}=e.staticOptions,i=o[n],s=e.options.choiceResults[n],l=e.staticOptions.prompt;nd().trackChoice(l.code,i.prompt.code);let u=s.text,c;if(s.skillCheck?(u=null,Gm(s.skillCheck.options).succeeded?c=i.skillBranches.success:c=i.skillBranches.failure):c=i.branch,u){const p={speaker:Bt().playerCharacter,text:u,interactive:!1};rt().addDialog(p)}if(c){const p={currentIndex:0,branchData:{branch:c}};return await r.addAndRunBlock(p)}};function JE(e,t){return{code:`choicePrompt ${t.code}`,indentation:t.indentation,line:t.line,branch:t.branch,expression:["choicePrompt",...t.expression]}}const YE=new Y("choicePrompt","any",async e=>{const t=e.args;return t.length===1?XE(t[0]):t.length===2?ZE(t):t.length>2?t[0]==="roll"||t[1]==="roll"?tN(e,t):eN(e,t):(_e(e,"Invalid choice prompt line"),{text:t[0]})});function XE(e){return{text:e}}function ZE(e){return{text:e[1],flag:e[0]}}function eN(e,t){const n=t[1]==="if"?1:2;if(t[n]!=="if")return _e(e,"Invalid choice prompt line"),{text:t[0]};const r=n===2;let o=r?t[1]:t[0],i=!0;t.length>n+1&&(i=t[n+1]),i||(o=null);const s={text:o};return r&&(s.flag=t[0]),s}function tN(e,t){const n=t[0]==="roll"?0:1,r=n===1,o=n,i=t[o+1];let s={},l=o+2;iv(i)?s={...sv(i),id:i}:(s={id:i,skill:t[o+2],difficulty:t[o+3]},l=o+4);const u=t[l];l++;let c=!1,p=!1,a;t.length>l&&(t[l]==="if"?(p=!0,t.length<l+2&&_e(e,'Missing condition argument after "if" in choice with a skill check'),a=t[l+1]):(c=t[l],t.length>l+1&&(l++,t[l]==="if"?(p=!0,t.length<l+2&&_e(e,'Missing condition argument after "if" in choice with a skill check'),a=t[l+1]):_e(e,`Invalid argument after skill check mode: ${t[l]}. The next argument can only be an if condition.`)))),c==="hideAfterRoll"&&(s.hideAfterRoll=!0),c==="repeatable"&&(s.repeatable=!0);const d=Lt().getSkillCheck(i);if(d.hidden||p&&!a)return{text:null};const h=!d.happened||d.happened&&d.succeeded||s.repeatable,{difficultyText:m}=J_({skill:s.skill,skillCheckId:i,value:s.difficulty}),y={text:`${m} ${u}`,skillCheck:{allowed:h,options:s}};return r&&(y.flag=t[0]),y}const Tv=Y.FromOptions({keyword:"text_field",argTypes:[{name:"prompt",type:"string"}],returnAfterPlayerAnswer:!0,runner:async e=>{const t={speaker:Bt().gameCharacter,text:e.options.prompt,textField:!0,interactive:!0};rt().addDialog(t)}});Tv.onPlayerAnswered=async(e,t)=>(typeof t!="string"&&_e(e,"The player's answer should be a string"),t);const nN=Y.FromOptions({keyword:"text_field_prompt",argTypes:[{name:"prompt",type:"string"}],runner:async e=>{const t={speaker:Bt().gameCharacter,text:e.options.prompt,textField:!0,interactive:!0};rt().addDialog(t)}}),rN=new Y("random",[{name:"a",type:"number"},{name:"b",type:"number"}],async e=>{const{a:t,b:n}=e.options;return typeof t!="number"||typeof n!="number"?(_e(e,"random command needs two numbers as parameters"),0):Math.floor(Math.random()*(n-t+1))+t}),oN=new Y("random_float",[{name:"a",type:"number"},{name:"b",type:"number"}],async e=>{const{a:t,b:n}=e.options;return typeof t!="number"||typeof n!="number"?(_e(e,"random_float command needs two numbers as parameters"),0):Math.random()*(n-t)+t}),sN=new Y("random_from_args",[],async e=>{const t=e.args;return!t||!t.length?(_e(e,"random_from_args command needs at least one argument"),0):t[Math.floor(Math.random()*t.length)]}),iN=new Y("random_from_array",[{name:"a",type:"any"}],async e=>{const{a:t}=e.options;return Array.isArray(t)?t[Math.floor(Math.random()*t.length)]:(_e(e,"random_from_array command needs an array as parameter"),0)}),aN=new Y("concat","any",async e=>(e.args.length<2&&_e(e,"requires at least two arguments"),e.args.reduce((t,n)=>typeof n=="string"?`${t}${n}`:(_e(e,"requires all arguments to be strings"),t),""))),lN=new Y("join","any",async e=>{const t=e.args[0];return e.args.length<3&&_e(e,"requires at least 3 arguments"),e.args.slice(1).reduce((n,r)=>typeof r=="string"?`${n}${t}${r}`:(_e(e,"requires all arguments to be strings"),n),"")}),cN=new Y("split","any",async e=>{e.args.length<2&&_e(e,"requires at least 2 arguments");const t=e.args[0],n=e.args[1];if(typeof t=="string"&&typeof n=="string")return n.split(t);_e(e,"requires all arguments to be strings")}),uN=Y.FromOptions({keyword:"str_search",argTypes:[{name:"str",type:"string"},{name:"matcher",type:"string"}],runner:async e=>{const{str:t,matcher:n}=e.options;return t.search(n)}}),dN=Y.FromOptions({keyword:"regex_search",argTypes:[{name:"str",type:"string"},{name:"regex",type:"string"}],runner:async e=>{const{str:t,regex:n}=e.options,r=new RegExp(n);return t.search(r)}}),pN=Y.FromOptions({keyword:"min",argTypes:[{name:"min",type:"number"},{name:"value",type:"number"}],runner:async e=>{const{min:t,value:n}=e.options;return n<t?n:t}}),fN=Y.FromOptions({keyword:"max",argTypes:[{name:"max",type:"number"},{name:"value",type:"number"}],runner:async e=>{const{max:t,value:n}=e.options;return n>t?n:t}}),hN=Y.FromOptions({keyword:"clamp",argTypes:[{name:"min",type:"number"},{name:"max",type:"number"},{name:"value",type:"number"}],runner:async e=>{const{min:t,max:n,value:r}=e.options;return r<t?t:r>n?n:r}}),mN=Y.FromOptions({keyword:"floor",argTypes:[{name:"value",type:"number"}],runner:async e=>{const{value:t}=e.options;return Math.floor(t)}}),yN=Y.FromOptions({keyword:"ceil",argTypes:[{name:"value",type:"number"}],runner:async e=>{const{value:t}=e.options;return Math.ceil(t)}}),gN=Y.FromOptions({keyword:"round",argTypes:[{name:"value",type:"number"}],runner:async e=>{const{value:t}=e.options;return Math.round(t)}}),vN=Y.FromOptions({keyword:"sqrt",argTypes:[{name:"value",type:"number"}],runner:async e=>{const{value:t}=e.options;return Math.sqrt(t)}}),bN=Y.FromOptions({keyword:"^",argTypes:[{name:"base",type:"number"},{name:"exponent",type:"number"}],runner:async e=>{const{base:t,exponent:n}=e.options;return Math.pow(t,n)}}),_N=new Y("create_sprite",[{name:"image",type:"string"},{name:"x",type:"number"},{name:"y",type:"number"},{name:"parent",type:"any",optional:!0}],async e=>{const t=An(),{x:n,y:r,image:o,parent:i}=e.options,s={x:n,y:r,image:o};return typeof i=="object"&&(s.parent=i),typeof i=="string"&&(s.parent=An().getObject(i)),t.createSprite(s)}),TN=new Y("create_object",[{name:"x",type:"number"},{name:"y",type:"number"},{name:"parent",type:"any",optional:!0}],async e=>{const t=An(),{x:n,y:r,parent:o}=e.options,i={x:n,y:r};return typeof o=="object"&&(i.parent=o),typeof o=="string"&&(i.parent=An().getObject(o)),t.createObject(i)}),wN=new Y("delete_sprite",[{name:"sprite",type:"any"}],async e=>An().destroyObject(e.options.sprite)),kN=Y.FromOptions({keyword:"empty_sprites",argTypes:[{name:"layer",type:"number",optional:!0}],runner:async e=>{const t=An(),{layer:n}=e.options;return typeof n=="number"?t.emptyLayer(n):t.emptyAllLayers()}}),SN=Y.FromOptions({keyword:"shuffle",argTypes:[{name:"array",type:"any"}],runner:async e=>{const t=e.options.array;if(!Array.isArray(t)){_e(e,"requires an array argument");return}return VN(t),t}}),CN=Y.FromOptions({keyword:"push",argTypes:[{name:"array",type:"any"},{name:"value",type:"any"}],runner:async e=>{const{array:t,value:n}=e.options;if(!Array.isArray(t)){_e(e,"requires an array argument");return}return t.push(n),t}}),xN=Y.FromOptions({keyword:"pop",argTypes:[{name:"array",type:"any"}],runner:async e=>{const{array:t}=e.options;if(!Array.isArray(t)){_e(e,"requires an array argument");return}return t.pop()}}),$N=Y.FromOptions({keyword:"shift",argTypes:[{name:"array",type:"any"}],runner:async e=>{const{array:t}=e.options;if(!Array.isArray(t)){_e(e,"requires an array argument");return}return t.shift()}}),ON=Y.FromOptions({keyword:"unshift",argTypes:[{name:"array",type:"any"},{name:"value",type:"any"}],runner:async e=>{const{array:t,value:n}=e.options;if(!Array.isArray(t)){_e(e,"requires an array argument");return}return t.unshift(n),t}}),AN=Y.FromOptions({keyword:"array_join",argTypes:[{name:"array",type:"any"},{name:"separator",type:"string",optional:!0}],runner:async e=>{const{array:t,separator:n}=e.options;if(!Array.isArray(t)){_e(e,"requires an array argument");return}if(typeof n<"u"&&typeof n!="string"){_e(e,"array join string separator must be a string");return}return t.join(n)}}),IN=Y.FromOptions({keyword:"array_concat",argTypes:[{name:"array",type:"any"},{name:"rest",type:"rest",optional:!0}],runner:async e=>{const{array:t}=e.options,n=e.args;if(!Array.isArray(t)){_e(e,"requires an array argument");return}for(const r of n)if(!Array.isArray(r)){_e(e,"All concat arguments should be arrays");return}return t.concat(...n.slice(1))}}),PN=Y.FromOptions({keyword:"includes",argTypes:[{name:"array",type:"any"},{name:"searchElement",type:"string"}],runner:async e=>{const{array:t,searchElement:n}=e.options;return Array.isArray(t)||_e(e,"requires an array argument"),typeof n>"u"&&_e(e,"requires a search element argument"),t.includes(n)}}),jN=Y.FromOptions({keyword:"reverse",argTypes:[{name:"array",type:"any"}],runner:async e=>{const{array:t}=e.options;return Array.isArray(t)||_e(e,"requires an array argument"),t.reverse(),t}}),EN=Y.FromOptions({keyword:"slice",argTypes:[{name:"array",type:"any"},{name:"start",type:"number"},{name:"end",type:"number",optional:!0}],runner:async e=>{const{array:t,start:n,end:r}=e.options;return Array.isArray(t)||_e(e,"requires an array argument"),typeof n!="number"&&_e(e,"requires a start index argument"),typeof r<"u"&&typeof r!="number"&&_e(e,"end index argument must be a number if present"),t.slice(n,r)}}),NN=Y.FromOptions({keyword:"splice",argTypes:[{name:"array",type:"any"},{name:"start",type:"number"},{name:"end",type:"number",optional:!0}],runner:async e=>{const{array:t,start:n,end:r}=e.options;return Array.isArray(t)||_e(e,"requires an array argument"),typeof n!="number"&&_e(e,"requires a start index argument"),typeof r<"u"&&typeof r!="number"&&_e(e,"end index argument must be a number if present"),t.splice(n,r)}}),MN=Y.FromOptions({keyword:"array_find_index",argTypes:[{name:"array",type:"any"},{name:"predicateLabel",type:"string"},{name:"rest",type:"rest",optional:!0}],runner:async e=>{const{array:t,predicateLabel:n}=e.options;Array.isArray(t)||_e(e,"requires an array argument");for(const[r,o]of t.entries())if(await Ue().runLabelFunction(n,o,r,t,...e.args.slice(2))===!0)return r;return-1}}),LN=Y.FromOptions({keyword:"array_find",argTypes:[{name:"array",type:"any"},{name:"predicateLabel",type:"string"},{name:"rest",type:"rest",optional:!0}],runner:async e=>{const{array:t,predicateLabel:n}=e.options;Array.isArray(t)||_e(e,"requires an array argument");for(const[r,o]of t.entries())if(await Ue().runLabelFunction(n,o,r,t,...e.args.slice(2))===!0)return o;return null}}),DN=Y.FromOptions({keyword:"array_filter",argTypes:[{name:"array",type:"any"},{name:"predicateLabel",type:"string"},{name:"rest",type:"rest",optional:!0}],runner:async e=>{const{array:t,predicateLabel:n}=e.options;Array.isArray(t)||_e(e,"requires an array argument");const r=[];for(const[o,i]of t.entries())await Ue().runLabelFunction(n,i,o,t,...e.args.slice(2))===!0&&r.push(i);return r}}),RN=Y.FromOptions({keyword:"array_map",argTypes:[{name:"array",type:"any"},{name:"mapperLabel",type:"string"},{name:"rest",type:"rest",optional:!0}],runner:async e=>{const{array:t,mapperLabel:n}=e.options;Array.isArray(t)||_e(e,"requires an array argument");const r=[];for(const[o,i]of t.entries()){const s=await Ue().runLabelFunction(n,i,o,t,...e.args.slice(2));r.push(s)}return r}}),FN=Y.FromOptions({keyword:"array_reduce",argTypes:[{name:"array",type:"any"},{name:"reducerLabel",type:"string"},{name:"initValue",type:"any"},{name:"rest",type:"rest",optional:!0}],runner:async e=>{const{array:t,reducerLabel:n,initValue:r}=e.options;Array.isArray(t)||_e(e,"requires an array argument");let o=r;for(const[i,s]of t.entries())o=await Ue().runLabelFunction(n,o,s,i,t,...e.args.slice(3));return o}}),BN=Y.FromOptions({keyword:"array_some",argTypes:[{name:"array",type:"any"},{name:"predicateLabel",type:"string"},{name:"rest",type:"rest",optional:!0}],runner:async e=>{const{array:t,predicateLabel:n}=e.options;Array.isArray(t)||_e(e,"requires an array argument");for(const[r,o]of t.entries())if(await Ue().runLabelFunction(n,o,r,t,...e.args.slice(2))===!0)return!0;return!1}}),UN=Y.FromOptions({keyword:"array_every",argTypes:[{name:"array",type:"any"},{name:"predicateLabel",type:"string"},{name:"rest",type:"rest",optional:!0}],runner:async e=>{const{array:t,predicateLabel:n}=e.options;Array.isArray(t)||_e(e,"requires an array argument");for(const[r,o]of t.entries())if(await Ue().runLabelFunction(n,o,r,t,...e.args.slice(2))!==!0)return!1;return!0}}),qN=Y.FromOptions({keyword:"array_entries",argTypes:[{name:"array",type:"any"}],runner:async e=>{const{array:t}=e.options;return Array.isArray(t)||_e(e,"requires an array argument"),t.entries()}});function VN(e){for(let t=e.length-1;t>0;t--){const n=Math.floor(Math.random()*(t+1));[e[t],e[n]]=[e[n],e[t]]}}const rs={keyframes:{"narrat-screenshake":[{transform:"translateX(0)"},{transform:"translateX(5px)"},{transform:"translateX(-5px)"},{transform:"translateX(5px)"},{transform:"translateX(0)"}]},animations:{"narrat-screenshake":{keyframes:"narrat-screenshake",options:{duration:150,iterations:3}}}};function HN(e){return typeof e=="string"?document.querySelector(e):e}function KN(e){if(typeof e=="string"){const t=ov();t.keyframes[e]?e=t.keyframes[e]:rs.keyframes[e]?e=rs.keyframes[e]:(Te(`[Animation] Animation not found: ${e}`),e=rs.keyframes["narrat-screenshake"])}return e}function GN(e){let t;if(typeof e=="string"){const n=ov();n.animations[e]?t=n.animations[e]:rs.animations[e]?t=rs.animations[e]:(Te(`[Animation] Animation not found: ${e}`),t=rs.animations["narrat-screenshake"])}else t=e;return WN(t)}function WN(e){return{keyframes:[...KN(e.keyframes)],options:{...e.options}}}async function wv(e,t,n){return new Promise(r=>{const o=HN(e);o||(Te(`[Animation] Element not found: ${e}`),r({}));const i=GN(t);n&&Object.assign(i.options,n),o.animate(i.keyframes,i.options).addEventListener("finish",r)})}const zN=Y.FromOptions({keyword:"load_data",argTypes:[{name:"url",type:"string"}],runner:async e=>{const{url:t}=e.options;return await qa(Xu(t))}}),QN=Y.FromOptions({keyword:"change_player_character",argTypes:[{name:"character",type:"string"}],runner:async e=>{const{character:t}=e.options;Bt().config.characters.config.playerCharacter=t}}),JN=Y.FromOptions({keyword:"change_game_character",argTypes:[{name:"character",type:"string"}],runner:async e=>{const{character:t}=e.options;Bt().config.characters.config.gameCharacter=t}}),YN=Y.FromOptions({keyword:"json_stringify",argTypes:[{name:"value",type:"any"}],runner:async e=>{const{value:t}=e.options;return JSON.stringify(t)}}),XN=Y.FromOptions({keyword:"json_parse",argTypes:[{name:"value",type:"string"}],runner:async e=>{const{value:t}=e.options;return JSON.parse(t)}}),ZN=Y.FromOptions({keyword:"set_dialog_panel_mode",argTypes:[{name:"mode",type:"string"}],runner:async e=>{const{mode:t}=e.options;Et().dialogPanelMode=t}}),kv=[{name:"element",type:"string"},{name:"animation",type:"string"},{name:"duration",optional:!0,type:"number"},{name:"iterations",optional:!0,type:"number"}];function Sv(e){const{element:t,animation:n,duration:r,iterations:o}=e.options,i={};return o&&(i.iterations=o),r&&(i.duration=r),i}const eM=Y.FromOptions({keyword:"animate",argTypes:kv,runner:async e=>{const{element:t,animation:n}=e.options,r=Sv(e);wv(t,n,r)}}),tM=Y.FromOptions({keyword:"animate_wait",argTypes:kv,runner:async e=>{const{element:t,animation:n}=e.options;await wv(t,n,Sv(e))}}),nM=Y.FromOptions({keyword:"time_now",argTypes:[],runner:async e=>Date.now()}),rM=Y.FromOptions({keyword:"total_playtime",argTypes:[],runner:async e=>Le().totalPlayTime}),oM=Y.FromOptions({keyword:"session_playtime",argTypes:[],runner:async e=>Le().sessionPlayTime}),sM=Y.FromOptions({keyword:"to_days",argTypes:[{name:"time",type:"number"}],runner:async e=>Math.floor(e.options.time/864e5)}),iM=Y.FromOptions({keyword:"to_hours",argTypes:[{name:"time",type:"number"}],runner:async e=>Math.floor(e.options.time/36e5)}),aM=Y.FromOptions({keyword:"to_minutes",argTypes:[{name:"time",type:"number"}],runner:async e=>Math.floor(e.options.time/6e4)}),lM=Y.FromOptions({keyword:"to_seconds",argTypes:[{name:"time",type:"number"}],runner:async e=>Math.floor(e.options.time/1e3)}),cM=new Y("unlock_achievement",[{name:"id",type:"string"}],async e=>{const{id:t}=e.options;_s().unlock(t)}),uM=new Y("has_achievement?",[{name:"id",type:"string"}],async e=>{const{id:t}=e.options;return _s().hasAchievement(t)}),dM=Y.FromOptions({keyword:"get_setting",argTypes:[{name:"setting",type:"string"}],runner:async e=>{const{setting:t}=e.options;return t||_e(e,"get_setting command needs a setting id"),sr().getSetting(t)}}),pM=Y.FromOptions({keyword:"set_setting",argTypes:[{name:"setting",type:"string"},{name:"value",type:"any"}],runner:async e=>{const{setting:t,value:n}=e.options;t||_e(e,"set_setting command needs a setting id"),sr().setSetting(t,n)}}),fM=Y.FromOptions({keyword:"object_entries",argTypes:[{name:"obj",type:"any"}],runner:async e=>{const t=e.options.obj;return typeof t!="object"?(_e(e,"Requires an object argument."),[]):Object.entries(t)}}),hM=Y.FromOptions({keyword:"object_keys",argTypes:[{name:"obj",type:"any"}],runner:async e=>{const t=e.options.obj;return typeof t!="object"?(_e(e,"Requires an object argument."),[]):Object.keys(t)}}),mM=Y.FromOptions({keyword:"object_values",argTypes:[{name:"obj",type:"any"}],runner:async e=>{const t=e.options.obj;return typeof t!="object"?(_e(e,"Requires an object argument."),[]):Object.values(t)}}),yM=Y.FromOptions({keyword:"object_has",argTypes:[{name:"obj",type:"any"},{name:"key",type:"string"}],runner:async e=>{const{obj:t,key:n}=e.options;return typeof t!="object"?(_e(e,"Requires an object argument."),!1):Object.hasOwn(t,n)}}),gM=Y.FromOptions({keyword:"for_of",argTypes:[{name:"target",type:"any"},{name:"predicateLabel",type:"string"},{name:"rest",type:"rest",optional:!0}],runner:async e=>{const{target:t,predicateLabel:n}=e.options;if(typeof t!="object")return _e(e,"Requires an object argument."),!1;for(const r of t)await Ue().runLabelFunction(n,r,...e.args.slice(2))}}),vM=Y.FromOptions({keyword:"for_in",argTypes:[{name:"target",type:"any"},{name:"predicateLabel",type:"string"},{name:"rest",type:"rest",optional:!0}],runner:async e=>{const{target:t,predicateLabel:n}=e.options;if(typeof t!="object")return _e(e,"Requires an object argument."),!1;for(const r in t)await Ue().runLabelFunction(n,r,t[r],...e.args.slice(2))}}),bM=Y.FromOptions({keyword:"change_scene",argTypes:[{name:"scene",type:"string"},{name:"rest",type:"rest",optional:!0}],runner:async e=>{const{scene:t}=e.options;await vn().changeScene(t,_M(e.args.slice(1)))}});function _M(e){const t={};let n=0;for(;n<e.length&&!(n+1>=e.length);){const r=e[n],o=e[n+1];t[r]=o,n+=2}return t}function Di(e,t,n){if(n>=t){let r="log";switch(t){case Ur.ERROR:r="error";break;case Ur.WARN:r="warn";break}return console.log.bind(console,r,`[${e}]`)}else return()=>{}}function TM(e,t){return{error:Di(e,Ur.ERROR,t),warn:Di(e,Ur.WARN,t),info:Di(e,Ur.INFO,t),debug:Di(e,Ur.DEBUG,t)}}const wM=TM("js-commands",TT),kM=Y.FromOptions({keyword:"call_js_method",argTypes:[{name:"target",type:"any"},{name:"method",type:"string"},{name:"args",type:"rest",optional:!0}],runner:async e=>{const{target:t,method:n}=e.options,r=e.args.slice(2);let o=t;if(typeof t=="string"){const i=ed(window,window,t,"");if(!i)return _e(e,"target object not found"),null;o=i[0][i[1]]}return typeof o!="object"?(_e(e,`target object not found when trying to call js method ${n} on ${t}`),null):typeof n!="string"?(_e(e,"method name must be a string"),null):typeof o[n]!="function"?(_e(e,`method ${n} not found on target object`),null):await o[n](...r)}}),SM=Y.FromOptions({keyword:"run_js",argTypes:[{name:"code",type:"string"}],runner:async e=>{const{code:t}=e.options,n=Function(`return (${t})`);return wM.debug(`Running JS code: ${t}`),n()}});function CM(e){e.addCommand(zE),e.addCommand(YE),e.addCommand(OE),e.addCommand(Oj),e.addCommand(Aj),e.addCommand(Ij),e.addCommand(Pj),e.addCommand(jj),e.addCommand($E),e.addCommand(SE),e.addCommand(CE),e.addCommand(xE),e.addCommand(Gj),e.addCommand(Hj),e.addCommand(Kj),e.addCommand(Wj),e.addCommand(Zj),e.addCommand(Yj),e.addCommand(Xj),e.addCommand(_N),e.addCommand(TN),e.addCommand(wN),e.addCommand(kN),e.addCommand(kE),e.addCommand(AE),e.addCommand(IE),e.addCommand(PE),e.addCommand(jE),e.addCommand(EE),e.addCommand(NE),e.addCommand(ME),e.addCommand(LE),e.addCommand(DE),e.addCommand(RE),e.addCommand(FE),e.addCommand(BE),e.addCommand(VE),e.addCommand(HE),e.addCommand(UE),e.addCommand(qE),e.addCommand(Jj),e.addCommand(Qj),e.addCommand(oE),e.addCommand(eE),e.addCommand(tE),e.addCommand(nE),e.addCommand(Ej),e.addCommand(Nj),e.addCommand(Mj),e.addCommand(Lj),e.addCommand(Dj),e.addCommand(Rj),e.addCommand(Fj),e.addCommand(Uj),e.addCommand(Bj),e.addCommand(qj),e.addCommand(dE),e.addCommand(pE),e.addCommand(fE),e.addCommand(hE),e.addCommand(TE),e.addCommand(wE),e.addCommand(mE),e.addCommand(yE),e.addCommand(gE),e.addCommand(vE),e.addCommand(bE),e.addCommand(_E),e.addCommand(sE),e.addCommand(iE),e.addCommand(cE),e.addCommand(uE),e.addCommand(aE),e.addCommand(lE),e.addCommand(bj),e.addCommand(_j),e.addCommand(Tj),e.addCommand(Sj),e.addCommand($j),e.addCommand(Cj),e.addCommand(xj),e.addCommand(wj),e.addCommand(kj),e.addCommand(Tv),e.addCommand(nN),e.addCommand(rN),e.addCommand(oN),e.addCommand(sN),e.addCommand(iN),e.addCommand(aN),e.addCommand(lN),e.addCommand(cN),e.addCommand(uN),e.addCommand(dN),e.addCommand(pN),e.addCommand(fN),e.addCommand(hN),e.addCommand(mN),e.addCommand(gN),e.addCommand(yN),e.addCommand(vN),e.addCommand(bN),e.addCommand(SN),e.addCommand(CN),e.addCommand(xN),e.addCommand($N),e.addCommand(ON),e.addCommand(AN),e.addCommand(IN),e.addCommand(PN),e.addCommand(jN),e.addCommand(EN),e.addCommand(NN),e.addCommand(MN),e.addCommand(LN),e.addCommand(DN),e.addCommand(RN),e.addCommand(FN),e.addCommand(BN),e.addCommand(UN),e.addCommand(qN),e.addCommand(hM),e.addCommand(mM),e.addCommand(fM),e.addCommand(yM),e.addCommand(gM),e.addCommand(vM),e.addCommand(zN),e.addCommand(QN),e.addCommand(JN),e.addCommand(YN),e.addCommand(XN),e.addCommand(ZN),e.addCommand(eM),e.addCommand(tM),e.addCommand(nM),e.addCommand(rM),e.addCommand(oM),e.addCommand(sM),e.addCommand(iM),e.addCommand(aM),e.addCommand(lM),e.addCommand(cM),e.addCommand(uM),e.addCommand(pM),e.addCommand(dM),e.addCommand(hI),e.addCommand(bM),e.addCommand(kM),e.addCommand(SM)}const xM=je({data(){return{muted:!1,volumes:[],modeNames:{master:"Master volume:",music:"Music:",ambiant:"Ambiant:",sound:"Sound effects:"}}},mounted(){const e=Yt(),t=rr.Howler.volume();this.volumes.push({mode:"master",volume:t}),e.modes.forEach((n,r)=>{this.volumes.push({mode:r,volume:e.modes.get(r).options.volume})})},methods:{changeVolume(e,t){const n=t.target;e==="master"?Yt().setMasterVolume(n.value):Yt().setModeVolume(e,n.value)},toggleMute(){this.muted?(rr.Howler.mute(!1),this.muted=!1):(rr.Howler.mute(!0),this.muted=!0)}}}),$M={class:"volume-controls"},OM=H("h3",{class:"nrt-subtitle"},"Volume",-1),AM={for:"volume",class:"volume-label"},IM=["onUpdate:modelValue","onChange"];function PM(e,t,n,r,o,i){return R(),ee("div",$M,[OM,(R(!0),ee(Be,null,lt(e.volumes,(s,l)=>(R(),ee("div",{class:"volume-control",key:s.mode},[H("label",AM,Se(e.modeNames[s.mode]),1),Kr(H("input",{ref_for:!0,ref:"slider",class:"volume-slider",type:"range",id:"volume",name:"volume",min:"0",max:"1",step:"0.1","onUpdate:modelValue":u=>e.volumes[l].volume=u,onChange:u=>e.changeVolume(s.mode,u)},null,40,IM),[[is,e.volumes[l].volume]])]))),128))])}const jM=Pn(xM,[["render",PM]]),EM={class:"settings-widget-container"},NM=["for","id"],MM=["id","name","min","max","step"],LM=["id","name"],DM=["id","name"],RM={class:"mx-8"},FM={class:"text-left setting-description"},BM=H("hr",{class:"h-px my-8 bg-gray-200 border-0 dark:bg-gray-700 setting-separator"},null,-1),UM=je({__name:"setting-widget",props:{settingId:{}},setup(e){const t=e,n=sr(),r=z(()=>n.getSetting(t.settingId)),o=be(r.value),i=z(()=>n.getSettingSchema(t.settingId));function s(l){let u=l;tp(i.value)&&(u=Math.round(u)),n.setSetting(t.settingId,u)}return Cn(o,l=>{s(l)}),(l,u)=>(R(),ee(Be,null,[H("div",EM,[H("label",{for:l.settingId,class:"setting-label",id:`setting-label-${l.settingId}`},Se(i.value.name),9,NM),st(hT)(i.value)||st(tp)(i.value)?Kr((R(),ee("input",{key:0,ref:"slider",class:"number-slider setting-slider",type:"range",id:`setting-slider-${l.settingId}`,name:l.settingId,min:i.value.minValue,max:i.value.maxValue,step:i.value.step,"onUpdate:modelValue":u[0]||(u[0]=c=>o.value=c)},null,8,MM)),[[is,o.value]]):st(mT)(i.value)?Kr((R(),ee("input",{key:1,type:"checkbox",class:"setting-checkbox",id:`setting-checkbox-${l.settingId}`,name:l.settingId,"onUpdate:modelValue":u[1]||(u[1]=c=>o.value=c)},null,8,LM)),[[o_,o.value]]):st(yT)(i.value)?Kr((R(),ee("input",{key:2,type:"text",class:"setting-text",id:`setting-text-${l.settingId}`,name:l.settingId,"onUpdate:modelValue":u[2]||(u[2]=c=>o.value=c)},null,8,DM)),[[is,o.value]]):xe("",!0),H("span",RM,Se(o.value),1)]),H("p",FM,Se(i.value.description),1),BM],64))}}),qM={class:"container mx-auto settings-menu-container"},VM=H("h2",{class:"settings-menu-title subtitle text-center"},"Settings",-1),HM=je({__name:"settings-menu",setup(e){const t=sr(),n=z(()=>t.getAllSettingSchemas());return(r,o)=>(R(),ee("div",qM,[VM,(R(!0),ee(Be,null,lt(n.value,(i,s)=>(R(),Oe(UM,{settingId:s,key:s},null,8,["settingId"]))),128))]))}}),KM={class:"menu-content"},GM={key:0,class:"fonts-picker"},WM=H("label",{name:"font-picker",class:"font-picker-label"}," Font Choice: ",-1),zM=["selected","value"],QM=je({__name:"MainMenu",props:{inputListener:{}},emits:["close"],setup(e,{emit:t}){const n=e,r=t,o=be(null),i=be(null),s=rd();function l(){window.close()}function u(){Hy(),c()}function c(){r("close")}function p(){iu({}),c()}const a=z(()=>{if(lc().allowChoosingFont===!1)return null;const T=lc().fontSets;return T&&Object.keys(T).length>0?Object.keys(T):null});function d(T){return s.currentFont===T}function h(T){const g=T.target.value;s.setFontSet(g)}function m(){document.fullscreenElement?document.exitFullscreen():document.body.requestFullscreen()}function y(){const T=Zo(Le().playTime.start,Le().playTime.previousPlaytime);return qc(T/1e3)}return St(()=>{i.value=Ar({mode:"list",container:o,listener:n.inputListener,onChosen:T=>{T===0?u():T===1&&l()}}),i.value.mount()}),Ct(()=>{i.value&&(i.value.disable(),i.value=null)}),(T,g)=>(R(),ee("div",KM,[H("h3",null,"Play time: "+Se(y()),1),Re(jM),a.value?(R(),ee("div",GM,[WM,H("select",{class:"nrt-select",name:"font-picker",onChange:g[0]||(g[0]=C=>h(C))},[(R(!0),ee(Be,null,lt(a.value,C=>(R(),ee("option",{class:"nrt-option",selected:d(C),value:C,key:C},Se(C),9,zM))),128))],32)])):xe("",!0),H("div",{ref_key:"mainActions",ref:o},[st(ve)().saves.allowManualSave!==!1?(R(),ee("button",{key:0,class:"nrt-button system-menu-button save-button",onClick:p}," Save Game ")):xe("",!0),st(ve)().graphics.allowFullscreen!==!1?(R(),ee("button",{key:1,class:"nrt-button system-menu-button fullscreen-button",onClick:m}," Toggle Fullscreen ")):xe("",!0),H("button",{class:"nrt-button system-menu-button return-main-menu-button",onClick:u}," Main Menu "),H("button",{class:"nrt-button system-menu-button quit-button",onClick:l}," Exit ")],512),Re(HM)]))}}),JM={class:"sub-tabs-controller"},YM={key:0,class:"sub-tabs-controller__tabs"},XM={key:1,class:"sub-tab-content"},ZM={key:2},eL=H("div",{class:"sub-tab-content__empty"},[H("p",null,"No tab selected")],-1),tL=[eL],nL=je({__name:"SubTabController",props:{tabs:{},defaultTab:{},inputListener:{}},emits:["tab-change","close"],setup(e,{emit:t}){const n=t,r=e,o=be(r.defaultTab);function i(l){o.value=l,n("tab-change",l)}const s=z(()=>r.tabs[o.value]);return St(()=>{r.inputListener.actions.subPreviousTab={press:()=>{o.value>0&&i(o.value-1)}},r.inputListener.actions.subNextTab={press:()=>{o.value<r.tabs.length-1&&i(o.value+1)}}}),Ct(()=>{delete r.inputListener.actions.subPreviousTab,delete r.inputListener.actions.subNextTab}),(l,u)=>(R(),ee("div",JM,[l.tabs.length>1?(R(),ee("div",YM,[(R(!0),ee(Be,null,lt(l.tabs,(c,p)=>(R(),Oe(Jy,{key:c.id,tab:c,active:p===o.value,onClick:()=>i(p)},null,8,["tab","active","onClick"]))),128))])):xe("",!0),s.value?(R(),ee("div",XM,[s.value?(R(),Oe(Ea(s.value.component),Rc({key:s.value.id,inputListener:l.inputListener},s.value.extraProps,{onClose:u[0]||(u[0]=c=>l.$emit("close"))}),null,16,["inputListener"])):xe("",!0)])):(R(),ee("div",ZM,tL))]))}}),rL=["onClick"],oL={class:"item-title"},sL={class:"item-amount"},iL=je({__name:"inventory-section",props:{items:{},title:{},id:{},inputListener:{}},emits:["chosen"],setup(e,{emit:t}){const n=e,r=be(null),o=be(null),i=t;function s(c){i("chosen",c)}function l(c){return{backgroundImage:`url(${Zt(tr(c).icon)})`}}function u(c){return tr(c).name}return St(()=>{o.value=Ar({mode:"grid",listener:n.inputListener,columns:3,container:r,onChosen:c=>{s(n.items[c].id)}}),o.value.mount()}),Ct(()=>{o.value&&(o.value.disable(),o.value=null)}),(c,p)=>(R(),ee("div",{class:Xe(["inventory-section",`section-${n.id}`])},[H("h3",null,Se(c.title),1),H("div",{class:"inventory-section-items",ref_key:"itemsContainer",ref:r},[(R(!0),ee(Be,null,lt(c.items,a=>(R(),ee("button",{onClick:()=>s(a.id),class:Xe(["item-display",`item-${a.id}`]),style:Ye(l(a.id)),key:a.id},[H("h3",oL,Se(u(a.id)),1),H("h3",sL,Se(a.amount),1)],14,rL))),128))],512)],2))}}),aL={class:"flex flex-row item-description-container"},lL={class:"flex item-left"},cL={class:"flex item-right"},uL=H("hr",{class:"hr-solid"},null,-1),dL=je({__name:"item-details",props:{item:{}},emits:["use","close"],setup(e,{emit:t}){const n=e,r=be(null),o=z(()=>tr(n.item.id)),i=z(()=>({backgroundImage:`url(${Zt(o.value.icon)})`})),s=t,l=z(()=>Xt().canUseItem(n.item));function u(){l.value&&s("use")}function c(){s("close")}return St(()=>{r.value=ut().registerInputListener("item-details",{confirm:{press:()=>{l.value&&u()}},cancel:{press:()=>{c()}}})}),Ct(()=>{r.value&&(ut().unregisterInputListener(r.value),r.value=null)}),(p,a)=>(R(),ee("div",null,[H("div",aL,[H("div",lL,[H("div",{class:"item-display",style:Ye(i.value)},null,4)]),H("div",cL,[H("h2",null,Se(o.value.name),1),uL,H("h3",null,"Amount: "+Se(p.item.amount),1),H("p",null,Se(o.value.description),1),H("button",{onClick:u,class:Xe(["nrt-button",l.value?"":"nrt-disabled"])}," Use ",2)])]),H("button",{class:"nrt-button",onClick:c},Se("<--"))]))}}),pL={key:0},fL={key:2},hL=H("h2",null,"The inventory is empty!",-1),mL=[hL],yL=je({__name:"inventory-ui",props:{section:{},inputListener:{}},emits:["close"],setup(e,{emit:t}){const n=Xt(),r=z(()=>n.items),o=be(!1),i=z(()=>o.value?r.value[o.value]:null);function s(){Jt().closeMenu()}function l(p){o.value=p}function u(){o.value=!1}function c(){n.useItem(i.value)&&s()}return(p,a)=>!i.value&&p.section.items.length>0?(R(),ee("div",pL,[Re(iL,{items:p.section.items,title:p.section.title,inputListener:p.inputListener,id:p.section.id,onChosen:l},null,8,["items","title","inputListener","id"])])):typeof o.value=="string"?(R(),Oe(dL,{key:1,item:r.value[o.value],onUse:c,onClose:u},null,8,["item"])):(R(),ee("div",fL,mL))}}),gL=je({__name:"InventoryTab",props:{inputListener:{}},setup(e){const t=Xt(),n=z(()=>t.items),r=z(()=>Object.values(n.value).filter(s=>s.amount>0?!0:!!tr(s.id).showIfEmpty)),o=z(()=>{const s=ft().items.categories,l=[];if(s.length>1){const u={id:"all",title:"All",items:r.value};l.push(u)}for(const u in s){const c=s[u],p=c.id,a=r.value.filter(d=>tr(d.id).category===p);l.push({id:p,title:c.title,items:a})}return l}),i=z(()=>{const s=[];return o.value.forEach(l=>{s.push({id:l.id,label:l.title,component:yL,extraProps:{section:l}})}),s});return(s,l)=>(R(),ee("div",null,[Re(nL,{tabs:i.value,defaultTab:0,inputListener:s.inputListener},null,8,["tabs","inputListener"])]))}}),vL=["id"],bL={class:"obtained-status"},_L={class:"achievement-title"},TL={class:"achievement-description"},wL=je({__name:"achievement-tile",props:{achievement:{}},setup(e){const t=e,n=_s(),r=z(()=>n.getExistingAchievement(t.achievement)),o=z(()=>Zu(t.achievement)),i=ci().secretAchievements??{censorName:!0,censorDescription:!0},s=z(()=>{let p=r.value.unlocked?o.value.icon:o.value.lockedIcon;return p||(p=ci().defaultAchievementIcon),{backgroundImage:`url(${Zt(p)})`}}),l=z(()=>!o.value.secret||!i.censorName?o.value.name:"Hidden Achievement"),u=z(()=>!o.value.secret||!i.censorDescription?o.value.description:"This achievement is hidden. Complete it to discover more."),c=z(()=>r.value.unlocked?`Obtained ${new Date(r.value.unlockTime).toLocaleDateString()}`:"Not obtained yet");return(p,a)=>(R(),ee("div",{class:"achievement-display nrt-tile",id:`achievement-${p.achievement}`},[H("div",{class:"achievement-icon",style:Ye(s.value)},null,4),H("p",bL,Se(c.value),1),H("h3",_L,Se(l.value),1),H("p",TL,Se(u.value),1)],8,vL))}}),kL={class:"achievements-section-achievements"},SL=je({__name:"achievements-section",props:{achievements:{},title:{},id:{}},setup(e){const t=e;return(n,r)=>(R(),ee("div",{class:Xe(["achievements-section",`section-${t.id}`])},[H("h3",null,Se(n.title),1),H("div",kL,[(R(!0),ee(Be,null,lt(n.achievements,o=>(R(),Oe(wL,{achievement:o.id,key:o.id},null,8,["achievement"]))),128))])],2))}}),CL=je({setup(){const e=_s(),t=rt(),n=z(()=>e.achievements),r=z(()=>t.currentDialog.choices);return{achievements:n,currentlyChoosing:r}},emits:["close"],data(){return{chosenId:!1}},mounted(){},methods:{close(){this.$emit("close")},clickAchievement(e){this.chosenId=e},closeAchievement(){this.chosenId=!1}},computed:{achievementsToDisplay(){return Object.values(this.achievements)},chosenAchievement(){return this.chosenId?this.achievements[this.chosenId]:null},chosenAchievementConf(){return this.chosenId?this.achievementConf[this.chosenId]:null},achievementConf(){return ft().achievements.achievements},sections(){const e=ft().achievements.categories,t=[];return this.achievementsToDisplay.reduce((n,r)=>{const o=Zu(r.id).category??"default",i=e.find(l=>l.id===o);if(!i)return Te(`Unknown category ${o}`),n;let s=n.find(l=>l.id===o);return s||(s={id:o,title:i.title,achievements:[]},n.push(s)),s.achievements.push(r),n},t)}},components:{AchievementsSection:SL}}),xL={key:0},$L={key:1},OL=H("h2",null,"The achievements section is empty!",-1),AL=[OL];function IL(e,t,n,r,o,i){const s=wo("AchievementsSection");return Object.keys(e.achievementsToDisplay).length>0?(R(),ee("div",xL,[(R(!0),ee(Be,null,lt(e.sections,l=>(R(),Oe(s,{key:l.id,achievements:l.achievements,title:l.title,id:l.id,onChosen:e.clickAchievement},null,8,["achievements","title","id","onChosen"]))),128))])):(R(),ee("div",$L,AL))}const PL=Pn(CL,[["render",IL]]),jL={class:"quest-display"},EL={class:"quest-title"},NL={class:"quest-description"},ML={key:0,class:"quest-objectives-container list-disc"},LL=je({__name:"QuestDetails",props:{quest:{}},setup(e){const t=e,n=z(()=>Yr(t.quest.id));function r(l){return ba(t.quest.id,l)}const o=z(()=>{switch(t.quest.state){case"hidden":return" Hidden";case"unlocked":return"";case"completed":return" (Completed)";default:return" Unknown"}}),i=z(()=>t.quest.ending?lv(t.quest.id,t.quest.ending).description:t.quest.succeeded&&n.value.succeededDescription?n.value.succeededDescription:!t.quest.succeeded&&n.value.failedDescription?n.value.failedDescription:n.value.description),s=z(()=>Object.values(t.quest.objectives).filter(l=>l.state!=="hidden"));return(l,u)=>(R(),ee("div",jL,[H("div",{class:Xe(["quest-header",l.quest.state==="completed"?"quest-completed":"quest-in-progress"])},[H("h3",EL,Se(n.value.title)+" "+Se(o.value),1)],2),H("p",NL,Se(i.value),1),l.quest.state!=="completed"?(R(),ee("ul",ML,[(R(!0),ee(Be,null,lt(s.value,c=>(R(),ee("li",{class:"quest-objective-display",key:c.id},[H("p",{class:Xe(["quest-objective-description",c.state==="completed"?"quest-objective-completed":"quest-objctive-in-progress"])},Se(r(c.id).description),3)]))),128))])):xe("",!0)]))}}),DL={class:"quest-list-title"},RL=je({__name:"QuestDisplay",props:{quest:{}},setup(e){const t=e,n=z(()=>Yr(t.quest.id));return(r,o)=>(R(),ee("div",{class:Xe(["quest-list-display",r.quest.state==="completed"?"quest-list-completed":"quest-list-in-progress"])},[H("p",DL,Se(n.value.title),1)],2))}}),FL={key:0},BL={key:0},UL={key:1},qL=je({__name:"quests-list-section",props:{quests:{},sectionId:{},title:{},fallbackText:{}},emits:["quest-selected"],setup(e,{emit:t}){const n=e,r=z(()=>Xa().categories),o=z(()=>{const i=[];return n.quests.reduce((s,l)=>{const u=Yr(l.id).category??"default",c=r.value.find(a=>a.id===u);if(!c)return Te(`Quest category ${u} not found in config`),s;let p=s.find(a=>a.category.id===u);return p||(p={category:c,quests:[]},s.push(p)),p.quests.push(l),s},i)});return(i,s)=>(R(),ee("div",{class:Xe([`${i.sectionId}-quests-container`,"quests-section"])},[H("h3",null,Se(i.title),1),i.quests.length>0?(R(),ee("div",FL,[(R(!0),ee(Be,null,lt(o.value,l=>(R(),ee("div",{class:Xe([`${i.sectionId}-${l.category.id}-category`,"quests-category"]),key:l.category.id},[r.value.length>1?(R(),ee("h4",BL,Se(l.category.title),1)):xe("",!0),H("div",{class:Xe(`${i.sectionId}-${l.category.id}-quests`)},[(R(!0),ee(Be,null,lt(l.quests,u=>(R(),Oe(RL,{key:u.id,quest:u,onClick:c=>i.$emit("quest-selected",u)},null,8,["quest","onClick"]))),128))],2)],2))),128))])):(R(),ee("div",UL,[H("p",null,Se(i.fallbackText),1)]))],2))}}),VL=je({setup(){const e=Gt(),t=z(()=>e.quests),n=be(null);return{quests:t,selectedQuest:n}},computed:{questsToDisplay(){return Object.values(this.quests).filter(e=>e.state!=="hidden")},activeQuests(){return this.questsToDisplay.filter(e=>e.state==="unlocked")},completedQuests(){return this.questsToDisplay.filter(e=>e.state==="completed")},questsUiClass(){return Et().layoutMode==="horizontal"?"quests-ui-horizontal":"quests-ui-vertical"}},mounted(){this.activeQuests.length>0?this.selectedQuest=this.activeQuests[0]:this.completedQuests.length>0&&(this.selectedQuest=this.completedQuests[0])},methods:{clickOnQuest(e){this.selectedQuest=e}},components:{QuestDetails:LL,QuestsListSection:qL}}),HL={class:"quests-list-container"},KL={class:"quest-details"};function GL(e,t,n,r,o,i){const s=wo("QuestsListSection"),l=wo("QuestDetails");return R(),ee("div",{class:Xe(["quests-ui",e.questsUiClass])},[H("div",HL,[Re(s,{quests:e.activeQuests,sectionId:"active",title:"Active Quests",fallbackText:"No active quests",onQuestSelected:e.clickOnQuest},null,8,["quests","onQuestSelected"]),Re(s,{quests:e.completedQuests,sectionId:"completed",title:"Completed Quests",fallbackText:"No completed quests",onQuestSelected:e.clickOnQuest},null,8,["quests","onQuestSelected"])]),H("div",KL,[e.selectedQuest?(R(),Oe(l,{key:0,quest:e.selectedQuest},null,8,["quest"])):xe("",!0)])],2)}const WL=Pn(VL,[["render",GL]]);function Cv(e){const t=Lt(),n=z(()=>t.skills),r=z(()=>n.value[e]),o=z(()=>kr().skills),i=z(()=>kr().skillOptions.xpPerLevel),s=z(()=>({backgroundImage:`url(${Zt(o.value[e].icon)})`})),l=z(()=>o.value[e].name),u=z(()=>o.value[e].description),c=z(()=>`Level ${n.value[e].level}`);return{skills:n,skillsStore:t,skillConfig:o,xpPerLevel:i,skillState:r,skillStyle:s,skillName:l,skillDescription:u,skillLevelText:c}}const zL=e=>(Ef("data-v-a94cb74f"),e=e(),Nf(),e),QL=["id"],JL={class:"flex flex-row skill-description-container"},YL={class:"flex skill-left"},XL={class:"flex skill-right"},ZL=zL(()=>H("hr",{class:"hr-solid"},null,-1)),eD=["innerHTML"],tD=je({__name:"SkillDetails",props:{chosenSkill:{},inputListener:{}},emits:["cancel"],setup(e,{emit:t}){const n=e,r=t,o=be(null),i=be(null);function s(){r("cancel")}const{skillStyle:l,skillName:u,skillDescription:c,skillLevelText:p}=Cv(n.chosenSkill);return St(()=>{o.value=Ar({mode:"list",listener:n.inputListener,container:i,onChosen:()=>{s()}}),o.value.mount()}),Ct(()=>{o.value&&(o.value.disable(),o.value=null)}),(a,d)=>(R(),ee("div",{id:`skill-display-${a.chosenSkill}`},[H("div",JL,[H("div",YL,[H("div",{class:"skill-display",style:Ye(st(l))},null,4)]),H("div",XL,[H("h2",null,Se(st(u)),1),ZL,H("h3",null,Se(st(p)),1),H("p",{innerHTML:st(c)},null,8,eD)])]),H("div",{ref_key:"buttonsContainer",ref:i},[H("button",{class:"nrt-button",onClick:s},Se("<--"))],512)],8,QL))}}),nD=Pn(tD,[["__scopeId","data-v-a94cb74f"]]),rD={class:"skill-title"},oD={class:"skill-xp-container"},sD={class:"skill-xp-text"},iD={class:"skill-level"},aD=je({__name:"SkillGridElement",props:{chosenSkill:{},inputListener:{}},emits:["choose"],setup(e,{expose:t,emit:n}){const r=e,o=be(null);t({gridElement:o});const i=n;function s(){i("choose")}const{skillStyle:l,skillName:u,skillState:c,xpPerLevel:p}=Cv(r.chosenSkill),a=z(()=>({width:`${Math.floor(c.value.xp/p.value*100)}%`}));return(d,h)=>(R(),ee("button",{onClick:s,class:"skill-grid-element",style:Ye(st(l)),ref_key:"gridElement",ref:o},[H("h3",rD,Se(st(u)),1),H("div",oD,[H("div",{class:"skill-xp-bar",style:Ye(a.value)},null,4),H("h3",sD,Se(st(c).xp)+" / "+Se(st(p))+" XP",1)]),H("h3",iD,Se(st(c).level),1)],4))}}),lD=Pn(aD,[["__scopeId","data-v-8d457bf9"]]),cD={class:"skills-container"},uD=je({__name:"SkillsGrid",props:{inputListener:{},lastChosenSkill:{type:[String,Boolean]}},emits:["choose"],setup(e,{emit:t}){const n=e,r=be([]),o=z(()=>r.value.map(d=>d.gridElement)),i=Lt(),s=z(()=>i.skills),l=be(null),u=t;function c(d){u("choose",d)}const p=z(()=>kr().skills),a=z(()=>{const d={};for(const h in s.value)p.value[h].hidden&&s.value[h].level<1||(d[h]=s.value[h]);return Object.values(d)});return St(()=>{var d;if(l.value=Ar({mode:"grid",listener:n.inputListener,elements:o,columns:3,onChosen:h=>{c(a.value[h].id)}}),(d=l.value)==null||d.mount(),typeof n.lastChosenSkill=="string"){const h=a.value.findIndex(m=>m.id===n.lastChosenSkill);h>=0&&l.value.select(h)}}),Ct(()=>{l.value&&l.value.disable()}),(d,h)=>(R(),ee("div",cD,[(R(!0),ee(Be,null,lt(a.value,m=>(R(),Oe(lD,{ref_for:!0,ref_key:"skillGridElements",ref:r,key:m.id,onChoose:()=>c(m.id),chosenSkill:m.id,inputListener:d.inputListener},null,8,["onChoose","chosenSkill","inputListener"]))),128))]))}}),dD=Pn(uD,[["__scopeId","data-v-31202bb8"]]),pD=je({__name:"SkillsWindow",props:{inputListener:{}},setup(e){const t=be(!1),n=be(!1);function r(i){n.value=i,t.value=i}function o(){t.value=!1}return(i,s)=>t.value?typeof t.value=="string"?(R(),Oe(nD,{key:1,chosenSkill:t.value,inputListener:i.inputListener,onCancel:o},null,8,["chosenSkill","inputListener"])):xe("",!0):(R(),Oe(dD,{key:0,inputListener:i.inputListener,lastChosenSkill:n.value,onChoose:r},null,8,["inputListener","lastChosenSkill"]))}});function fD(e){e.component("MainMenu",QM),e.component("InventoryTab",gL),e.component("AchievementsUI",PL),e.component("QuestsUi",WL),e.component("SkillsWindow",pD),Jt().menus={system:{label:"System",cssClass:"system-menu",id:"system",inputPrompt:"system",tabs:[{id:"system-tab",cssId:"system-tab",text:"System",component:"MainMenu"}],activeTab:0},menu:{label:"Menu",id:"menu",cssClass:"menu-menu",inputPrompt:"menu",tabs:[{id:"skills",cssId:"skills-menu-button",text:"Skills",condition:()=>Jt().showSkills,component:"SkillsWindow"},{id:"inventory",cssId:"inventory-menu-button",text:"Items",condition:()=>Jt().showInventory,component:"InventoryTab"},{id:"quests",cssId:"quests-menu-button",text:"Quests",condition:()=>Jt().showQuests,component:"QuestsUi"},{id:"achievements",cssId:"achievements-menu-button",text:"Achievements",condition:()=>Jt().showAchievements,component:"AchievementsUI"}],activeTab:0}}}function xv(e,t,n){const r=window.narrat.app;for(const o in t.tabs){const i=t.tabs[o].component;r.component(i,n[i])}Jt().addMenu(e,t)}function hD(e,t,n){window.narrat.app.component(t.component,n),Jt().addMenuOption(e,t)}function mD(){for(const e of Ge.plugins){if(e.customMenuButtons)for(const t of e.customMenuButtons)xv(t.config.id,t.config,t.components);if(e.customMenuTabs)for(const t of e.customMenuTabs)hD(t.config.id,t.config,t.component)}}function yD(e){e.directive("visible",{mounted(t,n){n.value?t.style.visibility="visible":t.style.visibility="hidden"},updated(t,n){n.value?t.style.visibility="visible":t.style.visibility="hidden"}})}class sd{constructor(){ot(this,"pluginId","narrat-plugin")}onPageLoaded(){}onNarratSetup(){}onAppMounted(){}onAssetsLoaded(){}onGameSetup(){}onStartScreenMounted(){}onGameStart(){}onGameMounted(){}onGameUnmounted(){}}function gD(e){Ge.addPlugin(e)}function vD(e){Ge.addCommand(e)}const bD={args:[],canvasResizePolicy:0,executable:"",experimentalVK:!1,fileSizes:{"index.pck":54160,"index.wasm":52315256},focusCanvas:!1,gdextensionLibs:[]};function _D(){window.godotReady=!0,window.narratReadyCallback&&window.narratReadyCallback(),console.log("godot ready")}window.godotReadyCallback=_D;class TD extends sd{constructor(t){super(),ot(this,"customCommands",[]),ot(this,"canvas"),ot(this,"app"),ot(this,"messageQueue",[]),ot(this,"narrat"),ot(this,"narratReady",!1),ot(this,"engineConfig"),ot(this,"engine");const n={...bD,...t.engineConfigOverrides??{}};t.godotGamePath&&(n.executable=t.godotGamePath),this.engineConfig=n,this.customCommands=[Y.FromOptions({keyword:"godot_pause",argTypes:[],runner:async r=>{this.addMessageForGodot({type:"pause",payload:{}})}}),Y.FromOptions({keyword:"godot_resume",argTypes:[],runner:async r=>{this.addMessageForGodot({type:"resume",payload:{}})}})]}onAppMounted(){const t=document.querySelector("#narrat");if(!t){console.error("no app");return}this.narrat=window.narrat;const n=document.createElement("canvas");this.app=t,this.canvas=n,n.id="godot-canvas",n.style.position="absolute",n.style.zIndex="0",t.appendChild(n),window.addEventListener("keydown",r=>{if(r.fakeEvent)return;const o=new KeyboardEvent(r.type,r);o.fakeEvent=!0,this.canvas.dispatchEvent(o)}),window.addEventListener("keyup",r=>{if(r.fakeEvent)return;const o=new KeyboardEvent(r.type,r);o.fakeEvent=!0,this.canvas.dispatchEvent(o)}),new window.Engine(this.engineConfig).startGame(),this.resizeCanvas(),window.godot=this,this.narratReady=!0,window.narratReadyCallback&&window.narratReadyCallback()}getCanvas(){return document.querySelector("#godot-canvas")}addMessageForGodot(t){this.messageQueue.unshift(t),window.godotCallback&&window.godotCallback(t)}grabNextMessage(){return this.messageQueue.pop()}async run(t,...n){const r=await this.narrat.run(t,...n),o={type:"run_end",payload:{label:t,args:n,result:r}};this.addMessageForGodot(o)}isJson(t){try{JSON.parse(t)}catch{return!1}return!0}resizeCanvas(){const t=Et(),n=t.gameWidth,r=t.gameHeight;this.canvas.width=n,this.canvas.height=r,this.canvas.style.width=`${n}px`,this.canvas.style.height=`${r}px`,window.requestAnimationFrame(()=>this.resizeCanvas())}}class wD extends sd{constructor(t={}){super(),ot(this,"defaultTheme"),ot(this,"themes",[]),ot(this,"activeTheme"),ot(this,"customCommands"),ot(this,"initialConfig"),t.defaultTheme&&(this.defaultTheme=t.defaultTheme),t.themes&&(this.themes=t.themes),this.customCommands=[this.createChangeThemeCommand()]}onNarratSetup(){if(this.defaultTheme){const t=this.themes.find(n=>n.id===this.defaultTheme);if(!t){Te(`Theme ${this.defaultTheme} not found`);return}this.setTheme(t)}}addTheme(t){this.themes.push(t)}createChangeThemeCommand(){return Y.FromOptions({keyword:"change_theme",argTypes:[{name:"theme",type:"string"}],runner:async t=>{this.changeTheme(t.options.theme)}})}changeTheme(t){if(t==="default"){this.removeCurrentTheme();return}const n=this.findTheme(t);this.setTheme(n)}findTheme(t){const n=this.themes.find(r=>r.id===t);return n||Te(`Theme ${t} not found`),n}setTheme(t){this.activeTheme&&this.removeCurrentTheme(),this.activeTheme={themeTag:this.createThemeTag(t),id:t.id},document.head.appendChild(this.activeTheme.themeTag),t.extendedConfig&&(this.initialConfig=Ao({},Bt().config),Bt().extendConfig(t.extendedConfig))}createThemeTag(t){if(this.isInlineTheme(t)){const n=document.createElement("style");return n.innerHTML=t.css,n}else{const n=document.createElement("link");return n.rel="stylesheet",n.href=t.cssPath,n.id=t.id,n}}isInlineTheme(t){return t.css!==void 0}isExternalTheme(t){return t.cssPath!==void 0}removeCurrentTheme(){this.activeTheme&&(this.activeTheme.themeTag&&this.activeTheme.themeTag.remove(),this.findTheme(this.activeTheme.id).extendedConfig&&(Bt().config=this.initialConfig)),this.activeTheme=void 0}}const kD="body{font-size:52px}",SD={css:kD,id:"narrat-fun-theme",extendedConfig:{}},CD="#narrat-app{--bg-color: #131720;--text-color: #d9e1f2;--primary: hsl(255, 30%, 55%);--focus: hsl(210, 90%, 50%);--secondary: #42b983;--dialog-box-bg: transparent;--dialog-box-border: none}.interact-button{background:unset;border:none;font-size:2rem;font-weight:700;color:#fff;font-family:monospace;text-shadow:-4px 4px 2px #000}.dialog{box-shadow:none!important;text-align:center}.dialog-text{font-size:1.5rem;font-family:monospace;text-shadow:-4px 4px 2px #000}",xD={id:"narrat-text-only",css:CD,extendedConfig:{common:{dialogPanel:{textSpeed:30,animateText:!0,timeBetweenLines:100,overlayMode:!0,rightOffset:300,bottomOffset:150,width:700,height:680}}}},$D=Object.freeze(Object.defineProperty({__proto__:null,BaseConfigInputSchema:au,BuiltInScene:Yn,CommandPlugin:Y,ConfigInputSchema:yg,ConfigInputSchemaWithCommon:hg,ConfigInputSchemaWithoutCommon:mg,EngineSplash:Fy,GameDialog:Qy,GameSplash:Uy,GodotPlugin:TD,Hud:eg,InGame:tg,InputsListener:Vy,LogManager:Bc,MenuButtons:Yy,ModalWindow:eo,NarratPlugin:sd,NarratThemesPlugin:wD,Screens:Zy,StartMenu:Gy,get Vec2(){return es},addCommand:vD,aspectRatioFit:By,audioConfig:xn,buttonsConfig:Qu,charactersConfig:Ju,constructNarratObject:$v,debounce:Ka,error:Te,findVariable:Dh,funTheme:SD,gameloop:Ha,generateObjectFromList:Fh,generateParser:_i,getAssetUrl:Zt,getButtonConfig:xo,getConfig:ve,getDataUrl:Xu,getFile:nu,getImageUrl:Jr,getItemConfig:tr,getObjectiveConfig:ba,getQuestConfig:Yr,getScreenConfig:Ti,getSkillConfig:Yu,getSplitConfigUrl:av,getWindow:Hc,handleHMR:ev,inputEvents:Hn,isConfigInputWithCommon:lu,isModuleValid:Zg,isNarratScript:tv,isNarratYaml:Wu,isPromise:Bh,itemsConfig:zu,loadDataFile:qa,logManager:Uc,logger:qn,processText:Cr,questsConfig:Xa,randomId:as,registerMenuButton:xv,registerPlugin:gD,screensConfig:ic,skillsConfig:kr,textOnlyTheme:xD,timeout:cn,tooltipsConfig:Co,useAchievements:_s,useAudio:Yt,useConfig:Bt,useDialogStore:rt,useFontsStore:rd,useHud:bn,useInputs:ut,useInventory:Xt,useMain:Le,useMenu:Jt,useNotifications:un,useQuests:Gt,useRenderingStore:Et,useScenes:vn,useScreenObjects:An,useScreens:Vn,useSkills:Lt,useTooltips:hi,useVM:Ue,warning:ys},Symbol.toStringTag,{value:"Module"}));function $v(e){const t={app:e,vm:Ge,handleHMR:ev,jump:n=>Ue().jumpToLabel(n),run:(n,...r)=>Ue().runThenGoBackToPreviousDialog(n,...r),getSave:()=>ir(),exports:$D};return window.narrat=t,t}let uo;Ge.callHook("onPageLoaded");async function OD(e){Ha.setup(),console.log("Starting narrat...");const t=Object.assign(mx(),e),n=N_();uo=l_(vj,{options:t}),uo.use(n),zC(),Le().setOptions(t),yD(uo);const r=await TI(t);Bt().setConfig(r),ir(),ut().setupInputs(),Ge.pinia=n,Le(),$v(uo),fD(uo),mD(),ou().addButtonsFromPlugins(),CM(Ge),Uc.setupDebugger(t.debug),console.log(`%c 🐀 Narrat v${bT} %c PRODUCTION BUILD %c https://narrat.dev %c
    Built at ${_T.toLocaleString()}
    Branch: ${np.branch}
    Commit: ${np.commit}`,"font-size: 2rem; background: #222; color: orange","font-size: 2rem; background: #222; color: #f00","font-size: 1rem;","font-size: 1.3rem; background: #222; color: #bada55"),Ge.callHook("onNarratSetup");let o;return typeof t.container=="string"?o=document.querySelector(t.container):o=t.container,o||alert("The narrat container was not found!"),Et().setContainer(o),ut().listenToContainerInputs(),uo.mount(o),Et().narratAppElement=document.querySelector("#narrat-app"),o.focus(),uo}const AD=`main:
  narrate "Emptiness, but not void."
  narrate "An infinite landscape extends in all directions, with no horizon in sight."
  narrate "A blend of shades of white. No clear source of light."
  narrate "A hum."
  narrate "Like a thought before language. Like a word striving to be spoken."
  narrate "Silence breaks—not with a sound, but with a meaning."
  narrate "A name emerges. Unspoken. Unheard. Unseen."
  talk silence idle "Salvador Banderas"
  narrate "Is it yours?"
  narrate "You don't know, but its presence is all over the place."
  narrate "Then the rush begins, like a waterfall of thoughts."
  talk silence idle "Narrative Design"
  talk silence idle "Game Development"
  talk silence idle "Translation"
  talk silence idle "Educational Technology"
  narrate "Like silent voices, echoing in an infinite abyss."
  narrate "Then, five symbols ignite. Slowly, as if pulled from the depths beneath your skin."
  add_level logic (random 1 6)
  talk silence idle "Logic. The mute solver of problems."
  add_level charisma (random 1 6)
  talk silence idle "Charisma. The joyful spark of connection."
  add_level empathy (random 1 6)
  talk silence idle "Empathy. The warm embrace of understanding."
  add_level drive (random 1 6)
  talk silence idle "Drive. The relentless push forward."
  add_level intuition (random 1 6)
  talk silence idle "Intuition. The uncharted whisper of the unknown."
  narrate "Their essence settle into your being. They are not yours, but they will be."
  narrate "Almost there."
  narrate "The world around you begins to take shape. Someone is waiting."
  narrate "Or perhaps dreaming."
  narrate "Finally, a thought."
  jump role_choice

role_choice:
  think player idle "Who am I?"
  choice
    "I am..."
    "...a recruiter from a big game company. I am looking for the next big thing."
      jump recruiter_scene
    "...the boss of a small indie game company. I need to find the right people to make my dream game."
      jump indie_scene
    "...someone looking for a collaborator to make a game with."
      jump collab_scene
    "...Salva."
      jump salva_scene
    "...I don't know."
      jump unknown_scene`,ID={code:AD,fileName:"game.narrat",id:"/home/salva/projects/thu-king-interactive_interview/src/scripts/game.narrat",type:"script"},PD=`recruiter_scene:
  set current_phase "phase0"
  set phases (new Object)
  set phases.phase1 0
  set phases.phase2 0
  set phases.phase3 0
  set phases.phase4 0
  set phases.phase5 0
  set phases.phase6 0
  jump intro_scene

increase_phase:
  add phases[$current_phase] 1

intro_scene:
  "You sit at a table made of glass, warm to the touch. A file lies in front of you—blank. The lights flicker, just once, as if reality is catching its breath."
  "Across from you, a door opens."
  "Salva steps in, not with swagger, but with a deliberate calm. His outfit is sharp but not showy, his posture balanced between humble and unafraid. But your eyes are drawn to the strange artifact around his neck—a swirling pendant, faintly humming with a golden pulse."
  talk lore idle "L’Amulet d’Auteur. A rumored relic of narrative resilience. It’s said that no question can truly undo him—not because he knows everything, but because he knows himself."
  talk salva idle "I’m ready when you are."
  think player idle "(Think) Who are you?"
  jump phase1_jump

phase1_jump:
  "Phase 1: Background & Motivation"
  set current_phase "phase1"
  jump phase1

phase1:
  if (>= $phases.phase1 2)
    jump phase2_jump
  run increase_phase

  choice:
    "What should I know about his background?"

    "What first drew you to game development?":
      talk salva idle "Honestly? I was already building worlds in my head as a kid. Learning code just gave me the syntax."

    "Your background isn’t typical. How do you explain your path to where you are now?":
      talk salva idle "It’s not a ladder. It’s a web. I’ve touched writing, design, code, localization… it all weaves together."

    roll motivation empathy 13 "Would you say your motivation is more intrinsic or strategic?":
      if motivation:
        talk salva idle "I’m deeply driven by meaning. If a story doesn't say something, I lose interest."
      else:
        talk salva idle "Hah, I could say ‘both,’ but that’s a cop-out, isn’t it?"

    roll burnout drive 15 "Have you ever lost motivation? What pulled you back?":
      if burnout:
        talk salva idle "Absolutely. I’ve burned out before. But telling stories that matter—that’s the spark."
      else:
        talk salva idle "Sure. I just power through. No tricks, just stubbornness."

    "There’s a quiet logic behind your path. Did you plan this?" if (> (get_level logic) 3):
      talk salva idle "I didn’t map it, but the signs were always there. I followed the threads."

  jump phase1

phase2_jump:
  "Phase 2: Technical & Craft Skills"
  set current_phase "phase2"
  jump phase2

phase2:
  if (>= $phases.phase2 2)
    jump phase3_jump
  run increase_phase

  choice:
    "Let's see what he can do."

    "What’s a tool or engine you’ve loved working with, and why?":
      talk salva idle "Unity, mostly. But not because it’s perfect—because it lets me iterate fast, fail fast, fix faster."

    "Tell me about a technical challenge you’re proud of solving.":
      talk salva idle "Once, I built a modular narrative system inside Moodle. Yes, Moodle. Don’t laugh."

    roll creativity logic 14 "How do you balance code and creativity when deadlines hit?":
      if creativity:
        talk salva idle "I scope aggressively, and I chunk everything. That way, the story survives the sprint."
      else:
        talk salva idle "Balance? I crash headfirst, then patch the narrative. Not elegant, but honest."

    roll skill_growth drive 15 "How do you keep your technical skills sharp while focusing on design?":
      if skill_growth:
        talk salva idle "Late nights, prototypes, learning from others. I like getting stuck—it means I’m growing."
      else:
        talk salva idle "I try… but I prioritize design these days."

    "Your code reads like it’s designed for someone else. Is that intentional?" if (> (get_level intuition) 4):
      talk salva idle "Always. If someone can’t pick up my work, I haven’t finished it."

  jump phase2

phase3_jump:
  "Phase 3: Collaboration & Soft Skills"
  set current_phase "phase3"
  jump phase3

phase3:
  if (>= $phases.phase3 2)
    jump phase4_jump
  run increase_phase

  choice:
    "Nice, but can he work with others?"

    "How do you handle feedback you disagree with?":
      talk salva idle "I ask why. Not as a defense, but to map the mismatch."

    "What kind of team brings out your best work?":
      talk salva idle "One that’s kind, sharp, and not afraid of the weird."

    roll collab_story empathy 14 "Describe a time when collaboration made your idea better.":
      if collab_story:
        talk salva idle "The best twist in Myself? Wasn't mine. A friend’s gut-punch suggestion. I just shaped it."
      else:
        talk salva idle "I like feedback. Sometimes it works. Sometimes… I ignore it."

    roll team_value charisma 13 "What do you bring to a team, beyond your skillset?":
      if team_value:
        talk salva idle "Energy. Sincerity. A voice that asks ‘what if we went further?’"
      else:
        talk salva idle "I try to help. Maybe I talk too much."

    "You seem tuned in. Ever play the team therapist?" if (> (get_level empathy) 4):
      talk salva idle "Guilty. But I won’t force it unless I’m needed."

  jump phase3

phase4_jump:
  "Phase 4: Design Thinking & Philosophy"
  set current_phase "phase4"
  jump phase4

phase4:
  if (>= $phases.phase4 2)
    jump phase5_jump
  run increase_phase

  choice:
    "What makes him tick?"

    "What makes a story game-worthy?":
      talk salva idle "Player agency. Otherwise, it’s just a short film with clicks."

    "What design lesson took you the longest to learn?":
      talk salva idle "That fun isn’t the only metric. Impact matters, even when it stings."

    roll narrative_loop logic 15 "How do you balance narrative depth with gameplay loops?":
      if narrative_loop:
        talk salva idle "Narrative is the loop. If the story breathes inside the mechanics, you’ve won."
      else:
        talk salva idle "I… try. But I still prototype too many story-heavy ideas."

    roll emotional_impact intuition 13 "What kind of emotions do you want players to walk away with?":
      if emotional_impact:
        talk salva idle "Recognition. A quiet ‘that was me’ when the credits roll."
      else:
        talk salva idle "I… I don’t know. I want to make them feel, but I’m still learning how."

    "You mentioned systems earlier. Are you a narrative systems designer at heart?" if (> (get_level logic) 4):
      talk salva idle "Yes. Systems tell stories too—if we let them."

  jump phase4

phase5_jump:
  "Phase 5: Pressure Test / Red Flags"
  set current_phase "phase5"
  jump phase5

phase5:
  if (>= $phases.phase5 2)
    jump phase6_jump
  run increase_phase

  choice:
    "Let's see how he handles the heat."

    "When have you failed? What did you learn?":
      talk salva idle "Kenney Jam 2024. I had the mechanics. I had the vision. I didn’t finish. That still burns."

    "What’s a blind spot you’re working on?":
      talk salva idle "Polish. I overdesign systems. I’m learning when to let go."

    roll adapt charisma 14 "How do you handle sudden changes in a project’s direction?":
      if adapt:
        talk salva idle "I try to rally people. If the core survives, we adapt."
      else:
        talk salva idle "Honestly? I get frustrated. Then I sulk. Then I get over it."

    roll regret empathy 15 "Have you ever made a call you regret?":
      if regret:
        talk salva idle "Yes. I cut someone’s feature without asking. They were crushed. I apologized. I still think about it."
      else:
        talk salva idle "I try not to regret. But I’ve made calls I’d now tweak."

    "You seem… relentless. Ever burn out?" if (> (get_level drive) 4):
      talk salva idle "Yes. Multiple times. But the fire always comes back."

  jump phase5

phase6_jump:
  "Phase 6: Wildcard / Playful / Weird"
  set current_phase "phase6"
  jump phase6

phase6:
  if (>= $phases.phase6 2)
    jump interview_climax
  run increase_phase

  choice:
    "And now, to end on a high note..."

    "You get one genre to design in for the rest of your life. What is it?":
      talk salva idle "Psychological puzzle-platformers. With jokes."

    "What’s a game idea you’d greenlight even if it made zero money?":
      talk salva idle "A silent rhythm game about aphasia. Wait—I’m already making it."

    roll improv_game charisma 16 "Invent a game right now, from a random word.":
      if improv_game:
        talk salva idle "Okay—‘Dust.’ A game where you can’t see your enemies, only their footprints in ash."
      else:
        talk salva idle "Uhh… ‘Brick Simulator’? I’ll come back to you."

    roll weird_mechanic logic 14 "What’s the weirdest mechanic you’ve ever imagined?":
      if weird_mechanic:
        talk salva idle "A turn-based game where time moves only if you don’t. Like, the opposite of Superhot."
      else:
        talk salva idle "I have this dice-based AI concept, but it’s still chaotic."

    "You think in metaphors a lot. Ever thought of designing poetry into gameplay?" if (> (get_level intuition) 4):
      talk salva idle "Always. Maybe one day I will."

  jump phase6

interview_climax:
  "The room is still now. The hum of the screens has quieted, like they, too, are waiting."
  "Salva adjusts the strange pendant around his neck—L’Amulet d’Auteur. It flickers once."
  "You expected a final glow. A flash of brilliance. A triumphant shimmer."
  "But there is none."
  "Instead, something simpler, more profound:"
  "His posture is upright. His eyes are steady. His voice—clear, calm, resolute."
  "He didn’t need saving. Not this time."
  "The amulet was not bright. It was fire."
  "And the fire was him."
  talk salva idle "So... how did I do?"
`,jD={code:PD,fileName:"recruiter.narrat",id:"/home/salva/projects/thu-king-interactive_interview/src/scripts/recruiter.narrat",type:"script"},ED=`indie_scene:
  talk salva idle "This role exists only in my imaginarium. You may choose another."
  jump role_choice`,ND={code:ED,fileName:"indie.narrat",id:"/home/salva/projects/thu-king-interactive_interview/src/scripts/indie.narrat",type:"script"},MD=`collab_scene:
  talk salva idle "This role exists only in my imaginarium. You may choose another."
  jump role_choice`,LD={code:MD,fileName:"collab.narrat",id:"/home/salva/projects/thu-king-interactive_interview/src/scripts/collab.narrat",type:"script"},DD=`salva_scene:
  talk salva idle "This role exists only in my imaginarium. You may choose another."
  jump role_choice`,RD={code:DD,fileName:"salva.narrat",id:"/home/salva/projects/thu-king-interactive_interview/src/scripts/salva.narrat",type:"script"},FD=`unknown_scene:
  talk salva idle "This role exists only in my imaginarium. You may choose another."
  jump role_choice`,BD={code:FD,fileName:"unknown.narrat",id:"/home/salva/projects/thu-king-interactive_interview/src/scripts/unknown.narrat",type:"script"},UD=[ID,jD,ND,LD,RD,BD],qD={files:{},options:{volume:.5,musicFadeInTime:.5,musicFadeInDelay:.5,musicFadeOutTime:.5},audioTriggers:{}},VD={code:qD,fileName:"audio.yaml",id:"/home/salva/projects/thu-king-interactive_interview/src/config/audio.yaml",type:"yaml"},HD={buttons:{}},KD={code:HD,fileName:"buttons.yaml",id:"/home/salva/projects/thu-king-interactive_interview/src/config/buttons.yaml",type:"yaml"},GD={config:{imagesPath:"img/characters/"},characters:{game:{name:"",color:"white"},player:{style:{color:"orange"},name:"You"},salva:{style:{color:"purple"},name:"Salva"},silence:{style:{color:"yellow"},name:"Silence"},lore:{style:{color:"red"},name:"Lore"}}},WD={code:GD,fileName:"characters.yaml",id:"/home/salva/projects/thu-king-interactive_interview/src/config/characters.yaml",type:"yaml"},zD={gameTitle:"Salvador Banderas Rovira - Interactive Interview",saveFileName:"Salva Interview",images:{},dialogPanel:{textSpeed:30,animateText:!0,timeBetweenLines:100,overlayMode:!0,rightOffset:100,bottomOffset:50,width:475,height:680,allowHistoryToggling:!0,historyLength:200,hideDuringTransition:!0,showAfterScriptEnd:!1},input:{showPromptsOnGamepad:!0,showPromptsOnKeyboard:!0,showBottomLegend:!0},graphics:{allowFullscreen:!0},layout:{backgrounds:{width:1280,height:720},dialogBottomPadding:70,mobileDialogHeightPercentage:60,verticalLayoutThreshold:600,portraits:{width:100,height:100}},notifications:{timeOnScreen:2.5,alsoPrintInDialogue:!0},hudStats:{},interactionTags:{default:{onlyInteractOutsideOfScripts:!0}},saves:{disabled:!0,mode:"manual",slots:10,runOnReload:"test_label_reload",autosaveDisabledOnLabels:["test_no_autosave"],allowManualSave:!0,autosaveFeedback:{enabled:!0,duration:.5,text:"saving...",backgroundImage:"img/ui/autosave_spinner_background.png",foregroundImage:"img/ui/autosave_spinner.png"}},menuButtons:{"new-game":{text:"Start a new game"}}},QD={code:zD,fileName:"common.yaml",id:"/home/salva/projects/thu-king-interactive_interview/src/config/common.yaml",type:"yaml"},JD={categories:[{id:"misc",title:"Miscellany"}],items:{}},YD={code:JD,fileName:"items.yaml",id:"/home/salva/projects/thu-king-interactive_interview/src/config/items.yaml",type:"yaml"},XD={categories:[{id:"default",title:"Default"}],quests:{}},ZD={code:XD,fileName:"quests.yaml",id:"/home/salva/projects/thu-king-interactive_interview/src/config/quests.yaml",type:"yaml"},eR={screens:{default:{background:"img/backgrounds/background.png"}}},tR={code:eR,fileName:"screens.yaml",id:"/home/salva/projects/thu-king-interactive_interview/src/config/screens.yaml",type:"yaml"},nR={skills:{logic:{name:"Logic",description:"Your analytical reasoning ability",startingLevel:0,icon:"img/skills/logic.png",hidden:!0},charisma:{name:"Charisma",description:"Your persuasive and social fluency",startingLevel:0,icon:"img/skills/charisma.png",hidden:!0},empathy:{name:"Empathy",description:"Your emotional intelligence and ability to read people",startingLevel:0,icon:"img/skills/empathy.png",hidden:!0},drive:{name:"Drive",description:"Your ambition and determination to dig deeper",startingLevel:0,icon:"img/skills/drive.png",hidden:!0},intuition:{name:"Intuition",description:"Your instinctive understanding of subtext and emotion",startingLevel:0,icon:"img/skills/intuition.png",hidden:!0}},skillChecks:{rollRange:20,skillMultiplier:1,failureChance:1,difficultyText:[[1,"Critical Miss"],[2,"Low"],[10,"Medium"],[15,"High"],[20,"Critical Hit"]]}},rR={code:nR,fileName:"skills.yaml",id:"/home/salva/projects/thu-king-interactive_interview/src/config/skills.yaml",type:"yaml"},oR={options:{diceRange:[1,20],diceCount:1,extraPointsPerLevel:1,extraDicePerLevel:0,successOnRollsBelowThreshold:!1,showDifficultyText:!0,showDifficultyNumber:!0,showDifficultyWithoutModifiers:!1,totalRollIsHighest:!1,totalRollIsLowest:!1,difficultyText:[[1,"Critical Miss"],[2,"Low"],[10,"Medium"],[15,"High"],[20,"Critical Hit"]]},skillChecks:{}},sR={code:oR,fileName:"skillchecks.yaml",id:"/home/salva/projects/thu-king-interactive_interview/src/config/skillchecks.yaml",type:"yaml"},iR={allowChoosingFont:!0,fontSets:{default:{header:{name:"Baskervville SC",fontFamily:'"Baskervville SC", serif',files:["fonts/Baskervville_SC/BaskervvilleSC-Regular.ttf"]},body:{name:"Montserrat",fontFamily:'"Montserrat", sans-serif',files:[{file:"fonts/Montserrat/Montserrat-VariableFont_wght.ttf",options:{}},{file:"fonts/Montserrat/Montserrat-Italic-VariableFont_wght.ttf",options:{style:"italic"}}]}},custom:{header:{name:"Nerko One",fontFamily:'"Nerko One", cursive',files:["fonts/Nerko_One/NerkoOne-Regular.ttf"]},body:{name:"Sevillana",fontFamily:'"Sevillana", cursive',files:["fonts/Sevillana/Sevillana-Regular.ttf"]}},opendyslexic:{header:{name:"OpenDyslexic",fontFamily:'"OpenDyslexic", sans-serif',files:[{file:"fonts/OpenDyslexic/OpenDyslexic-Regular.woff2",options:{weight:400}},{file:"fonts/OpenDyslexic/OpenDyslexic-Bold.woff2",options:{weight:700}},{file:"fonts/OpenDyslexic/OpenDyslexic-Italic.woff2",options:{style:"italic"}},{file:"fonts/OpenDyslexic/OpenDyslexic-Bold-Italic.woff2",options:{weight:700,style:"italic"}}]},body:{name:"OpenDyslexic",fontFamily:'"OpenDyslexic", sans-serif',files:[{file:"fonts/OpenDyslexic/OpenDyslexic-Regular.woff2",options:{weight:400}},{file:"fonts/OpenDyslexic/OpenDyslexic-Bold.woff2",options:{weight:700}},{file:"fonts/OpenDyslexic/OpenDyslexic-Italic.woff2",options:{style:"italic"}},{file:"fonts/OpenDyslexic/OpenDyslexic-Bold-Italic.woff2",options:{weight:700,style:"italic"}}]}}}},aR={code:iR,fileName:"fonts.yaml",id:"/home/salva/projects/thu-king-interactive_interview/src/config/fonts.yaml",type:"yaml"},lR={audio:VD,buttons:KD,characters:WD,common:QD,items:YD,quests:ZD,screens:tR,skills:rR,skillChecks:sR,fonts:aR};let Ov=!0;({}).VITE_DEBUG||(Ov=!1);window.addEventListener("load",()=>{OD({debug:Ov,logging:!1,scripts:UD,config:lR})});export{t$ as P,Pv as _,Cg as o,Ch as s};
